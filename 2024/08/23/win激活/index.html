<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>windows激活工具 | 大数据创智社团</title><meta name="author" content="极风"><meta name="copyright" content="极风"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="激活工具">
<meta property="og:type" content="article">
<meta property="og:title" content="windows激活工具">
<meta property="og:url" content="http://example.com/2024/08/23/win%E6%BF%80%E6%B4%BB/index.html">
<meta property="og:site_name" content="大数据创智社团">
<meta property="og:description" content="激活工具">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic.imgdb.cn/item/66f52624f21886ccc0dd07f6.jpg">
<meta property="article:published_time" content="2024-08-22T16:00:00.000Z">
<meta property="article:modified_time" content="2024-09-08T07:25:11.530Z">
<meta property="article:author" content="极风">
<meta property="article:tag" content="应用程序">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic.imgdb.cn/item/66f52624f21886ccc0dd07f6.jpg"><link rel="shortcut icon" href="/./img/favicon.ico"><link rel="canonical" href="http://example.com/2024/08/23/win%E6%BF%80%E6%B4%BB/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://geyueshi.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"该文章创建于","messageNext":"前天，轻以新文章为准。"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 极风","link":"链接: ","source":"来源: 大数据创智社团","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'windows激活工具',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-08 15:25:11'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2024/08/20/JDnLQO4KxRygEb5.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">35</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">16</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/lanzou/"><i class="fa-fw fas fa-link"></i><span> 蓝奏云解析</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://pic.imgdb.cn/item/66f52624f21886ccc0dd07f6.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="大数据创智社团"><span class="site-name">大数据创智社团</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/lanzou/"><i class="fa-fw fas fa-link"></i><span> 蓝奏云解析</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">windows激活工具</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-08-22T16:00:00.000Z" title="发表于 2024-08-23 00:00:00">2024-08-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-09-08T07:25:11.530Z" title="更新于 2024-09-08 15:25:11">2024-09-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">63.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>385分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="windows激活工具"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Windows激活工具"><a href="#Windows激活工具" class="headerlink" title="Windows激活工具"></a>Windows激活工具</h1><h2 id="复制代码然后后缀为cmd文件"><a href="#复制代码然后后缀为cmd文件" class="headerlink" title="复制代码然后后缀为cmd文件"></a><em>复制代码然后后缀为cmd文件</em></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br><span class="line">2345</span><br><span class="line">2346</span><br><span class="line">2347</span><br><span class="line">2348</span><br><span class="line">2349</span><br><span class="line">2350</span><br><span class="line">2351</span><br><span class="line">2352</span><br><span class="line">2353</span><br><span class="line">2354</span><br><span class="line">2355</span><br><span class="line">2356</span><br><span class="line">2357</span><br><span class="line">2358</span><br><span class="line">2359</span><br><span class="line">2360</span><br><span class="line">2361</span><br><span class="line">2362</span><br><span class="line">2363</span><br><span class="line">2364</span><br><span class="line">2365</span><br><span class="line">2366</span><br><span class="line">2367</span><br><span class="line">2368</span><br><span class="line">2369</span><br><span class="line">2370</span><br><span class="line">2371</span><br><span class="line">2372</span><br><span class="line">2373</span><br><span class="line">2374</span><br><span class="line">2375</span><br><span class="line">2376</span><br><span class="line">2377</span><br><span class="line">2378</span><br><span class="line">2379</span><br><span class="line">2380</span><br><span class="line">2381</span><br><span class="line">2382</span><br><span class="line">2383</span><br><span class="line">2384</span><br><span class="line">2385</span><br><span class="line">2386</span><br><span class="line">2387</span><br><span class="line">2388</span><br><span class="line">2389</span><br><span class="line">2390</span><br><span class="line">2391</span><br><span class="line">2392</span><br><span class="line">2393</span><br><span class="line">2394</span><br><span class="line">2395</span><br><span class="line">2396</span><br><span class="line">2397</span><br><span class="line">2398</span><br><span class="line">2399</span><br><span class="line">2400</span><br><span class="line">2401</span><br><span class="line">2402</span><br><span class="line">2403</span><br><span class="line">2404</span><br><span class="line">2405</span><br><span class="line">2406</span><br><span class="line">2407</span><br><span class="line">2408</span><br><span class="line">2409</span><br><span class="line">2410</span><br><span class="line">2411</span><br><span class="line">2412</span><br><span class="line">2413</span><br><span class="line">2414</span><br><span class="line">2415</span><br><span class="line">2416</span><br><span class="line">2417</span><br><span class="line">2418</span><br><span class="line">2419</span><br><span class="line">2420</span><br><span class="line">2421</span><br><span class="line">2422</span><br><span class="line">2423</span><br><span class="line">2424</span><br><span class="line">2425</span><br><span class="line">2426</span><br><span class="line">2427</span><br><span class="line">2428</span><br><span class="line">2429</span><br><span class="line">2430</span><br><span class="line">2431</span><br><span class="line">2432</span><br><span class="line">2433</span><br><span class="line">2434</span><br><span class="line">2435</span><br><span class="line">2436</span><br><span class="line">2437</span><br><span class="line">2438</span><br><span class="line">2439</span><br><span class="line">2440</span><br><span class="line">2441</span><br><span class="line">2442</span><br><span class="line">2443</span><br><span class="line">2444</span><br><span class="line">2445</span><br><span class="line">2446</span><br><span class="line">2447</span><br><span class="line">2448</span><br><span class="line">2449</span><br><span class="line">2450</span><br><span class="line">2451</span><br><span class="line">2452</span><br><span class="line">2453</span><br><span class="line">2454</span><br><span class="line">2455</span><br><span class="line">2456</span><br><span class="line">2457</span><br><span class="line">2458</span><br><span class="line">2459</span><br><span class="line">2460</span><br><span class="line">2461</span><br><span class="line">2462</span><br><span class="line">2463</span><br><span class="line">2464</span><br><span class="line">2465</span><br><span class="line">2466</span><br><span class="line">2467</span><br><span class="line">2468</span><br><span class="line">2469</span><br><span class="line">2470</span><br><span class="line">2471</span><br><span class="line">2472</span><br><span class="line">2473</span><br><span class="line">2474</span><br><span class="line">2475</span><br><span class="line">2476</span><br><span class="line">2477</span><br><span class="line">2478</span><br><span class="line">2479</span><br><span class="line">2480</span><br><span class="line">2481</span><br><span class="line">2482</span><br><span class="line">2483</span><br><span class="line">2484</span><br><span class="line">2485</span><br><span class="line">2486</span><br><span class="line">2487</span><br><span class="line">2488</span><br><span class="line">2489</span><br><span class="line">2490</span><br><span class="line">2491</span><br><span class="line">2492</span><br><span class="line">2493</span><br><span class="line">2494</span><br><span class="line">2495</span><br><span class="line">2496</span><br><span class="line">2497</span><br><span class="line">2498</span><br><span class="line">2499</span><br><span class="line">2500</span><br><span class="line">2501</span><br><span class="line">2502</span><br><span class="line">2503</span><br><span class="line">2504</span><br><span class="line">2505</span><br><span class="line">2506</span><br><span class="line">2507</span><br><span class="line">2508</span><br><span class="line">2509</span><br><span class="line">2510</span><br><span class="line">2511</span><br><span class="line">2512</span><br><span class="line">2513</span><br><span class="line">2514</span><br><span class="line">2515</span><br><span class="line">2516</span><br><span class="line">2517</span><br><span class="line">2518</span><br><span class="line">2519</span><br><span class="line">2520</span><br><span class="line">2521</span><br><span class="line">2522</span><br><span class="line">2523</span><br><span class="line">2524</span><br><span class="line">2525</span><br><span class="line">2526</span><br><span class="line">2527</span><br><span class="line">2528</span><br><span class="line">2529</span><br><span class="line">2530</span><br><span class="line">2531</span><br><span class="line">2532</span><br><span class="line">2533</span><br><span class="line">2534</span><br><span class="line">2535</span><br><span class="line">2536</span><br><span class="line">2537</span><br><span class="line">2538</span><br><span class="line">2539</span><br><span class="line">2540</span><br><span class="line">2541</span><br><span class="line">2542</span><br><span class="line">2543</span><br><span class="line">2544</span><br><span class="line">2545</span><br><span class="line">2546</span><br><span class="line">2547</span><br><span class="line">2548</span><br><span class="line">2549</span><br><span class="line">2550</span><br><span class="line">2551</span><br><span class="line">2552</span><br><span class="line">2553</span><br><span class="line">2554</span><br><span class="line">2555</span><br><span class="line">2556</span><br><span class="line">2557</span><br><span class="line">2558</span><br><span class="line">2559</span><br><span class="line">2560</span><br><span class="line">2561</span><br><span class="line">2562</span><br><span class="line">2563</span><br><span class="line">2564</span><br><span class="line">2565</span><br><span class="line">2566</span><br><span class="line">2567</span><br><span class="line">2568</span><br><span class="line">2569</span><br><span class="line">2570</span><br><span class="line">2571</span><br><span class="line">2572</span><br><span class="line">2573</span><br><span class="line">2574</span><br><span class="line">2575</span><br><span class="line">2576</span><br><span class="line">2577</span><br><span class="line">2578</span><br><span class="line">2579</span><br><span class="line">2580</span><br><span class="line">2581</span><br><span class="line">2582</span><br><span class="line">2583</span><br><span class="line">2584</span><br><span class="line">2585</span><br><span class="line">2586</span><br><span class="line">2587</span><br><span class="line">2588</span><br><span class="line">2589</span><br><span class="line">2590</span><br><span class="line">2591</span><br><span class="line">2592</span><br><span class="line">2593</span><br><span class="line">2594</span><br><span class="line">2595</span><br><span class="line">2596</span><br><span class="line">2597</span><br><span class="line">2598</span><br><span class="line">2599</span><br><span class="line">2600</span><br><span class="line">2601</span><br><span class="line">2602</span><br><span class="line">2603</span><br><span class="line">2604</span><br><span class="line">2605</span><br><span class="line">2606</span><br><span class="line">2607</span><br><span class="line">2608</span><br><span class="line">2609</span><br><span class="line">2610</span><br><span class="line">2611</span><br><span class="line">2612</span><br><span class="line">2613</span><br><span class="line">2614</span><br><span class="line">2615</span><br><span class="line">2616</span><br><span class="line">2617</span><br><span class="line">2618</span><br><span class="line">2619</span><br><span class="line">2620</span><br><span class="line">2621</span><br><span class="line">2622</span><br><span class="line">2623</span><br><span class="line">2624</span><br><span class="line">2625</span><br><span class="line">2626</span><br><span class="line">2627</span><br><span class="line">2628</span><br><span class="line">2629</span><br><span class="line">2630</span><br><span class="line">2631</span><br><span class="line">2632</span><br><span class="line">2633</span><br><span class="line">2634</span><br><span class="line">2635</span><br><span class="line">2636</span><br><span class="line">2637</span><br><span class="line">2638</span><br><span class="line">2639</span><br><span class="line">2640</span><br><span class="line">2641</span><br><span class="line">2642</span><br><span class="line">2643</span><br><span class="line">2644</span><br><span class="line">2645</span><br><span class="line">2646</span><br><span class="line">2647</span><br><span class="line">2648</span><br><span class="line">2649</span><br><span class="line">2650</span><br><span class="line">2651</span><br><span class="line">2652</span><br><span class="line">2653</span><br><span class="line">2654</span><br><span class="line">2655</span><br><span class="line">2656</span><br><span class="line">2657</span><br><span class="line">2658</span><br><span class="line">2659</span><br><span class="line">2660</span><br><span class="line">2661</span><br><span class="line">2662</span><br><span class="line">2663</span><br><span class="line">2664</span><br><span class="line">2665</span><br><span class="line">2666</span><br><span class="line">2667</span><br><span class="line">2668</span><br><span class="line">2669</span><br><span class="line">2670</span><br><span class="line">2671</span><br><span class="line">2672</span><br><span class="line">2673</span><br><span class="line">2674</span><br><span class="line">2675</span><br><span class="line">2676</span><br><span class="line">2677</span><br><span class="line">2678</span><br><span class="line">2679</span><br><span class="line">2680</span><br><span class="line">2681</span><br><span class="line">2682</span><br><span class="line">2683</span><br><span class="line">2684</span><br><span class="line">2685</span><br><span class="line">2686</span><br><span class="line">2687</span><br><span class="line">2688</span><br><span class="line">2689</span><br><span class="line">2690</span><br><span class="line">2691</span><br><span class="line">2692</span><br><span class="line">2693</span><br><span class="line">2694</span><br><span class="line">2695</span><br><span class="line">2696</span><br><span class="line">2697</span><br><span class="line">2698</span><br><span class="line">2699</span><br><span class="line">2700</span><br><span class="line">2701</span><br><span class="line">2702</span><br><span class="line">2703</span><br><span class="line">2704</span><br><span class="line">2705</span><br><span class="line">2706</span><br><span class="line">2707</span><br><span class="line">2708</span><br><span class="line">2709</span><br><span class="line">2710</span><br><span class="line">2711</span><br><span class="line">2712</span><br><span class="line">2713</span><br><span class="line">2714</span><br><span class="line">2715</span><br><span class="line">2716</span><br><span class="line">2717</span><br><span class="line">2718</span><br><span class="line">2719</span><br><span class="line">2720</span><br><span class="line">2721</span><br><span class="line">2722</span><br><span class="line">2723</span><br><span class="line">2724</span><br><span class="line">2725</span><br><span class="line">2726</span><br><span class="line">2727</span><br><span class="line">2728</span><br><span class="line">2729</span><br><span class="line">2730</span><br><span class="line">2731</span><br><span class="line">2732</span><br><span class="line">2733</span><br><span class="line">2734</span><br><span class="line">2735</span><br><span class="line">2736</span><br><span class="line">2737</span><br><span class="line">2738</span><br><span class="line">2739</span><br><span class="line">2740</span><br><span class="line">2741</span><br><span class="line">2742</span><br><span class="line">2743</span><br><span class="line">2744</span><br><span class="line">2745</span><br><span class="line">2746</span><br><span class="line">2747</span><br><span class="line">2748</span><br><span class="line">2749</span><br><span class="line">2750</span><br><span class="line">2751</span><br><span class="line">2752</span><br><span class="line">2753</span><br><span class="line">2754</span><br><span class="line">2755</span><br><span class="line">2756</span><br><span class="line">2757</span><br><span class="line">2758</span><br><span class="line">2759</span><br><span class="line">2760</span><br><span class="line">2761</span><br><span class="line">2762</span><br><span class="line">2763</span><br><span class="line">2764</span><br><span class="line">2765</span><br><span class="line">2766</span><br><span class="line">2767</span><br><span class="line">2768</span><br><span class="line">2769</span><br><span class="line">2770</span><br><span class="line">2771</span><br><span class="line">2772</span><br><span class="line">2773</span><br><span class="line">2774</span><br><span class="line">2775</span><br><span class="line">2776</span><br><span class="line">2777</span><br><span class="line">2778</span><br><span class="line">2779</span><br><span class="line">2780</span><br><span class="line">2781</span><br><span class="line">2782</span><br><span class="line">2783</span><br><span class="line">2784</span><br><span class="line">2785</span><br><span class="line">2786</span><br><span class="line">2787</span><br><span class="line">2788</span><br><span class="line">2789</span><br><span class="line">2790</span><br><span class="line">2791</span><br><span class="line">2792</span><br><span class="line">2793</span><br><span class="line">2794</span><br><span class="line">2795</span><br><span class="line">2796</span><br><span class="line">2797</span><br><span class="line">2798</span><br><span class="line">2799</span><br><span class="line">2800</span><br><span class="line">2801</span><br><span class="line">2802</span><br><span class="line">2803</span><br><span class="line">2804</span><br><span class="line">2805</span><br><span class="line">2806</span><br><span class="line">2807</span><br><span class="line">2808</span><br><span class="line">2809</span><br><span class="line">2810</span><br><span class="line">2811</span><br><span class="line">2812</span><br><span class="line">2813</span><br><span class="line">2814</span><br><span class="line">2815</span><br><span class="line">2816</span><br><span class="line">2817</span><br><span class="line">2818</span><br><span class="line">2819</span><br><span class="line">2820</span><br><span class="line">2821</span><br><span class="line">2822</span><br><span class="line">2823</span><br><span class="line">2824</span><br><span class="line">2825</span><br><span class="line">2826</span><br><span class="line">2827</span><br><span class="line">2828</span><br><span class="line">2829</span><br><span class="line">2830</span><br><span class="line">2831</span><br><span class="line">2832</span><br><span class="line">2833</span><br><span class="line">2834</span><br><span class="line">2835</span><br><span class="line">2836</span><br><span class="line">2837</span><br><span class="line">2838</span><br><span class="line">2839</span><br><span class="line">2840</span><br><span class="line">2841</span><br><span class="line">2842</span><br><span class="line">2843</span><br><span class="line">2844</span><br><span class="line">2845</span><br><span class="line">2846</span><br><span class="line">2847</span><br><span class="line">2848</span><br><span class="line">2849</span><br><span class="line">2850</span><br><span class="line">2851</span><br><span class="line">2852</span><br><span class="line">2853</span><br><span class="line">2854</span><br><span class="line">2855</span><br><span class="line">2856</span><br><span class="line">2857</span><br><span class="line">2858</span><br><span class="line">2859</span><br><span class="line">2860</span><br><span class="line">2861</span><br><span class="line">2862</span><br><span class="line">2863</span><br><span class="line">2864</span><br><span class="line">2865</span><br><span class="line">2866</span><br><span class="line">2867</span><br><span class="line">2868</span><br><span class="line">2869</span><br><span class="line">2870</span><br><span class="line">2871</span><br><span class="line">2872</span><br><span class="line">2873</span><br><span class="line">2874</span><br><span class="line">2875</span><br><span class="line">2876</span><br><span class="line">2877</span><br><span class="line">2878</span><br><span class="line">2879</span><br><span class="line">2880</span><br><span class="line">2881</span><br><span class="line">2882</span><br><span class="line">2883</span><br><span class="line">2884</span><br><span class="line">2885</span><br><span class="line">2886</span><br><span class="line">2887</span><br><span class="line">2888</span><br><span class="line">2889</span><br><span class="line">2890</span><br><span class="line">2891</span><br><span class="line">2892</span><br><span class="line">2893</span><br><span class="line">2894</span><br><span class="line">2895</span><br><span class="line">2896</span><br><span class="line">2897</span><br><span class="line">2898</span><br><span class="line">2899</span><br><span class="line">2900</span><br><span class="line">2901</span><br><span class="line">2902</span><br><span class="line">2903</span><br><span class="line">2904</span><br><span class="line">2905</span><br><span class="line">2906</span><br><span class="line">2907</span><br><span class="line">2908</span><br><span class="line">2909</span><br><span class="line">2910</span><br><span class="line">2911</span><br><span class="line">2912</span><br><span class="line">2913</span><br><span class="line">2914</span><br><span class="line">2915</span><br><span class="line">2916</span><br><span class="line">2917</span><br><span class="line">2918</span><br><span class="line">2919</span><br><span class="line">2920</span><br><span class="line">2921</span><br><span class="line">2922</span><br><span class="line">2923</span><br><span class="line">2924</span><br><span class="line">2925</span><br><span class="line">2926</span><br><span class="line">2927</span><br><span class="line">2928</span><br><span class="line">2929</span><br><span class="line">2930</span><br><span class="line">2931</span><br><span class="line">2932</span><br><span class="line">2933</span><br><span class="line">2934</span><br><span class="line">2935</span><br><span class="line">2936</span><br><span class="line">2937</span><br><span class="line">2938</span><br><span class="line">2939</span><br><span class="line">2940</span><br><span class="line">2941</span><br><span class="line">2942</span><br><span class="line">2943</span><br><span class="line">2944</span><br><span class="line">2945</span><br><span class="line">2946</span><br><span class="line">2947</span><br><span class="line">2948</span><br><span class="line">2949</span><br><span class="line">2950</span><br><span class="line">2951</span><br><span class="line">2952</span><br><span class="line">2953</span><br><span class="line">2954</span><br><span class="line">2955</span><br><span class="line">2956</span><br><span class="line">2957</span><br><span class="line">2958</span><br><span class="line">2959</span><br><span class="line">2960</span><br><span class="line">2961</span><br><span class="line">2962</span><br><span class="line">2963</span><br><span class="line">2964</span><br><span class="line">2965</span><br><span class="line">2966</span><br><span class="line">2967</span><br><span class="line">2968</span><br><span class="line">2969</span><br><span class="line">2970</span><br><span class="line">2971</span><br><span class="line">2972</span><br><span class="line">2973</span><br><span class="line">2974</span><br><span class="line">2975</span><br><span class="line">2976</span><br><span class="line">2977</span><br><span class="line">2978</span><br><span class="line">2979</span><br><span class="line">2980</span><br><span class="line">2981</span><br><span class="line">2982</span><br><span class="line">2983</span><br><span class="line">2984</span><br><span class="line">2985</span><br><span class="line">2986</span><br><span class="line">2987</span><br><span class="line">2988</span><br><span class="line">2989</span><br><span class="line">2990</span><br><span class="line">2991</span><br><span class="line">2992</span><br><span class="line">2993</span><br><span class="line">2994</span><br><span class="line">2995</span><br><span class="line">2996</span><br><span class="line">2997</span><br><span class="line">2998</span><br><span class="line">2999</span><br><span class="line">3000</span><br><span class="line">3001</span><br><span class="line">3002</span><br><span class="line">3003</span><br><span class="line">3004</span><br><span class="line">3005</span><br><span class="line">3006</span><br><span class="line">3007</span><br><span class="line">3008</span><br><span class="line">3009</span><br><span class="line">3010</span><br><span class="line">3011</span><br><span class="line">3012</span><br><span class="line">3013</span><br><span class="line">3014</span><br><span class="line">3015</span><br><span class="line">3016</span><br><span class="line">3017</span><br><span class="line">3018</span><br><span class="line">3019</span><br><span class="line">3020</span><br><span class="line">3021</span><br><span class="line">3022</span><br><span class="line">3023</span><br><span class="line">3024</span><br><span class="line">3025</span><br><span class="line">3026</span><br><span class="line">3027</span><br><span class="line">3028</span><br><span class="line">3029</span><br><span class="line">3030</span><br><span class="line">3031</span><br><span class="line">3032</span><br><span class="line">3033</span><br><span class="line">3034</span><br><span class="line">3035</span><br><span class="line">3036</span><br><span class="line">3037</span><br><span class="line">3038</span><br><span class="line">3039</span><br><span class="line">3040</span><br><span class="line">3041</span><br><span class="line">3042</span><br><span class="line">3043</span><br><span class="line">3044</span><br><span class="line">3045</span><br><span class="line">3046</span><br><span class="line">3047</span><br><span class="line">3048</span><br><span class="line">3049</span><br><span class="line">3050</span><br><span class="line">3051</span><br><span class="line">3052</span><br><span class="line">3053</span><br><span class="line">3054</span><br><span class="line">3055</span><br><span class="line">3056</span><br><span class="line">3057</span><br><span class="line">3058</span><br><span class="line">3059</span><br><span class="line">3060</span><br><span class="line">3061</span><br><span class="line">3062</span><br><span class="line">3063</span><br><span class="line">3064</span><br><span class="line">3065</span><br><span class="line">3066</span><br><span class="line">3067</span><br><span class="line">3068</span><br><span class="line">3069</span><br><span class="line">3070</span><br><span class="line">3071</span><br><span class="line">3072</span><br><span class="line">3073</span><br><span class="line">3074</span><br><span class="line">3075</span><br><span class="line">3076</span><br><span class="line">3077</span><br><span class="line">3078</span><br><span class="line">3079</span><br><span class="line">3080</span><br><span class="line">3081</span><br><span class="line">3082</span><br><span class="line">3083</span><br><span class="line">3084</span><br><span class="line">3085</span><br><span class="line">3086</span><br><span class="line">3087</span><br><span class="line">3088</span><br><span class="line">3089</span><br><span class="line">3090</span><br><span class="line">3091</span><br><span class="line">3092</span><br><span class="line">3093</span><br><span class="line">3094</span><br><span class="line">3095</span><br><span class="line">3096</span><br><span class="line">3097</span><br><span class="line">3098</span><br><span class="line">3099</span><br><span class="line">3100</span><br><span class="line">3101</span><br><span class="line">3102</span><br><span class="line">3103</span><br><span class="line">3104</span><br><span class="line">3105</span><br><span class="line">3106</span><br><span class="line">3107</span><br><span class="line">3108</span><br><span class="line">3109</span><br><span class="line">3110</span><br><span class="line">3111</span><br><span class="line">3112</span><br><span class="line">3113</span><br><span class="line">3114</span><br><span class="line">3115</span><br><span class="line">3116</span><br><span class="line">3117</span><br><span class="line">3118</span><br><span class="line">3119</span><br><span class="line">3120</span><br><span class="line">3121</span><br><span class="line">3122</span><br><span class="line">3123</span><br><span class="line">3124</span><br><span class="line">3125</span><br><span class="line">3126</span><br><span class="line">3127</span><br><span class="line">3128</span><br><span class="line">3129</span><br><span class="line">3130</span><br><span class="line">3131</span><br><span class="line">3132</span><br><span class="line">3133</span><br><span class="line">3134</span><br><span class="line">3135</span><br><span class="line">3136</span><br><span class="line">3137</span><br><span class="line">3138</span><br><span class="line">3139</span><br><span class="line">3140</span><br><span class="line">3141</span><br><span class="line">3142</span><br><span class="line">3143</span><br><span class="line">3144</span><br><span class="line">3145</span><br><span class="line">3146</span><br><span class="line">3147</span><br><span class="line">3148</span><br><span class="line">3149</span><br><span class="line">3150</span><br><span class="line">3151</span><br><span class="line">3152</span><br><span class="line">3153</span><br><span class="line">3154</span><br><span class="line">3155</span><br><span class="line">3156</span><br><span class="line">3157</span><br><span class="line">3158</span><br><span class="line">3159</span><br><span class="line">3160</span><br><span class="line">3161</span><br><span class="line">3162</span><br><span class="line">3163</span><br><span class="line">3164</span><br><span class="line">3165</span><br><span class="line">3166</span><br><span class="line">3167</span><br><span class="line">3168</span><br><span class="line">3169</span><br><span class="line">3170</span><br><span class="line">3171</span><br><span class="line">3172</span><br><span class="line">3173</span><br><span class="line">3174</span><br><span class="line">3175</span><br><span class="line">3176</span><br><span class="line">3177</span><br><span class="line">3178</span><br><span class="line">3179</span><br><span class="line">3180</span><br><span class="line">3181</span><br><span class="line">3182</span><br><span class="line">3183</span><br><span class="line">3184</span><br><span class="line">3185</span><br><span class="line">3186</span><br><span class="line">3187</span><br><span class="line">3188</span><br><span class="line">3189</span><br><span class="line">3190</span><br><span class="line">3191</span><br><span class="line">3192</span><br><span class="line">3193</span><br><span class="line">3194</span><br><span class="line">3195</span><br><span class="line">3196</span><br><span class="line">3197</span><br><span class="line">3198</span><br><span class="line">3199</span><br><span class="line">3200</span><br><span class="line">3201</span><br><span class="line">3202</span><br><span class="line">3203</span><br><span class="line">3204</span><br><span class="line">3205</span><br><span class="line">3206</span><br><span class="line">3207</span><br><span class="line">3208</span><br><span class="line">3209</span><br><span class="line">3210</span><br><span class="line">3211</span><br><span class="line">3212</span><br><span class="line">3213</span><br><span class="line">3214</span><br><span class="line">3215</span><br><span class="line">3216</span><br><span class="line">3217</span><br><span class="line">3218</span><br><span class="line">3219</span><br><span class="line">3220</span><br><span class="line">3221</span><br><span class="line">3222</span><br><span class="line">3223</span><br><span class="line">3224</span><br><span class="line">3225</span><br><span class="line">3226</span><br><span class="line">3227</span><br><span class="line">3228</span><br><span class="line">3229</span><br><span class="line">3230</span><br><span class="line">3231</span><br><span class="line">3232</span><br><span class="line">3233</span><br><span class="line">3234</span><br><span class="line">3235</span><br><span class="line">3236</span><br><span class="line">3237</span><br><span class="line">3238</span><br><span class="line">3239</span><br><span class="line">3240</span><br><span class="line">3241</span><br><span class="line">3242</span><br><span class="line">3243</span><br><span class="line">3244</span><br><span class="line">3245</span><br><span class="line">3246</span><br><span class="line">3247</span><br><span class="line">3248</span><br><span class="line">3249</span><br><span class="line">3250</span><br><span class="line">3251</span><br><span class="line">3252</span><br><span class="line">3253</span><br><span class="line">3254</span><br><span class="line">3255</span><br><span class="line">3256</span><br><span class="line">3257</span><br><span class="line">3258</span><br><span class="line">3259</span><br><span class="line">3260</span><br><span class="line">3261</span><br><span class="line">3262</span><br><span class="line">3263</span><br><span class="line">3264</span><br><span class="line">3265</span><br><span class="line">3266</span><br><span class="line">3267</span><br><span class="line">3268</span><br><span class="line">3269</span><br><span class="line">3270</span><br><span class="line">3271</span><br><span class="line">3272</span><br><span class="line">3273</span><br><span class="line">3274</span><br><span class="line">3275</span><br><span class="line">3276</span><br><span class="line">3277</span><br><span class="line">3278</span><br><span class="line">3279</span><br><span class="line">3280</span><br><span class="line">3281</span><br><span class="line">3282</span><br><span class="line">3283</span><br><span class="line">3284</span><br><span class="line">3285</span><br><span class="line">3286</span><br><span class="line">3287</span><br><span class="line">3288</span><br><span class="line">3289</span><br><span class="line">3290</span><br><span class="line">3291</span><br><span class="line">3292</span><br><span class="line">3293</span><br><span class="line">3294</span><br><span class="line">3295</span><br><span class="line">3296</span><br><span class="line">3297</span><br><span class="line">3298</span><br><span class="line">3299</span><br><span class="line">3300</span><br><span class="line">3301</span><br><span class="line">3302</span><br><span class="line">3303</span><br><span class="line">3304</span><br><span class="line">3305</span><br><span class="line">3306</span><br><span class="line">3307</span><br><span class="line">3308</span><br><span class="line">3309</span><br><span class="line">3310</span><br><span class="line">3311</span><br><span class="line">3312</span><br><span class="line">3313</span><br><span class="line">3314</span><br><span class="line">3315</span><br><span class="line">3316</span><br><span class="line">3317</span><br><span class="line">3318</span><br><span class="line">3319</span><br><span class="line">3320</span><br><span class="line">3321</span><br><span class="line">3322</span><br><span class="line">3323</span><br><span class="line">3324</span><br><span class="line">3325</span><br><span class="line">3326</span><br><span class="line">3327</span><br><span class="line">3328</span><br><span class="line">3329</span><br><span class="line">3330</span><br><span class="line">3331</span><br><span class="line">3332</span><br><span class="line">3333</span><br><span class="line">3334</span><br><span class="line">3335</span><br><span class="line">3336</span><br><span class="line">3337</span><br><span class="line">3338</span><br><span class="line">3339</span><br><span class="line">3340</span><br><span class="line">3341</span><br><span class="line">3342</span><br><span class="line">3343</span><br><span class="line">3344</span><br><span class="line">3345</span><br><span class="line">3346</span><br><span class="line">3347</span><br><span class="line">3348</span><br><span class="line">3349</span><br><span class="line">3350</span><br><span class="line">3351</span><br><span class="line">3352</span><br><span class="line">3353</span><br><span class="line">3354</span><br><span class="line">3355</span><br><span class="line">3356</span><br><span class="line">3357</span><br><span class="line">3358</span><br><span class="line">3359</span><br><span class="line">3360</span><br><span class="line">3361</span><br><span class="line">3362</span><br><span class="line">3363</span><br><span class="line">3364</span><br><span class="line">3365</span><br><span class="line">3366</span><br><span class="line">3367</span><br><span class="line">3368</span><br><span class="line">3369</span><br><span class="line">3370</span><br><span class="line">3371</span><br><span class="line">3372</span><br><span class="line">3373</span><br><span class="line">3374</span><br><span class="line">3375</span><br><span class="line">3376</span><br><span class="line">3377</span><br><span class="line">3378</span><br><span class="line">3379</span><br><span class="line">3380</span><br><span class="line">3381</span><br><span class="line">3382</span><br><span class="line">3383</span><br><span class="line">3384</span><br><span class="line">3385</span><br><span class="line">3386</span><br><span class="line">3387</span><br><span class="line">3388</span><br><span class="line">3389</span><br><span class="line">3390</span><br><span class="line">3391</span><br><span class="line">3392</span><br><span class="line">3393</span><br><span class="line">3394</span><br><span class="line">3395</span><br><span class="line">3396</span><br><span class="line">3397</span><br><span class="line">3398</span><br><span class="line">3399</span><br><span class="line">3400</span><br><span class="line">3401</span><br><span class="line">3402</span><br><span class="line">3403</span><br><span class="line">3404</span><br><span class="line">3405</span><br><span class="line">3406</span><br><span class="line">3407</span><br><span class="line">3408</span><br><span class="line">3409</span><br><span class="line">3410</span><br><span class="line">3411</span><br><span class="line">3412</span><br><span class="line">3413</span><br><span class="line">3414</span><br><span class="line">3415</span><br><span class="line">3416</span><br><span class="line">3417</span><br><span class="line">3418</span><br><span class="line">3419</span><br><span class="line">3420</span><br><span class="line">3421</span><br><span class="line">3422</span><br><span class="line">3423</span><br><span class="line">3424</span><br><span class="line">3425</span><br><span class="line">3426</span><br><span class="line">3427</span><br><span class="line">3428</span><br><span class="line">3429</span><br><span class="line">3430</span><br><span class="line">3431</span><br><span class="line">3432</span><br><span class="line">3433</span><br><span class="line">3434</span><br><span class="line">3435</span><br><span class="line">3436</span><br><span class="line">3437</span><br><span class="line">3438</span><br><span class="line">3439</span><br><span class="line">3440</span><br><span class="line">3441</span><br><span class="line">3442</span><br><span class="line">3443</span><br><span class="line">3444</span><br><span class="line">3445</span><br><span class="line">3446</span><br><span class="line">3447</span><br><span class="line">3448</span><br><span class="line">3449</span><br><span class="line">3450</span><br><span class="line">3451</span><br><span class="line">3452</span><br><span class="line">3453</span><br><span class="line">3454</span><br><span class="line">3455</span><br><span class="line">3456</span><br><span class="line">3457</span><br><span class="line">3458</span><br><span class="line">3459</span><br><span class="line">3460</span><br><span class="line">3461</span><br><span class="line">3462</span><br><span class="line">3463</span><br><span class="line">3464</span><br><span class="line">3465</span><br><span class="line">3466</span><br><span class="line">3467</span><br><span class="line">3468</span><br><span class="line">3469</span><br><span class="line">3470</span><br><span class="line">3471</span><br><span class="line">3472</span><br><span class="line">3473</span><br><span class="line">3474</span><br><span class="line">3475</span><br><span class="line">3476</span><br><span class="line">3477</span><br><span class="line">3478</span><br><span class="line">3479</span><br><span class="line">3480</span><br><span class="line">3481</span><br><span class="line">3482</span><br><span class="line">3483</span><br><span class="line">3484</span><br><span class="line">3485</span><br><span class="line">3486</span><br><span class="line">3487</span><br><span class="line">3488</span><br><span class="line">3489</span><br><span class="line">3490</span><br><span class="line">3491</span><br><span class="line">3492</span><br><span class="line">3493</span><br><span class="line">3494</span><br><span class="line">3495</span><br><span class="line">3496</span><br><span class="line">3497</span><br><span class="line">3498</span><br><span class="line">3499</span><br><span class="line">3500</span><br><span class="line">3501</span><br><span class="line">3502</span><br><span class="line">3503</span><br><span class="line">3504</span><br><span class="line">3505</span><br><span class="line">3506</span><br><span class="line">3507</span><br><span class="line">3508</span><br><span class="line">3509</span><br><span class="line">3510</span><br><span class="line">3511</span><br><span class="line">3512</span><br><span class="line">3513</span><br><span class="line">3514</span><br><span class="line">3515</span><br><span class="line">3516</span><br><span class="line">3517</span><br><span class="line">3518</span><br><span class="line">3519</span><br><span class="line">3520</span><br><span class="line">3521</span><br><span class="line">3522</span><br><span class="line">3523</span><br><span class="line">3524</span><br><span class="line">3525</span><br><span class="line">3526</span><br><span class="line">3527</span><br><span class="line">3528</span><br><span class="line">3529</span><br><span class="line">3530</span><br><span class="line">3531</span><br><span class="line">3532</span><br><span class="line">3533</span><br><span class="line">3534</span><br><span class="line">3535</span><br><span class="line">3536</span><br><span class="line">3537</span><br><span class="line">3538</span><br><span class="line">3539</span><br><span class="line">3540</span><br><span class="line">3541</span><br><span class="line">3542</span><br><span class="line">3543</span><br><span class="line">3544</span><br><span class="line">3545</span><br><span class="line">3546</span><br><span class="line">3547</span><br><span class="line">3548</span><br><span class="line">3549</span><br><span class="line">3550</span><br><span class="line">3551</span><br><span class="line">3552</span><br><span class="line">3553</span><br><span class="line">3554</span><br><span class="line">3555</span><br><span class="line">3556</span><br><span class="line">3557</span><br><span class="line">3558</span><br><span class="line">3559</span><br><span class="line">3560</span><br><span class="line">3561</span><br><span class="line">3562</span><br><span class="line">3563</span><br><span class="line">3564</span><br><span class="line">3565</span><br><span class="line">3566</span><br><span class="line">3567</span><br><span class="line">3568</span><br><span class="line">3569</span><br><span class="line">3570</span><br><span class="line">3571</span><br><span class="line">3572</span><br><span class="line">3573</span><br><span class="line">3574</span><br><span class="line">3575</span><br><span class="line">3576</span><br><span class="line">3577</span><br><span class="line">3578</span><br><span class="line">3579</span><br><span class="line">3580</span><br><span class="line">3581</span><br><span class="line">3582</span><br><span class="line">3583</span><br><span class="line">3584</span><br><span class="line">3585</span><br><span class="line">3586</span><br><span class="line">3587</span><br><span class="line">3588</span><br><span class="line">3589</span><br><span class="line">3590</span><br><span class="line">3591</span><br><span class="line">3592</span><br><span class="line">3593</span><br><span class="line">3594</span><br><span class="line">3595</span><br><span class="line">3596</span><br><span class="line">3597</span><br><span class="line">3598</span><br><span class="line">3599</span><br><span class="line">3600</span><br><span class="line">3601</span><br><span class="line">3602</span><br><span class="line">3603</span><br><span class="line">3604</span><br><span class="line">3605</span><br><span class="line">3606</span><br><span class="line">3607</span><br><span class="line">3608</span><br><span class="line">3609</span><br><span class="line">3610</span><br><span class="line">3611</span><br><span class="line">3612</span><br><span class="line">3613</span><br><span class="line">3614</span><br><span class="line">3615</span><br><span class="line">3616</span><br><span class="line">3617</span><br><span class="line">3618</span><br><span class="line">3619</span><br><span class="line">3620</span><br><span class="line">3621</span><br><span class="line">3622</span><br><span class="line">3623</span><br><span class="line">3624</span><br><span class="line">3625</span><br><span class="line">3626</span><br><span class="line">3627</span><br><span class="line">3628</span><br><span class="line">3629</span><br><span class="line">3630</span><br><span class="line">3631</span><br><span class="line">3632</span><br><span class="line">3633</span><br><span class="line">3634</span><br><span class="line">3635</span><br><span class="line">3636</span><br><span class="line">3637</span><br><span class="line">3638</span><br><span class="line">3639</span><br><span class="line">3640</span><br><span class="line">3641</span><br><span class="line">3642</span><br><span class="line">3643</span><br><span class="line">3644</span><br><span class="line">3645</span><br><span class="line">3646</span><br><span class="line">3647</span><br><span class="line">3648</span><br><span class="line">3649</span><br><span class="line">3650</span><br><span class="line">3651</span><br><span class="line">3652</span><br><span class="line">3653</span><br><span class="line">3654</span><br><span class="line">3655</span><br><span class="line">3656</span><br><span class="line">3657</span><br><span class="line">3658</span><br><span class="line">3659</span><br><span class="line">3660</span><br><span class="line">3661</span><br><span class="line">3662</span><br><span class="line">3663</span><br><span class="line">3664</span><br><span class="line">3665</span><br><span class="line">3666</span><br><span class="line">3667</span><br><span class="line">3668</span><br><span class="line">3669</span><br><span class="line">3670</span><br><span class="line">3671</span><br><span class="line">3672</span><br><span class="line">3673</span><br><span class="line">3674</span><br><span class="line">3675</span><br><span class="line">3676</span><br><span class="line">3677</span><br><span class="line">3678</span><br><span class="line">3679</span><br><span class="line">3680</span><br><span class="line">3681</span><br><span class="line">3682</span><br><span class="line">3683</span><br><span class="line">3684</span><br><span class="line">3685</span><br><span class="line">3686</span><br><span class="line">3687</span><br><span class="line">3688</span><br><span class="line">3689</span><br><span class="line">3690</span><br><span class="line">3691</span><br><span class="line">3692</span><br><span class="line">3693</span><br><span class="line">3694</span><br><span class="line">3695</span><br><span class="line">3696</span><br><span class="line">3697</span><br><span class="line">3698</span><br><span class="line">3699</span><br><span class="line">3700</span><br><span class="line">3701</span><br><span class="line">3702</span><br><span class="line">3703</span><br><span class="line">3704</span><br><span class="line">3705</span><br><span class="line">3706</span><br><span class="line">3707</span><br><span class="line">3708</span><br><span class="line">3709</span><br><span class="line">3710</span><br><span class="line">3711</span><br><span class="line">3712</span><br><span class="line">3713</span><br><span class="line">3714</span><br><span class="line">3715</span><br><span class="line">3716</span><br><span class="line">3717</span><br><span class="line">3718</span><br><span class="line">3719</span><br><span class="line">3720</span><br><span class="line">3721</span><br><span class="line">3722</span><br><span class="line">3723</span><br><span class="line">3724</span><br><span class="line">3725</span><br><span class="line">3726</span><br><span class="line">3727</span><br><span class="line">3728</span><br><span class="line">3729</span><br><span class="line">3730</span><br><span class="line">3731</span><br><span class="line">3732</span><br><span class="line">3733</span><br><span class="line">3734</span><br><span class="line">3735</span><br><span class="line">3736</span><br><span class="line">3737</span><br><span class="line">3738</span><br><span class="line">3739</span><br><span class="line">3740</span><br><span class="line">3741</span><br><span class="line">3742</span><br><span class="line">3743</span><br><span class="line">3744</span><br><span class="line">3745</span><br><span class="line">3746</span><br><span class="line">3747</span><br><span class="line">3748</span><br><span class="line">3749</span><br><span class="line">3750</span><br><span class="line">3751</span><br><span class="line">3752</span><br><span class="line">3753</span><br><span class="line">3754</span><br><span class="line">3755</span><br><span class="line">3756</span><br><span class="line">3757</span><br><span class="line">3758</span><br><span class="line">3759</span><br><span class="line">3760</span><br><span class="line">3761</span><br><span class="line">3762</span><br><span class="line">3763</span><br><span class="line">3764</span><br><span class="line">3765</span><br><span class="line">3766</span><br><span class="line">3767</span><br><span class="line">3768</span><br><span class="line">3769</span><br><span class="line">3770</span><br><span class="line">3771</span><br><span class="line">3772</span><br><span class="line">3773</span><br><span class="line">3774</span><br><span class="line">3775</span><br><span class="line">3776</span><br><span class="line">3777</span><br><span class="line">3778</span><br><span class="line">3779</span><br><span class="line">3780</span><br><span class="line">3781</span><br><span class="line">3782</span><br><span class="line">3783</span><br><span class="line">3784</span><br><span class="line">3785</span><br><span class="line">3786</span><br><span class="line">3787</span><br><span class="line">3788</span><br><span class="line">3789</span><br><span class="line">3790</span><br><span class="line">3791</span><br><span class="line">3792</span><br><span class="line">3793</span><br><span class="line">3794</span><br><span class="line">3795</span><br><span class="line">3796</span><br><span class="line">3797</span><br><span class="line">3798</span><br><span class="line">3799</span><br><span class="line">3800</span><br><span class="line">3801</span><br><span class="line">3802</span><br><span class="line">3803</span><br><span class="line">3804</span><br><span class="line">3805</span><br><span class="line">3806</span><br><span class="line">3807</span><br><span class="line">3808</span><br><span class="line">3809</span><br><span class="line">3810</span><br><span class="line">3811</span><br><span class="line">3812</span><br><span class="line">3813</span><br><span class="line">3814</span><br><span class="line">3815</span><br><span class="line">3816</span><br><span class="line">3817</span><br><span class="line">3818</span><br><span class="line">3819</span><br><span class="line">3820</span><br><span class="line">3821</span><br><span class="line">3822</span><br><span class="line">3823</span><br><span class="line">3824</span><br><span class="line">3825</span><br><span class="line">3826</span><br><span class="line">3827</span><br><span class="line">3828</span><br><span class="line">3829</span><br><span class="line">3830</span><br><span class="line">3831</span><br><span class="line">3832</span><br><span class="line">3833</span><br><span class="line">3834</span><br><span class="line">3835</span><br><span class="line">3836</span><br><span class="line">3837</span><br><span class="line">3838</span><br><span class="line">3839</span><br><span class="line">3840</span><br><span class="line">3841</span><br><span class="line">3842</span><br><span class="line">3843</span><br><span class="line">3844</span><br><span class="line">3845</span><br><span class="line">3846</span><br><span class="line">3847</span><br><span class="line">3848</span><br><span class="line">3849</span><br><span class="line">3850</span><br><span class="line">3851</span><br><span class="line">3852</span><br><span class="line">3853</span><br><span class="line">3854</span><br><span class="line">3855</span><br><span class="line">3856</span><br><span class="line">3857</span><br><span class="line">3858</span><br><span class="line">3859</span><br><span class="line">3860</span><br><span class="line">3861</span><br><span class="line">3862</span><br><span class="line">3863</span><br><span class="line">3864</span><br><span class="line">3865</span><br><span class="line">3866</span><br><span class="line">3867</span><br><span class="line">3868</span><br><span class="line">3869</span><br><span class="line">3870</span><br><span class="line">3871</span><br><span class="line">3872</span><br><span class="line">3873</span><br><span class="line">3874</span><br><span class="line">3875</span><br><span class="line">3876</span><br><span class="line">3877</span><br><span class="line">3878</span><br><span class="line">3879</span><br><span class="line">3880</span><br><span class="line">3881</span><br><span class="line">3882</span><br><span class="line">3883</span><br><span class="line">3884</span><br><span class="line">3885</span><br><span class="line">3886</span><br><span class="line">3887</span><br><span class="line">3888</span><br><span class="line">3889</span><br><span class="line">3890</span><br><span class="line">3891</span><br><span class="line">3892</span><br><span class="line">3893</span><br><span class="line">3894</span><br><span class="line">3895</span><br><span class="line">3896</span><br><span class="line">3897</span><br><span class="line">3898</span><br><span class="line">3899</span><br><span class="line">3900</span><br><span class="line">3901</span><br><span class="line">3902</span><br><span class="line">3903</span><br><span class="line">3904</span><br><span class="line">3905</span><br><span class="line">3906</span><br><span class="line">3907</span><br><span class="line">3908</span><br><span class="line">3909</span><br><span class="line">3910</span><br><span class="line">3911</span><br><span class="line">3912</span><br><span class="line">3913</span><br><span class="line">3914</span><br><span class="line">3915</span><br><span class="line">3916</span><br><span class="line">3917</span><br><span class="line">3918</span><br><span class="line">3919</span><br><span class="line">3920</span><br><span class="line">3921</span><br><span class="line">3922</span><br><span class="line">3923</span><br><span class="line">3924</span><br><span class="line">3925</span><br><span class="line">3926</span><br><span class="line">3927</span><br><span class="line">3928</span><br><span class="line">3929</span><br><span class="line">3930</span><br><span class="line">3931</span><br><span class="line">3932</span><br><span class="line">3933</span><br><span class="line">3934</span><br><span class="line">3935</span><br><span class="line">3936</span><br><span class="line">3937</span><br><span class="line">3938</span><br><span class="line">3939</span><br><span class="line">3940</span><br><span class="line">3941</span><br><span class="line">3942</span><br><span class="line">3943</span><br><span class="line">3944</span><br><span class="line">3945</span><br><span class="line">3946</span><br><span class="line">3947</span><br><span class="line">3948</span><br><span class="line">3949</span><br><span class="line">3950</span><br><span class="line">3951</span><br><span class="line">3952</span><br><span class="line">3953</span><br><span class="line">3954</span><br><span class="line">3955</span><br><span class="line">3956</span><br><span class="line">3957</span><br><span class="line">3958</span><br><span class="line">3959</span><br><span class="line">3960</span><br><span class="line">3961</span><br><span class="line">3962</span><br><span class="line">3963</span><br><span class="line">3964</span><br><span class="line">3965</span><br><span class="line">3966</span><br><span class="line">3967</span><br><span class="line">3968</span><br><span class="line">3969</span><br><span class="line">3970</span><br><span class="line">3971</span><br><span class="line">3972</span><br><span class="line">3973</span><br><span class="line">3974</span><br><span class="line">3975</span><br><span class="line">3976</span><br><span class="line">3977</span><br><span class="line">3978</span><br><span class="line">3979</span><br><span class="line">3980</span><br><span class="line">3981</span><br><span class="line">3982</span><br><span class="line">3983</span><br><span class="line">3984</span><br><span class="line">3985</span><br><span class="line">3986</span><br><span class="line">3987</span><br><span class="line">3988</span><br><span class="line">3989</span><br><span class="line">3990</span><br><span class="line">3991</span><br><span class="line">3992</span><br><span class="line">3993</span><br><span class="line">3994</span><br><span class="line">3995</span><br><span class="line">3996</span><br><span class="line">3997</span><br><span class="line">3998</span><br><span class="line">3999</span><br><span class="line">4000</span><br><span class="line">4001</span><br><span class="line">4002</span><br><span class="line">4003</span><br><span class="line">4004</span><br><span class="line">4005</span><br><span class="line">4006</span><br><span class="line">4007</span><br><span class="line">4008</span><br><span class="line">4009</span><br><span class="line">4010</span><br><span class="line">4011</span><br><span class="line">4012</span><br><span class="line">4013</span><br><span class="line">4014</span><br><span class="line">4015</span><br><span class="line">4016</span><br><span class="line">4017</span><br><span class="line">4018</span><br><span class="line">4019</span><br><span class="line">4020</span><br><span class="line">4021</span><br><span class="line">4022</span><br><span class="line">4023</span><br><span class="line">4024</span><br><span class="line">4025</span><br><span class="line">4026</span><br><span class="line">4027</span><br><span class="line">4028</span><br><span class="line">4029</span><br><span class="line">4030</span><br><span class="line">4031</span><br><span class="line">4032</span><br><span class="line">4033</span><br><span class="line">4034</span><br><span class="line">4035</span><br><span class="line">4036</span><br><span class="line">4037</span><br><span class="line">4038</span><br><span class="line">4039</span><br><span class="line">4040</span><br><span class="line">4041</span><br><span class="line">4042</span><br><span class="line">4043</span><br><span class="line">4044</span><br><span class="line">4045</span><br><span class="line">4046</span><br><span class="line">4047</span><br><span class="line">4048</span><br><span class="line">4049</span><br><span class="line">4050</span><br><span class="line">4051</span><br><span class="line">4052</span><br><span class="line">4053</span><br><span class="line">4054</span><br><span class="line">4055</span><br><span class="line">4056</span><br><span class="line">4057</span><br><span class="line">4058</span><br><span class="line">4059</span><br><span class="line">4060</span><br><span class="line">4061</span><br><span class="line">4062</span><br><span class="line">4063</span><br><span class="line">4064</span><br><span class="line">4065</span><br><span class="line">4066</span><br><span class="line">4067</span><br><span class="line">4068</span><br><span class="line">4069</span><br><span class="line">4070</span><br><span class="line">4071</span><br><span class="line">4072</span><br><span class="line">4073</span><br><span class="line">4074</span><br><span class="line">4075</span><br><span class="line">4076</span><br><span class="line">4077</span><br><span class="line">4078</span><br><span class="line">4079</span><br><span class="line">4080</span><br><span class="line">4081</span><br><span class="line">4082</span><br><span class="line">4083</span><br><span class="line">4084</span><br><span class="line">4085</span><br><span class="line">4086</span><br><span class="line">4087</span><br><span class="line">4088</span><br><span class="line">4089</span><br><span class="line">4090</span><br><span class="line">4091</span><br><span class="line">4092</span><br><span class="line">4093</span><br><span class="line">4094</span><br><span class="line">4095</span><br><span class="line">4096</span><br><span class="line">4097</span><br><span class="line">4098</span><br><span class="line">4099</span><br><span class="line">4100</span><br><span class="line">4101</span><br><span class="line">4102</span><br><span class="line">4103</span><br><span class="line">4104</span><br><span class="line">4105</span><br><span class="line">4106</span><br><span class="line">4107</span><br><span class="line">4108</span><br><span class="line">4109</span><br><span class="line">4110</span><br><span class="line">4111</span><br><span class="line">4112</span><br><span class="line">4113</span><br><span class="line">4114</span><br><span class="line">4115</span><br><span class="line">4116</span><br><span class="line">4117</span><br><span class="line">4118</span><br><span class="line">4119</span><br><span class="line">4120</span><br><span class="line">4121</span><br><span class="line">4122</span><br><span class="line">4123</span><br><span class="line">4124</span><br><span class="line">4125</span><br><span class="line">4126</span><br><span class="line">4127</span><br><span class="line">4128</span><br><span class="line">4129</span><br><span class="line">4130</span><br><span class="line">4131</span><br><span class="line">4132</span><br><span class="line">4133</span><br><span class="line">4134</span><br><span class="line">4135</span><br><span class="line">4136</span><br><span class="line">4137</span><br><span class="line">4138</span><br><span class="line">4139</span><br><span class="line">4140</span><br><span class="line">4141</span><br><span class="line">4142</span><br><span class="line">4143</span><br><span class="line">4144</span><br><span class="line">4145</span><br><span class="line">4146</span><br><span class="line">4147</span><br><span class="line">4148</span><br><span class="line">4149</span><br><span class="line">4150</span><br><span class="line">4151</span><br><span class="line">4152</span><br><span class="line">4153</span><br><span class="line">4154</span><br><span class="line">4155</span><br><span class="line">4156</span><br><span class="line">4157</span><br><span class="line">4158</span><br><span class="line">4159</span><br><span class="line">4160</span><br><span class="line">4161</span><br><span class="line">4162</span><br><span class="line">4163</span><br><span class="line">4164</span><br><span class="line">4165</span><br><span class="line">4166</span><br><span class="line">4167</span><br><span class="line">4168</span><br><span class="line">4169</span><br><span class="line">4170</span><br><span class="line">4171</span><br><span class="line">4172</span><br><span class="line">4173</span><br><span class="line">4174</span><br><span class="line">4175</span><br><span class="line">4176</span><br><span class="line">4177</span><br><span class="line">4178</span><br><span class="line">4179</span><br><span class="line">4180</span><br><span class="line">4181</span><br><span class="line">4182</span><br><span class="line">4183</span><br><span class="line">4184</span><br><span class="line">4185</span><br><span class="line">4186</span><br><span class="line">4187</span><br><span class="line">4188</span><br><span class="line">4189</span><br><span class="line">4190</span><br><span class="line">4191</span><br><span class="line">4192</span><br><span class="line">4193</span><br><span class="line">4194</span><br><span class="line">4195</span><br><span class="line">4196</span><br><span class="line">4197</span><br><span class="line">4198</span><br><span class="line">4199</span><br><span class="line">4200</span><br><span class="line">4201</span><br><span class="line">4202</span><br><span class="line">4203</span><br><span class="line">4204</span><br><span class="line">4205</span><br><span class="line">4206</span><br><span class="line">4207</span><br><span class="line">4208</span><br><span class="line">4209</span><br><span class="line">4210</span><br><span class="line">4211</span><br><span class="line">4212</span><br><span class="line">4213</span><br><span class="line">4214</span><br><span class="line">4215</span><br><span class="line">4216</span><br><span class="line">4217</span><br><span class="line">4218</span><br><span class="line">4219</span><br><span class="line">4220</span><br><span class="line">4221</span><br><span class="line">4222</span><br><span class="line">4223</span><br><span class="line">4224</span><br><span class="line">4225</span><br><span class="line">4226</span><br><span class="line">4227</span><br><span class="line">4228</span><br><span class="line">4229</span><br><span class="line">4230</span><br><span class="line">4231</span><br><span class="line">4232</span><br><span class="line">4233</span><br><span class="line">4234</span><br><span class="line">4235</span><br><span class="line">4236</span><br><span class="line">4237</span><br><span class="line">4238</span><br><span class="line">4239</span><br><span class="line">4240</span><br><span class="line">4241</span><br><span class="line">4242</span><br><span class="line">4243</span><br><span class="line">4244</span><br><span class="line">4245</span><br><span class="line">4246</span><br><span class="line">4247</span><br><span class="line">4248</span><br><span class="line">4249</span><br><span class="line">4250</span><br><span class="line">4251</span><br><span class="line">4252</span><br><span class="line">4253</span><br><span class="line">4254</span><br><span class="line">4255</span><br><span class="line">4256</span><br><span class="line">4257</span><br><span class="line">4258</span><br><span class="line">4259</span><br><span class="line">4260</span><br><span class="line">4261</span><br><span class="line">4262</span><br><span class="line">4263</span><br><span class="line">4264</span><br><span class="line">4265</span><br><span class="line">4266</span><br><span class="line">4267</span><br><span class="line">4268</span><br><span class="line">4269</span><br><span class="line">4270</span><br><span class="line">4271</span><br><span class="line">4272</span><br><span class="line">4273</span><br><span class="line">4274</span><br><span class="line">4275</span><br><span class="line">4276</span><br><span class="line">4277</span><br><span class="line">4278</span><br><span class="line">4279</span><br><span class="line">4280</span><br><span class="line">4281</span><br><span class="line">4282</span><br><span class="line">4283</span><br><span class="line">4284</span><br><span class="line">4285</span><br><span class="line">4286</span><br><span class="line">4287</span><br><span class="line">4288</span><br><span class="line">4289</span><br><span class="line">4290</span><br><span class="line">4291</span><br><span class="line">4292</span><br><span class="line">4293</span><br><span class="line">4294</span><br><span class="line">4295</span><br><span class="line">4296</span><br><span class="line">4297</span><br><span class="line">4298</span><br><span class="line">4299</span><br><span class="line">4300</span><br><span class="line">4301</span><br><span class="line">4302</span><br><span class="line">4303</span><br><span class="line">4304</span><br><span class="line">4305</span><br><span class="line">4306</span><br><span class="line">4307</span><br><span class="line">4308</span><br><span class="line">4309</span><br><span class="line">4310</span><br><span class="line">4311</span><br><span class="line">4312</span><br><span class="line">4313</span><br><span class="line">4314</span><br><span class="line">4315</span><br><span class="line">4316</span><br><span class="line">4317</span><br><span class="line">4318</span><br><span class="line">4319</span><br><span class="line">4320</span><br><span class="line">4321</span><br><span class="line">4322</span><br><span class="line">4323</span><br><span class="line">4324</span><br><span class="line">4325</span><br><span class="line">4326</span><br><span class="line">4327</span><br><span class="line">4328</span><br><span class="line">4329</span><br><span class="line">4330</span><br><span class="line">4331</span><br><span class="line">4332</span><br><span class="line">4333</span><br><span class="line">4334</span><br><span class="line">4335</span><br><span class="line">4336</span><br><span class="line">4337</span><br><span class="line">4338</span><br><span class="line">4339</span><br><span class="line">4340</span><br><span class="line">4341</span><br><span class="line">4342</span><br><span class="line">4343</span><br><span class="line">4344</span><br><span class="line">4345</span><br><span class="line">4346</span><br><span class="line">4347</span><br><span class="line">4348</span><br><span class="line">4349</span><br><span class="line">4350</span><br><span class="line">4351</span><br><span class="line">4352</span><br><span class="line">4353</span><br><span class="line">4354</span><br><span class="line">4355</span><br><span class="line">4356</span><br><span class="line">4357</span><br><span class="line">4358</span><br><span class="line">4359</span><br><span class="line">4360</span><br><span class="line">4361</span><br><span class="line">4362</span><br><span class="line">4363</span><br><span class="line">4364</span><br><span class="line">4365</span><br><span class="line">4366</span><br><span class="line">4367</span><br><span class="line">4368</span><br><span class="line">4369</span><br><span class="line">4370</span><br><span class="line">4371</span><br><span class="line">4372</span><br><span class="line">4373</span><br><span class="line">4374</span><br><span class="line">4375</span><br><span class="line">4376</span><br><span class="line">4377</span><br><span class="line">4378</span><br><span class="line">4379</span><br><span class="line">4380</span><br><span class="line">4381</span><br><span class="line">4382</span><br><span class="line">4383</span><br><span class="line">4384</span><br><span class="line">4385</span><br><span class="line">4386</span><br><span class="line">4387</span><br><span class="line">4388</span><br><span class="line">4389</span><br><span class="line">4390</span><br><span class="line">4391</span><br><span class="line">4392</span><br><span class="line">4393</span><br><span class="line">4394</span><br><span class="line">4395</span><br><span class="line">4396</span><br><span class="line">4397</span><br><span class="line">4398</span><br><span class="line">4399</span><br><span class="line">4400</span><br><span class="line">4401</span><br><span class="line">4402</span><br><span class="line">4403</span><br><span class="line">4404</span><br><span class="line">4405</span><br><span class="line">4406</span><br><span class="line">4407</span><br><span class="line">4408</span><br><span class="line">4409</span><br><span class="line">4410</span><br><span class="line">4411</span><br><span class="line">4412</span><br><span class="line">4413</span><br><span class="line">4414</span><br><span class="line">4415</span><br><span class="line">4416</span><br><span class="line">4417</span><br><span class="line">4418</span><br><span class="line">4419</span><br><span class="line">4420</span><br><span class="line">4421</span><br><span class="line">4422</span><br><span class="line">4423</span><br><span class="line">4424</span><br><span class="line">4425</span><br><span class="line">4426</span><br><span class="line">4427</span><br><span class="line">4428</span><br><span class="line">4429</span><br><span class="line">4430</span><br><span class="line">4431</span><br><span class="line">4432</span><br><span class="line">4433</span><br><span class="line">4434</span><br><span class="line">4435</span><br><span class="line">4436</span><br><span class="line">4437</span><br><span class="line">4438</span><br><span class="line">4439</span><br><span class="line">4440</span><br><span class="line">4441</span><br><span class="line">4442</span><br><span class="line">4443</span><br><span class="line">4444</span><br><span class="line">4445</span><br><span class="line">4446</span><br><span class="line">4447</span><br><span class="line">4448</span><br><span class="line">4449</span><br><span class="line">4450</span><br><span class="line">4451</span><br><span class="line">4452</span><br><span class="line">4453</span><br><span class="line">4454</span><br><span class="line">4455</span><br><span class="line">4456</span><br><span class="line">4457</span><br><span class="line">4458</span><br><span class="line">4459</span><br><span class="line">4460</span><br><span class="line">4461</span><br><span class="line">4462</span><br><span class="line">4463</span><br><span class="line">4464</span><br><span class="line">4465</span><br><span class="line">4466</span><br><span class="line">4467</span><br><span class="line">4468</span><br><span class="line">4469</span><br><span class="line">4470</span><br><span class="line">4471</span><br><span class="line">4472</span><br><span class="line">4473</span><br><span class="line">4474</span><br><span class="line">4475</span><br><span class="line">4476</span><br><span class="line">4477</span><br><span class="line">4478</span><br><span class="line">4479</span><br><span class="line">4480</span><br><span class="line">4481</span><br><span class="line">4482</span><br><span class="line">4483</span><br><span class="line">4484</span><br><span class="line">4485</span><br><span class="line">4486</span><br><span class="line">4487</span><br><span class="line">4488</span><br><span class="line">4489</span><br><span class="line">4490</span><br><span class="line">4491</span><br><span class="line">4492</span><br><span class="line">4493</span><br><span class="line">4494</span><br><span class="line">4495</span><br><span class="line">4496</span><br><span class="line">4497</span><br><span class="line">4498</span><br><span class="line">4499</span><br><span class="line">4500</span><br><span class="line">4501</span><br><span class="line">4502</span><br><span class="line">4503</span><br><span class="line">4504</span><br><span class="line">4505</span><br><span class="line">4506</span><br><span class="line">4507</span><br><span class="line">4508</span><br><span class="line">4509</span><br><span class="line">4510</span><br><span class="line">4511</span><br><span class="line">4512</span><br><span class="line">4513</span><br><span class="line">4514</span><br><span class="line">4515</span><br><span class="line">4516</span><br><span class="line">4517</span><br><span class="line">4518</span><br><span class="line">4519</span><br><span class="line">4520</span><br><span class="line">4521</span><br><span class="line">4522</span><br><span class="line">4523</span><br><span class="line">4524</span><br><span class="line">4525</span><br><span class="line">4526</span><br><span class="line">4527</span><br><span class="line">4528</span><br><span class="line">4529</span><br><span class="line">4530</span><br><span class="line">4531</span><br><span class="line">4532</span><br><span class="line">4533</span><br><span class="line">4534</span><br><span class="line">4535</span><br><span class="line">4536</span><br><span class="line">4537</span><br><span class="line">4538</span><br><span class="line">4539</span><br><span class="line">4540</span><br><span class="line">4541</span><br><span class="line">4542</span><br><span class="line">4543</span><br><span class="line">4544</span><br><span class="line">4545</span><br><span class="line">4546</span><br><span class="line">4547</span><br><span class="line">4548</span><br><span class="line">4549</span><br><span class="line">4550</span><br><span class="line">4551</span><br><span class="line">4552</span><br><span class="line">4553</span><br><span class="line">4554</span><br><span class="line">4555</span><br><span class="line">4556</span><br><span class="line">4557</span><br><span class="line">4558</span><br><span class="line">4559</span><br><span class="line">4560</span><br><span class="line">4561</span><br><span class="line">4562</span><br><span class="line">4563</span><br><span class="line">4564</span><br><span class="line">4565</span><br><span class="line">4566</span><br><span class="line">4567</span><br><span class="line">4568</span><br><span class="line">4569</span><br><span class="line">4570</span><br><span class="line">4571</span><br><span class="line">4572</span><br><span class="line">4573</span><br><span class="line">4574</span><br><span class="line">4575</span><br><span class="line">4576</span><br><span class="line">4577</span><br><span class="line">4578</span><br><span class="line">4579</span><br><span class="line">4580</span><br><span class="line">4581</span><br><span class="line">4582</span><br><span class="line">4583</span><br><span class="line">4584</span><br><span class="line">4585</span><br><span class="line">4586</span><br><span class="line">4587</span><br><span class="line">4588</span><br><span class="line">4589</span><br><span class="line">4590</span><br><span class="line">4591</span><br><span class="line">4592</span><br><span class="line">4593</span><br><span class="line">4594</span><br><span class="line">4595</span><br><span class="line">4596</span><br><span class="line">4597</span><br><span class="line">4598</span><br><span class="line">4599</span><br><span class="line">4600</span><br><span class="line">4601</span><br><span class="line">4602</span><br><span class="line">4603</span><br><span class="line">4604</span><br><span class="line">4605</span><br><span class="line">4606</span><br><span class="line">4607</span><br><span class="line">4608</span><br><span class="line">4609</span><br><span class="line">4610</span><br><span class="line">4611</span><br><span class="line">4612</span><br><span class="line">4613</span><br><span class="line">4614</span><br><span class="line">4615</span><br><span class="line">4616</span><br><span class="line">4617</span><br><span class="line">4618</span><br><span class="line">4619</span><br><span class="line">4620</span><br><span class="line">4621</span><br><span class="line">4622</span><br><span class="line">4623</span><br><span class="line">4624</span><br><span class="line">4625</span><br><span class="line">4626</span><br><span class="line">4627</span><br><span class="line">4628</span><br><span class="line">4629</span><br><span class="line">4630</span><br><span class="line">4631</span><br><span class="line">4632</span><br><span class="line">4633</span><br><span class="line">4634</span><br><span class="line">4635</span><br><span class="line">4636</span><br><span class="line">4637</span><br><span class="line">4638</span><br><span class="line">4639</span><br><span class="line">4640</span><br><span class="line">4641</span><br><span class="line">4642</span><br><span class="line">4643</span><br><span class="line">4644</span><br><span class="line">4645</span><br><span class="line">4646</span><br><span class="line">4647</span><br><span class="line">4648</span><br><span class="line">4649</span><br><span class="line">4650</span><br><span class="line">4651</span><br><span class="line">4652</span><br><span class="line">4653</span><br><span class="line">4654</span><br><span class="line">4655</span><br><span class="line">4656</span><br><span class="line">4657</span><br><span class="line">4658</span><br><span class="line">4659</span><br><span class="line">4660</span><br><span class="line">4661</span><br><span class="line">4662</span><br><span class="line">4663</span><br><span class="line">4664</span><br><span class="line">4665</span><br><span class="line">4666</span><br><span class="line">4667</span><br><span class="line">4668</span><br><span class="line">4669</span><br><span class="line">4670</span><br><span class="line">4671</span><br><span class="line">4672</span><br><span class="line">4673</span><br><span class="line">4674</span><br><span class="line">4675</span><br><span class="line">4676</span><br><span class="line">4677</span><br><span class="line">4678</span><br><span class="line">4679</span><br><span class="line">4680</span><br><span class="line">4681</span><br><span class="line">4682</span><br><span class="line">4683</span><br><span class="line">4684</span><br><span class="line">4685</span><br><span class="line">4686</span><br><span class="line">4687</span><br><span class="line">4688</span><br><span class="line">4689</span><br><span class="line">4690</span><br><span class="line">4691</span><br><span class="line">4692</span><br><span class="line">4693</span><br><span class="line">4694</span><br><span class="line">4695</span><br><span class="line">4696</span><br><span class="line">4697</span><br><span class="line">4698</span><br><span class="line">4699</span><br><span class="line">4700</span><br><span class="line">4701</span><br><span class="line">4702</span><br><span class="line">4703</span><br><span class="line">4704</span><br><span class="line">4705</span><br><span class="line">4706</span><br><span class="line">4707</span><br><span class="line">4708</span><br><span class="line">4709</span><br><span class="line">4710</span><br><span class="line">4711</span><br><span class="line">4712</span><br><span class="line">4713</span><br><span class="line">4714</span><br><span class="line">4715</span><br><span class="line">4716</span><br><span class="line">4717</span><br><span class="line">4718</span><br><span class="line">4719</span><br><span class="line">4720</span><br><span class="line">4721</span><br><span class="line">4722</span><br><span class="line">4723</span><br><span class="line">4724</span><br><span class="line">4725</span><br><span class="line">4726</span><br><span class="line">4727</span><br><span class="line">4728</span><br><span class="line">4729</span><br><span class="line">4730</span><br><span class="line">4731</span><br><span class="line">4732</span><br><span class="line">4733</span><br><span class="line">4734</span><br><span class="line">4735</span><br><span class="line">4736</span><br><span class="line">4737</span><br><span class="line">4738</span><br><span class="line">4739</span><br><span class="line">4740</span><br><span class="line">4741</span><br><span class="line">4742</span><br><span class="line">4743</span><br><span class="line">4744</span><br><span class="line">4745</span><br><span class="line">4746</span><br><span class="line">4747</span><br><span class="line">4748</span><br><span class="line">4749</span><br><span class="line">4750</span><br><span class="line">4751</span><br><span class="line">4752</span><br><span class="line">4753</span><br><span class="line">4754</span><br><span class="line">4755</span><br><span class="line">4756</span><br><span class="line">4757</span><br><span class="line">4758</span><br><span class="line">4759</span><br><span class="line">4760</span><br><span class="line">4761</span><br><span class="line">4762</span><br><span class="line">4763</span><br><span class="line">4764</span><br><span class="line">4765</span><br><span class="line">4766</span><br><span class="line">4767</span><br><span class="line">4768</span><br><span class="line">4769</span><br><span class="line">4770</span><br><span class="line">4771</span><br><span class="line">4772</span><br><span class="line">4773</span><br><span class="line">4774</span><br><span class="line">4775</span><br><span class="line">4776</span><br><span class="line">4777</span><br><span class="line">4778</span><br><span class="line">4779</span><br><span class="line">4780</span><br><span class="line">4781</span><br><span class="line">4782</span><br><span class="line">4783</span><br><span class="line">4784</span><br><span class="line">4785</span><br><span class="line">4786</span><br><span class="line">4787</span><br><span class="line">4788</span><br><span class="line">4789</span><br><span class="line">4790</span><br><span class="line">4791</span><br><span class="line">4792</span><br><span class="line">4793</span><br><span class="line">4794</span><br><span class="line">4795</span><br><span class="line">4796</span><br><span class="line">4797</span><br><span class="line">4798</span><br><span class="line">4799</span><br><span class="line">4800</span><br><span class="line">4801</span><br><span class="line">4802</span><br><span class="line">4803</span><br><span class="line">4804</span><br><span class="line">4805</span><br><span class="line">4806</span><br><span class="line">4807</span><br><span class="line">4808</span><br><span class="line">4809</span><br><span class="line">4810</span><br><span class="line">4811</span><br><span class="line">4812</span><br><span class="line">4813</span><br><span class="line">4814</span><br><span class="line">4815</span><br><span class="line">4816</span><br><span class="line">4817</span><br><span class="line">4818</span><br><span class="line">4819</span><br><span class="line">4820</span><br><span class="line">4821</span><br><span class="line">4822</span><br><span class="line">4823</span><br><span class="line">4824</span><br><span class="line">4825</span><br><span class="line">4826</span><br><span class="line">4827</span><br><span class="line">4828</span><br><span class="line">4829</span><br><span class="line">4830</span><br><span class="line">4831</span><br><span class="line">4832</span><br><span class="line">4833</span><br><span class="line">4834</span><br><span class="line">4835</span><br><span class="line">4836</span><br><span class="line">4837</span><br><span class="line">4838</span><br><span class="line">4839</span><br><span class="line">4840</span><br><span class="line">4841</span><br><span class="line">4842</span><br><span class="line">4843</span><br><span class="line">4844</span><br><span class="line">4845</span><br><span class="line">4846</span><br><span class="line">4847</span><br><span class="line">4848</span><br><span class="line">4849</span><br><span class="line">4850</span><br><span class="line">4851</span><br><span class="line">4852</span><br><span class="line">4853</span><br><span class="line">4854</span><br><span class="line">4855</span><br><span class="line">4856</span><br><span class="line">4857</span><br><span class="line">4858</span><br><span class="line">4859</span><br><span class="line">4860</span><br><span class="line">4861</span><br><span class="line">4862</span><br><span class="line">4863</span><br><span class="line">4864</span><br><span class="line">4865</span><br><span class="line">4866</span><br><span class="line">4867</span><br><span class="line">4868</span><br><span class="line">4869</span><br><span class="line">4870</span><br><span class="line">4871</span><br><span class="line">4872</span><br><span class="line">4873</span><br><span class="line">4874</span><br><span class="line">4875</span><br><span class="line">4876</span><br><span class="line">4877</span><br><span class="line">4878</span><br><span class="line">4879</span><br><span class="line">4880</span><br><span class="line">4881</span><br><span class="line">4882</span><br><span class="line">4883</span><br><span class="line">4884</span><br><span class="line">4885</span><br><span class="line">4886</span><br><span class="line">4887</span><br><span class="line">4888</span><br><span class="line">4889</span><br><span class="line">4890</span><br><span class="line">4891</span><br><span class="line">4892</span><br><span class="line">4893</span><br><span class="line">4894</span><br><span class="line">4895</span><br><span class="line">4896</span><br><span class="line">4897</span><br><span class="line">4898</span><br><span class="line">4899</span><br><span class="line">4900</span><br><span class="line">4901</span><br><span class="line">4902</span><br><span class="line">4903</span><br><span class="line">4904</span><br><span class="line">4905</span><br><span class="line">4906</span><br><span class="line">4907</span><br><span class="line">4908</span><br><span class="line">4909</span><br><span class="line">4910</span><br><span class="line">4911</span><br><span class="line">4912</span><br><span class="line">4913</span><br><span class="line">4914</span><br><span class="line">4915</span><br><span class="line">4916</span><br><span class="line">4917</span><br><span class="line">4918</span><br><span class="line">4919</span><br><span class="line">4920</span><br><span class="line">4921</span><br><span class="line">4922</span><br><span class="line">4923</span><br><span class="line">4924</span><br><span class="line">4925</span><br><span class="line">4926</span><br><span class="line">4927</span><br><span class="line">4928</span><br><span class="line">4929</span><br><span class="line">4930</span><br><span class="line">4931</span><br><span class="line">4932</span><br><span class="line">4933</span><br><span class="line">4934</span><br><span class="line">4935</span><br><span class="line">4936</span><br><span class="line">4937</span><br><span class="line">4938</span><br><span class="line">4939</span><br><span class="line">4940</span><br><span class="line">4941</span><br><span class="line">4942</span><br><span class="line">4943</span><br><span class="line">4944</span><br><span class="line">4945</span><br><span class="line">4946</span><br><span class="line">4947</span><br><span class="line">4948</span><br><span class="line">4949</span><br><span class="line">4950</span><br><span class="line">4951</span><br><span class="line">4952</span><br><span class="line">4953</span><br><span class="line">4954</span><br><span class="line">4955</span><br><span class="line">4956</span><br><span class="line">4957</span><br><span class="line">4958</span><br><span class="line">4959</span><br><span class="line">4960</span><br><span class="line">4961</span><br><span class="line">4962</span><br><span class="line">4963</span><br><span class="line">4964</span><br><span class="line">4965</span><br><span class="line">4966</span><br><span class="line">4967</span><br><span class="line">4968</span><br><span class="line">4969</span><br><span class="line">4970</span><br><span class="line">4971</span><br><span class="line">4972</span><br><span class="line">4973</span><br><span class="line">4974</span><br><span class="line">4975</span><br><span class="line">4976</span><br><span class="line">4977</span><br><span class="line">4978</span><br><span class="line">4979</span><br><span class="line">4980</span><br><span class="line">4981</span><br><span class="line">4982</span><br><span class="line">4983</span><br><span class="line">4984</span><br><span class="line">4985</span><br><span class="line">4986</span><br><span class="line">4987</span><br><span class="line">4988</span><br><span class="line">4989</span><br><span class="line">4990</span><br><span class="line">4991</span><br><span class="line">4992</span><br><span class="line">4993</span><br><span class="line">4994</span><br><span class="line">4995</span><br><span class="line">4996</span><br><span class="line">4997</span><br><span class="line">4998</span><br><span class="line">4999</span><br><span class="line">5000</span><br><span class="line">5001</span><br><span class="line">5002</span><br><span class="line">5003</span><br><span class="line">5004</span><br><span class="line">5005</span><br><span class="line">5006</span><br><span class="line">5007</span><br><span class="line">5008</span><br><span class="line">5009</span><br><span class="line">5010</span><br><span class="line">5011</span><br><span class="line">5012</span><br><span class="line">5013</span><br><span class="line">5014</span><br><span class="line">5015</span><br><span class="line">5016</span><br><span class="line">5017</span><br><span class="line">5018</span><br><span class="line">5019</span><br><span class="line">5020</span><br><span class="line">5021</span><br><span class="line">5022</span><br><span class="line">5023</span><br><span class="line">5024</span><br><span class="line">5025</span><br><span class="line">5026</span><br><span class="line">5027</span><br><span class="line">5028</span><br><span class="line">5029</span><br><span class="line">5030</span><br><span class="line">5031</span><br><span class="line">5032</span><br><span class="line">5033</span><br><span class="line">5034</span><br><span class="line">5035</span><br><span class="line">5036</span><br><span class="line">5037</span><br><span class="line">5038</span><br><span class="line">5039</span><br><span class="line">5040</span><br><span class="line">5041</span><br><span class="line">5042</span><br><span class="line">5043</span><br><span class="line">5044</span><br><span class="line">5045</span><br><span class="line">5046</span><br><span class="line">5047</span><br><span class="line">5048</span><br><span class="line">5049</span><br><span class="line">5050</span><br><span class="line">5051</span><br><span class="line">5052</span><br><span class="line">5053</span><br><span class="line">5054</span><br><span class="line">5055</span><br><span class="line">5056</span><br><span class="line">5057</span><br><span class="line">5058</span><br><span class="line">5059</span><br><span class="line">5060</span><br><span class="line">5061</span><br><span class="line">5062</span><br><span class="line">5063</span><br><span class="line">5064</span><br><span class="line">5065</span><br><span class="line">5066</span><br><span class="line">5067</span><br><span class="line">5068</span><br><span class="line">5069</span><br><span class="line">5070</span><br><span class="line">5071</span><br><span class="line">5072</span><br><span class="line">5073</span><br><span class="line">5074</span><br><span class="line">5075</span><br><span class="line">5076</span><br><span class="line">5077</span><br><span class="line">5078</span><br><span class="line">5079</span><br><span class="line">5080</span><br><span class="line">5081</span><br><span class="line">5082</span><br><span class="line">5083</span><br><span class="line">5084</span><br><span class="line">5085</span><br><span class="line">5086</span><br><span class="line">5087</span><br><span class="line">5088</span><br><span class="line">5089</span><br><span class="line">5090</span><br><span class="line">5091</span><br><span class="line">5092</span><br><span class="line">5093</span><br><span class="line">5094</span><br><span class="line">5095</span><br><span class="line">5096</span><br><span class="line">5097</span><br><span class="line">5098</span><br><span class="line">5099</span><br><span class="line">5100</span><br><span class="line">5101</span><br><span class="line">5102</span><br><span class="line">5103</span><br><span class="line">5104</span><br><span class="line">5105</span><br><span class="line">5106</span><br><span class="line">5107</span><br><span class="line">5108</span><br><span class="line">5109</span><br><span class="line">5110</span><br><span class="line">5111</span><br><span class="line">5112</span><br><span class="line">5113</span><br><span class="line">5114</span><br><span class="line">5115</span><br><span class="line">5116</span><br><span class="line">5117</span><br><span class="line">5118</span><br><span class="line">5119</span><br><span class="line">5120</span><br><span class="line">5121</span><br><span class="line">5122</span><br><span class="line">5123</span><br><span class="line">5124</span><br><span class="line">5125</span><br><span class="line">5126</span><br><span class="line">5127</span><br><span class="line">5128</span><br><span class="line">5129</span><br><span class="line">5130</span><br><span class="line">5131</span><br><span class="line">5132</span><br><span class="line">5133</span><br><span class="line">5134</span><br><span class="line">5135</span><br><span class="line">5136</span><br><span class="line">5137</span><br><span class="line">5138</span><br><span class="line">5139</span><br><span class="line">5140</span><br><span class="line">5141</span><br><span class="line">5142</span><br><span class="line">5143</span><br><span class="line">5144</span><br><span class="line">5145</span><br><span class="line">5146</span><br><span class="line">5147</span><br><span class="line">5148</span><br><span class="line">5149</span><br><span class="line">5150</span><br><span class="line">5151</span><br><span class="line">5152</span><br><span class="line">5153</span><br><span class="line">5154</span><br><span class="line">5155</span><br><span class="line">5156</span><br><span class="line">5157</span><br><span class="line">5158</span><br><span class="line">5159</span><br><span class="line">5160</span><br><span class="line">5161</span><br><span class="line">5162</span><br><span class="line">5163</span><br><span class="line">5164</span><br><span class="line">5165</span><br><span class="line">5166</span><br><span class="line">5167</span><br><span class="line">5168</span><br><span class="line">5169</span><br><span class="line">5170</span><br><span class="line">5171</span><br><span class="line">5172</span><br><span class="line">5173</span><br><span class="line">5174</span><br><span class="line">5175</span><br><span class="line">5176</span><br><span class="line">5177</span><br><span class="line">5178</span><br><span class="line">5179</span><br><span class="line">5180</span><br><span class="line">5181</span><br><span class="line">5182</span><br><span class="line">5183</span><br><span class="line">5184</span><br><span class="line">5185</span><br><span class="line">5186</span><br><span class="line">5187</span><br><span class="line">5188</span><br><span class="line">5189</span><br><span class="line">5190</span><br><span class="line">5191</span><br><span class="line">5192</span><br><span class="line">5193</span><br><span class="line">5194</span><br><span class="line">5195</span><br><span class="line">5196</span><br><span class="line">5197</span><br><span class="line">5198</span><br><span class="line">5199</span><br><span class="line">5200</span><br><span class="line">5201</span><br><span class="line">5202</span><br><span class="line">5203</span><br><span class="line">5204</span><br><span class="line">5205</span><br><span class="line">5206</span><br><span class="line">5207</span><br><span class="line">5208</span><br><span class="line">5209</span><br><span class="line">5210</span><br><span class="line">5211</span><br><span class="line">5212</span><br><span class="line">5213</span><br><span class="line">5214</span><br><span class="line">5215</span><br><span class="line">5216</span><br><span class="line">5217</span><br><span class="line">5218</span><br><span class="line">5219</span><br><span class="line">5220</span><br><span class="line">5221</span><br><span class="line">5222</span><br><span class="line">5223</span><br><span class="line">5224</span><br><span class="line">5225</span><br><span class="line">5226</span><br><span class="line">5227</span><br><span class="line">5228</span><br><span class="line">5229</span><br><span class="line">5230</span><br><span class="line">5231</span><br><span class="line">5232</span><br><span class="line">5233</span><br><span class="line">5234</span><br><span class="line">5235</span><br><span class="line">5236</span><br><span class="line">5237</span><br><span class="line">5238</span><br><span class="line">5239</span><br><span class="line">5240</span><br><span class="line">5241</span><br><span class="line">5242</span><br><span class="line">5243</span><br><span class="line">5244</span><br><span class="line">5245</span><br><span class="line">5246</span><br><span class="line">5247</span><br><span class="line">5248</span><br><span class="line">5249</span><br><span class="line">5250</span><br><span class="line">5251</span><br><span class="line">5252</span><br><span class="line">5253</span><br><span class="line">5254</span><br><span class="line">5255</span><br><span class="line">5256</span><br><span class="line">5257</span><br><span class="line">5258</span><br><span class="line">5259</span><br><span class="line">5260</span><br><span class="line">5261</span><br><span class="line">5262</span><br><span class="line">5263</span><br><span class="line">5264</span><br><span class="line">5265</span><br><span class="line">5266</span><br><span class="line">5267</span><br><span class="line">5268</span><br><span class="line">5269</span><br><span class="line">5270</span><br><span class="line">5271</span><br><span class="line">5272</span><br><span class="line">5273</span><br><span class="line">5274</span><br><span class="line">5275</span><br><span class="line">5276</span><br><span class="line">5277</span><br><span class="line">5278</span><br><span class="line">5279</span><br><span class="line">5280</span><br><span class="line">5281</span><br><span class="line">5282</span><br><span class="line">5283</span><br><span class="line">5284</span><br><span class="line">5285</span><br><span class="line">5286</span><br><span class="line">5287</span><br><span class="line">5288</span><br><span class="line">5289</span><br><span class="line">5290</span><br><span class="line">5291</span><br><span class="line">5292</span><br><span class="line">5293</span><br><span class="line">5294</span><br><span class="line">5295</span><br><span class="line">5296</span><br><span class="line">5297</span><br><span class="line">5298</span><br><span class="line">5299</span><br><span class="line">5300</span><br><span class="line">5301</span><br><span class="line">5302</span><br><span class="line">5303</span><br><span class="line">5304</span><br><span class="line">5305</span><br><span class="line">5306</span><br><span class="line">5307</span><br><span class="line">5308</span><br><span class="line">5309</span><br><span class="line">5310</span><br><span class="line">5311</span><br><span class="line">5312</span><br><span class="line">5313</span><br><span class="line">5314</span><br><span class="line">5315</span><br><span class="line">5316</span><br><span class="line">5317</span><br><span class="line">5318</span><br><span class="line">5319</span><br><span class="line">5320</span><br><span class="line">5321</span><br><span class="line">5322</span><br><span class="line">5323</span><br><span class="line">5324</span><br><span class="line">5325</span><br><span class="line">5326</span><br><span class="line">5327</span><br><span class="line">5328</span><br><span class="line">5329</span><br><span class="line">5330</span><br><span class="line">5331</span><br><span class="line">5332</span><br><span class="line">5333</span><br><span class="line">5334</span><br><span class="line">5335</span><br><span class="line">5336</span><br><span class="line">5337</span><br><span class="line">5338</span><br><span class="line">5339</span><br><span class="line">5340</span><br><span class="line">5341</span><br><span class="line">5342</span><br><span class="line">5343</span><br><span class="line">5344</span><br><span class="line">5345</span><br><span class="line">5346</span><br><span class="line">5347</span><br><span class="line">5348</span><br><span class="line">5349</span><br><span class="line">5350</span><br><span class="line">5351</span><br><span class="line">5352</span><br><span class="line">5353</span><br><span class="line">5354</span><br><span class="line">5355</span><br><span class="line">5356</span><br><span class="line">5357</span><br><span class="line">5358</span><br><span class="line">5359</span><br><span class="line">5360</span><br><span class="line">5361</span><br><span class="line">5362</span><br><span class="line">5363</span><br><span class="line">5364</span><br><span class="line">5365</span><br><span class="line">5366</span><br><span class="line">5367</span><br><span class="line">5368</span><br><span class="line">5369</span><br><span class="line">5370</span><br><span class="line">5371</span><br><span class="line">5372</span><br><span class="line">5373</span><br><span class="line">5374</span><br><span class="line">5375</span><br><span class="line">5376</span><br><span class="line">5377</span><br><span class="line">5378</span><br><span class="line">5379</span><br><span class="line">5380</span><br><span class="line">5381</span><br><span class="line">5382</span><br><span class="line">5383</span><br><span class="line">5384</span><br><span class="line">5385</span><br><span class="line">5386</span><br><span class="line">5387</span><br><span class="line">5388</span><br><span class="line">5389</span><br><span class="line">5390</span><br><span class="line">5391</span><br><span class="line">5392</span><br><span class="line">5393</span><br><span class="line">5394</span><br><span class="line">5395</span><br><span class="line">5396</span><br><span class="line">5397</span><br><span class="line">5398</span><br><span class="line">5399</span><br><span class="line">5400</span><br><span class="line">5401</span><br><span class="line">5402</span><br><span class="line">5403</span><br><span class="line">5404</span><br><span class="line">5405</span><br><span class="line">5406</span><br><span class="line">5407</span><br><span class="line">5408</span><br><span class="line">5409</span><br><span class="line">5410</span><br><span class="line">5411</span><br><span class="line">5412</span><br><span class="line">5413</span><br><span class="line">5414</span><br><span class="line">5415</span><br><span class="line">5416</span><br><span class="line">5417</span><br><span class="line">5418</span><br><span class="line">5419</span><br><span class="line">5420</span><br><span class="line">5421</span><br><span class="line">5422</span><br><span class="line">5423</span><br><span class="line">5424</span><br><span class="line">5425</span><br><span class="line">5426</span><br><span class="line">5427</span><br><span class="line">5428</span><br><span class="line">5429</span><br><span class="line">5430</span><br><span class="line">5431</span><br><span class="line">5432</span><br><span class="line">5433</span><br><span class="line">5434</span><br><span class="line">5435</span><br><span class="line">5436</span><br><span class="line">5437</span><br><span class="line">5438</span><br><span class="line">5439</span><br><span class="line">5440</span><br><span class="line">5441</span><br><span class="line">5442</span><br><span class="line">5443</span><br><span class="line">5444</span><br><span class="line">5445</span><br><span class="line">5446</span><br><span class="line">5447</span><br><span class="line">5448</span><br><span class="line">5449</span><br><span class="line">5450</span><br><span class="line">5451</span><br><span class="line">5452</span><br><span class="line">5453</span><br><span class="line">5454</span><br><span class="line">5455</span><br><span class="line">5456</span><br><span class="line">5457</span><br><span class="line">5458</span><br><span class="line">5459</span><br><span class="line">5460</span><br><span class="line">5461</span><br><span class="line">5462</span><br><span class="line">5463</span><br><span class="line">5464</span><br><span class="line">5465</span><br><span class="line">5466</span><br><span class="line">5467</span><br><span class="line">5468</span><br><span class="line">5469</span><br><span class="line">5470</span><br><span class="line">5471</span><br><span class="line">5472</span><br><span class="line">5473</span><br><span class="line">5474</span><br><span class="line">5475</span><br><span class="line">5476</span><br><span class="line">5477</span><br><span class="line">5478</span><br><span class="line">5479</span><br><span class="line">5480</span><br><span class="line">5481</span><br><span class="line">5482</span><br><span class="line">5483</span><br><span class="line">5484</span><br><span class="line">5485</span><br><span class="line">5486</span><br><span class="line">5487</span><br><span class="line">5488</span><br><span class="line">5489</span><br><span class="line">5490</span><br><span class="line">5491</span><br><span class="line">5492</span><br><span class="line">5493</span><br><span class="line">5494</span><br><span class="line">5495</span><br><span class="line">5496</span><br><span class="line">5497</span><br><span class="line">5498</span><br><span class="line">5499</span><br><span class="line">5500</span><br><span class="line">5501</span><br><span class="line">5502</span><br><span class="line">5503</span><br><span class="line">5504</span><br><span class="line">5505</span><br><span class="line">5506</span><br><span class="line">5507</span><br><span class="line">5508</span><br><span class="line">5509</span><br><span class="line">5510</span><br><span class="line">5511</span><br><span class="line">5512</span><br><span class="line">5513</span><br><span class="line">5514</span><br><span class="line">5515</span><br><span class="line">5516</span><br><span class="line">5517</span><br><span class="line">5518</span><br><span class="line">5519</span><br><span class="line">5520</span><br><span class="line">5521</span><br><span class="line">5522</span><br><span class="line">5523</span><br><span class="line">5524</span><br><span class="line">5525</span><br><span class="line">5526</span><br><span class="line">5527</span><br><span class="line">5528</span><br><span class="line">5529</span><br><span class="line">5530</span><br><span class="line">5531</span><br><span class="line">5532</span><br><span class="line">5533</span><br><span class="line">5534</span><br><span class="line">5535</span><br><span class="line">5536</span><br><span class="line">5537</span><br><span class="line">5538</span><br><span class="line">5539</span><br><span class="line">5540</span><br><span class="line">5541</span><br><span class="line">5542</span><br><span class="line">5543</span><br><span class="line">5544</span><br><span class="line">5545</span><br><span class="line">5546</span><br><span class="line">5547</span><br><span class="line">5548</span><br><span class="line">5549</span><br><span class="line">5550</span><br><span class="line">5551</span><br><span class="line">5552</span><br><span class="line">5553</span><br><span class="line">5554</span><br><span class="line">5555</span><br><span class="line">5556</span><br><span class="line">5557</span><br><span class="line">5558</span><br><span class="line">5559</span><br><span class="line">5560</span><br><span class="line">5561</span><br><span class="line">5562</span><br><span class="line">5563</span><br><span class="line">5564</span><br><span class="line">5565</span><br><span class="line">5566</span><br><span class="line">5567</span><br><span class="line">5568</span><br><span class="line">5569</span><br><span class="line">5570</span><br><span class="line">5571</span><br><span class="line">5572</span><br><span class="line">5573</span><br><span class="line">5574</span><br><span class="line">5575</span><br><span class="line">5576</span><br><span class="line">5577</span><br><span class="line">5578</span><br><span class="line">5579</span><br><span class="line">5580</span><br><span class="line">5581</span><br><span class="line">5582</span><br><span class="line">5583</span><br><span class="line">5584</span><br><span class="line">5585</span><br><span class="line">5586</span><br><span class="line">5587</span><br><span class="line">5588</span><br><span class="line">5589</span><br><span class="line">5590</span><br><span class="line">5591</span><br><span class="line">5592</span><br><span class="line">5593</span><br><span class="line">5594</span><br><span class="line">5595</span><br><span class="line">5596</span><br><span class="line">5597</span><br><span class="line">5598</span><br><span class="line">5599</span><br><span class="line">5600</span><br><span class="line">5601</span><br><span class="line">5602</span><br><span class="line">5603</span><br><span class="line">5604</span><br><span class="line">5605</span><br><span class="line">5606</span><br><span class="line">5607</span><br><span class="line">5608</span><br><span class="line">5609</span><br><span class="line">5610</span><br><span class="line">5611</span><br><span class="line">5612</span><br><span class="line">5613</span><br><span class="line">5614</span><br><span class="line">5615</span><br><span class="line">5616</span><br><span class="line">5617</span><br><span class="line">5618</span><br><span class="line">5619</span><br><span class="line">5620</span><br><span class="line">5621</span><br><span class="line">5622</span><br><span class="line">5623</span><br><span class="line">5624</span><br><span class="line">5625</span><br><span class="line">5626</span><br><span class="line">5627</span><br><span class="line">5628</span><br><span class="line">5629</span><br><span class="line">5630</span><br><span class="line">5631</span><br><span class="line">5632</span><br><span class="line">5633</span><br><span class="line">5634</span><br><span class="line">5635</span><br><span class="line">5636</span><br><span class="line">5637</span><br><span class="line">5638</span><br><span class="line">5639</span><br><span class="line">5640</span><br><span class="line">5641</span><br><span class="line">5642</span><br><span class="line">5643</span><br><span class="line">5644</span><br><span class="line">5645</span><br><span class="line">5646</span><br><span class="line">5647</span><br><span class="line">5648</span><br><span class="line">5649</span><br><span class="line">5650</span><br><span class="line">5651</span><br><span class="line">5652</span><br><span class="line">5653</span><br><span class="line">5654</span><br><span class="line">5655</span><br><span class="line">5656</span><br><span class="line">5657</span><br><span class="line">5658</span><br><span class="line">5659</span><br><span class="line">5660</span><br><span class="line">5661</span><br><span class="line">5662</span><br><span class="line">5663</span><br><span class="line">5664</span><br><span class="line">5665</span><br><span class="line">5666</span><br><span class="line">5667</span><br><span class="line">5668</span><br><span class="line">5669</span><br><span class="line">5670</span><br><span class="line">5671</span><br><span class="line">5672</span><br><span class="line">5673</span><br><span class="line">5674</span><br><span class="line">5675</span><br><span class="line">5676</span><br><span class="line">5677</span><br><span class="line">5678</span><br><span class="line">5679</span><br><span class="line">5680</span><br><span class="line">5681</span><br><span class="line">5682</span><br><span class="line">5683</span><br><span class="line">5684</span><br><span class="line">5685</span><br><span class="line">5686</span><br><span class="line">5687</span><br><span class="line">5688</span><br><span class="line">5689</span><br><span class="line">5690</span><br><span class="line">5691</span><br><span class="line">5692</span><br><span class="line">5693</span><br><span class="line">5694</span><br><span class="line">5695</span><br><span class="line">5696</span><br><span class="line">5697</span><br><span class="line">5698</span><br><span class="line">5699</span><br><span class="line">5700</span><br><span class="line">5701</span><br><span class="line">5702</span><br><span class="line">5703</span><br><span class="line">5704</span><br><span class="line">5705</span><br><span class="line">5706</span><br><span class="line">5707</span><br><span class="line">5708</span><br><span class="line">5709</span><br><span class="line">5710</span><br><span class="line">5711</span><br><span class="line">5712</span><br><span class="line">5713</span><br><span class="line">5714</span><br><span class="line">5715</span><br><span class="line">5716</span><br><span class="line">5717</span><br><span class="line">5718</span><br><span class="line">5719</span><br><span class="line">5720</span><br><span class="line">5721</span><br><span class="line">5722</span><br><span class="line">5723</span><br><span class="line">5724</span><br><span class="line">5725</span><br><span class="line">5726</span><br><span class="line">5727</span><br><span class="line">5728</span><br><span class="line">5729</span><br><span class="line">5730</span><br><span class="line">5731</span><br><span class="line">5732</span><br><span class="line">5733</span><br><span class="line">5734</span><br><span class="line">5735</span><br><span class="line">5736</span><br><span class="line">5737</span><br><span class="line">5738</span><br><span class="line">5739</span><br><span class="line">5740</span><br><span class="line">5741</span><br><span class="line">5742</span><br><span class="line">5743</span><br><span class="line">5744</span><br><span class="line">5745</span><br><span class="line">5746</span><br><span class="line">5747</span><br><span class="line">5748</span><br><span class="line">5749</span><br><span class="line">5750</span><br><span class="line">5751</span><br><span class="line">5752</span><br><span class="line">5753</span><br><span class="line">5754</span><br><span class="line">5755</span><br><span class="line">5756</span><br><span class="line">5757</span><br><span class="line">5758</span><br><span class="line">5759</span><br><span class="line">5760</span><br><span class="line">5761</span><br><span class="line">5762</span><br><span class="line">5763</span><br><span class="line">5764</span><br><span class="line">5765</span><br><span class="line">5766</span><br><span class="line">5767</span><br><span class="line">5768</span><br><span class="line">5769</span><br><span class="line">5770</span><br><span class="line">5771</span><br><span class="line">5772</span><br><span class="line">5773</span><br><span class="line">5774</span><br><span class="line">5775</span><br><span class="line">5776</span><br><span class="line">5777</span><br><span class="line">5778</span><br><span class="line">5779</span><br><span class="line">5780</span><br><span class="line">5781</span><br><span class="line">5782</span><br><span class="line">5783</span><br><span class="line">5784</span><br><span class="line">5785</span><br><span class="line">5786</span><br><span class="line">5787</span><br><span class="line">5788</span><br><span class="line">5789</span><br><span class="line">5790</span><br><span class="line">5791</span><br><span class="line">5792</span><br><span class="line">5793</span><br><span class="line">5794</span><br><span class="line">5795</span><br><span class="line">5796</span><br><span class="line">5797</span><br><span class="line">5798</span><br><span class="line">5799</span><br><span class="line">5800</span><br><span class="line">5801</span><br><span class="line">5802</span><br><span class="line">5803</span><br><span class="line">5804</span><br><span class="line">5805</span><br><span class="line">5806</span><br><span class="line">5807</span><br><span class="line">5808</span><br><span class="line">5809</span><br><span class="line">5810</span><br><span class="line">5811</span><br><span class="line">5812</span><br><span class="line">5813</span><br><span class="line">5814</span><br><span class="line">5815</span><br><span class="line">5816</span><br><span class="line">5817</span><br><span class="line">5818</span><br><span class="line">5819</span><br><span class="line">5820</span><br><span class="line">5821</span><br><span class="line">5822</span><br><span class="line">5823</span><br><span class="line">5824</span><br><span class="line">5825</span><br><span class="line">5826</span><br><span class="line">5827</span><br><span class="line">5828</span><br><span class="line">5829</span><br><span class="line">5830</span><br><span class="line">5831</span><br><span class="line">5832</span><br><span class="line">5833</span><br><span class="line">5834</span><br><span class="line">5835</span><br><span class="line">5836</span><br><span class="line">5837</span><br><span class="line">5838</span><br><span class="line">5839</span><br><span class="line">5840</span><br><span class="line">5841</span><br><span class="line">5842</span><br><span class="line">5843</span><br><span class="line">5844</span><br><span class="line">5845</span><br><span class="line">5846</span><br><span class="line">5847</span><br><span class="line">5848</span><br><span class="line">5849</span><br><span class="line">5850</span><br><span class="line">5851</span><br><span class="line">5852</span><br><span class="line">5853</span><br><span class="line">5854</span><br><span class="line">5855</span><br><span class="line">5856</span><br><span class="line">5857</span><br><span class="line">5858</span><br><span class="line">5859</span><br><span class="line">5860</span><br><span class="line">5861</span><br><span class="line">5862</span><br><span class="line">5863</span><br><span class="line">5864</span><br><span class="line">5865</span><br><span class="line">5866</span><br><span class="line">5867</span><br><span class="line">5868</span><br><span class="line">5869</span><br><span class="line">5870</span><br><span class="line">5871</span><br><span class="line">5872</span><br><span class="line">5873</span><br><span class="line">5874</span><br><span class="line">5875</span><br><span class="line">5876</span><br><span class="line">5877</span><br><span class="line">5878</span><br><span class="line">5879</span><br><span class="line">5880</span><br><span class="line">5881</span><br><span class="line">5882</span><br><span class="line">5883</span><br><span class="line">5884</span><br><span class="line">5885</span><br><span class="line">5886</span><br><span class="line">5887</span><br><span class="line">5888</span><br><span class="line">5889</span><br><span class="line">5890</span><br><span class="line">5891</span><br><span class="line">5892</span><br><span class="line">5893</span><br><span class="line">5894</span><br><span class="line">5895</span><br><span class="line">5896</span><br><span class="line">5897</span><br><span class="line">5898</span><br><span class="line">5899</span><br><span class="line">5900</span><br><span class="line">5901</span><br><span class="line">5902</span><br><span class="line">5903</span><br><span class="line">5904</span><br><span class="line">5905</span><br><span class="line">5906</span><br><span class="line">5907</span><br><span class="line">5908</span><br><span class="line">5909</span><br><span class="line">5910</span><br><span class="line">5911</span><br><span class="line">5912</span><br><span class="line">5913</span><br><span class="line">5914</span><br><span class="line">5915</span><br><span class="line">5916</span><br><span class="line">5917</span><br><span class="line">5918</span><br><span class="line">5919</span><br><span class="line">5920</span><br><span class="line">5921</span><br><span class="line">5922</span><br><span class="line">5923</span><br><span class="line">5924</span><br><span class="line">5925</span><br><span class="line">5926</span><br><span class="line">5927</span><br><span class="line">5928</span><br><span class="line">5929</span><br><span class="line">5930</span><br><span class="line">5931</span><br><span class="line">5932</span><br><span class="line">5933</span><br><span class="line">5934</span><br><span class="line">5935</span><br><span class="line">5936</span><br><span class="line">5937</span><br><span class="line">5938</span><br><span class="line">5939</span><br><span class="line">5940</span><br><span class="line">5941</span><br><span class="line">5942</span><br><span class="line">5943</span><br><span class="line">5944</span><br><span class="line">5945</span><br><span class="line">5946</span><br><span class="line">5947</span><br><span class="line">5948</span><br><span class="line">5949</span><br><span class="line">5950</span><br><span class="line">5951</span><br><span class="line">5952</span><br><span class="line">5953</span><br><span class="line">5954</span><br><span class="line">5955</span><br><span class="line">5956</span><br><span class="line">5957</span><br><span class="line">5958</span><br><span class="line">5959</span><br><span class="line">5960</span><br><span class="line">5961</span><br><span class="line">5962</span><br><span class="line">5963</span><br><span class="line">5964</span><br><span class="line">5965</span><br><span class="line">5966</span><br><span class="line">5967</span><br><span class="line">5968</span><br><span class="line">5969</span><br><span class="line">5970</span><br><span class="line">5971</span><br><span class="line">5972</span><br><span class="line">5973</span><br><span class="line">5974</span><br><span class="line">5975</span><br><span class="line">5976</span><br><span class="line">5977</span><br><span class="line">5978</span><br><span class="line">5979</span><br><span class="line">5980</span><br><span class="line">5981</span><br><span class="line">5982</span><br><span class="line">5983</span><br><span class="line">5984</span><br><span class="line">5985</span><br><span class="line">5986</span><br><span class="line">5987</span><br><span class="line">5988</span><br><span class="line">5989</span><br><span class="line">5990</span><br><span class="line">5991</span><br><span class="line">5992</span><br><span class="line">5993</span><br><span class="line">5994</span><br><span class="line">5995</span><br><span class="line">5996</span><br><span class="line">5997</span><br><span class="line">5998</span><br><span class="line">5999</span><br><span class="line">6000</span><br><span class="line">6001</span><br><span class="line">6002</span><br><span class="line">6003</span><br><span class="line">6004</span><br><span class="line">6005</span><br><span class="line">6006</span><br><span class="line">6007</span><br><span class="line">6008</span><br><span class="line">6009</span><br><span class="line">6010</span><br><span class="line">6011</span><br><span class="line">6012</span><br><span class="line">6013</span><br><span class="line">6014</span><br><span class="line">6015</span><br><span class="line">6016</span><br><span class="line">6017</span><br><span class="line">6018</span><br><span class="line">6019</span><br><span class="line">6020</span><br><span class="line">6021</span><br><span class="line">6022</span><br><span class="line">6023</span><br><span class="line">6024</span><br><span class="line">6025</span><br><span class="line">6026</span><br><span class="line">6027</span><br><span class="line">6028</span><br><span class="line">6029</span><br><span class="line">6030</span><br><span class="line">6031</span><br><span class="line">6032</span><br><span class="line">6033</span><br><span class="line">6034</span><br><span class="line">6035</span><br><span class="line">6036</span><br><span class="line">6037</span><br><span class="line">6038</span><br><span class="line">6039</span><br><span class="line">6040</span><br><span class="line">6041</span><br><span class="line">6042</span><br><span class="line">6043</span><br><span class="line">6044</span><br><span class="line">6045</span><br><span class="line">6046</span><br><span class="line">6047</span><br><span class="line">6048</span><br><span class="line">6049</span><br><span class="line">6050</span><br><span class="line">6051</span><br><span class="line">6052</span><br><span class="line">6053</span><br><span class="line">6054</span><br><span class="line">6055</span><br><span class="line">6056</span><br><span class="line">6057</span><br><span class="line">6058</span><br><span class="line">6059</span><br><span class="line">6060</span><br><span class="line">6061</span><br><span class="line">6062</span><br><span class="line">6063</span><br><span class="line">6064</span><br><span class="line">6065</span><br><span class="line">6066</span><br><span class="line">6067</span><br><span class="line">6068</span><br><span class="line">6069</span><br><span class="line">6070</span><br><span class="line">6071</span><br><span class="line">6072</span><br><span class="line">6073</span><br><span class="line">6074</span><br><span class="line">6075</span><br><span class="line">6076</span><br><span class="line">6077</span><br><span class="line">6078</span><br><span class="line">6079</span><br><span class="line">6080</span><br><span class="line">6081</span><br><span class="line">6082</span><br><span class="line">6083</span><br><span class="line">6084</span><br><span class="line">6085</span><br><span class="line">6086</span><br><span class="line">6087</span><br><span class="line">6088</span><br><span class="line">6089</span><br><span class="line">6090</span><br><span class="line">6091</span><br><span class="line">6092</span><br><span class="line">6093</span><br><span class="line">6094</span><br><span class="line">6095</span><br><span class="line">6096</span><br><span class="line">6097</span><br><span class="line">6098</span><br><span class="line">6099</span><br><span class="line">6100</span><br><span class="line">6101</span><br><span class="line">6102</span><br><span class="line">6103</span><br><span class="line">6104</span><br><span class="line">6105</span><br><span class="line">6106</span><br><span class="line">6107</span><br><span class="line">6108</span><br><span class="line">6109</span><br><span class="line">6110</span><br><span class="line">6111</span><br><span class="line">6112</span><br><span class="line">6113</span><br><span class="line">6114</span><br><span class="line">6115</span><br><span class="line">6116</span><br><span class="line">6117</span><br><span class="line">6118</span><br><span class="line">6119</span><br><span class="line">6120</span><br><span class="line">6121</span><br><span class="line">6122</span><br><span class="line">6123</span><br><span class="line">6124</span><br><span class="line">6125</span><br><span class="line">6126</span><br><span class="line">6127</span><br><span class="line">6128</span><br><span class="line">6129</span><br><span class="line">6130</span><br><span class="line">6131</span><br><span class="line">6132</span><br><span class="line">6133</span><br><span class="line">6134</span><br><span class="line">6135</span><br><span class="line">6136</span><br><span class="line">6137</span><br><span class="line">6138</span><br><span class="line">6139</span><br><span class="line">6140</span><br><span class="line">6141</span><br><span class="line">6142</span><br><span class="line">6143</span><br><span class="line">6144</span><br><span class="line">6145</span><br><span class="line">6146</span><br><span class="line">6147</span><br><span class="line">6148</span><br><span class="line">6149</span><br><span class="line">6150</span><br><span class="line">6151</span><br><span class="line">6152</span><br><span class="line">6153</span><br><span class="line">6154</span><br><span class="line">6155</span><br><span class="line">6156</span><br><span class="line">6157</span><br><span class="line">6158</span><br><span class="line">6159</span><br><span class="line">6160</span><br><span class="line">6161</span><br><span class="line">6162</span><br><span class="line">6163</span><br><span class="line">6164</span><br><span class="line">6165</span><br><span class="line">6166</span><br><span class="line">6167</span><br><span class="line">6168</span><br><span class="line">6169</span><br><span class="line">6170</span><br><span class="line">6171</span><br><span class="line">6172</span><br><span class="line">6173</span><br><span class="line">6174</span><br><span class="line">6175</span><br><span class="line">6176</span><br><span class="line">6177</span><br><span class="line">6178</span><br><span class="line">6179</span><br><span class="line">6180</span><br><span class="line">6181</span><br><span class="line">6182</span><br><span class="line">6183</span><br><span class="line">6184</span><br><span class="line">6185</span><br><span class="line">6186</span><br><span class="line">6187</span><br><span class="line">6188</span><br><span class="line">6189</span><br><span class="line">6190</span><br><span class="line">6191</span><br><span class="line">6192</span><br><span class="line">6193</span><br><span class="line">6194</span><br><span class="line">6195</span><br><span class="line">6196</span><br><span class="line">6197</span><br><span class="line">6198</span><br><span class="line">6199</span><br><span class="line">6200</span><br><span class="line">6201</span><br><span class="line">6202</span><br><span class="line">6203</span><br><span class="line">6204</span><br><span class="line">6205</span><br><span class="line">6206</span><br><span class="line">6207</span><br><span class="line">6208</span><br><span class="line">6209</span><br><span class="line">6210</span><br><span class="line">6211</span><br><span class="line">6212</span><br><span class="line">6213</span><br><span class="line">6214</span><br><span class="line">6215</span><br><span class="line">6216</span><br><span class="line">6217</span><br><span class="line">6218</span><br><span class="line">6219</span><br><span class="line">6220</span><br><span class="line">6221</span><br><span class="line">6222</span><br><span class="line">6223</span><br><span class="line">6224</span><br><span class="line">6225</span><br><span class="line">6226</span><br><span class="line">6227</span><br><span class="line">6228</span><br><span class="line">6229</span><br><span class="line">6230</span><br><span class="line">6231</span><br><span class="line">6232</span><br><span class="line">6233</span><br><span class="line">6234</span><br><span class="line">6235</span><br><span class="line">6236</span><br><span class="line">6237</span><br><span class="line">6238</span><br><span class="line">6239</span><br><span class="line">6240</span><br><span class="line">6241</span><br><span class="line">6242</span><br><span class="line">6243</span><br><span class="line">6244</span><br><span class="line">6245</span><br><span class="line">6246</span><br><span class="line">6247</span><br><span class="line">6248</span><br><span class="line">6249</span><br><span class="line">6250</span><br><span class="line">6251</span><br><span class="line">6252</span><br><span class="line">6253</span><br><span class="line">6254</span><br><span class="line">6255</span><br><span class="line">6256</span><br><span class="line">6257</span><br><span class="line">6258</span><br><span class="line">6259</span><br><span class="line">6260</span><br><span class="line">6261</span><br><span class="line">6262</span><br><span class="line">6263</span><br><span class="line">6264</span><br><span class="line">6265</span><br><span class="line">6266</span><br><span class="line">6267</span><br><span class="line">6268</span><br><span class="line">6269</span><br><span class="line">6270</span><br><span class="line">6271</span><br><span class="line">6272</span><br><span class="line">6273</span><br><span class="line">6274</span><br><span class="line">6275</span><br><span class="line">6276</span><br><span class="line">6277</span><br><span class="line">6278</span><br><span class="line">6279</span><br><span class="line">6280</span><br><span class="line">6281</span><br><span class="line">6282</span><br><span class="line">6283</span><br><span class="line">6284</span><br><span class="line">6285</span><br><span class="line">6286</span><br><span class="line">6287</span><br><span class="line">6288</span><br><span class="line">6289</span><br><span class="line">6290</span><br><span class="line">6291</span><br><span class="line">6292</span><br><span class="line">6293</span><br><span class="line">6294</span><br><span class="line">6295</span><br><span class="line">6296</span><br><span class="line">6297</span><br><span class="line">6298</span><br><span class="line">6299</span><br><span class="line">6300</span><br><span class="line">6301</span><br><span class="line">6302</span><br><span class="line">6303</span><br><span class="line">6304</span><br><span class="line">6305</span><br><span class="line">6306</span><br><span class="line">6307</span><br><span class="line">6308</span><br><span class="line">6309</span><br><span class="line">6310</span><br><span class="line">6311</span><br><span class="line">6312</span><br><span class="line">6313</span><br><span class="line">6314</span><br><span class="line">6315</span><br><span class="line">6316</span><br><span class="line">6317</span><br><span class="line">6318</span><br><span class="line">6319</span><br><span class="line">6320</span><br><span class="line">6321</span><br><span class="line">6322</span><br><span class="line">6323</span><br><span class="line">6324</span><br><span class="line">6325</span><br><span class="line">6326</span><br><span class="line">6327</span><br><span class="line">6328</span><br><span class="line">6329</span><br><span class="line">6330</span><br><span class="line">6331</span><br><span class="line">6332</span><br><span class="line">6333</span><br><span class="line">6334</span><br><span class="line">6335</span><br><span class="line">6336</span><br><span class="line">6337</span><br><span class="line">6338</span><br><span class="line">6339</span><br><span class="line">6340</span><br><span class="line">6341</span><br><span class="line">6342</span><br><span class="line">6343</span><br><span class="line">6344</span><br><span class="line">6345</span><br><span class="line">6346</span><br><span class="line">6347</span><br><span class="line">6348</span><br><span class="line">6349</span><br><span class="line">6350</span><br><span class="line">6351</span><br><span class="line">6352</span><br><span class="line">6353</span><br><span class="line">6354</span><br><span class="line">6355</span><br><span class="line">6356</span><br><span class="line">6357</span><br><span class="line">6358</span><br><span class="line">6359</span><br><span class="line">6360</span><br><span class="line">6361</span><br><span class="line">6362</span><br><span class="line">6363</span><br><span class="line">6364</span><br><span class="line">6365</span><br><span class="line">6366</span><br><span class="line">6367</span><br><span class="line">6368</span><br><span class="line">6369</span><br><span class="line">6370</span><br><span class="line">6371</span><br><span class="line">6372</span><br><span class="line">6373</span><br><span class="line">6374</span><br><span class="line">6375</span><br><span class="line">6376</span><br><span class="line">6377</span><br><span class="line">6378</span><br><span class="line">6379</span><br><span class="line">6380</span><br><span class="line">6381</span><br><span class="line">6382</span><br><span class="line">6383</span><br><span class="line">6384</span><br><span class="line">6385</span><br><span class="line">6386</span><br><span class="line">6387</span><br><span class="line">6388</span><br><span class="line">6389</span><br><span class="line">6390</span><br><span class="line">6391</span><br><span class="line">6392</span><br><span class="line">6393</span><br><span class="line">6394</span><br><span class="line">6395</span><br><span class="line">6396</span><br><span class="line">6397</span><br><span class="line">6398</span><br><span class="line">6399</span><br><span class="line">6400</span><br><span class="line">6401</span><br><span class="line">6402</span><br><span class="line">6403</span><br><span class="line">6404</span><br><span class="line">6405</span><br><span class="line">6406</span><br><span class="line">6407</span><br><span class="line">6408</span><br><span class="line">6409</span><br><span class="line">6410</span><br><span class="line">6411</span><br><span class="line">6412</span><br><span class="line">6413</span><br><span class="line">6414</span><br><span class="line">6415</span><br><span class="line">6416</span><br><span class="line">6417</span><br><span class="line">6418</span><br><span class="line">6419</span><br><span class="line">6420</span><br><span class="line">6421</span><br><span class="line">6422</span><br><span class="line">6423</span><br><span class="line">6424</span><br><span class="line">6425</span><br><span class="line">6426</span><br><span class="line">6427</span><br><span class="line">6428</span><br><span class="line">6429</span><br><span class="line">6430</span><br><span class="line">6431</span><br><span class="line">6432</span><br><span class="line">6433</span><br><span class="line">6434</span><br><span class="line">6435</span><br><span class="line">6436</span><br><span class="line">6437</span><br><span class="line">6438</span><br><span class="line">6439</span><br><span class="line">6440</span><br><span class="line">6441</span><br><span class="line">6442</span><br><span class="line">6443</span><br><span class="line">6444</span><br><span class="line">6445</span><br><span class="line">6446</span><br><span class="line">6447</span><br><span class="line">6448</span><br><span class="line">6449</span><br><span class="line">6450</span><br><span class="line">6451</span><br><span class="line">6452</span><br><span class="line">6453</span><br><span class="line">6454</span><br><span class="line">6455</span><br><span class="line">6456</span><br><span class="line">6457</span><br><span class="line">6458</span><br><span class="line">6459</span><br><span class="line">6460</span><br><span class="line">6461</span><br><span class="line">6462</span><br><span class="line">6463</span><br><span class="line">6464</span><br><span class="line">6465</span><br><span class="line">6466</span><br><span class="line">6467</span><br><span class="line">6468</span><br><span class="line">6469</span><br><span class="line">6470</span><br><span class="line">6471</span><br><span class="line">6472</span><br><span class="line">6473</span><br><span class="line">6474</span><br><span class="line">6475</span><br><span class="line">6476</span><br><span class="line">6477</span><br><span class="line">6478</span><br><span class="line">6479</span><br><span class="line">6480</span><br><span class="line">6481</span><br><span class="line">6482</span><br><span class="line">6483</span><br><span class="line">6484</span><br><span class="line">6485</span><br><span class="line">6486</span><br><span class="line">6487</span><br><span class="line">6488</span><br><span class="line">6489</span><br><span class="line">6490</span><br><span class="line">6491</span><br><span class="line">6492</span><br><span class="line">6493</span><br><span class="line">6494</span><br><span class="line">6495</span><br><span class="line">6496</span><br><span class="line">6497</span><br><span class="line">6498</span><br><span class="line">6499</span><br><span class="line">6500</span><br><span class="line">6501</span><br><span class="line">6502</span><br><span class="line">6503</span><br><span class="line">6504</span><br><span class="line">6505</span><br><span class="line">6506</span><br><span class="line">6507</span><br><span class="line">6508</span><br><span class="line">6509</span><br><span class="line">6510</span><br><span class="line">6511</span><br><span class="line">6512</span><br><span class="line">6513</span><br><span class="line">6514</span><br><span class="line">6515</span><br><span class="line">6516</span><br><span class="line">6517</span><br><span class="line">6518</span><br><span class="line">6519</span><br><span class="line">6520</span><br><span class="line">6521</span><br><span class="line">6522</span><br><span class="line">6523</span><br><span class="line">6524</span><br><span class="line">6525</span><br><span class="line">6526</span><br><span class="line">6527</span><br><span class="line">6528</span><br><span class="line">6529</span><br><span class="line">6530</span><br><span class="line">6531</span><br><span class="line">6532</span><br><span class="line">6533</span><br><span class="line">6534</span><br><span class="line">6535</span><br><span class="line">6536</span><br><span class="line">6537</span><br><span class="line">6538</span><br><span class="line">6539</span><br><span class="line">6540</span><br><span class="line">6541</span><br><span class="line">6542</span><br><span class="line">6543</span><br><span class="line">6544</span><br><span class="line">6545</span><br><span class="line">6546</span><br><span class="line">6547</span><br><span class="line">6548</span><br><span class="line">6549</span><br><span class="line">6550</span><br><span class="line">6551</span><br><span class="line">6552</span><br><span class="line">6553</span><br><span class="line">6554</span><br><span class="line">6555</span><br><span class="line">6556</span><br><span class="line">6557</span><br><span class="line">6558</span><br><span class="line">6559</span><br><span class="line">6560</span><br><span class="line">6561</span><br><span class="line">6562</span><br><span class="line">6563</span><br><span class="line">6564</span><br><span class="line">6565</span><br><span class="line">6566</span><br><span class="line">6567</span><br><span class="line">6568</span><br><span class="line">6569</span><br><span class="line">6570</span><br><span class="line">6571</span><br><span class="line">6572</span><br><span class="line">6573</span><br><span class="line">6574</span><br><span class="line">6575</span><br><span class="line">6576</span><br><span class="line">6577</span><br><span class="line">6578</span><br><span class="line">6579</span><br><span class="line">6580</span><br><span class="line">6581</span><br><span class="line">6582</span><br><span class="line">6583</span><br><span class="line">6584</span><br><span class="line">6585</span><br><span class="line">6586</span><br><span class="line">6587</span><br><span class="line">6588</span><br><span class="line">6589</span><br><span class="line">6590</span><br><span class="line">6591</span><br><span class="line">6592</span><br><span class="line">6593</span><br><span class="line">6594</span><br><span class="line">6595</span><br><span class="line">6596</span><br><span class="line">6597</span><br><span class="line">6598</span><br><span class="line">6599</span><br><span class="line">6600</span><br><span class="line">6601</span><br><span class="line">6602</span><br><span class="line">6603</span><br><span class="line">6604</span><br><span class="line">6605</span><br><span class="line">6606</span><br><span class="line">6607</span><br><span class="line">6608</span><br><span class="line">6609</span><br><span class="line">6610</span><br><span class="line">6611</span><br><span class="line">6612</span><br><span class="line">6613</span><br><span class="line">6614</span><br><span class="line">6615</span><br><span class="line">6616</span><br><span class="line">6617</span><br><span class="line">6618</span><br><span class="line">6619</span><br><span class="line">6620</span><br><span class="line">6621</span><br><span class="line">6622</span><br><span class="line">6623</span><br><span class="line">6624</span><br><span class="line">6625</span><br><span class="line">6626</span><br><span class="line">6627</span><br><span class="line">6628</span><br><span class="line">6629</span><br><span class="line">6630</span><br><span class="line">6631</span><br><span class="line">6632</span><br><span class="line">6633</span><br><span class="line">6634</span><br><span class="line">6635</span><br><span class="line">6636</span><br><span class="line">6637</span><br><span class="line">6638</span><br><span class="line">6639</span><br><span class="line">6640</span><br><span class="line">6641</span><br><span class="line">6642</span><br><span class="line">6643</span><br><span class="line">6644</span><br><span class="line">6645</span><br><span class="line">6646</span><br><span class="line">6647</span><br><span class="line">6648</span><br><span class="line">6649</span><br><span class="line">6650</span><br><span class="line">6651</span><br><span class="line">6652</span><br><span class="line">6653</span><br><span class="line">6654</span><br><span class="line">6655</span><br><span class="line">6656</span><br><span class="line">6657</span><br><span class="line">6658</span><br><span class="line">6659</span><br><span class="line">6660</span><br><span class="line">6661</span><br><span class="line">6662</span><br><span class="line">6663</span><br><span class="line">6664</span><br><span class="line">6665</span><br><span class="line">6666</span><br><span class="line">6667</span><br><span class="line">6668</span><br><span class="line">6669</span><br><span class="line">6670</span><br><span class="line">6671</span><br><span class="line">6672</span><br><span class="line">6673</span><br><span class="line">6674</span><br><span class="line">6675</span><br><span class="line">6676</span><br><span class="line">6677</span><br><span class="line">6678</span><br><span class="line">6679</span><br><span class="line">6680</span><br><span class="line">6681</span><br><span class="line">6682</span><br><span class="line">6683</span><br><span class="line">6684</span><br><span class="line">6685</span><br><span class="line">6686</span><br><span class="line">6687</span><br><span class="line">6688</span><br><span class="line">6689</span><br><span class="line">6690</span><br><span class="line">6691</span><br><span class="line">6692</span><br><span class="line">6693</span><br><span class="line">6694</span><br><span class="line">6695</span><br><span class="line">6696</span><br><span class="line">6697</span><br><span class="line">6698</span><br><span class="line">6699</span><br><span class="line">6700</span><br><span class="line">6701</span><br><span class="line">6702</span><br><span class="line">6703</span><br><span class="line">6704</span><br><span class="line">6705</span><br><span class="line">6706</span><br><span class="line">6707</span><br><span class="line">6708</span><br><span class="line">6709</span><br><span class="line">6710</span><br><span class="line">6711</span><br><span class="line">6712</span><br><span class="line">6713</span><br><span class="line">6714</span><br><span class="line">6715</span><br><span class="line">6716</span><br><span class="line">6717</span><br><span class="line">6718</span><br><span class="line">6719</span><br><span class="line">6720</span><br><span class="line">6721</span><br><span class="line">6722</span><br><span class="line">6723</span><br><span class="line">6724</span><br><span class="line">6725</span><br><span class="line">6726</span><br><span class="line">6727</span><br><span class="line">6728</span><br><span class="line">6729</span><br><span class="line">6730</span><br><span class="line">6731</span><br><span class="line">6732</span><br><span class="line">6733</span><br><span class="line">6734</span><br><span class="line">6735</span><br><span class="line">6736</span><br><span class="line">6737</span><br><span class="line">6738</span><br><span class="line">6739</span><br><span class="line">6740</span><br><span class="line">6741</span><br><span class="line">6742</span><br><span class="line">6743</span><br><span class="line">6744</span><br><span class="line">6745</span><br><span class="line">6746</span><br><span class="line">6747</span><br><span class="line">6748</span><br><span class="line">6749</span><br><span class="line">6750</span><br><span class="line">6751</span><br><span class="line">6752</span><br><span class="line">6753</span><br><span class="line">6754</span><br><span class="line">6755</span><br><span class="line">6756</span><br><span class="line">6757</span><br><span class="line">6758</span><br><span class="line">6759</span><br><span class="line">6760</span><br><span class="line">6761</span><br><span class="line">6762</span><br><span class="line">6763</span><br><span class="line">6764</span><br><span class="line">6765</span><br><span class="line">6766</span><br><span class="line">6767</span><br><span class="line">6768</span><br><span class="line">6769</span><br><span class="line">6770</span><br><span class="line">6771</span><br><span class="line">6772</span><br><span class="line">6773</span><br><span class="line">6774</span><br><span class="line">6775</span><br><span class="line">6776</span><br><span class="line">6777</span><br><span class="line">6778</span><br><span class="line">6779</span><br><span class="line">6780</span><br><span class="line">6781</span><br><span class="line">6782</span><br><span class="line">6783</span><br><span class="line">6784</span><br><span class="line">6785</span><br><span class="line">6786</span><br><span class="line">6787</span><br><span class="line">6788</span><br><span class="line">6789</span><br><span class="line">6790</span><br><span class="line">6791</span><br><span class="line">6792</span><br><span class="line">6793</span><br><span class="line">6794</span><br><span class="line">6795</span><br><span class="line">6796</span><br><span class="line">6797</span><br><span class="line">6798</span><br><span class="line">6799</span><br><span class="line">6800</span><br><span class="line">6801</span><br><span class="line">6802</span><br><span class="line">6803</span><br><span class="line">6804</span><br><span class="line">6805</span><br><span class="line">6806</span><br><span class="line">6807</span><br><span class="line">6808</span><br><span class="line">6809</span><br><span class="line">6810</span><br><span class="line">6811</span><br><span class="line">6812</span><br><span class="line">6813</span><br><span class="line">6814</span><br><span class="line">6815</span><br><span class="line">6816</span><br><span class="line">6817</span><br><span class="line">6818</span><br><span class="line">6819</span><br><span class="line">6820</span><br><span class="line">6821</span><br><span class="line">6822</span><br><span class="line">6823</span><br><span class="line">6824</span><br><span class="line">6825</span><br><span class="line">6826</span><br><span class="line">6827</span><br><span class="line">6828</span><br><span class="line">6829</span><br><span class="line">6830</span><br><span class="line">6831</span><br><span class="line">6832</span><br><span class="line">6833</span><br><span class="line">6834</span><br><span class="line">6835</span><br><span class="line">6836</span><br><span class="line">6837</span><br><span class="line">6838</span><br><span class="line">6839</span><br><span class="line">6840</span><br><span class="line">6841</span><br><span class="line">6842</span><br><span class="line">6843</span><br><span class="line">6844</span><br><span class="line">6845</span><br><span class="line">6846</span><br><span class="line">6847</span><br><span class="line">6848</span><br><span class="line">6849</span><br><span class="line">6850</span><br><span class="line">6851</span><br><span class="line">6852</span><br><span class="line">6853</span><br><span class="line">6854</span><br><span class="line">6855</span><br><span class="line">6856</span><br><span class="line">6857</span><br><span class="line">6858</span><br><span class="line">6859</span><br><span class="line">6860</span><br><span class="line">6861</span><br><span class="line">6862</span><br><span class="line">6863</span><br><span class="line">6864</span><br><span class="line">6865</span><br><span class="line">6866</span><br><span class="line">6867</span><br><span class="line">6868</span><br><span class="line">6869</span><br><span class="line">6870</span><br><span class="line">6871</span><br><span class="line">6872</span><br><span class="line">6873</span><br><span class="line">6874</span><br><span class="line">6875</span><br><span class="line">6876</span><br><span class="line">6877</span><br><span class="line">6878</span><br><span class="line">6879</span><br><span class="line">6880</span><br><span class="line">6881</span><br><span class="line">6882</span><br><span class="line">6883</span><br><span class="line">6884</span><br><span class="line">6885</span><br><span class="line">6886</span><br><span class="line">6887</span><br><span class="line">6888</span><br><span class="line">6889</span><br><span class="line">6890</span><br><span class="line">6891</span><br><span class="line">6892</span><br><span class="line">6893</span><br><span class="line">6894</span><br><span class="line">6895</span><br><span class="line">6896</span><br><span class="line">6897</span><br><span class="line">6898</span><br><span class="line">6899</span><br><span class="line">6900</span><br><span class="line">6901</span><br><span class="line">6902</span><br><span class="line">6903</span><br><span class="line">6904</span><br><span class="line">6905</span><br><span class="line">6906</span><br><span class="line">6907</span><br><span class="line">6908</span><br><span class="line">6909</span><br><span class="line">6910</span><br><span class="line">6911</span><br><span class="line">6912</span><br><span class="line">6913</span><br><span class="line">6914</span><br><span class="line">6915</span><br><span class="line">6916</span><br><span class="line">6917</span><br><span class="line">6918</span><br><span class="line">6919</span><br><span class="line">6920</span><br><span class="line">6921</span><br><span class="line">6922</span><br><span class="line">6923</span><br><span class="line">6924</span><br><span class="line">6925</span><br><span class="line">6926</span><br><span class="line">6927</span><br><span class="line">6928</span><br><span class="line">6929</span><br><span class="line">6930</span><br><span class="line">6931</span><br><span class="line">6932</span><br><span class="line">6933</span><br><span class="line">6934</span><br><span class="line">6935</span><br><span class="line">6936</span><br><span class="line">6937</span><br><span class="line">6938</span><br><span class="line">6939</span><br><span class="line">6940</span><br><span class="line">6941</span><br><span class="line">6942</span><br><span class="line">6943</span><br><span class="line">6944</span><br><span class="line">6945</span><br><span class="line">6946</span><br><span class="line">6947</span><br><span class="line">6948</span><br><span class="line">6949</span><br><span class="line">6950</span><br><span class="line">6951</span><br><span class="line">6952</span><br><span class="line">6953</span><br><span class="line">6954</span><br><span class="line">6955</span><br><span class="line">6956</span><br><span class="line">6957</span><br><span class="line">6958</span><br><span class="line">6959</span><br><span class="line">6960</span><br><span class="line">6961</span><br><span class="line">6962</span><br><span class="line">6963</span><br><span class="line">6964</span><br><span class="line">6965</span><br><span class="line">6966</span><br><span class="line">6967</span><br><span class="line">6968</span><br><span class="line">6969</span><br><span class="line">6970</span><br><span class="line">6971</span><br><span class="line">6972</span><br><span class="line">6973</span><br><span class="line">6974</span><br><span class="line">6975</span><br><span class="line">6976</span><br><span class="line">6977</span><br><span class="line">6978</span><br><span class="line">6979</span><br><span class="line">6980</span><br><span class="line">6981</span><br><span class="line">6982</span><br><span class="line">6983</span><br><span class="line">6984</span><br><span class="line">6985</span><br><span class="line">6986</span><br><span class="line">6987</span><br><span class="line">6988</span><br><span class="line">6989</span><br><span class="line">6990</span><br><span class="line">6991</span><br><span class="line">6992</span><br><span class="line">6993</span><br><span class="line">6994</span><br><span class="line">6995</span><br><span class="line">6996</span><br><span class="line">6997</span><br><span class="line">6998</span><br><span class="line">6999</span><br><span class="line">7000</span><br><span class="line">7001</span><br><span class="line">7002</span><br><span class="line">7003</span><br><span class="line">7004</span><br><span class="line">7005</span><br><span class="line">7006</span><br><span class="line">7007</span><br><span class="line">7008</span><br><span class="line">7009</span><br><span class="line">7010</span><br><span class="line">7011</span><br><span class="line">7012</span><br><span class="line">7013</span><br><span class="line">7014</span><br><span class="line">7015</span><br><span class="line">7016</span><br><span class="line">7017</span><br><span class="line">7018</span><br><span class="line">7019</span><br><span class="line">7020</span><br><span class="line">7021</span><br><span class="line">7022</span><br><span class="line">7023</span><br><span class="line">7024</span><br><span class="line">7025</span><br><span class="line">7026</span><br><span class="line">7027</span><br><span class="line">7028</span><br><span class="line">7029</span><br><span class="line">7030</span><br><span class="line">7031</span><br><span class="line">7032</span><br><span class="line">7033</span><br><span class="line">7034</span><br><span class="line">7035</span><br><span class="line">7036</span><br><span class="line">7037</span><br><span class="line">7038</span><br><span class="line">7039</span><br><span class="line">7040</span><br><span class="line">7041</span><br><span class="line">7042</span><br><span class="line">7043</span><br><span class="line">7044</span><br><span class="line">7045</span><br><span class="line">7046</span><br><span class="line">7047</span><br><span class="line">7048</span><br><span class="line">7049</span><br><span class="line">7050</span><br><span class="line">7051</span><br><span class="line">7052</span><br><span class="line">7053</span><br><span class="line">7054</span><br><span class="line">7055</span><br><span class="line">7056</span><br><span class="line">7057</span><br><span class="line">7058</span><br><span class="line">7059</span><br><span class="line">7060</span><br><span class="line">7061</span><br><span class="line">7062</span><br><span class="line">7063</span><br><span class="line">7064</span><br><span class="line">7065</span><br><span class="line">7066</span><br><span class="line">7067</span><br><span class="line">7068</span><br><span class="line">7069</span><br><span class="line">7070</span><br><span class="line">7071</span><br><span class="line">7072</span><br><span class="line">7073</span><br><span class="line">7074</span><br><span class="line">7075</span><br><span class="line">7076</span><br><span class="line">7077</span><br><span class="line">7078</span><br><span class="line">7079</span><br><span class="line">7080</span><br><span class="line">7081</span><br><span class="line">7082</span><br><span class="line">7083</span><br><span class="line">7084</span><br><span class="line">7085</span><br><span class="line">7086</span><br><span class="line">7087</span><br><span class="line">7088</span><br><span class="line">7089</span><br><span class="line">7090</span><br><span class="line">7091</span><br><span class="line">7092</span><br><span class="line">7093</span><br><span class="line">7094</span><br><span class="line">7095</span><br><span class="line">7096</span><br><span class="line">7097</span><br><span class="line">7098</span><br><span class="line">7099</span><br><span class="line">7100</span><br><span class="line">7101</span><br><span class="line">7102</span><br><span class="line">7103</span><br><span class="line">7104</span><br><span class="line">7105</span><br><span class="line">7106</span><br><span class="line">7107</span><br><span class="line">7108</span><br><span class="line">7109</span><br><span class="line">7110</span><br><span class="line">7111</span><br><span class="line">7112</span><br><span class="line">7113</span><br><span class="line">7114</span><br><span class="line">7115</span><br><span class="line">7116</span><br><span class="line">7117</span><br><span class="line">7118</span><br><span class="line">7119</span><br><span class="line">7120</span><br><span class="line">7121</span><br><span class="line">7122</span><br><span class="line">7123</span><br><span class="line">7124</span><br><span class="line">7125</span><br><span class="line">7126</span><br><span class="line">7127</span><br><span class="line">7128</span><br><span class="line">7129</span><br><span class="line">7130</span><br><span class="line">7131</span><br><span class="line">7132</span><br><span class="line">7133</span><br><span class="line">7134</span><br><span class="line">7135</span><br><span class="line">7136</span><br><span class="line">7137</span><br><span class="line">7138</span><br><span class="line">7139</span><br><span class="line">7140</span><br><span class="line">7141</span><br><span class="line">7142</span><br><span class="line">7143</span><br><span class="line">7144</span><br><span class="line">7145</span><br><span class="line">7146</span><br><span class="line">7147</span><br><span class="line">7148</span><br><span class="line">7149</span><br><span class="line">7150</span><br><span class="line">7151</span><br><span class="line">7152</span><br><span class="line">7153</span><br><span class="line">7154</span><br><span class="line">7155</span><br><span class="line">7156</span><br><span class="line">7157</span><br><span class="line">7158</span><br><span class="line">7159</span><br><span class="line">7160</span><br><span class="line">7161</span><br><span class="line">7162</span><br><span class="line">7163</span><br><span class="line">7164</span><br><span class="line">7165</span><br><span class="line">7166</span><br><span class="line">7167</span><br><span class="line">7168</span><br><span class="line">7169</span><br><span class="line">7170</span><br><span class="line">7171</span><br><span class="line">7172</span><br><span class="line">7173</span><br><span class="line">7174</span><br><span class="line">7175</span><br><span class="line">7176</span><br><span class="line">7177</span><br><span class="line">7178</span><br><span class="line">7179</span><br><span class="line">7180</span><br><span class="line">7181</span><br><span class="line">7182</span><br><span class="line">7183</span><br><span class="line">7184</span><br><span class="line">7185</span><br><span class="line">7186</span><br><span class="line">7187</span><br><span class="line">7188</span><br><span class="line">7189</span><br><span class="line">7190</span><br><span class="line">7191</span><br><span class="line">7192</span><br><span class="line">7193</span><br><span class="line">7194</span><br><span class="line">7195</span><br><span class="line">7196</span><br><span class="line">7197</span><br><span class="line">7198</span><br><span class="line">7199</span><br><span class="line">7200</span><br><span class="line">7201</span><br><span class="line">7202</span><br><span class="line">7203</span><br><span class="line">7204</span><br><span class="line">7205</span><br><span class="line">7206</span><br><span class="line">7207</span><br><span class="line">7208</span><br><span class="line">7209</span><br><span class="line">7210</span><br><span class="line">7211</span><br><span class="line">7212</span><br><span class="line">7213</span><br><span class="line">7214</span><br><span class="line">7215</span><br><span class="line">7216</span><br><span class="line">7217</span><br><span class="line">7218</span><br><span class="line">7219</span><br><span class="line">7220</span><br><span class="line">7221</span><br><span class="line">7222</span><br><span class="line">7223</span><br><span class="line">7224</span><br><span class="line">7225</span><br><span class="line">7226</span><br><span class="line">7227</span><br><span class="line">7228</span><br><span class="line">7229</span><br><span class="line">7230</span><br><span class="line">7231</span><br><span class="line">7232</span><br><span class="line">7233</span><br><span class="line">7234</span><br><span class="line">7235</span><br><span class="line">7236</span><br><span class="line">7237</span><br><span class="line">7238</span><br><span class="line">7239</span><br><span class="line">7240</span><br><span class="line">7241</span><br><span class="line">7242</span><br><span class="line">7243</span><br><span class="line">7244</span><br><span class="line">7245</span><br><span class="line">7246</span><br><span class="line">7247</span><br><span class="line">7248</span><br><span class="line">7249</span><br><span class="line">7250</span><br><span class="line">7251</span><br><span class="line">7252</span><br><span class="line">7253</span><br><span class="line">7254</span><br><span class="line">7255</span><br><span class="line">7256</span><br><span class="line">7257</span><br><span class="line">7258</span><br><span class="line">7259</span><br><span class="line">7260</span><br><span class="line">7261</span><br><span class="line">7262</span><br><span class="line">7263</span><br><span class="line">7264</span><br><span class="line">7265</span><br><span class="line">7266</span><br><span class="line">7267</span><br><span class="line">7268</span><br><span class="line">7269</span><br><span class="line">7270</span><br><span class="line">7271</span><br><span class="line">7272</span><br><span class="line">7273</span><br><span class="line">7274</span><br><span class="line">7275</span><br><span class="line">7276</span><br><span class="line">7277</span><br><span class="line">7278</span><br><span class="line">7279</span><br><span class="line">7280</span><br><span class="line">7281</span><br><span class="line">7282</span><br><span class="line">7283</span><br><span class="line">7284</span><br><span class="line">7285</span><br><span class="line">7286</span><br><span class="line">7287</span><br><span class="line">7288</span><br><span class="line">7289</span><br><span class="line">7290</span><br><span class="line">7291</span><br><span class="line">7292</span><br><span class="line">7293</span><br><span class="line">7294</span><br><span class="line">7295</span><br><span class="line">7296</span><br><span class="line">7297</span><br><span class="line">7298</span><br><span class="line">7299</span><br><span class="line">7300</span><br><span class="line">7301</span><br><span class="line">7302</span><br><span class="line">7303</span><br><span class="line">7304</span><br><span class="line">7305</span><br><span class="line">7306</span><br><span class="line">7307</span><br><span class="line">7308</span><br><span class="line">7309</span><br><span class="line">7310</span><br><span class="line">7311</span><br><span class="line">7312</span><br><span class="line">7313</span><br><span class="line">7314</span><br><span class="line">7315</span><br><span class="line">7316</span><br><span class="line">7317</span><br><span class="line">7318</span><br><span class="line">7319</span><br><span class="line">7320</span><br><span class="line">7321</span><br><span class="line">7322</span><br><span class="line">7323</span><br><span class="line">7324</span><br><span class="line">7325</span><br><span class="line">7326</span><br><span class="line">7327</span><br><span class="line">7328</span><br><span class="line">7329</span><br><span class="line">7330</span><br><span class="line">7331</span><br><span class="line">7332</span><br><span class="line">7333</span><br><span class="line">7334</span><br><span class="line">7335</span><br><span class="line">7336</span><br><span class="line">7337</span><br><span class="line">7338</span><br><span class="line">7339</span><br><span class="line">7340</span><br><span class="line">7341</span><br><span class="line">7342</span><br><span class="line">7343</span><br><span class="line">7344</span><br><span class="line">7345</span><br><span class="line">7346</span><br><span class="line">7347</span><br><span class="line">7348</span><br><span class="line">7349</span><br><span class="line">7350</span><br><span class="line">7351</span><br><span class="line">7352</span><br><span class="line">7353</span><br><span class="line">7354</span><br><span class="line">7355</span><br><span class="line">7356</span><br><span class="line">7357</span><br><span class="line">7358</span><br><span class="line">7359</span><br><span class="line">7360</span><br><span class="line">7361</span><br><span class="line">7362</span><br><span class="line">7363</span><br><span class="line">7364</span><br><span class="line">7365</span><br><span class="line">7366</span><br><span class="line">7367</span><br><span class="line">7368</span><br><span class="line">7369</span><br><span class="line">7370</span><br><span class="line">7371</span><br><span class="line">7372</span><br><span class="line">7373</span><br><span class="line">7374</span><br><span class="line">7375</span><br><span class="line">7376</span><br><span class="line">7377</span><br><span class="line">7378</span><br><span class="line">7379</span><br><span class="line">7380</span><br><span class="line">7381</span><br><span class="line">7382</span><br><span class="line">7383</span><br><span class="line">7384</span><br><span class="line">7385</span><br><span class="line">7386</span><br><span class="line">7387</span><br><span class="line">7388</span><br><span class="line">7389</span><br><span class="line">7390</span><br><span class="line">7391</span><br><span class="line">7392</span><br><span class="line">7393</span><br><span class="line">7394</span><br><span class="line">7395</span><br><span class="line">7396</span><br><span class="line">7397</span><br><span class="line">7398</span><br><span class="line">7399</span><br><span class="line">7400</span><br><span class="line">7401</span><br><span class="line">7402</span><br><span class="line">7403</span><br><span class="line">7404</span><br><span class="line">7405</span><br><span class="line">7406</span><br><span class="line">7407</span><br><span class="line">7408</span><br><span class="line">7409</span><br><span class="line">7410</span><br><span class="line">7411</span><br><span class="line">7412</span><br><span class="line">7413</span><br><span class="line">7414</span><br><span class="line">7415</span><br><span class="line">7416</span><br><span class="line">7417</span><br><span class="line">7418</span><br><span class="line">7419</span><br><span class="line">7420</span><br><span class="line">7421</span><br><span class="line">7422</span><br><span class="line">7423</span><br><span class="line">7424</span><br><span class="line">7425</span><br><span class="line">7426</span><br><span class="line">7427</span><br><span class="line">7428</span><br><span class="line">7429</span><br><span class="line">7430</span><br><span class="line">7431</span><br><span class="line">7432</span><br><span class="line">7433</span><br><span class="line">7434</span><br><span class="line">7435</span><br><span class="line">7436</span><br><span class="line">7437</span><br><span class="line">7438</span><br><span class="line">7439</span><br><span class="line">7440</span><br><span class="line">7441</span><br><span class="line">7442</span><br><span class="line">7443</span><br><span class="line">7444</span><br><span class="line">7445</span><br><span class="line">7446</span><br><span class="line">7447</span><br><span class="line">7448</span><br><span class="line">7449</span><br><span class="line">7450</span><br><span class="line">7451</span><br><span class="line">7452</span><br><span class="line">7453</span><br><span class="line">7454</span><br><span class="line">7455</span><br><span class="line">7456</span><br><span class="line">7457</span><br><span class="line">7458</span><br><span class="line">7459</span><br><span class="line">7460</span><br><span class="line">7461</span><br><span class="line">7462</span><br><span class="line">7463</span><br><span class="line">7464</span><br><span class="line">7465</span><br><span class="line">7466</span><br><span class="line">7467</span><br><span class="line">7468</span><br><span class="line">7469</span><br><span class="line">7470</span><br><span class="line">7471</span><br><span class="line">7472</span><br><span class="line">7473</span><br><span class="line">7474</span><br><span class="line">7475</span><br><span class="line">7476</span><br><span class="line">7477</span><br><span class="line">7478</span><br><span class="line">7479</span><br><span class="line">7480</span><br><span class="line">7481</span><br><span class="line">7482</span><br><span class="line">7483</span><br><span class="line">7484</span><br><span class="line">7485</span><br><span class="line">7486</span><br><span class="line">7487</span><br><span class="line">7488</span><br><span class="line">7489</span><br><span class="line">7490</span><br><span class="line">7491</span><br><span class="line">7492</span><br><span class="line">7493</span><br><span class="line">7494</span><br><span class="line">7495</span><br><span class="line">7496</span><br><span class="line">7497</span><br><span class="line">7498</span><br><span class="line">7499</span><br><span class="line">7500</span><br><span class="line">7501</span><br><span class="line">7502</span><br><span class="line">7503</span><br><span class="line">7504</span><br><span class="line">7505</span><br><span class="line">7506</span><br><span class="line">7507</span><br><span class="line">7508</span><br><span class="line">7509</span><br><span class="line">7510</span><br><span class="line">7511</span><br><span class="line">7512</span><br><span class="line">7513</span><br><span class="line">7514</span><br><span class="line">7515</span><br><span class="line">7516</span><br><span class="line">7517</span><br><span class="line">7518</span><br><span class="line">7519</span><br><span class="line">7520</span><br><span class="line">7521</span><br><span class="line">7522</span><br><span class="line">7523</span><br><span class="line">7524</span><br><span class="line">7525</span><br><span class="line">7526</span><br><span class="line">7527</span><br><span class="line">7528</span><br><span class="line">7529</span><br><span class="line">7530</span><br><span class="line">7531</span><br><span class="line">7532</span><br><span class="line">7533</span><br><span class="line">7534</span><br><span class="line">7535</span><br><span class="line">7536</span><br><span class="line">7537</span><br><span class="line">7538</span><br><span class="line">7539</span><br><span class="line">7540</span><br><span class="line">7541</span><br><span class="line">7542</span><br><span class="line">7543</span><br><span class="line">7544</span><br><span class="line">7545</span><br><span class="line">7546</span><br><span class="line">7547</span><br><span class="line">7548</span><br><span class="line">7549</span><br><span class="line">7550</span><br><span class="line">7551</span><br><span class="line">7552</span><br><span class="line">7553</span><br><span class="line">7554</span><br><span class="line">7555</span><br><span class="line">7556</span><br><span class="line">7557</span><br><span class="line">7558</span><br><span class="line">7559</span><br><span class="line">7560</span><br><span class="line">7561</span><br><span class="line">7562</span><br><span class="line">7563</span><br><span class="line">7564</span><br><span class="line">7565</span><br><span class="line">7566</span><br><span class="line">7567</span><br><span class="line">7568</span><br><span class="line">7569</span><br><span class="line">7570</span><br><span class="line">7571</span><br><span class="line">7572</span><br><span class="line">7573</span><br><span class="line">7574</span><br><span class="line">7575</span><br><span class="line">7576</span><br><span class="line">7577</span><br><span class="line">7578</span><br><span class="line">7579</span><br><span class="line">7580</span><br><span class="line">7581</span><br><span class="line">7582</span><br><span class="line">7583</span><br><span class="line">7584</span><br><span class="line">7585</span><br><span class="line">7586</span><br><span class="line">7587</span><br><span class="line">7588</span><br><span class="line">7589</span><br><span class="line">7590</span><br><span class="line">7591</span><br><span class="line">7592</span><br><span class="line">7593</span><br><span class="line">7594</span><br><span class="line">7595</span><br><span class="line">7596</span><br><span class="line">7597</span><br><span class="line">7598</span><br><span class="line">7599</span><br><span class="line">7600</span><br><span class="line">7601</span><br><span class="line">7602</span><br><span class="line">7603</span><br><span class="line">7604</span><br><span class="line">7605</span><br><span class="line">7606</span><br><span class="line">7607</span><br><span class="line">7608</span><br><span class="line">7609</span><br><span class="line">7610</span><br><span class="line">7611</span><br><span class="line">7612</span><br><span class="line">7613</span><br><span class="line">7614</span><br><span class="line">7615</span><br><span class="line">7616</span><br><span class="line">7617</span><br><span class="line">7618</span><br><span class="line">7619</span><br><span class="line">7620</span><br><span class="line">7621</span><br><span class="line">7622</span><br><span class="line">7623</span><br><span class="line">7624</span><br><span class="line">7625</span><br><span class="line">7626</span><br><span class="line">7627</span><br><span class="line">7628</span><br><span class="line">7629</span><br><span class="line">7630</span><br><span class="line">7631</span><br><span class="line">7632</span><br><span class="line">7633</span><br><span class="line">7634</span><br><span class="line">7635</span><br><span class="line">7636</span><br><span class="line">7637</span><br><span class="line">7638</span><br><span class="line">7639</span><br><span class="line">7640</span><br><span class="line">7641</span><br><span class="line">7642</span><br><span class="line">7643</span><br><span class="line">7644</span><br><span class="line">7645</span><br><span class="line">7646</span><br><span class="line">7647</span><br><span class="line">7648</span><br><span class="line">7649</span><br><span class="line">7650</span><br><span class="line">7651</span><br><span class="line">7652</span><br><span class="line">7653</span><br><span class="line">7654</span><br><span class="line">7655</span><br><span class="line">7656</span><br><span class="line">7657</span><br><span class="line">7658</span><br><span class="line">7659</span><br><span class="line">7660</span><br><span class="line">7661</span><br><span class="line">7662</span><br><span class="line">7663</span><br><span class="line">7664</span><br><span class="line">7665</span><br><span class="line">7666</span><br><span class="line">7667</span><br><span class="line">7668</span><br><span class="line">7669</span><br><span class="line">7670</span><br><span class="line">7671</span><br><span class="line">7672</span><br><span class="line">7673</span><br><span class="line">7674</span><br><span class="line">7675</span><br><span class="line">7676</span><br><span class="line">7677</span><br><span class="line">7678</span><br><span class="line">7679</span><br><span class="line">7680</span><br><span class="line">7681</span><br><span class="line">7682</span><br><span class="line">7683</span><br><span class="line">7684</span><br><span class="line">7685</span><br><span class="line">7686</span><br><span class="line">7687</span><br><span class="line">7688</span><br><span class="line">7689</span><br><span class="line">7690</span><br><span class="line">7691</span><br><span class="line">7692</span><br><span class="line">7693</span><br><span class="line">7694</span><br><span class="line">7695</span><br><span class="line">7696</span><br><span class="line">7697</span><br><span class="line">7698</span><br><span class="line">7699</span><br><span class="line">7700</span><br><span class="line">7701</span><br><span class="line">7702</span><br><span class="line">7703</span><br><span class="line">7704</span><br><span class="line">7705</span><br><span class="line">7706</span><br><span class="line">7707</span><br><span class="line">7708</span><br><span class="line">7709</span><br><span class="line">7710</span><br><span class="line">7711</span><br><span class="line">7712</span><br><span class="line">7713</span><br><span class="line">7714</span><br><span class="line">7715</span><br><span class="line">7716</span><br><span class="line">7717</span><br><span class="line">7718</span><br><span class="line">7719</span><br><span class="line">7720</span><br><span class="line">7721</span><br><span class="line">7722</span><br><span class="line">7723</span><br><span class="line">7724</span><br><span class="line">7725</span><br><span class="line">7726</span><br><span class="line">7727</span><br><span class="line">7728</span><br><span class="line">7729</span><br><span class="line">7730</span><br><span class="line">7731</span><br><span class="line">7732</span><br><span class="line">7733</span><br><span class="line">7734</span><br><span class="line">7735</span><br><span class="line">7736</span><br><span class="line">7737</span><br><span class="line">7738</span><br><span class="line">7739</span><br><span class="line">7740</span><br><span class="line">7741</span><br><span class="line">7742</span><br><span class="line">7743</span><br><span class="line">7744</span><br><span class="line">7745</span><br><span class="line">7746</span><br><span class="line">7747</span><br><span class="line">7748</span><br><span class="line">7749</span><br><span class="line">7750</span><br><span class="line">7751</span><br><span class="line">7752</span><br><span class="line">7753</span><br><span class="line">7754</span><br><span class="line">7755</span><br><span class="line">7756</span><br><span class="line">7757</span><br><span class="line">7758</span><br><span class="line">7759</span><br><span class="line">7760</span><br><span class="line">7761</span><br><span class="line">7762</span><br><span class="line">7763</span><br><span class="line">7764</span><br><span class="line">7765</span><br><span class="line">7766</span><br><span class="line">7767</span><br><span class="line">7768</span><br><span class="line">7769</span><br><span class="line">7770</span><br><span class="line">7771</span><br><span class="line">7772</span><br><span class="line">7773</span><br><span class="line">7774</span><br><span class="line">7775</span><br><span class="line">7776</span><br><span class="line">7777</span><br><span class="line">7778</span><br><span class="line">7779</span><br><span class="line">7780</span><br><span class="line">7781</span><br><span class="line">7782</span><br><span class="line">7783</span><br><span class="line">7784</span><br><span class="line">7785</span><br><span class="line">7786</span><br><span class="line">7787</span><br><span class="line">7788</span><br><span class="line">7789</span><br><span class="line">7790</span><br><span class="line">7791</span><br><span class="line">7792</span><br><span class="line">7793</span><br><span class="line">7794</span><br><span class="line">7795</span><br><span class="line">7796</span><br><span class="line">7797</span><br><span class="line">7798</span><br><span class="line">7799</span><br><span class="line">7800</span><br><span class="line">7801</span><br><span class="line">7802</span><br><span class="line">7803</span><br><span class="line">7804</span><br><span class="line">7805</span><br><span class="line">7806</span><br><span class="line">7807</span><br><span class="line">7808</span><br><span class="line">7809</span><br><span class="line">7810</span><br><span class="line">7811</span><br><span class="line">7812</span><br><span class="line">7813</span><br><span class="line">7814</span><br><span class="line">7815</span><br><span class="line">7816</span><br><span class="line">7817</span><br><span class="line">7818</span><br><span class="line">7819</span><br><span class="line">7820</span><br><span class="line">7821</span><br><span class="line">7822</span><br><span class="line">7823</span><br><span class="line">7824</span><br><span class="line">7825</span><br><span class="line">7826</span><br><span class="line">7827</span><br><span class="line">7828</span><br><span class="line">7829</span><br><span class="line">7830</span><br><span class="line">7831</span><br><span class="line">7832</span><br><span class="line">7833</span><br><span class="line">7834</span><br><span class="line">7835</span><br><span class="line">7836</span><br><span class="line">7837</span><br><span class="line">7838</span><br><span class="line">7839</span><br><span class="line">7840</span><br><span class="line">7841</span><br><span class="line">7842</span><br><span class="line">7843</span><br><span class="line">7844</span><br><span class="line">7845</span><br><span class="line">7846</span><br><span class="line">7847</span><br><span class="line">7848</span><br><span class="line">7849</span><br><span class="line">7850</span><br><span class="line">7851</span><br><span class="line">7852</span><br><span class="line">7853</span><br><span class="line">7854</span><br><span class="line">7855</span><br><span class="line">7856</span><br><span class="line">7857</span><br><span class="line">7858</span><br><span class="line">7859</span><br><span class="line">7860</span><br><span class="line">7861</span><br><span class="line">7862</span><br><span class="line">7863</span><br><span class="line">7864</span><br><span class="line">7865</span><br><span class="line">7866</span><br><span class="line">7867</span><br><span class="line">7868</span><br><span class="line">7869</span><br><span class="line">7870</span><br><span class="line">7871</span><br><span class="line">7872</span><br><span class="line">7873</span><br><span class="line">7874</span><br><span class="line">7875</span><br><span class="line">7876</span><br><span class="line">7877</span><br><span class="line">7878</span><br><span class="line">7879</span><br><span class="line">7880</span><br><span class="line">7881</span><br><span class="line">7882</span><br><span class="line">7883</span><br><span class="line">7884</span><br><span class="line">7885</span><br><span class="line">7886</span><br><span class="line">7887</span><br><span class="line">7888</span><br><span class="line">7889</span><br><span class="line">7890</span><br><span class="line">7891</span><br><span class="line">7892</span><br><span class="line">7893</span><br><span class="line">7894</span><br><span class="line">7895</span><br><span class="line">7896</span><br><span class="line">7897</span><br><span class="line">7898</span><br><span class="line">7899</span><br><span class="line">7900</span><br><span class="line">7901</span><br><span class="line">7902</span><br><span class="line">7903</span><br><span class="line">7904</span><br><span class="line">7905</span><br><span class="line">7906</span><br><span class="line">7907</span><br><span class="line">7908</span><br><span class="line">7909</span><br><span class="line">7910</span><br><span class="line">7911</span><br><span class="line">7912</span><br><span class="line">7913</span><br><span class="line">7914</span><br><span class="line">7915</span><br><span class="line">7916</span><br><span class="line">7917</span><br><span class="line">7918</span><br><span class="line">7919</span><br><span class="line">7920</span><br><span class="line">7921</span><br><span class="line">7922</span><br><span class="line">7923</span><br><span class="line">7924</span><br><span class="line">7925</span><br><span class="line">7926</span><br><span class="line">7927</span><br><span class="line">7928</span><br><span class="line">7929</span><br><span class="line">7930</span><br><span class="line">7931</span><br><span class="line">7932</span><br><span class="line">7933</span><br><span class="line">7934</span><br><span class="line">7935</span><br><span class="line">7936</span><br><span class="line">7937</span><br><span class="line">7938</span><br><span class="line">7939</span><br><span class="line">7940</span><br><span class="line">7941</span><br><span class="line">7942</span><br><span class="line">7943</span><br><span class="line">7944</span><br><span class="line">7945</span><br><span class="line">7946</span><br><span class="line">7947</span><br><span class="line">7948</span><br><span class="line">7949</span><br><span class="line">7950</span><br><span class="line">7951</span><br><span class="line">7952</span><br><span class="line">7953</span><br><span class="line">7954</span><br><span class="line">7955</span><br><span class="line">7956</span><br><span class="line">7957</span><br><span class="line">7958</span><br><span class="line">7959</span><br><span class="line">7960</span><br><span class="line">7961</span><br><span class="line">7962</span><br><span class="line">7963</span><br><span class="line">7964</span><br><span class="line">7965</span><br><span class="line">7966</span><br><span class="line">7967</span><br><span class="line">7968</span><br><span class="line">7969</span><br><span class="line">7970</span><br><span class="line">7971</span><br><span class="line">7972</span><br><span class="line">7973</span><br><span class="line">7974</span><br><span class="line">7975</span><br><span class="line">7976</span><br><span class="line">7977</span><br><span class="line">7978</span><br><span class="line">7979</span><br><span class="line">7980</span><br><span class="line">7981</span><br><span class="line">7982</span><br><span class="line">7983</span><br><span class="line">7984</span><br><span class="line">7985</span><br><span class="line">7986</span><br><span class="line">7987</span><br><span class="line">7988</span><br><span class="line">7989</span><br><span class="line">7990</span><br><span class="line">7991</span><br><span class="line">7992</span><br><span class="line">7993</span><br><span class="line">7994</span><br><span class="line">7995</span><br><span class="line">7996</span><br><span class="line">7997</span><br><span class="line">7998</span><br><span class="line">7999</span><br><span class="line">8000</span><br><span class="line">8001</span><br><span class="line">8002</span><br><span class="line">8003</span><br><span class="line">8004</span><br><span class="line">8005</span><br><span class="line">8006</span><br><span class="line">8007</span><br><span class="line">8008</span><br><span class="line">8009</span><br><span class="line">8010</span><br><span class="line">8011</span><br><span class="line">8012</span><br><span class="line">8013</span><br><span class="line">8014</span><br><span class="line">8015</span><br><span class="line">8016</span><br><span class="line">8017</span><br><span class="line">8018</span><br><span class="line">8019</span><br><span class="line">8020</span><br><span class="line">8021</span><br><span class="line">8022</span><br><span class="line">8023</span><br><span class="line">8024</span><br><span class="line">8025</span><br><span class="line">8026</span><br><span class="line">8027</span><br><span class="line">8028</span><br><span class="line">8029</span><br><span class="line">8030</span><br><span class="line">8031</span><br><span class="line">8032</span><br><span class="line">8033</span><br><span class="line">8034</span><br><span class="line">8035</span><br><span class="line">8036</span><br><span class="line">8037</span><br><span class="line">8038</span><br><span class="line">8039</span><br><span class="line">8040</span><br><span class="line">8041</span><br><span class="line">8042</span><br><span class="line">8043</span><br><span class="line">8044</span><br><span class="line">8045</span><br><span class="line">8046</span><br><span class="line">8047</span><br><span class="line">8048</span><br><span class="line">8049</span><br><span class="line">8050</span><br><span class="line">8051</span><br><span class="line">8052</span><br><span class="line">8053</span><br><span class="line">8054</span><br><span class="line">8055</span><br><span class="line">8056</span><br><span class="line">8057</span><br><span class="line">8058</span><br><span class="line">8059</span><br><span class="line">8060</span><br><span class="line">8061</span><br><span class="line">8062</span><br><span class="line">8063</span><br><span class="line">8064</span><br><span class="line">8065</span><br><span class="line">8066</span><br><span class="line">8067</span><br><span class="line">8068</span><br><span class="line">8069</span><br><span class="line">8070</span><br><span class="line">8071</span><br><span class="line">8072</span><br><span class="line">8073</span><br><span class="line">8074</span><br><span class="line">8075</span><br><span class="line">8076</span><br><span class="line">8077</span><br><span class="line">8078</span><br><span class="line">8079</span><br><span class="line">8080</span><br><span class="line">8081</span><br><span class="line">8082</span><br><span class="line">8083</span><br><span class="line">8084</span><br><span class="line">8085</span><br><span class="line">8086</span><br><span class="line">8087</span><br><span class="line">8088</span><br><span class="line">8089</span><br><span class="line">8090</span><br><span class="line">8091</span><br><span class="line">8092</span><br><span class="line">8093</span><br><span class="line">8094</span><br><span class="line">8095</span><br><span class="line">8096</span><br><span class="line">8097</span><br><span class="line">8098</span><br><span class="line">8099</span><br><span class="line">8100</span><br><span class="line">8101</span><br><span class="line">8102</span><br><span class="line">8103</span><br><span class="line">8104</span><br><span class="line">8105</span><br><span class="line">8106</span><br><span class="line">8107</span><br><span class="line">8108</span><br><span class="line">8109</span><br><span class="line">8110</span><br><span class="line">8111</span><br><span class="line">8112</span><br><span class="line">8113</span><br><span class="line">8114</span><br><span class="line">8115</span><br><span class="line">8116</span><br><span class="line">8117</span><br><span class="line">8118</span><br><span class="line">8119</span><br><span class="line">8120</span><br><span class="line">8121</span><br><span class="line">8122</span><br><span class="line">8123</span><br><span class="line">8124</span><br><span class="line">8125</span><br><span class="line">8126</span><br><span class="line">8127</span><br><span class="line">8128</span><br><span class="line">8129</span><br><span class="line">8130</span><br><span class="line">8131</span><br><span class="line">8132</span><br><span class="line">8133</span><br><span class="line">8134</span><br><span class="line">8135</span><br><span class="line">8136</span><br><span class="line">8137</span><br><span class="line">8138</span><br><span class="line">8139</span><br><span class="line">8140</span><br><span class="line">8141</span><br><span class="line">8142</span><br><span class="line">8143</span><br><span class="line">8144</span><br><span class="line">8145</span><br><span class="line">8146</span><br><span class="line">8147</span><br><span class="line">8148</span><br><span class="line">8149</span><br><span class="line">8150</span><br><span class="line">8151</span><br><span class="line">8152</span><br><span class="line">8153</span><br><span class="line">8154</span><br><span class="line">8155</span><br><span class="line">8156</span><br><span class="line">8157</span><br><span class="line">8158</span><br><span class="line">8159</span><br><span class="line">8160</span><br><span class="line">8161</span><br><span class="line">8162</span><br><span class="line">8163</span><br><span class="line">8164</span><br><span class="line">8165</span><br><span class="line">8166</span><br><span class="line">8167</span><br><span class="line">8168</span><br><span class="line">8169</span><br><span class="line">8170</span><br><span class="line">8171</span><br><span class="line">8172</span><br><span class="line">8173</span><br><span class="line">8174</span><br><span class="line">8175</span><br><span class="line">8176</span><br><span class="line">8177</span><br><span class="line">8178</span><br><span class="line">8179</span><br><span class="line">8180</span><br><span class="line">8181</span><br><span class="line">8182</span><br><span class="line">8183</span><br><span class="line">8184</span><br><span class="line">8185</span><br><span class="line">8186</span><br><span class="line">8187</span><br><span class="line">8188</span><br><span class="line">8189</span><br><span class="line">8190</span><br><span class="line">8191</span><br><span class="line">8192</span><br><span class="line">8193</span><br><span class="line">8194</span><br><span class="line">8195</span><br><span class="line">8196</span><br><span class="line">8197</span><br><span class="line">8198</span><br><span class="line">8199</span><br><span class="line">8200</span><br><span class="line">8201</span><br><span class="line">8202</span><br><span class="line">8203</span><br><span class="line">8204</span><br><span class="line">8205</span><br><span class="line">8206</span><br><span class="line">8207</span><br><span class="line">8208</span><br><span class="line">8209</span><br><span class="line">8210</span><br><span class="line">8211</span><br><span class="line">8212</span><br><span class="line">8213</span><br><span class="line">8214</span><br><span class="line">8215</span><br><span class="line">8216</span><br><span class="line">8217</span><br><span class="line">8218</span><br><span class="line">8219</span><br><span class="line">8220</span><br><span class="line">8221</span><br><span class="line">8222</span><br><span class="line">8223</span><br><span class="line">8224</span><br><span class="line">8225</span><br><span class="line">8226</span><br><span class="line">8227</span><br><span class="line">8228</span><br><span class="line">8229</span><br><span class="line">8230</span><br><span class="line">8231</span><br><span class="line">8232</span><br><span class="line">8233</span><br><span class="line">8234</span><br><span class="line">8235</span><br><span class="line">8236</span><br><span class="line">8237</span><br><span class="line">8238</span><br><span class="line">8239</span><br><span class="line">8240</span><br><span class="line">8241</span><br><span class="line">8242</span><br><span class="line">8243</span><br><span class="line">8244</span><br><span class="line">8245</span><br><span class="line">8246</span><br><span class="line">8247</span><br><span class="line">8248</span><br><span class="line">8249</span><br><span class="line">8250</span><br><span class="line">8251</span><br><span class="line">8252</span><br><span class="line">8253</span><br><span class="line">8254</span><br><span class="line">8255</span><br><span class="line">8256</span><br><span class="line">8257</span><br><span class="line">8258</span><br><span class="line">8259</span><br><span class="line">8260</span><br><span class="line">8261</span><br><span class="line">8262</span><br><span class="line">8263</span><br><span class="line">8264</span><br><span class="line">8265</span><br><span class="line">8266</span><br><span class="line">8267</span><br><span class="line">8268</span><br><span class="line">8269</span><br><span class="line">8270</span><br><span class="line">8271</span><br><span class="line">8272</span><br><span class="line">8273</span><br><span class="line">8274</span><br><span class="line">8275</span><br><span class="line">8276</span><br><span class="line">8277</span><br><span class="line">8278</span><br><span class="line">8279</span><br><span class="line">8280</span><br><span class="line">8281</span><br><span class="line">8282</span><br><span class="line">8283</span><br><span class="line">8284</span><br><span class="line">8285</span><br><span class="line">8286</span><br><span class="line">8287</span><br><span class="line">8288</span><br><span class="line">8289</span><br><span class="line">8290</span><br><span class="line">8291</span><br><span class="line">8292</span><br><span class="line">8293</span><br><span class="line">8294</span><br><span class="line">8295</span><br><span class="line">8296</span><br><span class="line">8297</span><br><span class="line">8298</span><br><span class="line">8299</span><br><span class="line">8300</span><br><span class="line">8301</span><br><span class="line">8302</span><br><span class="line">8303</span><br><span class="line">8304</span><br><span class="line">8305</span><br><span class="line">8306</span><br><span class="line">8307</span><br><span class="line">8308</span><br><span class="line">8309</span><br><span class="line">8310</span><br><span class="line">8311</span><br><span class="line">8312</span><br><span class="line">8313</span><br><span class="line">8314</span><br><span class="line">8315</span><br><span class="line">8316</span><br><span class="line">8317</span><br><span class="line">8318</span><br><span class="line">8319</span><br><span class="line">8320</span><br><span class="line">8321</span><br><span class="line">8322</span><br><span class="line">8323</span><br><span class="line">8324</span><br><span class="line">8325</span><br><span class="line">8326</span><br><span class="line">8327</span><br><span class="line">8328</span><br><span class="line">8329</span><br><span class="line">8330</span><br><span class="line">8331</span><br><span class="line">8332</span><br><span class="line">8333</span><br><span class="line">8334</span><br><span class="line">8335</span><br><span class="line">8336</span><br><span class="line">8337</span><br><span class="line">8338</span><br><span class="line">8339</span><br><span class="line">8340</span><br><span class="line">8341</span><br><span class="line">8342</span><br><span class="line">8343</span><br><span class="line">8344</span><br><span class="line">8345</span><br><span class="line">8346</span><br><span class="line">8347</span><br><span class="line">8348</span><br><span class="line">8349</span><br><span class="line">8350</span><br><span class="line">8351</span><br><span class="line">8352</span><br><span class="line">8353</span><br><span class="line">8354</span><br><span class="line">8355</span><br><span class="line">8356</span><br><span class="line">8357</span><br><span class="line">8358</span><br><span class="line">8359</span><br><span class="line">8360</span><br><span class="line">8361</span><br><span class="line">8362</span><br><span class="line">8363</span><br><span class="line">8364</span><br><span class="line">8365</span><br><span class="line">8366</span><br><span class="line">8367</span><br><span class="line">8368</span><br><span class="line">8369</span><br><span class="line">8370</span><br><span class="line">8371</span><br><span class="line">8372</span><br><span class="line">8373</span><br><span class="line">8374</span><br><span class="line">8375</span><br><span class="line">8376</span><br><span class="line">8377</span><br><span class="line">8378</span><br><span class="line">8379</span><br><span class="line">8380</span><br><span class="line">8381</span><br><span class="line">8382</span><br><span class="line">8383</span><br><span class="line">8384</span><br><span class="line">8385</span><br><span class="line">8386</span><br><span class="line">8387</span><br><span class="line">8388</span><br><span class="line">8389</span><br><span class="line">8390</span><br><span class="line">8391</span><br><span class="line">8392</span><br><span class="line">8393</span><br><span class="line">8394</span><br><span class="line">8395</span><br><span class="line">8396</span><br><span class="line">8397</span><br><span class="line">8398</span><br><span class="line">8399</span><br><span class="line">8400</span><br><span class="line">8401</span><br><span class="line">8402</span><br><span class="line">8403</span><br><span class="line">8404</span><br><span class="line">8405</span><br><span class="line">8406</span><br><span class="line">8407</span><br><span class="line">8408</span><br><span class="line">8409</span><br><span class="line">8410</span><br><span class="line">8411</span><br><span class="line">8412</span><br><span class="line">8413</span><br><span class="line">8414</span><br><span class="line">8415</span><br><span class="line">8416</span><br><span class="line">8417</span><br><span class="line">8418</span><br><span class="line">8419</span><br><span class="line">8420</span><br><span class="line">8421</span><br><span class="line">8422</span><br><span class="line">8423</span><br><span class="line">8424</span><br><span class="line">8425</span><br><span class="line">8426</span><br><span class="line">8427</span><br><span class="line">8428</span><br><span class="line">8429</span><br><span class="line">8430</span><br><span class="line">8431</span><br><span class="line">8432</span><br><span class="line">8433</span><br><span class="line">8434</span><br><span class="line">8435</span><br><span class="line">8436</span><br><span class="line">8437</span><br><span class="line">8438</span><br><span class="line">8439</span><br><span class="line">8440</span><br><span class="line">8441</span><br><span class="line">8442</span><br><span class="line">8443</span><br><span class="line">8444</span><br><span class="line">8445</span><br><span class="line">8446</span><br><span class="line">8447</span><br><span class="line">8448</span><br><span class="line">8449</span><br><span class="line">8450</span><br><span class="line">8451</span><br><span class="line">8452</span><br><span class="line">8453</span><br><span class="line">8454</span><br><span class="line">8455</span><br><span class="line">8456</span><br><span class="line">8457</span><br><span class="line">8458</span><br><span class="line">8459</span><br><span class="line">8460</span><br><span class="line">8461</span><br><span class="line">8462</span><br><span class="line">8463</span><br><span class="line">8464</span><br><span class="line">8465</span><br><span class="line">8466</span><br><span class="line">8467</span><br><span class="line">8468</span><br><span class="line">8469</span><br><span class="line">8470</span><br><span class="line">8471</span><br><span class="line">8472</span><br><span class="line">8473</span><br><span class="line">8474</span><br><span class="line">8475</span><br><span class="line">8476</span><br><span class="line">8477</span><br><span class="line">8478</span><br><span class="line">8479</span><br><span class="line">8480</span><br><span class="line">8481</span><br><span class="line">8482</span><br><span class="line">8483</span><br><span class="line">8484</span><br><span class="line">8485</span><br><span class="line">8486</span><br><span class="line">8487</span><br><span class="line">8488</span><br><span class="line">8489</span><br><span class="line">8490</span><br><span class="line">8491</span><br><span class="line">8492</span><br><span class="line">8493</span><br><span class="line">8494</span><br><span class="line">8495</span><br><span class="line">8496</span><br><span class="line">8497</span><br><span class="line">8498</span><br><span class="line">8499</span><br><span class="line">8500</span><br><span class="line">8501</span><br><span class="line">8502</span><br><span class="line">8503</span><br><span class="line">8504</span><br><span class="line">8505</span><br><span class="line">8506</span><br><span class="line">8507</span><br><span class="line">8508</span><br><span class="line">8509</span><br><span class="line">8510</span><br><span class="line">8511</span><br><span class="line">8512</span><br><span class="line">8513</span><br><span class="line">8514</span><br><span class="line">8515</span><br><span class="line">8516</span><br><span class="line">8517</span><br><span class="line">8518</span><br><span class="line">8519</span><br><span class="line">8520</span><br><span class="line">8521</span><br><span class="line">8522</span><br><span class="line">8523</span><br><span class="line">8524</span><br><span class="line">8525</span><br><span class="line">8526</span><br><span class="line">8527</span><br><span class="line">8528</span><br><span class="line">8529</span><br><span class="line">8530</span><br><span class="line">8531</span><br><span class="line">8532</span><br><span class="line">8533</span><br><span class="line">8534</span><br><span class="line">8535</span><br><span class="line">8536</span><br><span class="line">8537</span><br><span class="line">8538</span><br><span class="line">8539</span><br><span class="line">8540</span><br><span class="line">8541</span><br><span class="line">8542</span><br><span class="line">8543</span><br><span class="line">8544</span><br><span class="line">8545</span><br><span class="line">8546</span><br><span class="line">8547</span><br><span class="line">8548</span><br><span class="line">8549</span><br><span class="line">8550</span><br><span class="line">8551</span><br><span class="line">8552</span><br><span class="line">8553</span><br><span class="line">8554</span><br><span class="line">8555</span><br><span class="line">8556</span><br><span class="line">8557</span><br><span class="line">8558</span><br><span class="line">8559</span><br><span class="line">8560</span><br><span class="line">8561</span><br><span class="line">8562</span><br><span class="line">8563</span><br><span class="line">8564</span><br><span class="line">8565</span><br><span class="line">8566</span><br><span class="line">8567</span><br><span class="line">8568</span><br><span class="line">8569</span><br><span class="line">8570</span><br><span class="line">8571</span><br><span class="line">8572</span><br><span class="line">8573</span><br><span class="line">8574</span><br><span class="line">8575</span><br><span class="line">8576</span><br><span class="line">8577</span><br><span class="line">8578</span><br><span class="line">8579</span><br><span class="line">8580</span><br><span class="line">8581</span><br><span class="line">8582</span><br><span class="line">8583</span><br><span class="line">8584</span><br><span class="line">8585</span><br><span class="line">8586</span><br><span class="line">8587</span><br><span class="line">8588</span><br><span class="line">8589</span><br><span class="line">8590</span><br><span class="line">8591</span><br><span class="line">8592</span><br><span class="line">8593</span><br><span class="line">8594</span><br><span class="line">8595</span><br><span class="line">8596</span><br><span class="line">8597</span><br><span class="line">8598</span><br><span class="line">8599</span><br><span class="line">8600</span><br><span class="line">8601</span><br><span class="line">8602</span><br><span class="line">8603</span><br><span class="line">8604</span><br><span class="line">8605</span><br><span class="line">8606</span><br><span class="line">8607</span><br><span class="line">8608</span><br><span class="line">8609</span><br><span class="line">8610</span><br><span class="line">8611</span><br><span class="line">8612</span><br><span class="line">8613</span><br><span class="line">8614</span><br><span class="line">8615</span><br><span class="line">8616</span><br><span class="line">8617</span><br><span class="line">8618</span><br><span class="line">8619</span><br><span class="line">8620</span><br><span class="line">8621</span><br><span class="line">8622</span><br><span class="line">8623</span><br><span class="line">8624</span><br><span class="line">8625</span><br><span class="line">8626</span><br><span class="line">8627</span><br><span class="line">8628</span><br><span class="line">8629</span><br><span class="line">8630</span><br><span class="line">8631</span><br><span class="line">8632</span><br><span class="line">8633</span><br><span class="line">8634</span><br><span class="line">8635</span><br><span class="line">8636</span><br><span class="line">8637</span><br><span class="line">8638</span><br><span class="line">8639</span><br><span class="line">8640</span><br><span class="line">8641</span><br><span class="line">8642</span><br><span class="line">8643</span><br><span class="line">8644</span><br><span class="line">8645</span><br><span class="line">8646</span><br><span class="line">8647</span><br><span class="line">8648</span><br><span class="line">8649</span><br><span class="line">8650</span><br><span class="line">8651</span><br><span class="line">8652</span><br><span class="line">8653</span><br><span class="line">8654</span><br><span class="line">8655</span><br><span class="line">8656</span><br><span class="line">8657</span><br><span class="line">8658</span><br><span class="line">8659</span><br><span class="line">8660</span><br><span class="line">8661</span><br><span class="line">8662</span><br><span class="line">8663</span><br><span class="line">8664</span><br><span class="line">8665</span><br><span class="line">8666</span><br><span class="line">8667</span><br><span class="line">8668</span><br><span class="line">8669</span><br><span class="line">8670</span><br><span class="line">8671</span><br><span class="line">8672</span><br><span class="line">8673</span><br><span class="line">8674</span><br><span class="line">8675</span><br><span class="line">8676</span><br><span class="line">8677</span><br><span class="line">8678</span><br><span class="line">8679</span><br><span class="line">8680</span><br><span class="line">8681</span><br><span class="line">8682</span><br><span class="line">8683</span><br><span class="line">8684</span><br><span class="line">8685</span><br><span class="line">8686</span><br><span class="line">8687</span><br><span class="line">8688</span><br><span class="line">8689</span><br><span class="line">8690</span><br><span class="line">8691</span><br><span class="line">8692</span><br><span class="line">8693</span><br><span class="line">8694</span><br><span class="line">8695</span><br><span class="line">8696</span><br><span class="line">8697</span><br><span class="line">8698</span><br><span class="line">8699</span><br><span class="line">8700</span><br><span class="line">8701</span><br><span class="line">8702</span><br><span class="line">8703</span><br><span class="line">8704</span><br><span class="line">8705</span><br><span class="line">8706</span><br><span class="line">8707</span><br><span class="line">8708</span><br><span class="line">8709</span><br><span class="line">8710</span><br><span class="line">8711</span><br><span class="line">8712</span><br><span class="line">8713</span><br><span class="line">8714</span><br><span class="line">8715</span><br><span class="line">8716</span><br><span class="line">8717</span><br><span class="line">8718</span><br><span class="line">8719</span><br><span class="line">8720</span><br><span class="line">8721</span><br><span class="line">8722</span><br><span class="line">8723</span><br><span class="line">8724</span><br><span class="line">8725</span><br><span class="line">8726</span><br><span class="line">8727</span><br><span class="line">8728</span><br><span class="line">8729</span><br><span class="line">8730</span><br><span class="line">8731</span><br><span class="line">8732</span><br><span class="line">8733</span><br><span class="line">8734</span><br><span class="line">8735</span><br><span class="line">8736</span><br><span class="line">8737</span><br><span class="line">8738</span><br><span class="line">8739</span><br><span class="line">8740</span><br><span class="line">8741</span><br><span class="line">8742</span><br><span class="line">8743</span><br><span class="line">8744</span><br><span class="line">8745</span><br><span class="line">8746</span><br><span class="line">8747</span><br><span class="line">8748</span><br><span class="line">8749</span><br><span class="line">8750</span><br><span class="line">8751</span><br><span class="line">8752</span><br><span class="line">8753</span><br><span class="line">8754</span><br><span class="line">8755</span><br><span class="line">8756</span><br><span class="line">8757</span><br><span class="line">8758</span><br><span class="line">8759</span><br><span class="line">8760</span><br><span class="line">8761</span><br><span class="line">8762</span><br><span class="line">8763</span><br><span class="line">8764</span><br><span class="line">8765</span><br><span class="line">8766</span><br><span class="line">8767</span><br><span class="line">8768</span><br><span class="line">8769</span><br><span class="line">8770</span><br><span class="line">8771</span><br><span class="line">8772</span><br><span class="line">8773</span><br><span class="line">8774</span><br><span class="line">8775</span><br><span class="line">8776</span><br><span class="line">8777</span><br><span class="line">8778</span><br><span class="line">8779</span><br><span class="line">8780</span><br><span class="line">8781</span><br><span class="line">8782</span><br><span class="line">8783</span><br><span class="line">8784</span><br><span class="line">8785</span><br><span class="line">8786</span><br><span class="line">8787</span><br><span class="line">8788</span><br><span class="line">8789</span><br><span class="line">8790</span><br><span class="line">8791</span><br><span class="line">8792</span><br><span class="line">8793</span><br><span class="line">8794</span><br><span class="line">8795</span><br><span class="line">8796</span><br><span class="line">8797</span><br><span class="line">8798</span><br><span class="line">8799</span><br><span class="line">8800</span><br><span class="line">8801</span><br><span class="line">8802</span><br><span class="line">8803</span><br><span class="line">8804</span><br><span class="line">8805</span><br><span class="line">8806</span><br><span class="line">8807</span><br><span class="line">8808</span><br><span class="line">8809</span><br><span class="line">8810</span><br><span class="line">8811</span><br><span class="line">8812</span><br><span class="line">8813</span><br><span class="line">8814</span><br><span class="line">8815</span><br><span class="line">8816</span><br><span class="line">8817</span><br><span class="line">8818</span><br><span class="line">8819</span><br><span class="line">8820</span><br><span class="line">8821</span><br><span class="line">8822</span><br><span class="line">8823</span><br><span class="line">8824</span><br><span class="line">8825</span><br><span class="line">8826</span><br><span class="line">8827</span><br><span class="line">8828</span><br><span class="line">8829</span><br><span class="line">8830</span><br><span class="line">8831</span><br><span class="line">8832</span><br><span class="line">8833</span><br><span class="line">8834</span><br><span class="line">8835</span><br><span class="line">8836</span><br><span class="line">8837</span><br><span class="line">8838</span><br><span class="line">8839</span><br><span class="line">8840</span><br><span class="line">8841</span><br><span class="line">8842</span><br><span class="line">8843</span><br><span class="line">8844</span><br><span class="line">8845</span><br><span class="line">8846</span><br><span class="line">8847</span><br><span class="line">8848</span><br><span class="line">8849</span><br><span class="line">8850</span><br><span class="line">8851</span><br><span class="line">8852</span><br><span class="line">8853</span><br><span class="line">8854</span><br><span class="line">8855</span><br><span class="line">8856</span><br><span class="line">8857</span><br><span class="line">8858</span><br><span class="line">8859</span><br><span class="line">8860</span><br><span class="line">8861</span><br><span class="line">8862</span><br><span class="line">8863</span><br><span class="line">8864</span><br><span class="line">8865</span><br><span class="line">8866</span><br><span class="line">8867</span><br><span class="line">8868</span><br><span class="line">8869</span><br><span class="line">8870</span><br><span class="line">8871</span><br><span class="line">8872</span><br><span class="line">8873</span><br><span class="line">8874</span><br><span class="line">8875</span><br><span class="line">8876</span><br><span class="line">8877</span><br><span class="line">8878</span><br><span class="line">8879</span><br><span class="line">8880</span><br><span class="line">8881</span><br><span class="line">8882</span><br><span class="line">8883</span><br><span class="line">8884</span><br><span class="line">8885</span><br><span class="line">8886</span><br><span class="line">8887</span><br><span class="line">8888</span><br><span class="line">8889</span><br><span class="line">8890</span><br><span class="line">8891</span><br><span class="line">8892</span><br><span class="line">8893</span><br><span class="line">8894</span><br><span class="line">8895</span><br><span class="line">8896</span><br><span class="line">8897</span><br><span class="line">8898</span><br><span class="line">8899</span><br><span class="line">8900</span><br><span class="line">8901</span><br><span class="line">8902</span><br><span class="line">8903</span><br><span class="line">8904</span><br><span class="line">8905</span><br><span class="line">8906</span><br><span class="line">8907</span><br><span class="line">8908</span><br><span class="line">8909</span><br><span class="line">8910</span><br><span class="line">8911</span><br><span class="line">8912</span><br><span class="line">8913</span><br><span class="line">8914</span><br><span class="line">8915</span><br><span class="line">8916</span><br><span class="line">8917</span><br><span class="line">8918</span><br><span class="line">8919</span><br><span class="line">8920</span><br><span class="line">8921</span><br><span class="line">8922</span><br><span class="line">8923</span><br><span class="line">8924</span><br><span class="line">8925</span><br><span class="line">8926</span><br><span class="line">8927</span><br><span class="line">8928</span><br><span class="line">8929</span><br><span class="line">8930</span><br><span class="line">8931</span><br><span class="line">8932</span><br><span class="line">8933</span><br><span class="line">8934</span><br><span class="line">8935</span><br><span class="line">8936</span><br><span class="line">8937</span><br><span class="line">8938</span><br><span class="line">8939</span><br><span class="line">8940</span><br><span class="line">8941</span><br><span class="line">8942</span><br><span class="line">8943</span><br><span class="line">8944</span><br><span class="line">8945</span><br><span class="line">8946</span><br><span class="line">8947</span><br><span class="line">8948</span><br><span class="line">8949</span><br><span class="line">8950</span><br><span class="line">8951</span><br><span class="line">8952</span><br><span class="line">8953</span><br><span class="line">8954</span><br><span class="line">8955</span><br><span class="line">8956</span><br><span class="line">8957</span><br><span class="line">8958</span><br><span class="line">8959</span><br><span class="line">8960</span><br><span class="line">8961</span><br><span class="line">8962</span><br><span class="line">8963</span><br><span class="line">8964</span><br><span class="line">8965</span><br><span class="line">8966</span><br><span class="line">8967</span><br><span class="line">8968</span><br><span class="line">8969</span><br><span class="line">8970</span><br><span class="line">8971</span><br><span class="line">8972</span><br><span class="line">8973</span><br><span class="line">8974</span><br><span class="line">8975</span><br><span class="line">8976</span><br><span class="line">8977</span><br><span class="line">8978</span><br><span class="line">8979</span><br><span class="line">8980</span><br><span class="line">8981</span><br><span class="line">8982</span><br><span class="line">8983</span><br><span class="line">8984</span><br><span class="line">8985</span><br><span class="line">8986</span><br><span class="line">8987</span><br><span class="line">8988</span><br><span class="line">8989</span><br><span class="line">8990</span><br><span class="line">8991</span><br><span class="line">8992</span><br><span class="line">8993</span><br><span class="line">8994</span><br><span class="line">8995</span><br><span class="line">8996</span><br><span class="line">8997</span><br><span class="line">8998</span><br><span class="line">8999</span><br><span class="line">9000</span><br><span class="line">9001</span><br><span class="line">9002</span><br><span class="line">9003</span><br><span class="line">9004</span><br><span class="line">9005</span><br><span class="line">9006</span><br><span class="line">9007</span><br><span class="line">9008</span><br><span class="line">9009</span><br><span class="line">9010</span><br><span class="line">9011</span><br><span class="line">9012</span><br><span class="line">9013</span><br><span class="line">9014</span><br><span class="line">9015</span><br><span class="line">9016</span><br><span class="line">9017</span><br><span class="line">9018</span><br><span class="line">9019</span><br><span class="line">9020</span><br><span class="line">9021</span><br><span class="line">9022</span><br><span class="line">9023</span><br><span class="line">9024</span><br><span class="line">9025</span><br><span class="line">9026</span><br><span class="line">9027</span><br><span class="line">9028</span><br><span class="line">9029</span><br><span class="line">9030</span><br><span class="line">9031</span><br><span class="line">9032</span><br><span class="line">9033</span><br><span class="line">9034</span><br><span class="line">9035</span><br><span class="line">9036</span><br><span class="line">9037</span><br><span class="line">9038</span><br><span class="line">9039</span><br><span class="line">9040</span><br><span class="line">9041</span><br><span class="line">9042</span><br><span class="line">9043</span><br><span class="line">9044</span><br><span class="line">9045</span><br><span class="line">9046</span><br><span class="line">9047</span><br><span class="line">9048</span><br><span class="line">9049</span><br><span class="line">9050</span><br><span class="line">9051</span><br><span class="line">9052</span><br><span class="line">9053</span><br><span class="line">9054</span><br><span class="line">9055</span><br><span class="line">9056</span><br><span class="line">9057</span><br><span class="line">9058</span><br><span class="line">9059</span><br><span class="line">9060</span><br><span class="line">9061</span><br><span class="line">9062</span><br><span class="line">9063</span><br><span class="line">9064</span><br><span class="line">9065</span><br><span class="line">9066</span><br><span class="line">9067</span><br><span class="line">9068</span><br><span class="line">9069</span><br><span class="line">9070</span><br><span class="line">9071</span><br><span class="line">9072</span><br><span class="line">9073</span><br><span class="line">9074</span><br><span class="line">9075</span><br><span class="line">9076</span><br><span class="line">9077</span><br><span class="line">9078</span><br><span class="line">9079</span><br><span class="line">9080</span><br><span class="line">9081</span><br><span class="line">9082</span><br><span class="line">9083</span><br><span class="line">9084</span><br><span class="line">9085</span><br><span class="line">9086</span><br><span class="line">9087</span><br><span class="line">9088</span><br><span class="line">9089</span><br><span class="line">9090</span><br><span class="line">9091</span><br><span class="line">9092</span><br><span class="line">9093</span><br><span class="line">9094</span><br><span class="line">9095</span><br><span class="line">9096</span><br><span class="line">9097</span><br><span class="line">9098</span><br><span class="line">9099</span><br><span class="line">9100</span><br><span class="line">9101</span><br><span class="line">9102</span><br><span class="line">9103</span><br><span class="line">9104</span><br><span class="line">9105</span><br><span class="line">9106</span><br><span class="line">9107</span><br><span class="line">9108</span><br><span class="line">9109</span><br><span class="line">9110</span><br><span class="line">9111</span><br><span class="line">9112</span><br><span class="line">9113</span><br><span class="line">9114</span><br><span class="line">9115</span><br><span class="line">9116</span><br><span class="line">9117</span><br><span class="line">9118</span><br><span class="line">9119</span><br><span class="line">9120</span><br><span class="line">9121</span><br><span class="line">9122</span><br><span class="line">9123</span><br><span class="line">9124</span><br><span class="line">9125</span><br><span class="line">9126</span><br><span class="line">9127</span><br><span class="line">9128</span><br><span class="line">9129</span><br><span class="line">9130</span><br><span class="line">9131</span><br><span class="line">9132</span><br><span class="line">9133</span><br><span class="line">9134</span><br><span class="line">9135</span><br><span class="line">9136</span><br><span class="line">9137</span><br><span class="line">9138</span><br><span class="line">9139</span><br><span class="line">9140</span><br><span class="line">9141</span><br><span class="line">9142</span><br><span class="line">9143</span><br><span class="line">9144</span><br><span class="line">9145</span><br><span class="line">9146</span><br><span class="line">9147</span><br><span class="line">9148</span><br><span class="line">9149</span><br><span class="line">9150</span><br><span class="line">9151</span><br><span class="line">9152</span><br><span class="line">9153</span><br><span class="line">9154</span><br><span class="line">9155</span><br><span class="line">9156</span><br><span class="line">9157</span><br><span class="line">9158</span><br><span class="line">9159</span><br><span class="line">9160</span><br><span class="line">9161</span><br><span class="line">9162</span><br><span class="line">9163</span><br><span class="line">9164</span><br><span class="line">9165</span><br><span class="line">9166</span><br><span class="line">9167</span><br><span class="line">9168</span><br><span class="line">9169</span><br><span class="line">9170</span><br><span class="line">9171</span><br><span class="line">9172</span><br><span class="line">9173</span><br><span class="line">9174</span><br><span class="line">9175</span><br><span class="line">9176</span><br><span class="line">9177</span><br><span class="line">9178</span><br><span class="line">9179</span><br><span class="line">9180</span><br><span class="line">9181</span><br><span class="line">9182</span><br><span class="line">9183</span><br><span class="line">9184</span><br><span class="line">9185</span><br><span class="line">9186</span><br><span class="line">9187</span><br><span class="line">9188</span><br><span class="line">9189</span><br><span class="line">9190</span><br><span class="line">9191</span><br><span class="line">9192</span><br><span class="line">9193</span><br><span class="line">9194</span><br><span class="line">9195</span><br><span class="line">9196</span><br><span class="line">9197</span><br><span class="line">9198</span><br><span class="line">9199</span><br><span class="line">9200</span><br><span class="line">9201</span><br><span class="line">9202</span><br><span class="line">9203</span><br><span class="line">9204</span><br><span class="line">9205</span><br><span class="line">9206</span><br><span class="line">9207</span><br><span class="line">9208</span><br><span class="line">9209</span><br><span class="line">9210</span><br><span class="line">9211</span><br><span class="line">9212</span><br><span class="line">9213</span><br><span class="line">9214</span><br><span class="line">9215</span><br><span class="line">9216</span><br><span class="line">9217</span><br><span class="line">9218</span><br><span class="line">9219</span><br><span class="line">9220</span><br><span class="line">9221</span><br><span class="line">9222</span><br><span class="line">9223</span><br><span class="line">9224</span><br><span class="line">9225</span><br><span class="line">9226</span><br><span class="line">9227</span><br><span class="line">9228</span><br><span class="line">9229</span><br><span class="line">9230</span><br><span class="line">9231</span><br><span class="line">9232</span><br><span class="line">9233</span><br><span class="line">9234</span><br><span class="line">9235</span><br><span class="line">9236</span><br><span class="line">9237</span><br><span class="line">9238</span><br><span class="line">9239</span><br><span class="line">9240</span><br><span class="line">9241</span><br><span class="line">9242</span><br><span class="line">9243</span><br><span class="line">9244</span><br><span class="line">9245</span><br><span class="line">9246</span><br><span class="line">9247</span><br><span class="line">9248</span><br><span class="line">9249</span><br><span class="line">9250</span><br><span class="line">9251</span><br><span class="line">9252</span><br><span class="line">9253</span><br><span class="line">9254</span><br><span class="line">9255</span><br><span class="line">9256</span><br><span class="line">9257</span><br><span class="line">9258</span><br><span class="line">9259</span><br><span class="line">9260</span><br><span class="line">9261</span><br><span class="line">9262</span><br><span class="line">9263</span><br><span class="line">9264</span><br><span class="line">9265</span><br><span class="line">9266</span><br><span class="line">9267</span><br><span class="line">9268</span><br><span class="line">9269</span><br><span class="line">9270</span><br><span class="line">9271</span><br><span class="line">9272</span><br><span class="line">9273</span><br><span class="line">9274</span><br><span class="line">9275</span><br><span class="line">9276</span><br><span class="line">9277</span><br><span class="line">9278</span><br><span class="line">9279</span><br><span class="line">9280</span><br><span class="line">9281</span><br><span class="line">9282</span><br><span class="line">9283</span><br><span class="line">9284</span><br><span class="line">9285</span><br><span class="line">9286</span><br><span class="line">9287</span><br><span class="line">9288</span><br><span class="line">9289</span><br><span class="line">9290</span><br><span class="line">9291</span><br><span class="line">9292</span><br><span class="line">9293</span><br><span class="line">9294</span><br><span class="line">9295</span><br><span class="line">9296</span><br><span class="line">9297</span><br><span class="line">9298</span><br><span class="line">9299</span><br><span class="line">9300</span><br><span class="line">9301</span><br><span class="line">9302</span><br><span class="line">9303</span><br><span class="line">9304</span><br><span class="line">9305</span><br><span class="line">9306</span><br><span class="line">9307</span><br><span class="line">9308</span><br><span class="line">9309</span><br><span class="line">9310</span><br><span class="line">9311</span><br><span class="line">9312</span><br><span class="line">9313</span><br><span class="line">9314</span><br><span class="line">9315</span><br><span class="line">9316</span><br><span class="line">9317</span><br><span class="line">9318</span><br><span class="line">9319</span><br><span class="line">9320</span><br><span class="line">9321</span><br><span class="line">9322</span><br><span class="line">9323</span><br><span class="line">9324</span><br><span class="line">9325</span><br><span class="line">9326</span><br><span class="line">9327</span><br><span class="line">9328</span><br><span class="line">9329</span><br><span class="line">9330</span><br><span class="line">9331</span><br><span class="line">9332</span><br><span class="line">9333</span><br><span class="line">9334</span><br><span class="line">9335</span><br><span class="line">9336</span><br><span class="line">9337</span><br><span class="line">9338</span><br><span class="line">9339</span><br><span class="line">9340</span><br><span class="line">9341</span><br><span class="line">9342</span><br><span class="line">9343</span><br><span class="line">9344</span><br><span class="line">9345</span><br><span class="line">9346</span><br><span class="line">9347</span><br><span class="line">9348</span><br><span class="line">9349</span><br><span class="line">9350</span><br><span class="line">9351</span><br><span class="line">9352</span><br><span class="line">9353</span><br><span class="line">9354</span><br><span class="line">9355</span><br><span class="line">9356</span><br><span class="line">9357</span><br><span class="line">9358</span><br><span class="line">9359</span><br><span class="line">9360</span><br><span class="line">9361</span><br><span class="line">9362</span><br><span class="line">9363</span><br><span class="line">9364</span><br><span class="line">9365</span><br><span class="line">9366</span><br><span class="line">9367</span><br><span class="line">9368</span><br><span class="line">9369</span><br><span class="line">9370</span><br><span class="line">9371</span><br><span class="line">9372</span><br><span class="line">9373</span><br><span class="line">9374</span><br><span class="line">9375</span><br><span class="line">9376</span><br><span class="line">9377</span><br><span class="line">9378</span><br><span class="line">9379</span><br><span class="line">9380</span><br><span class="line">9381</span><br><span class="line">9382</span><br><span class="line">9383</span><br><span class="line">9384</span><br><span class="line">9385</span><br><span class="line">9386</span><br><span class="line">9387</span><br><span class="line">9388</span><br><span class="line">9389</span><br><span class="line">9390</span><br><span class="line">9391</span><br><span class="line">9392</span><br><span class="line">9393</span><br><span class="line">9394</span><br><span class="line">9395</span><br><span class="line">9396</span><br><span class="line">9397</span><br><span class="line">9398</span><br><span class="line">9399</span><br><span class="line">9400</span><br><span class="line">9401</span><br><span class="line">9402</span><br><span class="line">9403</span><br><span class="line">9404</span><br><span class="line">9405</span><br><span class="line">9406</span><br><span class="line">9407</span><br><span class="line">9408</span><br><span class="line">9409</span><br><span class="line">9410</span><br><span class="line">9411</span><br><span class="line">9412</span><br><span class="line">9413</span><br><span class="line">9414</span><br><span class="line">9415</span><br><span class="line">9416</span><br><span class="line">9417</span><br><span class="line">9418</span><br><span class="line">9419</span><br><span class="line">9420</span><br><span class="line">9421</span><br><span class="line">9422</span><br><span class="line">9423</span><br><span class="line">9424</span><br><span class="line">9425</span><br><span class="line">9426</span><br><span class="line">9427</span><br><span class="line">9428</span><br><span class="line">9429</span><br><span class="line">9430</span><br><span class="line">9431</span><br><span class="line">9432</span><br><span class="line">9433</span><br><span class="line">9434</span><br><span class="line">9435</span><br><span class="line">9436</span><br><span class="line">9437</span><br><span class="line">9438</span><br><span class="line">9439</span><br><span class="line">9440</span><br><span class="line">9441</span><br><span class="line">9442</span><br><span class="line">9443</span><br><span class="line">9444</span><br><span class="line">9445</span><br><span class="line">9446</span><br><span class="line">9447</span><br><span class="line">9448</span><br><span class="line">9449</span><br><span class="line">9450</span><br><span class="line">9451</span><br><span class="line">9452</span><br><span class="line">9453</span><br><span class="line">9454</span><br><span class="line">9455</span><br><span class="line">9456</span><br><span class="line">9457</span><br><span class="line">9458</span><br><span class="line">9459</span><br><span class="line">9460</span><br><span class="line">9461</span><br><span class="line">9462</span><br><span class="line">9463</span><br><span class="line">9464</span><br><span class="line">9465</span><br><span class="line">9466</span><br><span class="line">9467</span><br><span class="line">9468</span><br><span class="line">9469</span><br><span class="line">9470</span><br><span class="line">9471</span><br><span class="line">9472</span><br><span class="line">9473</span><br><span class="line">9474</span><br><span class="line">9475</span><br><span class="line">9476</span><br><span class="line">9477</span><br><span class="line">9478</span><br><span class="line">9479</span><br><span class="line">9480</span><br><span class="line">9481</span><br><span class="line">9482</span><br><span class="line">9483</span><br><span class="line">9484</span><br><span class="line">9485</span><br><span class="line">9486</span><br><span class="line">9487</span><br><span class="line">9488</span><br><span class="line">9489</span><br><span class="line">9490</span><br><span class="line">9491</span><br><span class="line">9492</span><br><span class="line">9493</span><br><span class="line">9494</span><br><span class="line">9495</span><br><span class="line">9496</span><br><span class="line">9497</span><br><span class="line">9498</span><br><span class="line">9499</span><br><span class="line">9500</span><br><span class="line">9501</span><br><span class="line">9502</span><br><span class="line">9503</span><br><span class="line">9504</span><br><span class="line">9505</span><br><span class="line">9506</span><br><span class="line">9507</span><br><span class="line">9508</span><br><span class="line">9509</span><br><span class="line">9510</span><br><span class="line">9511</span><br><span class="line">9512</span><br><span class="line">9513</span><br><span class="line">9514</span><br><span class="line">9515</span><br><span class="line">9516</span><br><span class="line">9517</span><br><span class="line">9518</span><br><span class="line">9519</span><br><span class="line">9520</span><br><span class="line">9521</span><br><span class="line">9522</span><br><span class="line">9523</span><br><span class="line">9524</span><br><span class="line">9525</span><br><span class="line">9526</span><br><span class="line">9527</span><br><span class="line">9528</span><br><span class="line">9529</span><br><span class="line">9530</span><br><span class="line">9531</span><br><span class="line">9532</span><br><span class="line">9533</span><br><span class="line">9534</span><br><span class="line">9535</span><br><span class="line">9536</span><br><span class="line">9537</span><br><span class="line">9538</span><br><span class="line">9539</span><br><span class="line">9540</span><br><span class="line">9541</span><br><span class="line">9542</span><br><span class="line">9543</span><br><span class="line">9544</span><br><span class="line">9545</span><br><span class="line">9546</span><br><span class="line">9547</span><br><span class="line">9548</span><br><span class="line">9549</span><br><span class="line">9550</span><br><span class="line">9551</span><br><span class="line">9552</span><br><span class="line">9553</span><br><span class="line">9554</span><br><span class="line">9555</span><br><span class="line">9556</span><br><span class="line">9557</span><br><span class="line">9558</span><br><span class="line">9559</span><br><span class="line">9560</span><br><span class="line">9561</span><br><span class="line">9562</span><br><span class="line">9563</span><br><span class="line">9564</span><br><span class="line">9565</span><br><span class="line">9566</span><br><span class="line">9567</span><br><span class="line">9568</span><br><span class="line">9569</span><br><span class="line">9570</span><br><span class="line">9571</span><br><span class="line">9572</span><br><span class="line">9573</span><br><span class="line">9574</span><br><span class="line">9575</span><br><span class="line">9576</span><br><span class="line">9577</span><br><span class="line">9578</span><br><span class="line">9579</span><br><span class="line">9580</span><br><span class="line">9581</span><br><span class="line">9582</span><br><span class="line">9583</span><br><span class="line">9584</span><br><span class="line">9585</span><br><span class="line">9586</span><br><span class="line">9587</span><br><span class="line">9588</span><br><span class="line">9589</span><br><span class="line">9590</span><br><span class="line">9591</span><br><span class="line">9592</span><br><span class="line">9593</span><br><span class="line">9594</span><br><span class="line">9595</span><br><span class="line">9596</span><br><span class="line">9597</span><br><span class="line">9598</span><br><span class="line">9599</span><br><span class="line">9600</span><br><span class="line">9601</span><br><span class="line">9602</span><br><span class="line">9603</span><br><span class="line">9604</span><br><span class="line">9605</span><br><span class="line">9606</span><br><span class="line">9607</span><br><span class="line">9608</span><br><span class="line">9609</span><br><span class="line">9610</span><br><span class="line">9611</span><br><span class="line">9612</span><br><span class="line">9613</span><br><span class="line">9614</span><br><span class="line">9615</span><br><span class="line">9616</span><br><span class="line">9617</span><br><span class="line">9618</span><br><span class="line">9619</span><br><span class="line">9620</span><br><span class="line">9621</span><br><span class="line">9622</span><br><span class="line">9623</span><br><span class="line">9624</span><br><span class="line">9625</span><br><span class="line">9626</span><br><span class="line">9627</span><br><span class="line">9628</span><br><span class="line">9629</span><br><span class="line">9630</span><br><span class="line">9631</span><br><span class="line">9632</span><br><span class="line">9633</span><br><span class="line">9634</span><br><span class="line">9635</span><br><span class="line">9636</span><br><span class="line">9637</span><br><span class="line">9638</span><br><span class="line">9639</span><br><span class="line">9640</span><br><span class="line">9641</span><br><span class="line">9642</span><br><span class="line">9643</span><br><span class="line">9644</span><br><span class="line">9645</span><br><span class="line">9646</span><br><span class="line">9647</span><br><span class="line">9648</span><br><span class="line">9649</span><br><span class="line">9650</span><br><span class="line">9651</span><br><span class="line">9652</span><br><span class="line">9653</span><br><span class="line">9654</span><br><span class="line">9655</span><br><span class="line">9656</span><br><span class="line">9657</span><br><span class="line">9658</span><br><span class="line">9659</span><br><span class="line">9660</span><br><span class="line">9661</span><br><span class="line">9662</span><br><span class="line">9663</span><br><span class="line">9664</span><br><span class="line">9665</span><br><span class="line">9666</span><br><span class="line">9667</span><br><span class="line">9668</span><br><span class="line">9669</span><br><span class="line">9670</span><br><span class="line">9671</span><br><span class="line">9672</span><br><span class="line">9673</span><br><span class="line">9674</span><br><span class="line">9675</span><br><span class="line">9676</span><br><span class="line">9677</span><br><span class="line">9678</span><br><span class="line">9679</span><br><span class="line">9680</span><br><span class="line">9681</span><br><span class="line">9682</span><br><span class="line">9683</span><br><span class="line">9684</span><br><span class="line">9685</span><br><span class="line">9686</span><br><span class="line">9687</span><br><span class="line">9688</span><br><span class="line">9689</span><br><span class="line">9690</span><br><span class="line">9691</span><br><span class="line">9692</span><br><span class="line">9693</span><br><span class="line">9694</span><br><span class="line">9695</span><br><span class="line">9696</span><br><span class="line">9697</span><br><span class="line">9698</span><br><span class="line">9699</span><br><span class="line">9700</span><br><span class="line">9701</span><br><span class="line">9702</span><br><span class="line">9703</span><br><span class="line">9704</span><br><span class="line">9705</span><br><span class="line">9706</span><br><span class="line">9707</span><br><span class="line">9708</span><br><span class="line">9709</span><br><span class="line">9710</span><br><span class="line">9711</span><br><span class="line">9712</span><br><span class="line">9713</span><br><span class="line">9714</span><br><span class="line">9715</span><br><span class="line">9716</span><br><span class="line">9717</span><br><span class="line">9718</span><br><span class="line">9719</span><br><span class="line">9720</span><br><span class="line">9721</span><br><span class="line">9722</span><br><span class="line">9723</span><br><span class="line">9724</span><br><span class="line">9725</span><br><span class="line">9726</span><br><span class="line">9727</span><br><span class="line">9728</span><br><span class="line">9729</span><br><span class="line">9730</span><br><span class="line">9731</span><br><span class="line">9732</span><br><span class="line">9733</span><br><span class="line">9734</span><br><span class="line">9735</span><br><span class="line">9736</span><br><span class="line">9737</span><br><span class="line">9738</span><br><span class="line">9739</span><br><span class="line">9740</span><br><span class="line">9741</span><br><span class="line">9742</span><br><span class="line">9743</span><br><span class="line">9744</span><br><span class="line">9745</span><br><span class="line">9746</span><br><span class="line">9747</span><br><span class="line">9748</span><br><span class="line">9749</span><br><span class="line">9750</span><br><span class="line">9751</span><br><span class="line">9752</span><br><span class="line">9753</span><br><span class="line">9754</span><br><span class="line">9755</span><br><span class="line">9756</span><br><span class="line">9757</span><br><span class="line">9758</span><br><span class="line">9759</span><br><span class="line">9760</span><br><span class="line">9761</span><br><span class="line">9762</span><br><span class="line">9763</span><br><span class="line">9764</span><br><span class="line">9765</span><br><span class="line">9766</span><br><span class="line">9767</span><br><span class="line">9768</span><br><span class="line">9769</span><br><span class="line">9770</span><br><span class="line">9771</span><br><span class="line">9772</span><br><span class="line">9773</span><br><span class="line">9774</span><br><span class="line">9775</span><br><span class="line">9776</span><br><span class="line">9777</span><br><span class="line">9778</span><br><span class="line">9779</span><br><span class="line">9780</span><br><span class="line">9781</span><br><span class="line">9782</span><br><span class="line">9783</span><br><span class="line">9784</span><br><span class="line">9785</span><br><span class="line">9786</span><br><span class="line">9787</span><br><span class="line">9788</span><br><span class="line">9789</span><br><span class="line">9790</span><br><span class="line">9791</span><br><span class="line">9792</span><br><span class="line">9793</span><br><span class="line">9794</span><br><span class="line">9795</span><br><span class="line">9796</span><br><span class="line">9797</span><br><span class="line">9798</span><br><span class="line">9799</span><br><span class="line">9800</span><br><span class="line">9801</span><br><span class="line">9802</span><br><span class="line">9803</span><br><span class="line">9804</span><br><span class="line">9805</span><br><span class="line">9806</span><br><span class="line">9807</span><br><span class="line">9808</span><br><span class="line">9809</span><br><span class="line">9810</span><br><span class="line">9811</span><br><span class="line">9812</span><br><span class="line">9813</span><br><span class="line">9814</span><br><span class="line">9815</span><br><span class="line">9816</span><br><span class="line">9817</span><br><span class="line">9818</span><br><span class="line">9819</span><br><span class="line">9820</span><br><span class="line">9821</span><br><span class="line">9822</span><br><span class="line">9823</span><br><span class="line">9824</span><br><span class="line">9825</span><br><span class="line">9826</span><br><span class="line">9827</span><br><span class="line">9828</span><br><span class="line">9829</span><br><span class="line">9830</span><br><span class="line">9831</span><br><span class="line">9832</span><br><span class="line">9833</span><br><span class="line">9834</span><br><span class="line">9835</span><br><span class="line">9836</span><br><span class="line">9837</span><br><span class="line">9838</span><br><span class="line">9839</span><br><span class="line">9840</span><br><span class="line">9841</span><br><span class="line">9842</span><br><span class="line">9843</span><br><span class="line">9844</span><br><span class="line">9845</span><br><span class="line">9846</span><br><span class="line">9847</span><br><span class="line">9848</span><br><span class="line">9849</span><br><span class="line">9850</span><br><span class="line">9851</span><br><span class="line">9852</span><br><span class="line">9853</span><br><span class="line">9854</span><br><span class="line">9855</span><br><span class="line">9856</span><br><span class="line">9857</span><br><span class="line">9858</span><br><span class="line">9859</span><br><span class="line">9860</span><br><span class="line">9861</span><br><span class="line">9862</span><br><span class="line">9863</span><br><span class="line">9864</span><br><span class="line">9865</span><br><span class="line">9866</span><br><span class="line">9867</span><br><span class="line">9868</span><br><span class="line">9869</span><br><span class="line">9870</span><br><span class="line">9871</span><br><span class="line">9872</span><br><span class="line">9873</span><br><span class="line">9874</span><br><span class="line">9875</span><br><span class="line">9876</span><br><span class="line">9877</span><br><span class="line">9878</span><br><span class="line">9879</span><br><span class="line">9880</span><br><span class="line">9881</span><br><span class="line">9882</span><br><span class="line">9883</span><br><span class="line">9884</span><br><span class="line">9885</span><br><span class="line">9886</span><br><span class="line">9887</span><br><span class="line">9888</span><br><span class="line">9889</span><br><span class="line">9890</span><br><span class="line">9891</span><br><span class="line">9892</span><br><span class="line">9893</span><br><span class="line">9894</span><br><span class="line">9895</span><br><span class="line">9896</span><br><span class="line">9897</span><br><span class="line">9898</span><br><span class="line">9899</span><br><span class="line">9900</span><br><span class="line">9901</span><br><span class="line">9902</span><br><span class="line">9903</span><br><span class="line">9904</span><br><span class="line">9905</span><br><span class="line">9906</span><br><span class="line">9907</span><br><span class="line">9908</span><br><span class="line">9909</span><br><span class="line">9910</span><br><span class="line">9911</span><br><span class="line">9912</span><br><span class="line">9913</span><br><span class="line">9914</span><br><span class="line">9915</span><br><span class="line">9916</span><br><span class="line">9917</span><br><span class="line">9918</span><br><span class="line">9919</span><br><span class="line">9920</span><br><span class="line">9921</span><br><span class="line">9922</span><br><span class="line">9923</span><br><span class="line">9924</span><br><span class="line">9925</span><br><span class="line">9926</span><br><span class="line">9927</span><br><span class="line">9928</span><br><span class="line">9929</span><br><span class="line">9930</span><br><span class="line">9931</span><br><span class="line">9932</span><br><span class="line">9933</span><br><span class="line">9934</span><br><span class="line">9935</span><br><span class="line">9936</span><br><span class="line">9937</span><br><span class="line">9938</span><br><span class="line">9939</span><br><span class="line">9940</span><br><span class="line">9941</span><br><span class="line">9942</span><br><span class="line">9943</span><br><span class="line">9944</span><br><span class="line">9945</span><br><span class="line">9946</span><br><span class="line">9947</span><br><span class="line">9948</span><br><span class="line">9949</span><br><span class="line">9950</span><br><span class="line">9951</span><br><span class="line">9952</span><br><span class="line">9953</span><br><span class="line">9954</span><br><span class="line">9955</span><br><span class="line">9956</span><br><span class="line">9957</span><br><span class="line">9958</span><br><span class="line">9959</span><br><span class="line">9960</span><br><span class="line">9961</span><br><span class="line">9962</span><br><span class="line">9963</span><br><span class="line">9964</span><br><span class="line">9965</span><br><span class="line">9966</span><br><span class="line">9967</span><br><span class="line">9968</span><br><span class="line">9969</span><br><span class="line">9970</span><br><span class="line">9971</span><br><span class="line">9972</span><br><span class="line">9973</span><br><span class="line">9974</span><br><span class="line">9975</span><br><span class="line">9976</span><br><span class="line">9977</span><br><span class="line">9978</span><br><span class="line">9979</span><br><span class="line">9980</span><br><span class="line">9981</span><br><span class="line">9982</span><br><span class="line">9983</span><br><span class="line">9984</span><br><span class="line">9985</span><br><span class="line">9986</span><br><span class="line">9987</span><br><span class="line">9988</span><br><span class="line">9989</span><br><span class="line">9990</span><br><span class="line">9991</span><br><span class="line">9992</span><br><span class="line">9993</span><br><span class="line">9994</span><br><span class="line">9995</span><br><span class="line">9996</span><br><span class="line">9997</span><br><span class="line">9998</span><br><span class="line">9999</span><br><span class="line">10000</span><br><span class="line">10001</span><br><span class="line">10002</span><br><span class="line">10003</span><br><span class="line">10004</span><br><span class="line">10005</span><br><span class="line">10006</span><br><span class="line">10007</span><br><span class="line">10008</span><br><span class="line">10009</span><br><span class="line">10010</span><br><span class="line">10011</span><br><span class="line">10012</span><br><span class="line">10013</span><br><span class="line">10014</span><br><span class="line">10015</span><br><span class="line">10016</span><br><span class="line">10017</span><br><span class="line">10018</span><br><span class="line">10019</span><br><span class="line">10020</span><br><span class="line">10021</span><br><span class="line">10022</span><br><span class="line">10023</span><br><span class="line">10024</span><br><span class="line">10025</span><br><span class="line">10026</span><br><span class="line">10027</span><br><span class="line">10028</span><br><span class="line">10029</span><br><span class="line">10030</span><br><span class="line">10031</span><br><span class="line">10032</span><br><span class="line">10033</span><br><span class="line">10034</span><br><span class="line">10035</span><br><span class="line">10036</span><br><span class="line">10037</span><br><span class="line">10038</span><br><span class="line">10039</span><br><span class="line">10040</span><br><span class="line">10041</span><br><span class="line">10042</span><br><span class="line">10043</span><br><span class="line">10044</span><br><span class="line">10045</span><br><span class="line">10046</span><br><span class="line">10047</span><br><span class="line">10048</span><br><span class="line">10049</span><br><span class="line">10050</span><br><span class="line">10051</span><br><span class="line">10052</span><br><span class="line">10053</span><br><span class="line">10054</span><br><span class="line">10055</span><br><span class="line">10056</span><br><span class="line">10057</span><br><span class="line">10058</span><br><span class="line">10059</span><br><span class="line">10060</span><br><span class="line">10061</span><br><span class="line">10062</span><br><span class="line">10063</span><br><span class="line">10064</span><br><span class="line">10065</span><br><span class="line">10066</span><br><span class="line">10067</span><br><span class="line">10068</span><br><span class="line">10069</span><br><span class="line">10070</span><br><span class="line">10071</span><br><span class="line">10072</span><br><span class="line">10073</span><br><span class="line">10074</span><br><span class="line">10075</span><br><span class="line">10076</span><br><span class="line">10077</span><br><span class="line">10078</span><br><span class="line">10079</span><br><span class="line">10080</span><br><span class="line">10081</span><br><span class="line">10082</span><br><span class="line">10083</span><br><span class="line">10084</span><br><span class="line">10085</span><br><span class="line">10086</span><br><span class="line">10087</span><br><span class="line">10088</span><br><span class="line">10089</span><br><span class="line">10090</span><br><span class="line">10091</span><br><span class="line">10092</span><br><span class="line">10093</span><br><span class="line">10094</span><br><span class="line">10095</span><br><span class="line">10096</span><br><span class="line">10097</span><br><span class="line">10098</span><br><span class="line">10099</span><br><span class="line">10100</span><br><span class="line">10101</span><br><span class="line">10102</span><br><span class="line">10103</span><br><span class="line">10104</span><br><span class="line">10105</span><br><span class="line">10106</span><br><span class="line">10107</span><br><span class="line">10108</span><br><span class="line">10109</span><br><span class="line">10110</span><br><span class="line">10111</span><br><span class="line">10112</span><br><span class="line">10113</span><br><span class="line">10114</span><br><span class="line">10115</span><br><span class="line">10116</span><br><span class="line">10117</span><br><span class="line">10118</span><br><span class="line">10119</span><br><span class="line">10120</span><br><span class="line">10121</span><br><span class="line">10122</span><br><span class="line">10123</span><br><span class="line">10124</span><br><span class="line">10125</span><br><span class="line">10126</span><br><span class="line">10127</span><br><span class="line">10128</span><br><span class="line">10129</span><br><span class="line">10130</span><br><span class="line">10131</span><br><span class="line">10132</span><br><span class="line">10133</span><br><span class="line">10134</span><br><span class="line">10135</span><br><span class="line">10136</span><br><span class="line">10137</span><br><span class="line">10138</span><br><span class="line">10139</span><br><span class="line">10140</span><br><span class="line">10141</span><br><span class="line">10142</span><br><span class="line">10143</span><br><span class="line">10144</span><br><span class="line">10145</span><br><span class="line">10146</span><br><span class="line">10147</span><br><span class="line">10148</span><br><span class="line">10149</span><br><span class="line">10150</span><br><span class="line">10151</span><br><span class="line">10152</span><br><span class="line">10153</span><br><span class="line">10154</span><br><span class="line">10155</span><br><span class="line">10156</span><br><span class="line">10157</span><br><span class="line">10158</span><br><span class="line">10159</span><br><span class="line">10160</span><br><span class="line">10161</span><br><span class="line">10162</span><br><span class="line">10163</span><br><span class="line">10164</span><br><span class="line">10165</span><br><span class="line">10166</span><br><span class="line">10167</span><br><span class="line">10168</span><br><span class="line">10169</span><br><span class="line">10170</span><br><span class="line">10171</span><br><span class="line">10172</span><br><span class="line">10173</span><br><span class="line">10174</span><br><span class="line">10175</span><br><span class="line">10176</span><br><span class="line">10177</span><br><span class="line">10178</span><br><span class="line">10179</span><br><span class="line">10180</span><br><span class="line">10181</span><br><span class="line">10182</span><br><span class="line">10183</span><br><span class="line">10184</span><br><span class="line">10185</span><br><span class="line">10186</span><br><span class="line">10187</span><br><span class="line">10188</span><br><span class="line">10189</span><br><span class="line">10190</span><br><span class="line">10191</span><br><span class="line">10192</span><br><span class="line">10193</span><br><span class="line">10194</span><br><span class="line">10195</span><br><span class="line">10196</span><br><span class="line">10197</span><br><span class="line">10198</span><br><span class="line">10199</span><br><span class="line">10200</span><br><span class="line">10201</span><br><span class="line">10202</span><br><span class="line">10203</span><br><span class="line">10204</span><br><span class="line">10205</span><br><span class="line">10206</span><br><span class="line">10207</span><br><span class="line">10208</span><br><span class="line">10209</span><br><span class="line">10210</span><br><span class="line">10211</span><br><span class="line">10212</span><br><span class="line">10213</span><br><span class="line">10214</span><br><span class="line">10215</span><br><span class="line">10216</span><br><span class="line">10217</span><br><span class="line">10218</span><br><span class="line">10219</span><br><span class="line">10220</span><br><span class="line">10221</span><br><span class="line">10222</span><br><span class="line">10223</span><br><span class="line">10224</span><br><span class="line">10225</span><br><span class="line">10226</span><br><span class="line">10227</span><br><span class="line">10228</span><br><span class="line">10229</span><br><span class="line">10230</span><br><span class="line">10231</span><br><span class="line">10232</span><br><span class="line">10233</span><br><span class="line">10234</span><br><span class="line">10235</span><br><span class="line">10236</span><br><span class="line">10237</span><br><span class="line">10238</span><br><span class="line">10239</span><br><span class="line">10240</span><br><span class="line">10241</span><br><span class="line">10242</span><br><span class="line">10243</span><br><span class="line">10244</span><br><span class="line">10245</span><br><span class="line">10246</span><br><span class="line">10247</span><br><span class="line">10248</span><br><span class="line">10249</span><br><span class="line">10250</span><br><span class="line">10251</span><br><span class="line">10252</span><br><span class="line">10253</span><br><span class="line">10254</span><br><span class="line">10255</span><br><span class="line">10256</span><br><span class="line">10257</span><br><span class="line">10258</span><br><span class="line">10259</span><br><span class="line">10260</span><br><span class="line">10261</span><br><span class="line">10262</span><br><span class="line">10263</span><br><span class="line">10264</span><br><span class="line">10265</span><br><span class="line">10266</span><br><span class="line">10267</span><br><span class="line">10268</span><br><span class="line">10269</span><br><span class="line">10270</span><br><span class="line">10271</span><br><span class="line">10272</span><br><span class="line">10273</span><br><span class="line">10274</span><br><span class="line">10275</span><br><span class="line">10276</span><br><span class="line">10277</span><br><span class="line">10278</span><br><span class="line">10279</span><br><span class="line">10280</span><br><span class="line">10281</span><br><span class="line">10282</span><br><span class="line">10283</span><br><span class="line">10284</span><br><span class="line">10285</span><br><span class="line">10286</span><br><span class="line">10287</span><br><span class="line">10288</span><br><span class="line">10289</span><br><span class="line">10290</span><br><span class="line">10291</span><br><span class="line">10292</span><br><span class="line">10293</span><br><span class="line">10294</span><br><span class="line">10295</span><br><span class="line">10296</span><br><span class="line">10297</span><br><span class="line">10298</span><br><span class="line">10299</span><br><span class="line">10300</span><br><span class="line">10301</span><br><span class="line">10302</span><br><span class="line">10303</span><br><span class="line">10304</span><br><span class="line">10305</span><br><span class="line">10306</span><br><span class="line">10307</span><br><span class="line">10308</span><br><span class="line">10309</span><br><span class="line">10310</span><br><span class="line">10311</span><br><span class="line">10312</span><br><span class="line">10313</span><br><span class="line">10314</span><br><span class="line">10315</span><br><span class="line">10316</span><br><span class="line">10317</span><br><span class="line">10318</span><br><span class="line">10319</span><br><span class="line">10320</span><br><span class="line">10321</span><br><span class="line">10322</span><br><span class="line">10323</span><br><span class="line">10324</span><br><span class="line">10325</span><br><span class="line">10326</span><br><span class="line">10327</span><br><span class="line">10328</span><br><span class="line">10329</span><br><span class="line">10330</span><br><span class="line">10331</span><br><span class="line">10332</span><br><span class="line">10333</span><br><span class="line">10334</span><br><span class="line">10335</span><br><span class="line">10336</span><br><span class="line">10337</span><br><span class="line">10338</span><br><span class="line">10339</span><br><span class="line">10340</span><br><span class="line">10341</span><br><span class="line">10342</span><br><span class="line">10343</span><br><span class="line">10344</span><br><span class="line">10345</span><br><span class="line">10346</span><br><span class="line">10347</span><br><span class="line">10348</span><br><span class="line">10349</span><br><span class="line">10350</span><br><span class="line">10351</span><br><span class="line">10352</span><br><span class="line">10353</span><br><span class="line">10354</span><br><span class="line">10355</span><br><span class="line">10356</span><br><span class="line">10357</span><br><span class="line">10358</span><br><span class="line">10359</span><br><span class="line">10360</span><br><span class="line">10361</span><br><span class="line">10362</span><br><span class="line">10363</span><br><span class="line">10364</span><br><span class="line">10365</span><br><span class="line">10366</span><br><span class="line">10367</span><br><span class="line">10368</span><br><span class="line">10369</span><br><span class="line">10370</span><br><span class="line">10371</span><br><span class="line">10372</span><br><span class="line">10373</span><br><span class="line">10374</span><br><span class="line">10375</span><br><span class="line">10376</span><br><span class="line">10377</span><br><span class="line">10378</span><br><span class="line">10379</span><br></pre></td><td class="code"><pre><span class="line">@setlocal DisableDelayedExpansion</span><br><span class="line">@echo off</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">::  For command line switches, check mass grave[.]dev/command_line_switches.html</span><br><span class="line">::  If you want to better understand script, read from MAS separate files version. </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">::============================================================================</span><br><span class="line">::</span><br><span class="line">::   This script is a part of &#x27;微软激活脚本【由feifei汉化】&#x27; (MAS) project.</span><br><span class="line">::</span><br><span class="line">::   Homepage: mass grave[.]dev</span><br><span class="line">::      Email: windowsaddict@protonmail.com</span><br><span class="line">::</span><br><span class="line">::============================================================================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Set Path variable, it helps if it is misconfigured in the system</span><br><span class="line"></span><br><span class="line">set &quot;PATH=%SystemRoot%\System32;%SystemRoot%\System32\wbem;%SystemRoot%\System32\WindowsPowerShell\v1.0\&quot;</span><br><span class="line">if exist &quot;%SystemRoot%\Sysnative\reg.exe&quot; (</span><br><span class="line">set &quot;PATH=%SystemRoot%\Sysnative;%SystemRoot%\Sysnative\wbem;%SystemRoot%\Sysnative\WindowsPowerShell\v1.0\;%PATH%&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:: Re-launch the script with x64 process if it was initiated by x86 process on x64 bit Windows</span><br><span class="line">:: or with ARM64 process if it was initiated by x86/ARM32 process on ARM64 Windows</span><br><span class="line"></span><br><span class="line">set &quot;_cmdf=%~f0&quot;</span><br><span class="line">for %%# in (%*) do (</span><br><span class="line">if /i &quot;%%#&quot;==&quot;r1&quot; set r1=1</span><br><span class="line">if /i &quot;%%#&quot;==&quot;r2&quot; set r2=1</span><br><span class="line">if /i &quot;%%#&quot;==&quot;-qedit&quot; (</span><br><span class="line">reg add HKCU\Console /v QuickEdit /t REG_DWORD /d &quot;1&quot; /f 1&gt;nul</span><br><span class="line">rem check the code below admin elevation to understand why it&#x27;s here</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if exist %SystemRoot%\Sysnative\cmd.exe if not defined r1 (</span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line">start %SystemRoot%\Sysnative\cmd.exe /c &quot;&quot;!_cmdf!&quot; %* r1&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:: Re-launch the script with ARM32 process if it was initiated by x64 process on ARM64 Windows</span><br><span class="line"></span><br><span class="line">if exist %SystemRoot%\SysArm32\cmd.exe if %PROCESSOR_ARCHITECTURE%==AMD64 if not defined r2 (</span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line">start %SystemRoot%\SysArm32\cmd.exe /c &quot;&quot;!_cmdf!&quot; %* r2&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set &quot;blank=&quot;</span><br><span class="line">set &quot;mas=ht%blank%tps%blank%://mass%blank%grave.dev/&quot;</span><br><span class="line"></span><br><span class="line">::  Check if Null service is working, it&#x27;s important for the batch script</span><br><span class="line"></span><br><span class="line">sc query Null | find /i &quot;RUNNING&quot;</span><br><span class="line">if %errorlevel% NEQ 0 (</span><br><span class="line">echo:</span><br><span class="line">echo 服务未在运行，程序可能已经崩溃...</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo 帮助（英文） - %mas%troubleshoot.html</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">ping 127.0.0.1 -n 10</span><br><span class="line">)</span><br><span class="line">cls</span><br><span class="line"></span><br><span class="line">::  Check LF line ending</span><br><span class="line"></span><br><span class="line">pushd &quot;%~dp0&quot;</span><br><span class="line">&gt;nul findstr /v &quot;$&quot; &quot;%~nx0&quot; &amp;&amp; (</span><br><span class="line">echo:</span><br><span class="line">echo 错误: 脚本行尾的换行符可能存在问题，或者脚本末尾可能缺少一个空行。</span><br><span class="line">echo:</span><br><span class="line">ping 127.0.0.1 -n 6 &gt;nul</span><br><span class="line">popd</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">popd</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">color 07</span><br><span class="line">title  微软激活脚本【由feifei汉化】</span><br><span class="line"></span><br><span class="line">set _args=</span><br><span class="line">set _elev=</span><br><span class="line">set _MASunattended=</span><br><span class="line"></span><br><span class="line">set _args=%*</span><br><span class="line">if defined _args set _args=%_args:&quot;=%</span><br><span class="line">if defined _args (</span><br><span class="line">for %%A in (%_args%) do (</span><br><span class="line">if /i &quot;%%A&quot;==&quot;-el&quot;                    set _elev=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined _args echo &quot;%_args%&quot; | find /i &quot;/&quot; &gt;nul &amp;&amp; set _MASunattended=1</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set winbuild=1</span><br><span class="line">set &quot;nul=&gt;nul 2&gt;&amp;1&quot;</span><br><span class="line">set psc=powershell.exe</span><br><span class="line">for /f &quot;tokens=6 delims=[]. &quot; %%G in (&#x27;ver&#x27;) do set winbuild=%%G</span><br><span class="line"></span><br><span class="line">set _NCS=1</span><br><span class="line">if %winbuild% LSS 10586 set _NCS=0</span><br><span class="line">if %winbuild% GEQ 10586 reg query &quot;HKCU\Console&quot; /v ForceV2 2&gt;nul | find /i &quot;0x0&quot; 1&gt;nul &amp;&amp; (set _NCS=0)</span><br><span class="line"></span><br><span class="line">call :_colorprep</span><br><span class="line"></span><br><span class="line">set &quot;nceline=echo: &amp;echo ==== ERROR ==== &amp;echo:&quot;</span><br><span class="line">set &quot;eline=echo: &amp;call :_color %Red% &quot;==== ERROR ====&quot; &amp;echo:&quot;</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">if %winbuild% LSS 7600 (</span><br><span class="line">%nceline%</span><br><span class="line">echo 不支持的系统版本 [%winbuild%].</span><br><span class="line">echo 本项目仅支持Windows7/8/8.1/10/11以及同等底层的Windows Server。</span><br><span class="line">goto MASend</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%# in (powershell.exe) do @if &quot;%%~$PATH:#&quot;==&quot;&quot; (</span><br><span class="line">%nceline%</span><br><span class="line">echo 系统内未找到powershell.exe。</span><br><span class="line">echo 程序即将终止...</span><br><span class="line">goto MASend</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Fix for the special characters limitation in path name</span><br><span class="line"></span><br><span class="line">set &quot;_work=%~dp0&quot;</span><br><span class="line">if &quot;%_work:~-1%&quot;==&quot;\&quot; set &quot;_work=%_work:~0,-1%&quot;</span><br><span class="line"></span><br><span class="line">set &quot;_batf=%~f0&quot;</span><br><span class="line">set &quot;_batp=%_batf:&#x27;=&#x27;&#x27;%&quot;</span><br><span class="line"></span><br><span class="line">set _PSarg=&quot;&quot;&quot;%~f0&quot;&quot;&quot; -el %_args%</span><br><span class="line"></span><br><span class="line">set &quot;_ttemp=%temp%&quot;</span><br><span class="line"></span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">echo &quot;!_batf!&quot; | find /i &quot;!_ttemp!&quot; 1&gt;nul &amp;&amp; (</span><br><span class="line">if /i not &quot;!_work!&quot;==&quot;!_ttemp!&quot; (</span><br><span class="line">%nceline%</span><br><span class="line">echo 脚本从临时文件夹启动</span><br><span class="line">echo 请检查是否从压缩包内直接运行。</span><br><span class="line">echo:</span><br><span class="line">echo 请解压后再次运行。</span><br><span class="line">goto MASend</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Elevate script as admin and pass arguments and preventing loop</span><br><span class="line"></span><br><span class="line">&gt;nul fltmc || (</span><br><span class="line">if not defined _elev %psc% &quot;start cmd.exe -arg &#x27;/c \&quot;!_PSarg:&#x27;=&#x27;&#x27;!\&quot;&#x27; -verb runas&quot; &amp;&amp; exit /b</span><br><span class="line">%nceline%</span><br><span class="line">echo 此脚本需要管理员权限。</span><br><span class="line">echo 为此，请右键单击此脚本，并选择“以管理员身份运行”；</span><br><span class="line">goto MASend</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not exist &quot;%SystemRoot%\Temp\&quot; mkdir &quot;%SystemRoot%\Temp&quot; 1&gt;nul 2&gt;nul</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  This code disables QuickEdit for this cmd.exe session only without making permanent changes to the registry</span><br><span class="line">::  It is added because clicking on the script window pauses the operation and leads to the confusion that script stopped due to an error</span><br><span class="line"></span><br><span class="line">if defined _MASunattended set quedit=1</span><br><span class="line">for %%# in (%_args%) do (if /i &quot;%%#&quot;==&quot;-qedit&quot; set quedit=1)</span><br><span class="line"></span><br><span class="line">reg query HKCU\Console /v QuickEdit %nul2% | find /i &quot;0x0&quot; %nul1% || if not defined quedit (</span><br><span class="line">reg add HKCU\Console /v QuickEdit /t REG_DWORD /d &quot;0&quot; /f %nul1%</span><br><span class="line">start cmd.exe /c &quot;&quot;!_batf!&quot; %_args% -qedit&quot;</span><br><span class="line">rem quickedit reset code is added at the starting of the script instead of here because it takes time to reflect in some cases</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Run script with parameters in unattended mode</span><br><span class="line"></span><br><span class="line">set _elev=</span><br><span class="line">if defined _args echo &quot;%_args%&quot; | find /i &quot;/S&quot; %nul% &amp;&amp; (set &quot;_silent=%nul%&quot;) || (set _silent=)</span><br><span class="line">if defined _args echo &quot;%_args%&quot; | find /i &quot;/&quot; %nul% &amp;&amp; (</span><br><span class="line">echo &quot;%_args%&quot; | find /i &quot;/HWID&quot;   %nul% &amp;&amp; (setlocal &amp; cls &amp; (call :HWIDActivation   %_args% %_silent%) &amp; endlocal)</span><br><span class="line">echo &quot;%_args%&quot; | find /i &quot;/KMS38&quot;  %nul% &amp;&amp; (setlocal &amp; cls &amp; (call :KMS38Activation  %_args% %_silent%) &amp; endlocal)</span><br><span class="line">echo &quot;%_args%&quot; | find /i &quot;/KMS-&quot;   %nul% &amp;&amp; (setlocal &amp; cls &amp; (call :KMSActivation    %_args% %_silent%) &amp; endlocal)</span><br><span class="line">echo &quot;%_args%&quot; | find /i &quot;/Ohook&quot;  %nul% &amp;&amp; (setlocal &amp; cls &amp; (call :OhookActivation  %_args% %_silent%) &amp; endlocal)</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">setlocal DisableDelayedExpansion</span><br><span class="line"></span><br><span class="line">::  Check desktop location</span><br><span class="line"></span><br><span class="line">set _desktop_=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders&quot; /v Desktop&#x27;) do call set &quot;_desktop_=%%b&quot;</span><br><span class="line">if not defined _desktop_ for /f &quot;delims=&quot; %%a in (&#x27;%psc% &quot;&amp; &#123;write-host $([Environment]::GetFolderPath(&#x27;Desktop&#x27;))&#125;&quot;&#x27;) do call set &quot;_desktop_=%%a&quot;</span><br><span class="line"></span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:MainMenu</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">color 07</span><br><span class="line">title  微软激活脚本【由feifei汉化】 2.2</span><br><span class="line">mode 76, 30</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:       ______________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">echo:                             请选择激活模式:</span><br><span class="line">echo:</span><br><span class="line">echo:             [1] HWID        ^|  Windows           ^|   永久</span><br><span class="line">echo:             [2] Ohook       ^|  Office            ^|   永久</span><br><span class="line">echo:             [3] KMS38       ^|  Windows           ^|   到 2038 年</span><br><span class="line">echo:             [4] Online KMS  ^|  Windows / Office  ^|   续期 180 天</span><br><span class="line">echo:             __________________________________________________      </span><br><span class="line">echo:</span><br><span class="line">echo:             [5] 查看当前系统激活状态</span><br><span class="line">echo:             [6] 故障排除</span><br><span class="line">echo:             [7] 杂项</span><br><span class="line">echo:             [8] 帮助</span><br><span class="line">echo:             [0] 退出</span><br><span class="line">echo:       ______________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">call :_color2 %_White% &quot;          &quot; %_Green% &quot;通过键盘输入菜单选项 [1,2,3,4,5,6,7,8,0] :&quot;</span><br><span class="line">echo:                           由 feifei.cn 汉化</span><br><span class="line">choice /C:123456780 /N</span><br><span class="line">set _erl=%errorlevel%</span><br><span class="line"></span><br><span class="line">if %_erl%==9 exit /b</span><br><span class="line">if %_erl%==8 start https://%mas%/troubleshoot.html &amp; goto :MainMenu</span><br><span class="line">if %_erl%==7 goto:Extras</span><br><span class="line">if %_erl%==6 setlocal &amp; call :troubleshoot      &amp; cls &amp; endlocal &amp; goto :MainMenu</span><br><span class="line">if %_erl%==5 setlocal &amp; call :_Check_Status_wmi &amp; cls &amp; endlocal &amp; goto :MainMenu</span><br><span class="line">if %_erl%==4 setlocal &amp; call :KMSActivation     &amp; cls &amp; endlocal &amp; goto :MainMenu</span><br><span class="line">if %_erl%==3 setlocal &amp; call :KMS38Activation   &amp; cls &amp; endlocal &amp; goto :MainMenu</span><br><span class="line">if %_erl%==2 setlocal &amp; call :OhookActivation   &amp; cls &amp; endlocal &amp; goto :MainMenu</span><br><span class="line">if %_erl%==1 setlocal &amp; call :HWIDActivation    &amp; cls &amp; endlocal &amp; goto :MainMenu</span><br><span class="line">goto :MainMenu</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:Extras</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">title  杂项</span><br><span class="line">mode 76, 30</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:       ______________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">echo:             [1] 修改Windows系统版本</span><br><span class="line">echo:</span><br><span class="line">echo:             [2] 提取 $OEM$ 文件夹</span><br><span class="line">echo:</span><br><span class="line">echo:             [3] 查看当前系统激活状态 [vbs]</span><br><span class="line">echo:</span><br><span class="line">echo:             [4] 下载正版 Windows / Office</span><br><span class="line">echo:             __________________________________________________      </span><br><span class="line">echo:                                                                     </span><br><span class="line">echo:             [0] 返回主菜单</span><br><span class="line">echo:       ______________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">call :_color2 %_White% &quot;           &quot; %_Green% &quot;通过键盘输入菜单选项 [1,2,3,4,0] :&quot;</span><br><span class="line">choice /C:12340 /N</span><br><span class="line">set _erl=%errorlevel%</span><br><span class="line"></span><br><span class="line">if %_erl%==5 goto :MainMenu</span><br><span class="line">if %_erl%==4 start %mas%genuine-installation-media.html &amp; goto :Extras</span><br><span class="line">if %_erl%==3 setlocal &amp; call :_Check_Status_vbs &amp; cls &amp; endlocal &amp; goto :Extras</span><br><span class="line">if %_erl%==2 goto:Extract$OEM$</span><br><span class="line">if %_erl%==1 setlocal &amp; call :change_edition    &amp; cls &amp; endlocal &amp; goto :Extras</span><br><span class="line">goto :Extras</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:Extract$OEM$</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">title  提取 $OEM$ 文件夹</span><br><span class="line">mode 76, 30</span><br><span class="line"></span><br><span class="line">if not exist &quot;!_desktop_!\&quot; (</span><br><span class="line">%eline%</span><br><span class="line">echo 未检测到桌面位置，操作终止…</span><br><span class="line">echo _____________________________________________________</span><br><span class="line">echo:</span><br><span class="line">call :_color %_Yellow% &quot;按任意键返回...&quot;</span><br><span class="line">pause &gt;nul</span><br><span class="line">goto Extras</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if exist &quot;!_desktop_!\$OEM$\&quot; (</span><br><span class="line">%eline%</span><br><span class="line">echo $OEM$ folder already exists on the Desktop.</span><br><span class="line">echo _____________________________________________________</span><br><span class="line">echo:</span><br><span class="line">call :_color %_Yellow% &quot;按任意键返回...&quot;</span><br><span class="line">pause &gt;nul</span><br><span class="line">goto Extras</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:Extract$OEM$2</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">title  提取 $OEM$ 文件夹</span><br><span class="line">mode 78, 30</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:                           提取 $OEM$ 文件夹到桌面           </span><br><span class="line">echo:           ________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">echo:              [1] HWID</span><br><span class="line">echo:              [2] Ohook</span><br><span class="line">echo:              [3] KMS38</span><br><span class="line">echo:              [4] Online KMS</span><br><span class="line">echo:</span><br><span class="line">echo:              [5] HWID       ^(Windows^) ^+ Ohook      ^(Office^)</span><br><span class="line">echo:              [6] HWID       ^(Windows^) ^+ Online KMS ^(Office^)</span><br><span class="line">echo:              [7] KMS38      ^(Windows^) ^+ Ohook      ^(Office^)</span><br><span class="line">echo:              [8] KMS38      ^(Windows^) ^+ Online KMS ^(Office^)</span><br><span class="line">echo:              [9] Online KMS ^(Windows^) ^+ Ohook      ^(Office^)</span><br><span class="line">echo:</span><br><span class="line">call :_color2 %_White% &quot;              [R] &quot; %_Green% &quot;自述文件&quot;</span><br><span class="line">echo:              [0] 返回</span><br><span class="line">echo:           ________________________________________________________</span><br><span class="line">echo:  </span><br><span class="line">call :_color2 %_White% &quot;           &quot; %_Green% &quot;通过键盘输入菜单选项：&quot;</span><br><span class="line">choice /C:123456789R0 /N</span><br><span class="line">set _erl=%errorlevel%</span><br><span class="line"></span><br><span class="line">if %_erl%==11 goto:Extras</span><br><span class="line">if %_erl%==10 start %mas%oem-folder.html &amp;goto:Extract$OEM$2</span><br><span class="line">if %_erl%==9 (set &quot;_oem=Online KMS [Windows] + Ohook [Office]&quot; &amp; set &quot;para=/KMS-ActAndRenewalTask /KMS-Windows /Ohook&quot; &amp;goto:Extract$OEM$3)</span><br><span class="line">if %_erl%==8 (set &quot;_oem=KMS38 [Windows] + Online KMS [Office]&quot; &amp; set &quot;para=/KMS38 /KMS-ActAndRenewalTask /KMS-Office&quot; &amp;goto:Extract$OEM$3)</span><br><span class="line">if %_erl%==7 (set &quot;_oem=KMS38 [Windows] + Ohook [Office]&quot; &amp; set &quot;para=/KMS38 /Ohook&quot; &amp;goto:Extract$OEM$3)</span><br><span class="line">if %_erl%==6 (set &quot;_oem=HWID [Windows] + Online KMS [Office]&quot; &amp; set &quot;para=/HWID /KMS-ActAndRenewalTask /KMS-Office&quot; &amp;goto:Extract$OEM$3)</span><br><span class="line">if %_erl%==5 (set &quot;_oem=HWID [Windows] + Ohook [Office]&quot; &amp; set &quot;para=/HWID /Ohook&quot; &amp;goto:Extract$OEM$3)</span><br><span class="line">if %_erl%==4 (set &quot;_oem=Online KMS&quot; &amp; set &quot;para=/KMS-ActAndRenewalTask /KMS-WindowsOffice&quot; &amp;goto:Extract$OEM$3)</span><br><span class="line">if %_erl%==3 (set &quot;_oem=KMS38&quot; &amp; set &quot;para=/KMS38&quot; &amp;goto:Extract$OEM$3)</span><br><span class="line">if %_erl%==2 (set &quot;_oem=Ohook&quot; &amp; set &quot;para=/Ohook&quot; &amp;goto:Extract$OEM$3)</span><br><span class="line">if %_erl%==1 (set &quot;_oem=HWID&quot; &amp; set &quot;para=/HWID&quot; &amp;goto:Extract$OEM$3)</span><br><span class="line">goto :Extract$OEM$2</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:Extract$OEM$3</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">set &quot;_dir=!_desktop_!\$OEM$\$$\Setup\Scripts&quot;</span><br><span class="line">md &quot;!_dir!\&quot;</span><br><span class="line">copy /y /b &quot;!_batf!&quot; &quot;!_dir!\MAS_AIO.cmd&quot; %nul%</span><br><span class="line"></span><br><span class="line">(</span><br><span class="line">echo @echo off</span><br><span class="line">echo fltmc ^&gt;nul ^|^| exit /b</span><br><span class="line">echo call &quot;%%~dp0MAS_AIO.cmd&quot; %para%</span><br><span class="line">echo cd \</span><br><span class="line">echo ^(goto^) 2^&gt;nul ^&amp; ^(if &quot;%%~dp0&quot;==&quot;%%SystemRoot%%\Setup\Scripts\&quot; rd /s /q &quot;%%~dp0&quot;^)</span><br><span class="line">)&gt;&quot;!_dir!\SetupComplete.cmd&quot;</span><br><span class="line"></span><br><span class="line">set _error=</span><br><span class="line">if not exist &quot;!_dir!\MAS_AIO.cmd&quot; set _error=1</span><br><span class="line">if not exist &quot;!_dir!\SetupComplete.cmd&quot; set _error=1</span><br><span class="line"></span><br><span class="line">if defined _error (</span><br><span class="line">%eline%</span><br><span class="line">echo 提取 $OEM$ 文件夹到桌面失败。</span><br><span class="line">) else (</span><br><span class="line">echo:</span><br><span class="line">call :_color %Blue% &quot;%_oem%&quot;</span><br><span class="line">call :_color %Green% &quot;成功提取 $OEM$ 文件夹到桌面。&quot;</span><br><span class="line">)</span><br><span class="line">echo &quot;%_oem%&quot; | find /i &quot;KMS38&quot; 1&gt;nul &amp;&amp; (</span><br><span class="line">echo:</span><br><span class="line">echo KMS38激活服务器核心/辅助版本（无图形用户界面） ,</span><br><span class="line">echo 查看此页 %mas%oem-folder</span><br><span class="line">)</span><br><span class="line">echo ___________________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">call :_color %_Yellow% &quot;按任意键返回...&quot;</span><br><span class="line">pause &gt;nul</span><br><span class="line">goto Extras</span><br><span class="line"></span><br><span class="line">:+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class="line"></span><br><span class="line">:HWIDActivation</span><br><span class="line">@setlocal DisableDelayedExpansion</span><br><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">::  To activate, run the script with &quot;/HWID&quot; parameter or change 0 to 1 in below line</span><br><span class="line">set _act=0</span><br><span class="line"></span><br><span class="line">::  To disable changing edition if current edition doesn&#x27;t support HWID activation, change the value to 1 from 0 or run the script with &quot;/HWID-NoEditionChange&quot; parameter</span><br><span class="line">set _NoEditionChange=0</span><br><span class="line"></span><br><span class="line">::  If value is changed in above lines or parameter is used then script will run in unattended mode</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">color 07</span><br><span class="line">title  HWID 激活</span><br><span class="line"></span><br><span class="line">set _args=</span><br><span class="line">set _elev=</span><br><span class="line">set _unattended=0</span><br><span class="line"></span><br><span class="line">set _args=%*</span><br><span class="line">if defined _args set _args=%_args:&quot;=%</span><br><span class="line">if defined _args (</span><br><span class="line">for %%A in (%_args%) do (</span><br><span class="line">if /i &quot;%%A&quot;==&quot;/HWID&quot;                  set _act=1</span><br><span class="line">if /i &quot;%%A&quot;==&quot;/HWID-NoEditionChange&quot;  set _NoEditionChange=1</span><br><span class="line">if /i &quot;%%A&quot;==&quot;-el&quot;                    set _elev=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%A in (%_act% %_NoEditionChange%) do (if &quot;%%A&quot;==&quot;1&quot; set _unattended=1)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set &quot;nul1=1&gt;nul&quot;</span><br><span class="line">set &quot;nul2=2&gt;nul&quot;</span><br><span class="line">set &quot;nul6=2^&gt;nul&quot;</span><br><span class="line">set &quot;nul=&gt;nul 2&gt;&amp;1&quot;</span><br><span class="line"></span><br><span class="line">set psc=powershell.exe</span><br><span class="line">set winbuild=1</span><br><span class="line">for /f &quot;tokens=6 delims=[]. &quot; %%G in (&#x27;ver&#x27;) do set winbuild=%%G</span><br><span class="line"></span><br><span class="line">set _NCS=1</span><br><span class="line">if %winbuild% LSS 10586 set _NCS=0</span><br><span class="line">if %winbuild% GEQ 10586 reg query &quot;HKCU\Console&quot; /v ForceV2 %nul2% | find /i &quot;0x0&quot; %nul1% &amp;&amp; (set _NCS=0)</span><br><span class="line"></span><br><span class="line">if %_NCS% EQU 1 (</span><br><span class="line">for /F %%a in (&#x27;echo prompt $E ^| cmd&#x27;) do set &quot;esc=%%a&quot;</span><br><span class="line">set     &quot;Red=&quot;41;97m&quot;&quot;</span><br><span class="line">set    &quot;Gray=&quot;100;97m&quot;&quot;</span><br><span class="line">set   &quot;Green=&quot;42;97m&quot;&quot;</span><br><span class="line">set    &quot;Blue=&quot;44;97m&quot;&quot;</span><br><span class="line">set  &quot;_White=&quot;40;37m&quot;&quot;</span><br><span class="line">set  &quot;_Green=&quot;40;92m&quot;&quot;</span><br><span class="line">set &quot;_Yellow=&quot;40;93m&quot;&quot;</span><br><span class="line">) else (</span><br><span class="line">set     &quot;Red=&quot;Red&quot; &quot;white&quot;&quot;</span><br><span class="line">set    &quot;Gray=&quot;Darkgray&quot; &quot;white&quot;&quot;</span><br><span class="line">set   &quot;Green=&quot;DarkGreen&quot; &quot;white&quot;&quot;</span><br><span class="line">set    &quot;Blue=&quot;Blue&quot; &quot;white&quot;&quot;</span><br><span class="line">set  &quot;_White=&quot;Black&quot; &quot;Gray&quot;&quot;</span><br><span class="line">set  &quot;_Green=&quot;Black&quot; &quot;Green&quot;&quot;</span><br><span class="line">set &quot;_Yellow=&quot;Black&quot; &quot;Yellow&quot;&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;nceline=echo: &amp;echo ==== ERROR ==== &amp;echo:&quot;</span><br><span class="line">set &quot;eline=echo: &amp;call :dk_color %Red% &quot;==== ERROR ====&quot; &amp;echo:&quot;</span><br><span class="line">if %~z0 GEQ 200000 (</span><br><span class="line">set &quot;_exitmsg=返回&quot;</span><br><span class="line">set &quot;_fixmsg=返回主菜单，选择 &quot;故障排除 &quot;并运行 &quot;修复 Licensing &quot;选项。&quot;</span><br><span class="line">) else (</span><br><span class="line">set &quot;_exitmsg=退出&quot;</span><br><span class="line">set &quot;_fixmsg=在 MAS 文件夹中，运行 &quot;故障排除 &quot;脚本并选择 &quot;修复 Licensing &quot;选项。&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">if %winbuild% LSS 10240 (</span><br><span class="line">%eline%</span><br><span class="line">echo 检测到不支持的操作系统版本 [%winbuild%].</span><br><span class="line">echo HWID 激活仅支持 Windows 10/11。</span><br><span class="line">echo 请使用在线 KMS 激活选项。</span><br><span class="line">goto dk_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-Server*Edition~*.mum&quot; (</span><br><span class="line">%eline%</span><br><span class="line">echo Windows Server 不支持 HWID 激活。</span><br><span class="line">echo 请使用 KMS38 或在线 KMS 激活选项。</span><br><span class="line">goto dk_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Fix for the special characters limitation in path name</span><br><span class="line"></span><br><span class="line">set &quot;_work=%~dp0&quot;</span><br><span class="line">if &quot;%_work:~-1%&quot;==&quot;\&quot; set &quot;_work=%_work:~0,-1%&quot;</span><br><span class="line"></span><br><span class="line">set &quot;_batf=%~f0&quot;</span><br><span class="line">set &quot;_batp=%_batf:&#x27;=&#x27;&#x27;%&quot;</span><br><span class="line"></span><br><span class="line">set _PSarg=&quot;&quot;&quot;%~f0&quot;&quot;&quot; -el %_args%</span><br><span class="line"></span><br><span class="line">set &quot;_ttemp=%temp%&quot;</span><br><span class="line"></span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode 108, 34</span><br><span class="line">title  HWID 激活</span><br><span class="line"></span><br><span class="line">::  Start Windows update service at the beginning and in later checks as well, because in some normal conditions one kick is not enough</span><br><span class="line"></span><br><span class="line">sc start wuauserv %nul%</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo 初始化...</span><br><span class="line">call :dk_product</span><br><span class="line">call :dk_ckeckwmic</span><br><span class="line"></span><br><span class="line">::  Show info for potential script stuck scenario</span><br><span class="line"></span><br><span class="line">sc start sppsvc %nul%</span><br><span class="line">if %errorlevel% NEQ 1056 if %errorlevel% NEQ 0 (</span><br><span class="line">echo:</span><br><span class="line">echo 错误代码: %errorlevel%</span><br><span class="line">call :dk_color %Red% &quot;启动 [sppsvc] 服务失败，剩余过程可能需要很长时间...&quot;</span><br><span class="line">echo:</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check if system is permanently activated or not</span><br><span class="line"></span><br><span class="line">call :dk_checkperm</span><br><span class="line">if defined _perm (</span><br><span class="line">cls</span><br><span class="line">echo ___________________________________________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">call :dk_color2 %_White% &quot;     &quot; %Green% &quot;检查: %winos% 已被永久激活&quot;</span><br><span class="line">call :dk_color2 %_White% &quot;     &quot; %Gray% &quot;无需激活&quot;。</span><br><span class="line">echo ___________________________________________________________________________________________</span><br><span class="line">if %_unattended%==1 goto dk_done</span><br><span class="line">echo:</span><br><span class="line">choice /C:10 /N /M &quot;&gt;    [1] 激活 [0] %_exitmsg% : &quot;</span><br><span class="line">if errorlevel 2 exit /b</span><br><span class="line">)</span><br><span class="line">cls</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check Evaluation version</span><br><span class="line"></span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-*EvalEdition~*.mum&quot; (</span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; /v EditionID %nul2% | find /i &quot;Eval&quot; %nul1% &amp;&amp; (</span><br><span class="line">%eline%</span><br><span class="line">echo [%winos% ^| %winbuild%]</span><br><span class="line">echo:</span><br><span class="line">echo 评估版无法激活。</span><br><span class="line">echo 您需要安装 %winos% 的完整版本</span><br><span class="line">echo:</span><br><span class="line">echo 从这里下载：</span><br><span class="line">echo %mas%genuine-installation-media.html</span><br><span class="line">goto dk_done</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check SKU value / Check in multiple places to find Edition change corruption</span><br><span class="line"></span><br><span class="line">set osSKU=</span><br><span class="line">set slcSKU=</span><br><span class="line">set wmiSKU=</span><br><span class="line">set regSKU=</span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 14393 (set info=Kernel-BrandingInfo) else (set info=Kernel-ProductInfo)</span><br><span class="line">set d1=%ref% [void]$TypeBuilder.DefinePInvokeMethod(&#x27;SLGetWindowsInformationDWORD&#x27;, &#x27;slc.dll&#x27;, &#x27;Public, Static&#x27;, 1, [int], @([String], [int].MakeByRefType()), 1, 3);</span><br><span class="line">set d1=%d1% $Sku = 0; [void]$TypeBuilder.CreateType()::SLGetWindowsInformationDWORD(&#x27;%info%&#x27;, [ref]$Sku); $Sku</span><br><span class="line">for /f &quot;delims=&quot; %%s in (&#x27;&quot;%psc% %d1%&quot;&#x27;) do if not errorlevel 1 (set slcSKU=%%s)</span><br><span class="line">if &quot;%slcSKU%&quot;==&quot;0&quot; set slcSKU=</span><br><span class="line">if 1%slcSKU% NEQ +1%slcSKU% set slcSKU=</span><br><span class="line"></span><br><span class="line">for /f &quot;tokens=3 delims=.&quot; %%a in (&#x27;reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\ProductOptions&quot; /v OSProductPfn %nul6%&#x27;) do set &quot;regSKU=%%a&quot;</span><br><span class="line">if %_wmic% EQU 1 for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;&quot;wmic Path Win32_OperatingSystem Get OperatingSystemSKU /format:LIST&quot; %nul6%&#x27;) do if not errorlevel 1 set &quot;wmiSKU=%%a&quot;</span><br><span class="line">if %_wmic% EQU 0 for /f &quot;tokens=1&quot; %%a in (&#x27;%psc% &quot;([WMI]&#x27;Win32_OperatingSystem=@&#x27;).OperatingSystemSKU&quot; %nul6%&#x27;) do if not errorlevel 1 set &quot;wmiSKU=%%a&quot;</span><br><span class="line"></span><br><span class="line">set osSKU=%slcSKU%</span><br><span class="line">if not defined osSKU set osSKU=%wmiSKU%</span><br><span class="line">if not defined osSKU set osSKU=%regSKU%</span><br><span class="line"></span><br><span class="line">if not defined osSKU (</span><br><span class="line">%eline%</span><br><span class="line">echo 检测到不正确的 SKU 值，程序终止...</span><br><span class="line">goto dk_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set error=</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">echo:</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; /v PROCESSOR_ARCHITECTURE&#x27;) do set arch=%%b</span><br><span class="line">for /f &quot;tokens=6-7 delims=[]. &quot; %%i in (&#x27;ver&#x27;) do if &quot;%%j&quot;==&quot;&quot; (set fullbuild=%%i) else (set fullbuild=%%i.%%j)</span><br><span class="line">echo 检查操作系统信息                        [%winos% ^| %fullbuild% ^| %arch%]</span><br><span class="line"></span><br><span class="line">::  Check Internet connection</span><br><span class="line"></span><br><span class="line">set _int=</span><br><span class="line">for %%a in (l.root-servers.net resolver1.opendns.com download.windowsupdate.com google.com) do if not defined _int (</span><br><span class="line">for /f &quot;delims=[] tokens=2&quot; %%# in (&#x27;ping -n 1 %%a&#x27;) do (if not [%%#]==[] set _int=1)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not defined _int (</span><br><span class="line">%psc% &quot;If([Activator]::CreateInstance([Type]::GetTypeFromCLSID([Guid]&#x27;&#123;DCB00C01-570F-4A9B-8D69-199FDBA5723B&#125;&#x27;)).IsConnectedToInternet)&#123;Exit 0&#125;Else&#123;Exit 1&#125;&quot;</span><br><span class="line">if !errorlevel!==0 set _int=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined _int (</span><br><span class="line">echo 检查网络连接            [已连接]</span><br><span class="line">) else (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Checking Internet Connection            [Not Connected]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check Windows Script Host</span><br><span class="line"></span><br><span class="line">set _WSH=1</span><br><span class="line">reg query &quot;HKCU\SOFTWARE\Microsoft\Windows Script Host\Settings&quot; /v Enabled %nul2% | find /i &quot;0x0&quot; %nul1% &amp;&amp; (set _WSH=0)</span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows Script Host\Settings&quot; /v Enabled %nul2% | find /i &quot;0x0&quot; %nul1% &amp;&amp; (set _WSH=0)</span><br><span class="line"></span><br><span class="line">if %_WSH% EQU 0 (</span><br><span class="line">reg add &quot;HKLM\Software\Microsoft\Windows Script Host\Settings&quot; /v Enabled /t REG_DWORD /d 1 /f %nul%</span><br><span class="line">reg add &quot;HKCU\Software\Microsoft\Windows Script Host\Settings&quot; /v Enabled /t REG_DWORD /d 1 /f %nul%</span><br><span class="line">if not &quot;%arch%&quot;==&quot;x86&quot; reg add &quot;HKLM\Software\Microsoft\Windows Script Host\Settings&quot; /v Enabled /t REG_DWORD /d 1 /f /reg:32 %nul%</span><br><span class="line">echo 启用 Windows 脚本托管            [成功]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">echo 启动诊断测试...</span><br><span class="line"></span><br><span class="line">set &quot;_serv=ClipSVC wlidsvc sppsvc KeyIso LicenseManager Winmgmt wuauserv&quot;</span><br><span class="line"></span><br><span class="line">::  Client License Service (ClipSVC)</span><br><span class="line">::  Microsoft Account Sign-in Assistant</span><br><span class="line">::  Software Protection</span><br><span class="line">::  CNG Key Isolation</span><br><span class="line">::  Windows License Manager Service</span><br><span class="line">::  Windows Management Instrumentation</span><br><span class="line">::  Windows Update</span><br><span class="line"></span><br><span class="line">call :dk_errorcheck</span><br><span class="line"></span><br><span class="line">::  Check Windows updates and store app blockers</span><br><span class="line"></span><br><span class="line">set updatesblock=</span><br><span class="line">echo: %serv_cor% %serv_ste% | findstr /i &quot;wuauserv&quot; %nul% &amp;&amp; set updatesblock=1</span><br><span class="line"></span><br><span class="line">sc start UsoSvc %nul%</span><br><span class="line">if %errorlevel% NEQ 1056 if %errorlevel% NEQ 0 set updatesblock=1</span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 17134 (</span><br><span class="line">sc start WaaSMedicSvc %nul%</span><br><span class="line">if !errorlevel! NEQ 1056 if !errorlevel! NEQ 0 set updatesblock=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer /v SettingsPageVisibility %nul2% | find /i &quot;windowsupdate&quot; %nul% &amp;&amp; set updatesblock=1</span><br><span class="line">reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdateSysprepInProgress %nul% &amp;&amp; set updatesblock=1</span><br><span class="line">reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate /s %nul2% | findstr /i &quot;NoAutoUpdate DisableWindowsUpdateAccess&quot; %nul% &amp;&amp; set updatesblock=1</span><br><span class="line"></span><br><span class="line">if defined updatesblock (</span><br><span class="line">call :dk_color %Gray% &quot;Checking Windows Update Blockers        [Found]&quot;</span><br><span class="line">if defined applist echo: %serv_e% | find /i &quot;wuauserv&quot; %nul% &amp;&amp; (</span><br><span class="line">call :dk_color %Blue% &quot;Windows Update is not working. Enable it incase if you have disabled it.&quot;</span><br><span class="line">reg query HKLM\SYSTEM\CurrentControlSet\Services\wuauserv /v WubLock %nul% &amp;&amp; call :dk_color %Blue% &quot;Sordum Windows Update Blocker tool has been used to block updates.&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Policies\Microsoft\WindowsStore&quot; /v DisableStoreApps %nul2% | find /i &quot;0x1&quot; %nul% &amp;&amp; (</span><br><span class="line">call :dk_color %Gray% &quot;Checking Store App Blocker              [Found]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Detect Key</span><br><span class="line"></span><br><span class="line">set key=</span><br><span class="line">set altkey=</span><br><span class="line">set changekey=</span><br><span class="line">set altapplist=</span><br><span class="line">set altedition=</span><br><span class="line">set notworking=</span><br><span class="line"></span><br><span class="line">if defined applist call :hwiddata key</span><br><span class="line">if not defined key (</span><br><span class="line">for /f &quot;delims=&quot; %%a in (&#x27;%psc% &quot;$f=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split &#x27;:getactivationid\:.*&#x27;;iex ($f[1]);&quot;&#x27;) do (set altapplist=%%a)</span><br><span class="line">if defined altapplist call :hwiddata key</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined notworking call :hwidfallback</span><br><span class="line">if not defined key call :hwidfallback</span><br><span class="line"></span><br><span class="line">if defined altkey (set key=%altkey%&amp;set changekey=1&amp;set notworking=)</span><br><span class="line"></span><br><span class="line">if defined notworking if defined notfoundaltactID (</span><br><span class="line">call :dk_color %Red% &quot;Checking Alternate Edition For HWID     [%altedition% 未找到激活 ID]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not defined key (</span><br><span class="line">%eline%</span><br><span class="line">echo [%winos% ^| %winbuild% ^| SKU:%osSKU%]</span><br><span class="line">echo 无法在支持的产品列表中找到此产品。</span><br><span class="line">echo 确保您使用的是最新版本的脚本。</span><br><span class="line">echo %mas%</span><br><span class="line">echo:</span><br><span class="line">goto dk_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined notworking set error=1</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Install key</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if defined changekey (</span><br><span class="line">call :dk_color %Blue% &quot;[%altedition%] Edition product key will be used to enable HWID activation.&quot;</span><br><span class="line">echo:</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %_wmic% EQU 1 wmic path SoftwareLicensingService where __CLASS=&#x27;SoftwareLicensingService&#x27; call InstallProductKey ProductKey=&quot;%key%&quot; %nul%</span><br><span class="line">if %_wmic% EQU 0 %psc% &quot;(([WMISEARCHER]&#x27;SELECT Version FROM SoftwareLicensingService&#x27;).Get()).InstallProductKey(&#x27;%key%&#x27;)&quot; %nul%</span><br><span class="line">if not %errorlevel%==0 cscript //nologo %windir%\system32\slmgr.vbs /ipk %key% %nul%</span><br><span class="line">set errorcode=%errorlevel%</span><br><span class="line">cmd /c exit /b %errorcode%</span><br><span class="line">if %errorcode% NEQ 0 set &quot;errorcode=[0x%=ExitCode%]&quot;</span><br><span class="line"></span><br><span class="line">if %errorcode% EQU 0 (</span><br><span class="line">call :dk_refresh</span><br><span class="line">echo 安装通用产品密钥          [%key%] [成功]</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Red% &quot;安装通用产品密钥          [%key%] [失败] %errorcode%&quot;</span><br><span class="line">if not defined error (</span><br><span class="line">if defined altapplist call :dk_color %Red% &quot;Activation ID not found for this key.&quot;</span><br><span class="line">call :dk_color %Blue% &quot;%_fixmsg%&quot;</span><br><span class="line">set showfix=1</span><br><span class="line">)</span><br><span class="line">set error=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Change Windows region to USA to avoid activation issues as Windows store license is not available in many countries </span><br><span class="line"></span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKCU\Control Panel\International\Geo&quot; /v Name %nul6%&#x27;) do set &quot;name=%%b&quot;</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKCU\Control Panel\International\Geo&quot; /v Nation %nul6%&#x27;) do set &quot;nation=%%b&quot;</span><br><span class="line"></span><br><span class="line">set regionchange=</span><br><span class="line">if not &quot;%name%&quot;==&quot;US&quot; (</span><br><span class="line">set regionchange=1</span><br><span class="line">%psc% &quot;Set-WinHomeLocation -GeoId 244&quot; %nul%</span><br><span class="line">if !errorlevel! EQU 0 (</span><br><span class="line">echo 正在将 Windows 地区更改为美国          [成功]</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Red% &quot;Changing Windows Region To USA          [失败]&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::==========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Generate GenuineTicket.xml and apply</span><br><span class="line">::  In some cases clipup -v -o method fails and in some cases service restart method fails as well</span><br><span class="line">::  To maximize success rate and get better error details, script will install tickets two times (service restart + clipup -v -o)</span><br><span class="line"></span><br><span class="line">if not exist %SystemRoot%\system32\ClipUp.exe (</span><br><span class="line">call :dk_color %Red% &quot;Checking ClipUp.exe File                [Not found, aborting the process]&quot;</span><br><span class="line">call :dk_color2 %Blue% &quot;查看此页以获得帮助&quot; %_Yellow% &quot; %mas%troubleshoot&quot;</span><br><span class="line">goto :dl_final</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;tdir=%ProgramData%\Microsoft\Windows\ClipSVC\GenuineTicket&quot;</span><br><span class="line">if not exist &quot;%tdir%\&quot; md &quot;%tdir%\&quot; %nul%</span><br><span class="line"></span><br><span class="line">if exist &quot;%tdir%\Genuine*&quot; del /f /q &quot;%tdir%\Genuine*&quot; %nul%</span><br><span class="line">if exist &quot;%tdir%\*.xml&quot; del /f /q &quot;%tdir%\*.xml&quot; %nul%</span><br><span class="line">if exist &quot;%ProgramData%\Microsoft\Windows\ClipSVC\Install\Migration\*&quot; del /f /q &quot;%ProgramData%\Microsoft\Windows\ClipSVC\Install\Migration\*&quot; %nul%</span><br><span class="line"></span><br><span class="line">call :hwiddata ticket</span><br><span class="line"></span><br><span class="line">copy /y /b &quot;%tdir%\GenuineTicket&quot; &quot;%tdir%\GenuineTicket.xml&quot; %nul%</span><br><span class="line"></span><br><span class="line">if not exist &quot;%tdir%\GenuineTicket.xml&quot; (</span><br><span class="line">call :dk_color %Red% &quot;生成 GenuineTicket.xml            [Failed, aborting the process]&quot;</span><br><span class="line">echo [%encoded%]</span><br><span class="line">if exist &quot;%tdir%\Genuine*&quot; del /f /q &quot;%tdir%\Genuine*&quot; %nul%</span><br><span class="line">goto :dl_final</span><br><span class="line">) else (</span><br><span class="line">echo 生成 GenuineTicket.xml            [成功]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;_xmlexist=if exist &quot;%tdir%\GenuineTicket.xml&quot;&quot;</span><br><span class="line"></span><br><span class="line">%_xmlexist% (</span><br><span class="line">net stop ClipSVC /y %nul%</span><br><span class="line">net start ClipSVC /y %nul%</span><br><span class="line">%_xmlexist% timeout /t 2 %nul%</span><br><span class="line">%_xmlexist% timeout /t 2 %nul%</span><br><span class="line"></span><br><span class="line">%_xmlexist% (</span><br><span class="line">set error=1</span><br><span class="line">if exist &quot;%tdir%\*.xml&quot; del /f /q &quot;%tdir%\*.xml&quot; %nul%</span><br><span class="line">call :dk_color %Red% &quot;Installing GenuineTicket.xml            [ClipSVC 服务重启失败，等待中...]&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">copy /y /b &quot;%tdir%\GenuineTicket&quot; &quot;%tdir%\GenuineTicket.xml&quot; %nul%</span><br><span class="line">clipup -v -o</span><br><span class="line"></span><br><span class="line">set rebuildinfo=</span><br><span class="line"></span><br><span class="line">if not exist %ProgramData%\Microsoft\Windows\ClipSVC\tokens.dat (</span><br><span class="line">set error=1</span><br><span class="line">set rebuildinfo=1</span><br><span class="line">call :dk_color %Red% &quot;Checking ClipSVC tokens.dat             [Not Found]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">%_xmlexist% (</span><br><span class="line">set error=1</span><br><span class="line">set rebuildinfo=1</span><br><span class="line">call :dk_color %Red% &quot;Installing GenuineTicket.xml            [Failed With clipup -v -o]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if exist &quot;%ProgramData%\Microsoft\Windows\ClipSVC\Install\Migration\*.xml&quot; (</span><br><span class="line">set error=1</span><br><span class="line">set rebuildinfo=1</span><br><span class="line">call :dk_color %Red% &quot;Checking Ticket Migration               [失败]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined applist if not defined showfix if defined rebuildinfo (</span><br><span class="line">set showfix=1</span><br><span class="line">call :dk_color %Blue% &quot;%_fixmsg%&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if exist &quot;%tdir%\Genuine*&quot; del /f /q &quot;%tdir%\Genuine*&quot; %nul%</span><br><span class="line"></span><br><span class="line">::==========================================================================================================================================</span><br><span class="line"></span><br><span class="line">call :dk_product</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo 激活...</span><br><span class="line"></span><br><span class="line">call :dk_act</span><br><span class="line">call :dk_checkperm</span><br><span class="line">if defined _perm (</span><br><span class="line">echo:</span><br><span class="line">call :dk_color %Green% &quot;%winos% is permanently activated with a digital license.&quot;</span><br><span class="line">goto :dl_final</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::==========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Extended licensing servers tests incase error not found and activation failed</span><br><span class="line"></span><br><span class="line">set resfail=</span><br><span class="line">if not defined error (</span><br><span class="line"></span><br><span class="line">ipconfig /flushdns %nul%</span><br><span class="line">set &quot;tls=$Tls12 = [Enum]::ToObject([System.Net.SecurityProtocolType], 3072); [System.Net.ServicePointManager]::SecurityProtocol = $Tls12;&quot;</span><br><span class="line"></span><br><span class="line">for %%# in (</span><br><span class="line">login.live.com/ppsecure/deviceaddcredential.srf</span><br><span class="line">purchase.mp.microsoft.com/v7.0/users/me/orders</span><br><span class="line">) do if not defined resfail (</span><br><span class="line">set &quot;d1=Add-Type -AssemblyName System.Net.Http;&quot;</span><br><span class="line">set &quot;d1=!d1! $client = [System.Net.Http.HttpClient]::new();&quot;</span><br><span class="line">set &quot;d1=!d1! $response = $client.GetAsync(&#x27;https://%%#&#x27;).GetAwaiter().GetResult();&quot;</span><br><span class="line">set &quot;d1=!d1! $response.Content.ReadAsStringAsync().GetAwaiter().GetResult()&quot;</span><br><span class="line">%psc% &quot;!tls! !d1!&quot; %nul2% | findstr /i &quot;PurchaseFD DeviceAddResponse&quot; %nul1% || set resfail=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not defined resfail (</span><br><span class="line">%psc% &quot;!tls! irm https://licensing.mp.microsoft.com/v7.0/licenses/content -Method POST&quot; | find /i &quot;traceId&quot; %nul1% || set resfail=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined resfail (</span><br><span class="line">set error=1</span><br><span class="line">echo:</span><br><span class="line">call :dk_color %Red% &quot;Checking Licensing Servers              [Failed To Connect]&quot;</span><br><span class="line">call :dk_color2 %Blue% &quot;查看此页以获得帮助&quot; %_Yellow% &quot; %mas%licensing-servers-issue&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::==========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Clear store ID related registry to fix activation incase error not found</span><br><span class="line"></span><br><span class="line">if not defined error (</span><br><span class="line">echo:</span><br><span class="line">set &quot;_ident=HKU\S-1-5-19\SOFTWARE\Microsoft\IdentityCRL&quot;</span><br><span class="line">reg delete &quot;!_ident!&quot; /f %nul%</span><br><span class="line">reg query &quot;!_ident!&quot; %nul% &amp;&amp; (</span><br><span class="line">call :dk_color %Red% &quot;Deleting a Registry                     [失败] [!_ident!]&quot;</span><br><span class="line">) || (</span><br><span class="line">echo 删除注册表                     [成功] [!_ident!]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">REM Refresh some services and license status</span><br><span class="line"></span><br><span class="line">for %%# in (wlidsvc LicenseManager sppsvc) do (net stop %%# /y %nul% &amp; net start %%# /y %nul%)</span><br><span class="line">call :dk_refresh</span><br><span class="line">call :dk_act</span><br><span class="line">call :dk_checkperm</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">REM Check Internet related error codes</span><br><span class="line"></span><br><span class="line">if not defined error if not defined _perm (</span><br><span class="line">echo &quot;%error_code%&quot; | findstr /i &quot;0x80072e 0x80072f&quot; %nul% &amp;&amp; (</span><br><span class="line">set error=1</span><br><span class="line">echo:</span><br><span class="line">call :dk_color %Red% &quot;Checking Internet Issues                [Found] %error_code%&quot;</span><br><span class="line">call :dk_color2 %Blue% &quot;查看此页以获得帮助&quot; %_Yellow% &quot; %mas%licensing-servers-issue&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::==========================================================================================================================================</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if defined _perm (</span><br><span class="line">call :dk_color %Green% &quot;%winos% is permanently activated with a digital license.&quot;</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Red% &quot;Activation Failed %error_code%&quot;</span><br><span class="line">if defined notworking (</span><br><span class="line">call :dk_color %Blue% &quot;At the time of writing this, HWID Activation was not supported for this product.&quot;</span><br><span class="line">call :dk_color %Blue% &quot;Use KMS38 Activation option.&quot;</span><br><span class="line">) else (</span><br><span class="line">if not defined error call :dk_color %Blue% &quot;%_fixmsg%&quot;</span><br><span class="line">call :dk_color2 %Blue% &quot;查看此页以获得帮助&quot; %_Yellow% &quot; %mas%troubleshoot&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:dl_final</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">if defined regionchange (</span><br><span class="line">%psc% &quot;Set-WinHomeLocation -GeoId %nation%&quot; %nul%</span><br><span class="line">if !errorlevel! EQU 0 (</span><br><span class="line">echo 还原 Windows 区域                [成功]</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Red% &quot;Restoring Windows Region                [失败] [%name% - %nation%]&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %osSKU%==175 call :dk_color %Red% &quot;%winos% 不支持在非 Azure 平台上激活。&quot;</span><br><span class="line"></span><br><span class="line">goto :dk_done</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Get Windows permanent activation status</span><br><span class="line"></span><br><span class="line">:dk_checkperm</span><br><span class="line"></span><br><span class="line">if %_wmic% EQU 1 wmic path SoftwareLicensingProduct where (LicenseStatus=&#x27;1&#x27; and GracePeriodRemaining=&#x27;0&#x27; and PartialProductKey is not NULL) get Name /value %nul2% | findstr /i &quot;Windows&quot; %nul1% &amp;&amp; set _perm=1||set _perm=</span><br><span class="line">if %_wmic% EQU 0 %psc% &quot;(([WMISEARCHER]&#x27;SELECT Name FROM SoftwareLicensingProduct WHERE LicenseStatus=1 AND GracePeriodRemaining=0 AND PartialProductKey IS NOT NULL&#x27;).Get()).Name | %% &#123;echo (&#x27;Name=&#x27;+$_)&#125;&quot; %nul2% | findstr /i &quot;Windows&quot; %nul1% &amp;&amp; set _perm=1||set _perm=</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::  Refresh license status</span><br><span class="line"></span><br><span class="line">:dk_refresh</span><br><span class="line"></span><br><span class="line">if %_wmic% EQU 1 wmic path SoftwareLicensingService where __CLASS=&#x27;SoftwareLicensingService&#x27; call RefreshLicenseStatus %nul%</span><br><span class="line">if %_wmic% EQU 0 %psc% &quot;$null=(([WMICLASS]&#x27;SoftwareLicensingService&#x27;).GetInstances()).RefreshLicenseStatus()&quot; %nul%</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::  Activation command</span><br><span class="line"></span><br><span class="line">:dk_act</span><br><span class="line"></span><br><span class="line">set error_code=</span><br><span class="line">if %_wmic% EQU 1 wmic path SoftwareLicensingProduct where &quot;ApplicationID=&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27; and PartialProductKey&lt;&gt;null&quot; call Activate %nul%</span><br><span class="line">if %_wmic% EQU 0 %psc% &quot;(([WMISEARCHER]&#x27;SELECT ID FROM SoftwareLicensingProduct WHERE ApplicationID=&#x27;&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27;&#x27; AND PartialProductKey IS NOT NULL&#x27;).Get()).Activate()&quot; %nul%</span><br><span class="line">if not %errorlevel%==0 cscript //nologo %windir%\system32\slmgr.vbs /ato %nul%</span><br><span class="line">set error_code=%errorlevel%</span><br><span class="line">cmd /c exit /b %error_code%</span><br><span class="line">if %error_code% NEQ 0 (set &quot;error_code=[Error Code: 0x%=ExitCode%]&quot;) else (set error_code=)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::  Get Windows Activation IDs</span><br><span class="line"></span><br><span class="line">:dk_actids</span><br><span class="line"></span><br><span class="line">set applist=</span><br><span class="line">if %_wmic% EQU 1 set &quot;chkapp=for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;&quot;wmic path SoftwareLicensingProduct where (ApplicationID=&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27;) get ID /VALUE&quot; %nul6%&#x27;)&quot;</span><br><span class="line">if %_wmic% EQU 0 set &quot;chkapp=for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;%psc% &quot;(([WMISEARCHER]&#x27;SELECT ID FROM SoftwareLicensingProduct WHERE ApplicationID=&#x27;&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27;&#x27;&#x27;).Get()).ID ^| %% &#123;echo (&#x27;ID=&#x27;+$_)&#125;&quot; %nul6%&#x27;)&quot;</span><br><span class="line">%chkapp% do (if defined applist (call set &quot;applist=!applist! %%a&quot;) else (call set &quot;applist=%%a&quot;))</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::  Get Activation IDs from licensing files if not found through WMI</span><br><span class="line"></span><br><span class="line">:getactivationid:</span><br><span class="line">$folderPath = &quot;$env:windir\System32\spp\tokens\skus&quot;</span><br><span class="line">$files = Get-ChildItem -Path $folderPath -Recurse -Filter &quot;*.xrm-ms&quot;</span><br><span class="line">$guids = @()</span><br><span class="line">foreach ($file in $files) &#123;</span><br><span class="line">    $content = Get-Content -Path $file.FullName -Raw</span><br><span class="line">    $matches = [regex]::Matches($content, &#x27;name=&quot;productSkuId&quot;&gt;\&#123;([0-9a-fA-F\-]+)\&#125;&#x27;)</span><br><span class="line">    foreach ($match in $matches) &#123;</span><br><span class="line">        $guids += $match.Groups[1].Value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$guids = $guids | Select-Object -Unique</span><br><span class="line">$guidsString = $guids -join &quot; &quot;</span><br><span class="line">$guidsString</span><br><span class="line">:getactivationid:</span><br><span class="line"></span><br><span class="line">::  Check wmic.exe</span><br><span class="line"></span><br><span class="line">:dk_ckeckwmic</span><br><span class="line"></span><br><span class="line">set _wmic=0</span><br><span class="line">for %%# in (wmic.exe) do @if not &quot;%%~$PATH:#&quot;==&quot;&quot; (</span><br><span class="line">wmic path Win32_ComputerSystem get CreationClassName /value %nul2% | find /i &quot;computersystem&quot; %nul1% &amp;&amp; set _wmic=1</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::  Get Product name (WMI/REG methods are not reliable in all conditions, hence winbrand.dll method is used)</span><br><span class="line"></span><br><span class="line">:dk_product</span><br><span class="line"></span><br><span class="line">call :dk_reflection</span><br><span class="line"></span><br><span class="line">set d1=%ref% $meth = $TypeBuilder.DefinePInvokeMethod(&#x27;BrandingFormatString&#x27;, &#x27;winbrand.dll&#x27;, &#x27;Public, Static&#x27;, 1, [String], @([String]), 1, 3);</span><br><span class="line">set d1=%d1% $meth.SetImplementationFlags(128); $TypeBuilder.CreateType()::BrandingFormatString(&#x27;%%WINDOWS_LONG%%&#x27;)</span><br><span class="line"></span><br><span class="line">set winos=</span><br><span class="line">for /f &quot;delims=&quot; %%s in (&#x27;&quot;%psc% %d1%&quot;&#x27;) do if not errorlevel 1 (set winos=%%s)</span><br><span class="line">echo &quot;%winos%&quot; | find /i &quot;Windows&quot; %nul1% || (</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; /v ProductName %nul6%&#x27;) do set &quot;winos=%%b&quot;</span><br><span class="line">if %winbuild% GEQ 22000 (</span><br><span class="line">set winos=!winos:Windows 10=Windows 11!</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::  Common lines used in PowerShell reflection code</span><br><span class="line"></span><br><span class="line">:dk_reflection</span><br><span class="line"></span><br><span class="line">set ref=$AssemblyBuilder = [AppDomain]::CurrentDomain.DefineDynamicAssembly(4, 1);</span><br><span class="line">set ref=%ref% $ModuleBuilder = $AssemblyBuilder.DefineDynamicModule(2, $False);</span><br><span class="line">set ref=%ref% $TypeBuilder = $ModuleBuilder.DefineType(0);</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:dk_errorcheck</span><br><span class="line"></span><br><span class="line">set showfix=</span><br><span class="line"></span><br><span class="line">::  Check corrupt services</span><br><span class="line"></span><br><span class="line">set serv_cor=</span><br><span class="line">for %%# in (%_serv%) do (</span><br><span class="line">set _corrupt=</span><br><span class="line">sc start %%# %nul%</span><br><span class="line">if !errorlevel! EQU 1060 set _corrupt=1</span><br><span class="line">sc query %%# %nul% || set _corrupt=1</span><br><span class="line">for %%G in (DependOnService Description DisplayName ErrorControl ImagePath ObjectName Start Type) do if not defined _corrupt (reg query HKLM\SYSTEM\CurrentControlSet\Services\%%# /v %%G %nul% || set _corrupt=1)</span><br><span class="line">if defined _corrupt (if defined serv_cor (set &quot;serv_cor=!serv_cor! %%#&quot;) else (set &quot;serv_cor=%%#&quot;))</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined serv_cor (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Checking Corrupt Services               [%serv_cor%]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check disabled services</span><br><span class="line"></span><br><span class="line">set serv_ste=</span><br><span class="line">for %%# in (%_serv%) do (</span><br><span class="line">sc start %%# %nul%</span><br><span class="line">if !errorlevel! EQU 1058 (if defined serv_ste (set &quot;serv_ste=!serv_ste! %%#&quot;) else (set &quot;serv_ste=%%#&quot;))</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::  Change disabled services startup type to default</span><br><span class="line"></span><br><span class="line">set serv_csts=</span><br><span class="line">set serv_cste=</span><br><span class="line"></span><br><span class="line">if defined serv_ste (</span><br><span class="line">for %%# in (%serv_ste%) do (</span><br><span class="line">if /i %%#==ClipSVC        (reg add &quot;HKLM\SYSTEM\CurrentControlSet\Services\%%#&quot; /v &quot;Start&quot; /t REG_DWORD /d &quot;3&quot; /f %nul% &amp; sc config %%# start= demand %nul%)</span><br><span class="line">if /i %%#==wlidsvc        sc config %%# start= demand %nul%</span><br><span class="line">if /i %%#==sppsvc         (reg add &quot;HKLM\SYSTEM\CurrentControlSet\Services\%%#&quot; /v &quot;Start&quot; /t REG_DWORD /d &quot;2&quot; /f %nul% &amp; sc config %%# start= delayed-auto %nul%)</span><br><span class="line">if /i %%#==KeyIso         sc config %%# start= demand %nul%</span><br><span class="line">if /i %%#==LicenseManager sc config %%# start= demand %nul%</span><br><span class="line">if /i %%#==Winmgmt        sc config %%# start= auto %nul%</span><br><span class="line">if /i %%#==wuauserv       sc config %%# start= demand %nul%</span><br><span class="line">if !errorlevel!==0 (</span><br><span class="line">if defined serv_csts (set &quot;serv_csts=!serv_csts! %%#&quot;) else (set &quot;serv_csts=%%#&quot;)</span><br><span class="line">) else (</span><br><span class="line">if defined serv_cste (set &quot;serv_cste=!serv_cste! %%#&quot;) else (set &quot;serv_cste=%%#&quot;)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined serv_csts call :dk_color %Gray% &quot;Enabling Disabled Services              [成功] [%serv_csts%]&quot;</span><br><span class="line"></span><br><span class="line">if defined serv_cste (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Enabling Disabled Services              [失败] [%serv_cste%]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check if the services are able to run or not</span><br><span class="line">::  Workarounds are added to get correct status and error code because sc query doesn&#x27;t output correct results in some conditions</span><br><span class="line"></span><br><span class="line">set serv_e=</span><br><span class="line">for %%# in (%_serv%) do (</span><br><span class="line">set errorcode=</span><br><span class="line">set checkerror=</span><br><span class="line">net start %%# /y %nul%</span><br><span class="line">set errorcode=!errorlevel!</span><br><span class="line">sc query %%# | find /i &quot;RUNNING&quot; %nul% || set checkerror=1</span><br><span class="line"></span><br><span class="line">sc start %%# %nul%</span><br><span class="line">if !errorlevel! NEQ 1056 if !errorlevel! NEQ 0 (set errorcode=!errorlevel!&amp;set checkerror=1)</span><br><span class="line">if defined checkerror if defined serv_e (set &quot;serv_e=!serv_e!, %%#-!errorcode!&quot;) else (set &quot;serv_e=%%#-!errorcode!&quot;)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined serv_e (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Starting Services                       [失败] [%serv_e%]&quot;</span><br><span class="line">echo %serv_e% | findstr /i &quot;ClipSVC-1058 sppsvc-1058&quot; %nul% &amp;&amp; (</span><br><span class="line">call :dk_color %Blue% &quot;Restart the system to fix disabled service error 1058.&quot;</span><br><span class="line">set showfix=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Various error checks</span><br><span class="line"></span><br><span class="line">if defined safeboot_option (</span><br><span class="line">set error=1</span><br><span class="line">set showfix=1</span><br><span class="line">call :dk_color2 %Red% &quot;Checking Boot Mode                      &quot; %Blue% &quot;[System is running in safe mode. Run in normal mode.]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Setup\State&quot; %nul2% | find /i &quot;IMAGE_STATE_COMPLETE&quot; %nul1% || (</span><br><span class="line">set error=1</span><br><span class="line">set showfix=1</span><br><span class="line">call :dk_color2 %Red% &quot;Checking Audit Mode                     &quot; %Blue% &quot;[IMAGE_STATE_COMPLETE status not found. Run in normal mode.]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WinPE&quot; /v InstRoot %nul% &amp;&amp; (</span><br><span class="line">set error=1</span><br><span class="line">set showfix=1</span><br><span class="line">call :dk_color2 %Red% &quot;Checking WinPE                          &quot; %Blue% &quot;[System is running in WinPE mode. Run in normal mode.]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">%psc% $ExecutionContext.SessionState.LanguageMode %nul2% | find /i &quot;Full&quot; %nul1% || (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Checking Powershell                     [Not Responding]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DISM /English /Online /Get-CurrentEdition %nul%</span><br><span class="line">set dism_error=%errorlevel%</span><br><span class="line">cmd /c exit /b %dism_error%</span><br><span class="line">if %dism_error% NEQ 0 set &quot;dism_error=[0x%=ExitCode%]&quot;</span><br><span class="line">if %dism_error% NEQ 0 (</span><br><span class="line">call :dk_color %Red% &quot;Checking DISM                           [Not Responding] %dism_error%&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if not defined officeact if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-*EvalEdition~*.mum&quot; (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Checking Eval Packages                  [Non-Eval Licenses are installed in Eval Windows]&quot;</span><br><span class="line">if /i %dism_error%==[0x800F0805] (</span><br><span class="line">for %%# in (4 125 126 188 191 205) do if &quot;%osSKU%&quot;==&quot;%%#&quot; (</span><br><span class="line">call :dk_color %Blue% &quot;Evaluation Windows can not be activated and different License install may lead to errors.&quot;</span><br><span class="line">call :dk_color %Blue% &quot;It is recommended to install full version of %winos%.&quot;</span><br><span class="line">call :dk_color %Blue% &quot;You can download it from %mas%genuine-installation-media.html&quot;</span><br><span class="line">set showfix=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cscript //nologo %windir%\system32\slmgr.vbs /dlv %nul%</span><br><span class="line">set error_code=%errorlevel%</span><br><span class="line">cmd /c exit /b %error_code%</span><br><span class="line">if %error_code% NEQ 0 set &quot;error_code=0x%=ExitCode%&quot;</span><br><span class="line">if %error_code% NEQ 0 (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Checking slmgr /dlv                     [Not Responding] %error_code%&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for %%# in (wmic.exe) do @if &quot;%%~$PATH:#&quot;==&quot;&quot; (</span><br><span class="line">call :dk_color %Gray% &quot;Checking WMIC.exe                       [Not Found]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">set wmifailed=</span><br><span class="line">if %_wmic% EQU 1 wmic path Win32_ComputerSystem get CreationClassName /value %nul2% | find /i &quot;computersystem&quot; %nul1%</span><br><span class="line">if %_wmic% EQU 0 %psc% &quot;Get-CIMInstance -Class Win32_ComputerSystem | Select-Object -Property CreationClassName&quot; %nul2% | find /i &quot;computersystem&quot; %nul1%</span><br><span class="line"></span><br><span class="line">if %errorlevel% NEQ 0 set wmifailed=1</span><br><span class="line">echo &quot;%error_code%&quot; | findstr /i &quot;0x800410 0x800440&quot; %nul1% &amp;&amp; set wmifailed=1&amp; ::  https://learn.microsoft.com/en-us/windows/win32/wmisdk/wmi-error-constants</span><br><span class="line">if defined wmifailed (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Checking WMI                            [Not Responding]&quot;</span><br><span class="line">call :dk_color %Blue% &quot;在 MAS 中，转到故障排除并运行修复 WMI 选项。&quot;</span><br><span class="line">set showfix=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">%nul% set /a &quot;sum=%slcSKU%+%regSKU%+%wmiSKU%&quot;</span><br><span class="line">set /a &quot;sum/=3&quot;</span><br><span class="line">if not defined officeact if not &quot;%sum%&quot;==&quot;%slcSKU%&quot; (</span><br><span class="line">call :dk_color %Red% &quot;Checking SLC/WMI/REG SKU                [Difference Found - SLC:%slcSKU% WMI:%wmiSKU% Reg:%regSKU%]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">reg query &quot;HKU\S-1-5-20\Software\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\PersistedTSReArmed&quot; %nul% &amp;&amp; (</span><br><span class="line">set error=1</span><br><span class="line">set showfix=1</span><br><span class="line">call :dk_color2 %Red% &quot;Checking Rearm                          &quot; %Blue% &quot;[System Restart Is Required]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ClipSVC\Volatile\PersistedSystemState&quot; %nul% &amp;&amp; (</span><br><span class="line">set error=1</span><br><span class="line">set showfix=1</span><br><span class="line">call :dk_color2 %Red% &quot;Checking ClipSVC                        &quot; %Blue% &quot;[System Restart Is Required]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform&quot; /v &quot;SkipRearm&quot; %nul6%&#x27;) do if /i %%b NEQ 0x0 (</span><br><span class="line">reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform&quot; /v &quot;SkipRearm&quot; /t REG_DWORD /d &quot;0&quot; /f %nul%</span><br><span class="line">call :dk_color %Red% &quot;Checking SkipRearm                      [Default 0 Value Not Found. Changing To 0]&quot;</span><br><span class="line">net stop sppsvc /y %nul%</span><br><span class="line">net start sppsvc /y %nul%</span><br><span class="line">set error=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\Plugins\Objects\msft:rm/algorithm/hwid/4.0&quot; /f ba02fed39662 /d %nul% || (</span><br><span class="line">call :dk_color %Red% &quot;Checking SPP Registry Key               [Incorrect ModuleId Found]&quot;</span><br><span class="line">call :dk_color %Blue% &quot;Possibly Caused By Gaming Spoofers. Help: %mas%troubleshoot&quot;</span><br><span class="line">set error=1</span><br><span class="line">set showfix=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">set tokenstore=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform&quot; /v TokenStore %nul6%&#x27;) do call set &quot;tokenstore=%%b&quot;</span><br><span class="line">if not exist &quot;%tokenstore%\&quot; (</span><br><span class="line">set error=1</span><br><span class="line">REM This code creates token folder only if it&#x27;s missing and sets default permission for it</span><br><span class="line">mkdir &quot;%tokenstore%&quot; %nul%</span><br><span class="line">set &quot;d=$sddl = &#x27;O:BAG:BAD:PAI(A;OICI;FA;;;SY)(A;OICI;FA;;;BA)(A;OICIIO;GR;;;BU)(A;;FR;;;BU)(A;OICI;FA;;;S-1-5-80-123231216-2592883651-3715271367-3753151631-4175906628)&#x27;;&quot;</span><br><span class="line">set &quot;d=!d! $AclObject = New-Object System.Security.AccessControl.DirectorySecurity;&quot;</span><br><span class="line">set &quot;d=!d! $AclObject.SetSecurityDescriptorSddlForm($sddl);&quot;</span><br><span class="line">set &quot;d=!d! Set-Acl -Path %tokenstore% -AclObject $AclObject;&quot;</span><br><span class="line">%psc% &quot;!d!&quot; %nul%</span><br><span class="line">call :dk_color %Gray% &quot;Checking SPP Token Folder               [Not Found. Creating Now] [%tokenstore%\]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">call :dk_actids</span><br><span class="line">if not defined applist (</span><br><span class="line">net stop sppsvc /y %nul%</span><br><span class="line">cscript //nologo %windir%\system32\slmgr.vbs /rilc %nul%</span><br><span class="line">if !errorlevel! NEQ 0 cscript //nologo %windir%\system32\slmgr.vbs /rilc %nul%</span><br><span class="line">call :dk_refresh</span><br><span class="line">call :dk_actids</span><br><span class="line">if not defined applist (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Checking Activation IDs                 [Not Found]&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if exist &quot;%tokenstore%\&quot; if not exist &quot;%tokenstore%\tokens.dat&quot; (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Checking SPP tokens.dat                 [Not Found] [%tokenstore%\]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if not exist %SystemRoot%\system32\sppsvc.exe (</span><br><span class="line">set error=1</span><br><span class="line">set showfix=1</span><br><span class="line">call :dk_color %Red% &quot;Checking sppsvc.exe File                [Not Found]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">::  Below checks are performed if required services are not disabled or corrupted + if there is any error + slmgr /dlv errorlevel is not Zero + no fix was shown before</span><br><span class="line"></span><br><span class="line">set wpaerror=</span><br><span class="line">set permerror=</span><br><span class="line">if not defined serv_cor if not defined serv_cste if defined error if /i not %error_code%==0 if not defined showfix (</span><br><span class="line"></span><br><span class="line">REM  This code checks for invalid registry keys in HKLM\SYSTEM\WPA. This issue may appear even on healthy systems.</span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 14393 (</span><br><span class="line">set /a count=0</span><br><span class="line">for /f %%a in (&#x27;reg query &quot;HKLM\SYSTEM\WPA&quot; %nul6%&#x27;) do set /a count+=1</span><br><span class="line">for /L %%# in (1,1,!count!) do (</span><br><span class="line">reg query &quot;HKLM\SYSTEM\WPA\8DEC0AF1-0341-4b93-85CD-72606C2DF94C-7P-%%#&quot; /ve /t REG_BINARY %nul% || set wpaerror=1</span><br><span class="line">)</span><br><span class="line">if defined wpaerror call :dk_color %Red% &quot;Checking WPA Registry Keys              [Error Found] [Registry Count - !count!]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">REM  This code checks if NT SERVICE\sppsvc has permission access to tokens folder and required registry keys. It&#x27;s often caused by gaming spoofers. </span><br><span class="line"></span><br><span class="line">if not exist &quot;%tokenstore%\&quot; set permerror=1</span><br><span class="line"></span><br><span class="line">for %%# in (</span><br><span class="line">&quot;%tokenstore%&quot;</span><br><span class="line">&quot;HKLM:\SYSTEM\WPA&quot;</span><br><span class="line">&quot;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform&quot;</span><br><span class="line">) do if not defined permerror (</span><br><span class="line">%psc% &quot;$acl = Get-Acl &#x27;%%#&#x27;; if ($acl.Access.Where&#123; $_.IdentityReference -eq &#x27;NT SERVICE\sppsvc&#x27; -and $_.AccessControlType -eq &#x27;Deny&#x27; -or $acl.Access.IdentityReference -notcontains &#x27;NT SERVICE\sppsvc&#x27;&#125;) &#123;Exit 2&#125;&quot; %nul%</span><br><span class="line">if !errorlevel!==2 set permerror=1</span><br><span class="line">)</span><br><span class="line">if defined permerror call :dk_color %Red% &quot;Checking SPP Permissions                [Error Found]&quot;</span><br><span class="line"></span><br><span class="line">set showfix=1</span><br><span class="line">call :dk_color %Blue% &quot;%_fixmsg%&quot;</span><br><span class="line">if not defined permerror call :dk_color %Blue% &quot;If activation still fails then run Fix WPA Registry option.&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:dk_color</span><br><span class="line"></span><br><span class="line">if %_NCS% EQU 1 (</span><br><span class="line">echo %esc%[%~1%~2%esc%[0m</span><br><span class="line">) else (</span><br><span class="line">%psc% write-host -back &#x27;%1&#x27; -fore &#x27;%2&#x27; &#x27;%3&#x27;</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:dk_color2</span><br><span class="line"></span><br><span class="line">if %_NCS% EQU 1 (</span><br><span class="line">echo %esc%[%~1%~2%esc%[%~3%~4%esc%[0m</span><br><span class="line">) else (</span><br><span class="line">%psc% write-host -back &#x27;%1&#x27; -fore &#x27;%2&#x27; &#x27;%3&#x27; -NoNewline; write-host -back &#x27;%4&#x27; -fore &#x27;%5&#x27; &#x27;%6&#x27;</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:dk_done</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if %_unattended%==1 timeout /t 2 &amp; exit /b</span><br><span class="line">call :dk_color %_Yellow% &quot;Press any key to %_exitmsg%...&quot;</span><br><span class="line">pause %nul1%</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  1st column = Activation ID</span><br><span class="line">::  2nd column = Generic Retail/OEM/MAK Key</span><br><span class="line">::  3rd column = SKU ID</span><br><span class="line">::  4th column = Key part number</span><br><span class="line">::  5th column = Ticket signature value. It&#x27;s as it is, it&#x27;s not encoded. (Check mass grave[.]dev/hwid.html#Manual_Activation to see how it&#x27;s generated)</span><br><span class="line">::  6th column = 1 = activation is not working (at the time of writing this), 0 = activation is working</span><br><span class="line">::  7th column = Key Type</span><br><span class="line">::  8th column = WMI Edition ID (For reference only)</span><br><span class="line">::  9th column = Version name incase same Edition ID is used in different OS versions with different key</span><br><span class="line">::  Separator  = _</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:hwiddata</span><br><span class="line"></span><br><span class="line">set f=</span><br><span class="line">for %%# in (</span><br><span class="line">8b351c9c-f398-4515-9900-09df49427262_XGV%f%PP-NM%f%H47-7TT%f%HJ-W3%f%FW7-8H%f%V2C___4_X19-99683_HGNKjkKcKQHO6n8srMUrDh/MElffBZarLqCMD9rWtgFKf3YzYOLDPEMGhuO/auNMKCeiU7ebFbQALS/MyZ7TvidMQ2dvzXeXXKzPBjfwQx549WJUU7qAQ9Txg9cR9SAT8b12Pry2iBk+nZWD9VtHK3kOnEYkvp5WTCTsrSi6Re4_0_OEM:NONSLP_Enterprise</span><br><span class="line">c83cef07-6b72-4bbc-a28f-a00386872839_3V6%f%Q6-NQ%f%XCX-V8Y%f%XR-9Q%f%CYV-QP%f%FCT__27_X19-98746_NHn2n0N1UfVf00CfaI5LCDMDsKdVAWpD/HAfUrcTAKsw9d2Sks4h5MhyH/WUx+B6dFi8ol7D3AHorR8y9dqVS1Bd2FdZNJl/tTR1PGwYn6KL88NS19aHmFNdX8s4438vaa+Ty8Qk8EDcwm/wscC8lQmi3/RgUKYdyGFvpbGSVlk_0_Volume:MAK_EnterpriseN</span><br><span class="line">4de7cb65-cdf1-4de9-8ae8-e3cce27b9f2c_VK7%f%JG-NP%f%HTM-C97%f%JM-9M%f%PGT-3V%f%66T__48_X19-98841_Yl/jNfxJ1SnaIZCIZ4m6Pf3ySNoQXifNeqfltNaNctx+onwiivOx7qcSn8dFtURzgMzSOFnsRQzb5IrvuqHoxWWl1S3JIQn56FvKsvSx7aFXIX3+2Q98G1amPV/WEQ0uHA5d7Ya6An+g0Z0zRP7evGoomTs4YuweaWiZQjQzSpA_0_____Retail_Professional</span><br><span class="line">9fbaf5d6-4d83-4422-870d-fdda6e5858aa_2B8%f%7N-8K%f%FHP-DKV%f%6R-Y2%f%C8J-PK%f%CKT__49_X19-98859_Ge0mRQbW8ALk7T09V+1k1yg66qoS0lhkgPIROOIOgxKmWPAvsiLAYPKDqM4+neFCA/qf1dHFmdh0VUrwFBPYsK251UeWuElj4bZFVISL6gUt1eZwbGfv5eurQ0i+qZiFv+CcQOEFsd5DD4Up6xPLLQS3nAXODL5rSrn2sHRoCVY_0_____Retail_ProfessionalN</span><br><span class="line">f742e4ff-909d-4fe9-aacb-3231d24a0c58_4CP%f%RK-NM%f%3K3-X6X%f%XQ-RX%f%X86-WX%f%CHW__98_X19-98877_vel4ytVtnE8FhvN87Cflz9sbh5QwHD1YGOeej9QP7hF3vlBR4EX2/S/09gRneeXVbQnjDOCd2KFMKRUWHLM7ZhFBk8AtlG+kvUawPZ+CIrwrD3mhi7NMv8UX/xkLK3HnBupMEuEwsMJgCUD8Pn6om1mEiQebHBAqu4cT7GN9Y0g_0_____Retail_CoreN</span><br><span class="line">1d1bac85-7365-4fea-949a-96978ec91ae0_N24%f%34-X9%f%D7W-8PF%f%6X-8D%f%V9T-8T%f%YMD__99_X19-99652_Nv17eUTrr1TmUX6frlI7V69VR6yWb7alppCFJPcdjfI+xX4/Cf2np3zm7jmC+zxFb9nELUs477/ydw2KCCXFfM53bKpBQZKHE5+MdGJGxebOCcOtJ3hrkDJtwlVxTQmUgk5xnlmpk8PHg82M2uM5B7UsGLxGKK4d3hi0voSyKeI_0_____Retail_CoreCountrySpecific</span><br><span class="line">3ae2cc14-ab2d-41f4-972f-5e20142771dc_BT7%f%9Q-G7%f%N6G-PGB%f%YW-4Y%f%WX6-6F%f%4BT_100_X19-99661_FV2Eao/R5v8sGrfQeOjQ4daokVlNOlqRCDZXuaC45bQd5PsNU3t1b4AwWeYM8TAwbHauzr4tPG0UlsUqUikCZHy0poROx35bBBMBym6Zbm9wDBVyi7nCzBtwS86eOonQ3cU6WfZxhZRze0POdR33G3QTNPrnVIM2gf6nZJYqDOA_0_____Retail_CoreSingleLanguage</span><br><span class="line">2b1f36bb-c1cd-4306-bf5c-a0367c2d97d8_YTM%f%G3-N6%f%DKC-DKB%f%77-7M%f%9GH-8H%f%VX7_101_X19-98868_GH/jwFxIcdQhNxJIlFka8c1H48PF0y7TgJwaryAUzqSKXynONLw7MVciDJFVXTkCjbXSdxLSWpPIC50/xyy1rAf8aC7WuN/9cRNAvtFPC1IVAJaMeq1vf4mCqRrrxJQP6ZEcuAeHFzLe/LLovGWCd8rrs6BbBwJXCvAqXImvycQ_0_____Retail_Core</span><br><span class="line">2a6137f3-75c0-4f26-8e3e-d83d802865a4_XKC%f%NC-J2%f%6Q9-KFH%f%D2-FK%f%THY-KD%f%72Y_119_X19-99606_hci78IRWDLBtdbnAIKLDgV9whYgtHc1uYyp9y6FszE9wZBD5Nc8CUD2pI2s2RRd3M04C4O7M3tisB3Ov/XVjpAbxlX3MWfUR5w4MH0AphbuQX0p5MuHEDYyfqlRgBBRzOKePF06qfYvPQMuEfDpKCKFwNojQxBV8O0Arf5zmrIw_0_OEM:NONSLP_PPIPro</span><br><span class="line">e558417a-5123-4f6f-91e7-385c1c7ca9d4_YNM%f%GQ-8R%f%YV3-4PG%f%Q3-C8%f%XTP-7C%f%FBY_121_X19-98886_x9tPFDZmjZMf29zFeHV5SHbXj8Wd8YAcCn/0hbpLcId4D7OWqkQKXxXHIegRlwcWjtII0sZ6WYB0HQV2KH3LvYRnWKpJ5SxeOgdzBIJ6fhegYGGyiXsBv9sEb3/zidPU6ZK9LugVGAcRZ6HQOiXyOw+Yf5H35iM+2oDZXSpjvJw_0_____Retail_Education</span><br><span class="line">c5198a66-e435-4432-89cf-ec777c9d0352_84N%f%GF-MH%f%BT6-FXB%f%X8-QW%f%JK7-DR%f%R8H_122_X19-98892_jkL4YZkmBCJtvL1fT30ZPBcjmzshBSxjwrE0Q00AZ1hYnhrH+npzo1MPCT6ZRHw19ZLTz7wzyBb0qqcBVbtEjZW0Xs2MYLxgriyoONkhnPE6KSUJBw7C0enFVLHEqnVu/nkaOFfockN3bc+Eouw6W2lmHjklPHc9c6Clo04jul0_0_____Retail_EducationN</span><br><span class="line">f6e29426-a256-4316-88bf-cc5b0f95ec0c_PJB%f%47-8P%f%N2T-MCG%f%DY-JT%f%Y3D-CB%f%CPV_125_X23-50331_OPGhsyx+Ctw7w/KLMRNrY+fNBmKPjUG0R9RqkWk4e8ez+ExSJxSLLex5WhO5QSNgXLmEra+cCsN6C638aLjIdH2/L7D+8z/C6EDgRvbHMmidHg1lX3/O8lv0JudHkGtHJYewjorn/xXGY++vOCTQdZNk6qzEgmYSvPehKfdg8js_1_Volume:MAK_EnterpriseS_Ge</span><br><span class="line">cce9d2de-98ee-4ce2-8113-222620c64a27_KCN%f%VH-YK%f%WX8-GJJ%f%B9-H9%f%FDT-6F%f%7W2_125_X22-66075_GCqWmJOsTVun9z4QkE9n2XqBvt3ZWSPl9QmIh9Q2mXMG/QVt2IE7S+ES/NWlyTSNjLVySr1D2sGjxgEzy9kLwn7VENQVJ736h1iOdMj/3rdqLMSpTa813+nPSQgKpqJ3uMuvIvRP0FdB7Y4qt8qf9kNKK25A1QknioD/6YubL/4_1_Volume:MAK_EnterpriseS_VB</span><br><span class="line">d06934ee-5448-4fd1-964a-cd077618aa06_43T%f%BQ-NH%f%92J-XKT%f%M7-KT%f%3KK-P3%f%9PB_125_X21-83233_EpB6qOCo8pRgO5kL4vxEHck2J1vxyd9OqvxUenDnYO9AkcGWat/D74ZcFg5SFlIya1U8l5zv+tsvZ4wAvQ1IaFW1PwOKJLOaGgejqZ41TIMdFGGw+G+s1RHsEnrWr3UOakTodby1aIMUMoqf3NdaM5aWFo8fOmqWC5/LnCoighs_0_OEM:NONSLP_EnterpriseS_RS5</span><br><span class="line">706e0cfd-23f4-43bb-a9af-1a492b9f1302_NK9%f%6Y-D9%f%CD8-W44%f%CQ-R8%f%YTK-DY%f%JWX_125_X21-05035_ntcKmazIvLpZOryft28gWBHu1nHSbR+Gp143f/BiVe+BD2UjHBZfSR1q405xmQZsygz6VRK6+zm8FPR++71pkmArgCLhodCQJ5I4m7rAJNw/YX99pILphi1yCRcvHsOTGa825GUVXgf530tHT6hr0HQ1lGeGgG1hPekpqqBbTlg_0_OEM:NONSLP_EnterpriseS_RS1</span><br><span class="line">faa57748-75c8-40a2-b851-71ce92aa8b45_FWN%f%7H-PF%f%93Q-4GG%f%P8-M8%f%RF3-MD%f%WWW_125_X19-99617_Fe9CDClilrAmwwT7Yhfx67GafWRQEpwyj8R+a4eaTqbpPcAt7d1hv1rx8Sa9AzopEGxIrb7IhiPoDZs0XaT1HN0/olJJ/MnD73CfBP4sdQdLTsSJE3dKMWYTQHpnjqRaS/pNBYRr8l9Mv8yfcP8uS2MjIQ1cRTqRmC7WMpShyCg_0_OEM:NONSLP_EnterpriseS_TH</span><br><span class="line">837766ff-61c5-427d-87c3-a2acbd44767a_XFC%f%77-XN%f%RXM-2Q3%f%6W-FC%f%M9T-YH%f%DJ9_126_X23-50304_h6V6Q4DL/hlvcD3GyVxrVfP1BEL4a5TdyNCMlbq/OZnky/HowuRAcHMpN59fwqLS98+7WEDooWCrxriXcATwo0fwOGs/fEfP/Pa5SKP+Xnng1eoPm1PkjuZaqA8p2dPQv32wJ0u3QW7VMQM9BzzpyqtNAsqNS/wl7vfN7tyLbDo_1_Volume:MAK_EnterpriseSN_Ge</span><br><span class="line">2c060131-0e43-4e01-adc1-cf5ad1100da8_RQF%f%NW-9T%f%PM3-JQ7%f%3T-QV%f%4VQ-DV%f%9PT_126_X22-66108_w/HFPDNCz4EogszDYZ8xUJh8aylfpgh6gzm9k8JSteprY5UumLc5n6KUwiSE3/5NaiI9gZ3xmTJq+g1OSPsdGwhuA+8LA2pQhA+wU8VO/ZaYxe1T4WF6oip/c0n6xA1sx/mWYNwd/WBDJpslTw5NRNLc5wWh0FV5RtxCaXE07lM_1_Volume:MAK_EnterpriseSN_VB</span><br><span class="line">e8f74caa-03fb-4839-8bcc-2e442b317e53_M33%f%WV-NH%f%Y3C-R7F%f%PM-BQ%f%GPT-23%f%9PG_126_X21-83264_Fl7tjifybEI9hArxMVFKqIqmI6mrCZy4EtJyVjpo2eSfeMTBli55+E0i2AaPfE2FJknUig7HuiNC1Pu2IWZcj5ShVFQEKPY6K//RucX8oPQfh0zK5r1aNJNvV4gMlqvOyGD8sXttLBZv8wg1w/++cNk/z38DE2shiDf7LYnK4w0_1_Volume:MAK_EnterpriseSN_RS5</span><br><span class="line">3d1022d8-969f-4222-b54b-327f5a5af4c9_2DB%f%W3-N2%f%PJG-MVH%f%W3-G7%f%TDK-9H%f%KR4_126_X21-04921_zLPNvcl1iqOefy0VLg+WZgNtRNhuGpn8+BFKjMqjaNOSKiuDcR6GNDS5FF1Aqk6/e6shJ+ohKzuwrnmYq3iNQ3I2MBlYjM5kuNfKs8Vl9dCjSpQr//GBGps6HtF2xrG/2g/yhtYC7FbtGDIE16uOeNKFcVg+XMb0qHE/5Etyfd8_0_Volume:MAK_EnterpriseSN_RS1</span><br><span class="line">60c243e1-f90b-4a1b-ba89-387294948fb6_NTX%f%6B-BR%f%YC2-K67%f%86-F6%f%MVQ-M7%f%V2X_126_X19-98770_kbXfe0z9Vi1S0yfxMWzI5+UtWsJKzxs7wLGUDLjrckFDn1bDQb4MvvuCK1w+Qrq33lemiGpNDspa+ehXiYEeSPFcCvUBpoMlGBFfzurNCHWiv3o1k3jBoawJr/VoDoVZfxhkps0fVoubf9oy6C6AgrkZ7PjCaS58edMcaUWvYYg_0_Volume:MAK_EnterpriseSN_TH</span><br><span class="line">01eb852c-424d-4060-94b8-c10d799d7364_3XP%f%6D-CR%f%ND4-DRY%f%M2-GM%f%84D-4G%f%G8Y_139_X23-37869_PVW0XnRJnsWYjTqxb6StCi2tge/uUwegjdiFaFUiZpwdJ620RK+MIAsSq5S+egXXzIWNntoy2fB6BO8F1wBFmxP/mm/3rn5C33jtF5QrbNqY7X9HMbqSiC7zhs4v4u2Xa4oZQx8JQkwr8Q2c/NgHrOJKKRASsSckhunxZ+WVEuM_1_____Retail_ProfessionalCountrySpecific_Zn</span><br><span class="line">eb6d346f-1c60-4643-b960-40ec31596c45_DXG%f%7C-N3%f%6C4-C4H%f%TG-X4%f%T3X-2Y%f%V77_161_X21-43626_MaVqTkRrGnOqYizl15whCOKWzx01+BZTVAalvEuHXM+WV55jnIfhWmd/u1GqCd5OplqXdU959zmipK2Iwgu2nw/g91nW//sQiN/cUcvg1Lxo6pC3gAo1AjTpHmGIIf9XlZMYlD+Vl6gXsi/Auwh3yrSSFh5s7gOczZoDTqQwHXA_0_____Retail_ProfessionalWorkstation</span><br><span class="line">89e87510-ba92-45f6-8329-3afa905e3e83_WYP%f%NQ-8C%f%467-V2W%f%6J-TX%f%4WX-WT%f%2RQ_162_X21-43644_JVGQowLiCcPtGY9ndbBDV+rTu/q5ljmQTwQWZgBIQsrAeQjLD8jLEk/qse7riZ7tMT6PKFVNXeWqF7PhLAmACbE8O3Lvp65XMd/Oml9Daynj5/4n7unsffFHIHH8TGyO5j7xb4dkFNqC5TX3P8/1gQEkTIdZEOTQQXFu0L2SP5c_0_____Retail_ProfessionalWorkstationN</span><br><span class="line">62f0c100-9c53-4e02-b886-a3528ddfe7f6_8PT%f%T6-RN%f%W4C-6V7%f%J2-C2%f%D3X-MH%f%BPB_164_X21-04955_CEDgxI8f/fxMBiwmeXw5Of55DG32sbGALzHihXkdbYTDaE3pY37oAA4zwGHALzAFN/t254QImGPYR6hATgl+Cp804f7serJqiLeXY965Zy67I4CKIMBm49lzHLFJeDnVTjDB0wVyN29pvgO3+HLhZ22KYCpkRHFFMy2OKxS68Yc_0_____Retail_ProfessionalEducation</span><br><span class="line">13a38698-4a49-4b9e-8e83-98fe51110953_GJT%f%YN-HD%f%MQY-FRR%f%76-HV%f%GC7-QP%f%F8P_165_X21-04956_r35zp9OfxKSBcTxKWon3zFtbOiCufAPo6xRGY5DJqCRFKdB0jgZalNQitvjmaZ/Rlez2vjRJnEart4LrvyW4d9rrukAjR3+c3UkeTKwoD3qBl9AdRJbXCa2BdsoXJs1WVS4w4LuVzpB/SZDuggZt0F2DlMB427F5aflook/n1pY_0_____Retail_ProfessionalEducationN</span><br><span class="line">df96023b-dcd9-4be2-afa0-c6c871159ebe_NJC%f%F7-PW%f%8QT-332%f%4D-68%f%8JX-2Y%f%V66_175_X21-41295_rVpetYUmiRB48YJfCvJHiaZapJ0bO8gQDRoql+rq5IobiSRu//efV1VXqVpBkwILQRKgKIVONSTUF5y2TSxlDLbDSPKp7UHfbz17g6vRKLwOameYEz0ZcK3NTbApN/cMljHvvF/mBag1+sHjWu+eoFzk8H89k9nw8LMeVOPJRDc_0_____Retail_ServerRdsh</span><br><span class="line">d4ef7282-3d2c-4cf0-9976-8854e64a8d1e_V3W%f%VW-N2%f%PV2-CGW%f%C3-34%f%QGF-VM%f%J2C_178_X21-32983_Xzme9hDZR6H0Yx0deURVdE6LiTOkVqWng5W/OTbkxRc0rq+mSYpo/f/yqhtwYlrkBPWx16Yok5Bvcb34vbKHvEAtxfYp4te20uexLzVOtBcoeEozARv4W/6MhYfl+llZtR5efsktj4N4/G4sVbuGvZ9nzNfQO9TwV6NGgGEj2Ec_0_____Retail_Cloud</span><br><span class="line">af5c9381-9240-417d-8d35-eb40cd03e484_NH9%f%J3-68%f%WK7-6FB%f%93-4K%f%3DF-DJ%f%4F6_179_X21-32987_QGRDZOU/VZhYLOSdp2xDnFs8HInNZctcQlWCIrORVnxTQr55IJwN4vK3PJHjkfRLQ/bgUrcEIhyFbANqZFUq8yD1YNubb2bjNORgI/m8u85O9V7nDGtxzO/viEBSWyEHnrzLKKWYqkRQKbbSW3ungaZR0Ti5O2mAUI4HzAFej50_0_____Retail_CloudN</span><br><span class="line">8ab9bdd1-1f67-4997-82d9-8878520837d9_XQQ%f%YW-NF%f%FMW-XJP%f%BH-K8%f%732-CK%f%FFD_188_X21-99378_djy0od0uuKd2rrIl+V1/2+MeRltNgW7FEeTNQsPMkVSL75NBphgoso4uS0JPv2D7Y1iEEvmVq6G842Kyt52QOwXgFWmP/IQ6Sq1dr+fHK/4Et7bEPrrGBEZoCfWqk0kdcZRPBij2KN6qCRWhrk1hX2g+U40smx/EYCLGh9HCi24_0_____OEM:DM_IoTEnterprise</span><br><span class="line">ed655016-a9e8-4434-95d9-4345352c2552_QPM%f%6N-7J%f%2WJ-P88%f%HH-P3%f%YRH-YY%f%74H_191_X21-99682_qHs/PzfhYWdtSys2edzcz4h+Qs8aDqb8BIiQ/mJ/+0uyoJh1fitbRCIgiFh2WAGZXjdgB8hZeheNwHibd8ChXaXg4u+0XlOdFlaDTgTXblji8fjETzDBk9aGkeMCvyVXRuUYhTSdp83IqGHz7XuLwN2p/6AUArx9JZCoLGV8j3w_0_OEM:NONSLP_IoTEnterpriseS_VB</span><br><span class="line">6c4de1b8-24bb-4c17-9a77-7b939414c298_CGK%f%42-GY%f%N6Y-VD2%f%2B-BX%f%98W-J8%f%JXD_191_X23-12617_J/fpIRynsVQXbp4qZNKp6RvOgZ/P2klILUKQguMlcwrBZybwNkHg/kM5LNOF/aDzEktbPnLnX40GEvKkYT6/qP4cMhn/SOY0/hYOkIdR34ilzNlVNq5xP7CMjCjaUYJe+6ydHPK6FpOuEoWOYYP5BZENKNGyBy4w4shkMAw19mA_0_OEM:NONSLP_IoTEnterpriseS_Ge</span><br><span class="line">d4bdc678-0a4b-4a32-a5b3-aaa24c3b0f24_K9V%f%KN-3B%f%GWV-Y62%f%4W-MC%f%RMQ-BH%f%DCD_202_X22-53884_kyoNx2s93U6OUSklB1xn+GXcwCJO1QTEtACYnChi8aXSoxGQ6H2xHfUdHVCwUA1OR0UeNcRrMmOzZBOEUBtdoGWSYPg9AMjvxlxq9JOzYAH+G6lT0UbCWgMSGGrqdcIfmshyEak3aUmsZK6l+uIAFCCZZ/HbbCRkkHC5rWKstMI_0_____Retail_CloudEditionN</span><br><span class="line">92fb8726-92a8-4ffc-94ce-f82e07444653_KY7%f%PN-VR%f%6RX-83W%f%6Y-6D%f%DYQ-T6%f%R4W_203_X22-53847_gD6HnT4jP4rcNu9u83gvDiQq1xs7QSujcDbo60Di5iSVa9/ihZ7nlhnA0eDEZfnoDXriRiPPqc09T6AhSnFxLYitAkOuPJqL5UMobIrab9dwTKlowqFolxoHhLOO4V92Hsvn/9JLy7rEzoiAWHhX/0cpMr3FCzVYPeUW1OyLT1A_0_____Retail_CloudEdition</span><br><span class="line">d4f9b41f-205c-405e-8e08-3d16e88e02be_J7N%f%JW-V6%f%KBM-CC8%f%RW-Y2%f%9Y4-HQ%f%2MJ_205_X23-15027_BjCACpBJMs/qftw+cjNvpXmG+++IzXTMqE5kPCTbWuNZXh/d5OSX8Ii3l2yq6xJAdSiYcALItHttLbBBEJ9H8iBj8STQeYHxdp3xU2k3/5Hoe+dPHwf1Qfg/CBd/AkCpiPqFYvjH9OhxvdUk8GvBGL2p2MrAAU4n+CuISSutZKM_0_OEM:NONSLP_IoTEnterpriseSK</span><br><span class="line">) do (</span><br><span class="line">for /f &quot;tokens=1-9 delims=_&quot; %%A in (&quot;%%#&quot;) do (</span><br><span class="line"></span><br><span class="line">REM Detect key</span><br><span class="line"></span><br><span class="line">if %1==key if %osSKU%==%%C if not defined key (</span><br><span class="line">echo &quot;!applist! !altapplist!&quot; | find /i &quot;%%A&quot; %nul1% &amp;&amp; (</span><br><span class="line">if %%F==1 set notworking=1</span><br><span class="line">set key=%%B</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">REM Generate ticket</span><br><span class="line"></span><br><span class="line">if %1==ticket if &quot;%key%&quot;==&quot;%%B&quot; (</span><br><span class="line">set &quot;string=OSMajorVersion=5;OSMinorVersion=1;OSPlatformId=2;PP=0;Pfn=Microsoft.Windows.%%C.%%D_8wekyb3d8bbwe;PKeyIID=465145217131314304264339481117862266242033457260311819664735280;$([char]0)&quot;</span><br><span class="line">for /f &quot;tokens=* delims=&quot; %%i in (&#x27;%psc% [conv%f%ert]::ToBas%f%e64String([Text.En%f%coding]::Uni%f%code.GetBytes(&quot;&quot;&quot;!string!&quot;&quot;&quot;^)^)&#x27;) do set &quot;encoded=%%i&quot;</span><br><span class="line">echo &quot;!encoded!&quot; | find &quot;AAAA&quot; %nul1% || exit /b</span><br><span class="line"></span><br><span class="line">&lt;nul set /p &quot;=&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;genuineAuthorization xmlns=&quot;http://www.microsoft.com/DRM/SL/GenuineAuthorization/1.0&quot;&gt;&lt;version&gt;1.0&lt;/version&gt;&lt;genuineProperties origin=&quot;sppclient&quot;&gt;&lt;properties&gt;OA3xOriginalProductId=;OA3xOriginalProductKey=;SessionId=!encoded!;TimeStampClient=2022-10-11T12:00:00Z&lt;/properties&gt;&lt;signatures&gt;&lt;signature name=&quot;clientLockboxKey&quot; method=&quot;rsa-sha256&quot;&gt;%%E=&lt;/signature&gt;&lt;/signatures&gt;&lt;/genuineProperties&gt;&lt;/genuineAuthorization&gt;&quot; &gt;&quot;%tdir%\GenuineTicket&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Below code is used to get alternate edition name and key if current edition doesn&#x27;t support HWID activation</span><br><span class="line"></span><br><span class="line">::  1st column = Current SKU ID</span><br><span class="line">::  2nd column = Current Edition Name</span><br><span class="line">::  3rd column = Current Edition Activation ID</span><br><span class="line">::  4th column = Alternate Edition Activation ID</span><br><span class="line">::  5th column = Alternate Edition HWID Key</span><br><span class="line">::  6th column = Alternate Edition Name</span><br><span class="line">::  Separator  = _</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:hwidfallback</span><br><span class="line"></span><br><span class="line">set notfoundaltactID=</span><br><span class="line">if %_NoEditionChange%==1 exit /b</span><br><span class="line"></span><br><span class="line">for %%# in (</span><br><span class="line">125_EnterpriseS-2021_______________cce9d2de-98ee-4ce2-8113-222620c64a27_ed655016-a9e8-4434-95d9-4345352c2552_QPM%f%6N-7J2%f%WJ-P8%f%8HH-P3Y%f%RH-YY%f%74H_IoTEnterpriseS-2021</span><br><span class="line">125_EnterpriseS-2024_______________f6e29426-a256-4316-88bf-cc5b0f95ec0c_6c4de1b8-24bb-4c17-9a77-7b939414c298_CGK%f%42-GYN%f%6Y-VD%f%22B-BX9%f%8W-J8%f%JXD_IoTEnterpriseS-2024</span><br><span class="line">138_ProfessionalSingleLanguage_____a48938aa-62fa-4966-9d44-9f04da3f72f2_4de7cb65-cdf1-4de9-8ae8-e3cce27b9f2c_VK7%f%JG-NPH%f%TM-C9%f%7JM-9MP%f%GT-3V%f%66T_Professional</span><br><span class="line">139_ProfessionalCountrySpecific____f7af7d09-40e4-419c-a49b-eae366689ebd_4de7cb65-cdf1-4de9-8ae8-e3cce27b9f2c_VK7%f%JG-NPH%f%TM-C9%f%7JM-9MP%f%GT-3V%f%66T_Professional</span><br><span class="line">139_ProfessionalCountrySpecific-Zn_01eb852c-424d-4060-94b8-c10d799d7364_4de7cb65-cdf1-4de9-8ae8-e3cce27b9f2c_VK7%f%JG-NPH%f%TM-C9%f%7JM-9MP%f%GT-3V%f%66T_Professional</span><br><span class="line">) do (</span><br><span class="line">for /f &quot;tokens=1-6 delims=_&quot; %%A in (&quot;%%#&quot;) do if %osSKU%==%%A (</span><br><span class="line">echo &quot;!applist! !altapplist!&quot; | find /i &quot;%%C&quot; %nul1% &amp;&amp; (</span><br><span class="line">echo &quot;!applist!&quot; | find /i &quot;%%D&quot; %nul1% &amp;&amp; (</span><br><span class="line">set altkey=%%E</span><br><span class="line">set altedition=%%F</span><br><span class="line">) || (</span><br><span class="line">set altedition=%%F</span><br><span class="line">set notfoundaltactID=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class="line"></span><br><span class="line">:OhookActivation</span><br><span class="line">@setlocal DisableDelayedExpansion</span><br><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">::  To activate Office with Ohook activation, run the script with &quot;/Ohook&quot; parameter or change 0 to 1 in below line</span><br><span class="line">set _act=0</span><br><span class="line"></span><br><span class="line">::  To remove Ohook activation, run the script with /Ohook-Uninstall parameter or change 0 to 1 in below line</span><br><span class="line">set _rem=0</span><br><span class="line"></span><br><span class="line">::  If value is changed in above lines or parameter is used then script will run in unattended mode</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">color 07</span><br><span class="line">title  Ohook 激活</span><br><span class="line"></span><br><span class="line">set _args=</span><br><span class="line">set _elev=</span><br><span class="line">set _unattended=0</span><br><span class="line"></span><br><span class="line">set _args=%*</span><br><span class="line">if defined _args set _args=%_args:&quot;=%</span><br><span class="line">if defined _args (</span><br><span class="line">for %%A in (%_args%) do (</span><br><span class="line">if /i &quot;%%A&quot;==&quot;/Ohook&quot;                  set _act=1</span><br><span class="line">if /i &quot;%%A&quot;==&quot;/Ohook-Uninstall&quot;        set _rem=1</span><br><span class="line">if /i &quot;%%A&quot;==&quot;-el&quot;                     set _elev=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%A in (%_act% %_rem%) do (if &quot;%%A&quot;==&quot;1&quot; set _unattended=1)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set &quot;nul1=1&gt;nul&quot;</span><br><span class="line">set &quot;nul2=2&gt;nul&quot;</span><br><span class="line">set &quot;nul6=2^&gt;nul&quot;</span><br><span class="line">set &quot;nul=&gt;nul 2&gt;&amp;1&quot;</span><br><span class="line"></span><br><span class="line">set psc=powershell.exe</span><br><span class="line">set winbuild=1</span><br><span class="line">for /f &quot;tokens=6 delims=[]. &quot; %%G in (&#x27;ver&#x27;) do set winbuild=%%G</span><br><span class="line"></span><br><span class="line">set _NCS=1</span><br><span class="line">if %winbuild% LSS 10586 set _NCS=0</span><br><span class="line">if %winbuild% GEQ 10586 reg query &quot;HKCU\Console&quot; /v ForceV2 %nul2% | find /i &quot;0x0&quot; %nul1% &amp;&amp; (set _NCS=0)</span><br><span class="line"></span><br><span class="line">if %_NCS% EQU 1 (</span><br><span class="line">for /F %%a in (&#x27;echo prompt $E ^| cmd&#x27;) do set &quot;esc=%%a&quot;</span><br><span class="line">set     &quot;Red=&quot;41;97m&quot;&quot;</span><br><span class="line">set    &quot;Gray=&quot;100;97m&quot;&quot;</span><br><span class="line">set   &quot;Green=&quot;42;97m&quot;&quot;</span><br><span class="line">set    &quot;Blue=&quot;44;97m&quot;&quot;</span><br><span class="line">set  &quot;_White=&quot;40;37m&quot;&quot;</span><br><span class="line">set  &quot;_Green=&quot;40;92m&quot;&quot;</span><br><span class="line">set &quot;_Yellow=&quot;40;93m&quot;&quot;</span><br><span class="line">) else (</span><br><span class="line">set     &quot;Red=&quot;Red&quot; &quot;white&quot;&quot;</span><br><span class="line">set    &quot;Gray=&quot;Darkgray&quot; &quot;white&quot;&quot;</span><br><span class="line">set   &quot;Green=&quot;DarkGreen&quot; &quot;white&quot;&quot;</span><br><span class="line">set    &quot;Blue=&quot;Blue&quot; &quot;white&quot;&quot;</span><br><span class="line">set  &quot;_White=&quot;Black&quot; &quot;Gray&quot;&quot;</span><br><span class="line">set  &quot;_Green=&quot;Black&quot; &quot;Green&quot;&quot;</span><br><span class="line">set &quot;_Yellow=&quot;Black&quot; &quot;Yellow&quot;&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;nceline=echo: &amp;echo ==== ERROR ==== &amp;echo:&quot;</span><br><span class="line">set &quot;eline=echo: &amp;call :dk_color %Red% &quot;==== ERROR ====&quot; &amp;echo:&quot;</span><br><span class="line">if %~z0 GEQ 200000 (</span><br><span class="line">set &quot;_exitmsg=返回&quot;</span><br><span class="line">set &quot;_fixmsg=返回主菜单，选择 &quot;故障排除 &quot;并运行 &quot;修复许可 &quot;选项。&quot;</span><br><span class="line">) else (</span><br><span class="line">set &quot;_exitmsg=退出&quot;</span><br><span class="line">set &quot;_fixmsg=在 MAS 文件夹中，运行 &quot;故障排除 &quot;脚本并选择 &quot;修复许可 &quot;选项。&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">if %winbuild% LSS 9200 (</span><br><span class="line">%eline%</span><br><span class="line">echo 检测到不支持的操作系统版本 [%winbuild%]。</span><br><span class="line">echo Ohook Activation 支持 Windows 8 及更高版本及其同底层的Windows Server。</span><br><span class="line">goto dk_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Fix for the special characters limitation in path name</span><br><span class="line"></span><br><span class="line">set &quot;_work=%~dp0&quot;</span><br><span class="line">if &quot;%_work:~-1%&quot;==&quot;\&quot; set &quot;_work=%_work:~0,-1%&quot;</span><br><span class="line"></span><br><span class="line">set &quot;_batf=%~f0&quot;</span><br><span class="line">set &quot;_batp=%_batf:&#x27;=&#x27;&#x27;%&quot;</span><br><span class="line"></span><br><span class="line">set _PSarg=&quot;&quot;&quot;%~f0&quot;&quot;&quot; -el %_args%</span><br><span class="line"></span><br><span class="line">set &quot;_ttemp=%temp%&quot;</span><br><span class="line"></span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">if %_rem%==1 goto :oh_uninstall</span><br><span class="line"></span><br><span class="line">:oh_menu</span><br><span class="line"></span><br><span class="line">if %_unattended%==0 (</span><br><span class="line">cls</span><br><span class="line">mode 76, 25</span><br><span class="line">title  Ohook 激活</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo         ____________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">echo                 [1] 安装 Ohook Office 激活</span><br><span class="line">echo:</span><br><span class="line">echo                 [2] 卸载</span><br><span class="line">echo                 ____________________________________________</span><br><span class="line">echo:</span><br><span class="line">echo                 [3] 下载 Office</span><br><span class="line">echo:</span><br><span class="line">echo                 [0] %_exitmsg%</span><br><span class="line">echo         ____________________________________________________________</span><br><span class="line">echo: </span><br><span class="line">call :dk_color2 %_White% &quot;              &quot; %_Green% &quot;通过键盘输入菜单选项 [1,2,3,0]&quot;</span><br><span class="line">choice /C:1230 /N</span><br><span class="line">set _el=!errorlevel!</span><br><span class="line">if !_el!==4  exit /b</span><br><span class="line">if !_el!==3  start %mas%genuine-installation-media.html &amp;goto :oh_menu</span><br><span class="line">if !_el!==2  goto :oh_uninstall</span><br><span class="line">if !_el!==1  goto :oh_menu2</span><br><span class="line">goto :oh_menu</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:oh_menu2</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode 128, 32</span><br><span class="line">%psc% &quot;&amp;&#123;$W=$Host.UI.RawUI.WindowSize;$B=$Host.UI.RawUI.BufferSize;$W.Height=32;$B.Height=300;$Host.UI.RawUI.WindowSize=$W;$Host.UI.RawUI.BufferSize=$B;&#125;&quot;</span><br><span class="line"></span><br><span class="line">title  Ohook 激活</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo 初始化...</span><br><span class="line">call :dk_product</span><br><span class="line">call :dk_ckeckwmic</span><br><span class="line"></span><br><span class="line">::  Show info for potential script stuck scenario</span><br><span class="line"></span><br><span class="line">sc start sppsvc %nul%</span><br><span class="line">if %errorlevel% NEQ 1056 if %errorlevel% NEQ 0 (</span><br><span class="line">echo:</span><br><span class="line">echo 错误代码: %errorlevel%</span><br><span class="line">call :dk_color %Red% &quot;启动 [sppsvc] 服务失败，剩余过程可能需要很长时间...&quot;</span><br><span class="line">echo:</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set error=</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">echo:</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; /v PROCESSOR_ARCHITECTURE&#x27;) do set osarch=%%b</span><br><span class="line">for /f &quot;tokens=6-7 delims=[]. &quot; %%i in (&#x27;ver&#x27;) do if &quot;%%j&quot;==&quot;&quot; (set fullbuild=%%i) else (set fullbuild=%%i.%%j)</span><br><span class="line">echo 检查操作系统信息                        [%winos% ^| %fullbuild% ^| %osarch%]</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check Windows Script Host</span><br><span class="line"></span><br><span class="line">set _WSH=1</span><br><span class="line">reg query &quot;HKCU\SOFTWARE\Microsoft\Windows Script Host\Settings&quot; /v Enabled %nul2% | find /i &quot;0x0&quot; %nul1% &amp;&amp; (set _WSH=0)</span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows Script Host\Settings&quot; /v Enabled %nul2% | find /i &quot;0x0&quot; %nul1% &amp;&amp; (set _WSH=0)</span><br><span class="line"></span><br><span class="line">if %_WSH% EQU 0 (</span><br><span class="line">reg add &quot;HKLM\Software\Microsoft\Windows Script Host\Settings&quot; /v Enabled /t REG_DWORD /d 1 /f %nul%</span><br><span class="line">reg add &quot;HKCU\Software\Microsoft\Windows Script Host\Settings&quot; /v Enabled /t REG_DWORD /d 1 /f %nul%</span><br><span class="line">if not &quot;%arch%&quot;==&quot;x86&quot; reg add &quot;HKLM\Software\Microsoft\Windows Script Host\Settings&quot; /v Enabled /t REG_DWORD /d 1 /f /reg:32 %nul%</span><br><span class="line">echo 启用 Windows 脚本托管            [成功]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">echo 启动诊断测试...</span><br><span class="line"></span><br><span class="line">set &quot;_serv=sppsvc Winmgmt&quot;</span><br><span class="line">set officeact=1</span><br><span class="line">call :dk_errorcheck</span><br><span class="line"></span><br><span class="line">::  Check unsupported office versions</span><br><span class="line"></span><br><span class="line">set o14msi=</span><br><span class="line">set o14c2r=</span><br><span class="line">set o16uwp=</span><br><span class="line"></span><br><span class="line">set _68=HKLM\SOFTWARE\Microsoft\Office</span><br><span class="line">set _86=HKLM\SOFTWARE\Wow6432Node\Microsoft\Office</span><br><span class="line">%nul% reg query %_68%\14.0\Common\InstallRoot /v Path  &amp;&amp; set o14msi=Office 2010 MSI </span><br><span class="line">%nul% reg query %_86%\14.0\Common\InstallRoot /v Path  &amp;&amp; set o14msi=Office 2010 MSI </span><br><span class="line">%nul% reg query %_68%\14.0\CVH /f Click2run /k         &amp;&amp; set o14c2r=Office 2010 C2R </span><br><span class="line">%nul% reg query %_86%\14.0\CVH /f Click2run /k         &amp;&amp; set o14c2r=Office 2010 C2R </span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 10240 %psc% &quot;Get-AppxPackage -name &quot;Microsoft.Office.Desktop&quot;&quot; | find /i &quot;Office&quot; %nul1% &amp;&amp; set o16uwp=Office UWP </span><br><span class="line"></span><br><span class="line">if not &quot;%o14msi%%o14c2r%%o16uwp%&quot;==&quot;&quot; (</span><br><span class="line">echo:</span><br><span class="line">call :dk_color %Red% &quot;检查不支持的 Office 安装程序     [ %o14msi%%o14c2r%%o16uwp%]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check supported office versions</span><br><span class="line"></span><br><span class="line">call :oh_getpath</span><br><span class="line"></span><br><span class="line">sc query ClickToRunSvc %nul%</span><br><span class="line">set error1=%errorlevel%</span><br><span class="line"></span><br><span class="line">if defined o16c2r if %error1% EQU 1060 (</span><br><span class="line">call :dk_color %Red% &quot;Checking ClickToRun Service             [Not found, Office 16.0 files found]&quot;</span><br><span class="line">set o16c2r=</span><br><span class="line">set error=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">sc query OfficeSvc %nul%</span><br><span class="line">set error2=%errorlevel%</span><br><span class="line"></span><br><span class="line">if defined o15c2r if %error1% EQU 1060 if %error2% EQU 1060 (</span><br><span class="line">call :dk_color %Red% &quot;Checking ClickToRun Service             [Not found, Office 15.0 files found]&quot;</span><br><span class="line">set o15c2r=</span><br><span class="line">set error=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if &quot;%o16c2r%%o15c2r%%o16msi%%o15msi%&quot;==&quot;&quot; (</span><br><span class="line">set error=1</span><br><span class="line">echo:</span><br><span class="line">if not &quot;%o14msi%%o14c2r%%o16uwp%&quot;==&quot;&quot; (</span><br><span class="line">call :dk_color %Red% &quot;Checking Supported Office Install       [Not Found]&quot;</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Red% &quot;Checking Installed Office               [Not Found]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 10240 %psc% &quot;Get-AppxPackage -name &quot;Microsoft.MicrosoftOfficeHub&quot;&quot; | find /i &quot;Office&quot; %nul1% &amp;&amp; (</span><br><span class="line">echo:</span><br><span class="line">echo 您只安装了 Office dashboard 应用程序，您需要安装完整的 Office 版本。</span><br><span class="line">)</span><br><span class="line">echo:</span><br><span class="line">call :dk_color %Blue% &quot;Download and install Office from below URL and try again.&quot;</span><br><span class="line">echo:</span><br><span class="line">echo %mas%genuine-installation-media.html</span><br><span class="line">goto dk_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set multioffice=</span><br><span class="line">if not &quot;%o16c2r%%o15c2r%%o16msi%%o15msi%&quot;==&quot;1&quot; set multioffice=1</span><br><span class="line">if not &quot;%o14msi%%o14c2r%%o16uwp%&quot;==&quot;&quot; set multioffice=1</span><br><span class="line"></span><br><span class="line">if defined multioffice (</span><br><span class="line">call :dk_color %Gray% &quot;Checking Multiple Office Install        [Found. Its best to install only one version]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Process Office 15.0 C2R</span><br><span class="line"></span><br><span class="line">if not defined o15c2r goto :starto16c2r</span><br><span class="line"></span><br><span class="line">call :oh_reset</span><br><span class="line">call :oh_actids</span><br><span class="line"></span><br><span class="line">set oVer=15</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %o15c2r_reg% /v InstallPath&quot; %nul6%&#x27;) do (set &quot;_oRoot=%%b\root&quot;)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %o15c2r_reg%\Configuration /v Platform&quot; %nul6%&#x27;) do (set &quot;_oArch=%%b&quot;)</span><br><span class="line">if not defined _oArch for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %o15c2r_reg%\propertyBag /v Platform&quot; %nul6%&#x27;) do (set &quot;_oArch=%%b&quot;)</span><br><span class="line"></span><br><span class="line">echo &quot;%o15c2r_reg%&quot; | find /i &quot;Wow6432Node&quot; %nul1% &amp;&amp; (set _tok=10) || (set _tok=9)</span><br><span class="line">for /f &quot;tokens=%_tok% delims=\&quot; %%a in (&#x27;reg query %o15c2r_reg%\ProductReleaseIDs\Active %nul6% ^| findstr /i &quot;Retail Volume&quot;&#x27;) do (</span><br><span class="line">if not defined _oIds (set &quot;_oIds=%%a&quot;) else (set &quot;_oIds=!_oIds! %%a&quot;)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;_oLPath=%_oRoot%\Licenses&quot;</span><br><span class="line"></span><br><span class="line">if [%_oArch%]==[x64] (set &quot;_hookPath=%_oRoot%\vfs\System&quot;    &amp; set &quot;_hook=sppc64.dll&quot;)</span><br><span class="line">if [%_oArch%]==[x86] (set &quot;_hookPath=%_oRoot%\vfs\SystemX86&quot; &amp; set &quot;_hook=sppc32.dll&quot;)</span><br><span class="line">if not [%osarch%]==[x86] (</span><br><span class="line">if [%_oArch%]==[x64] set &quot;_sppcPath=%SystemRoot%\System32\sppc.dll&quot;</span><br><span class="line">if [%_oArch%]==[x86] set &quot;_sppcPath=%SystemRoot%\SysWOW64\sppc.dll&quot;</span><br><span class="line">) else (</span><br><span class="line">set &quot;_sppcPath=%SystemRoot%\System32\sppc.dll&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo 激活 Office 15.0 %_oArch% C2R...</span><br><span class="line"></span><br><span class="line">if not defined _oIds (</span><br><span class="line">call :dk_color %Red% &quot;Checking Installed Products             [Product IDs not found. Aborting activation...]&quot;</span><br><span class="line">set error=1</span><br><span class="line">goto :starto16c2r</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :oh_process</span><br><span class="line">call :oh_hookinstall</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:starto16c2r</span><br><span class="line"></span><br><span class="line">::  Process Office 16.0 C2R</span><br><span class="line"></span><br><span class="line">if not defined o16c2r goto :startmsi</span><br><span class="line"></span><br><span class="line">call :oh_reset</span><br><span class="line">call :oh_actids</span><br><span class="line"></span><br><span class="line">set oVer=16</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %o16c2r_reg% /v InstallPath&quot; %nul6%&#x27;) do (set &quot;_oRoot=%%b\root&quot;)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %o16c2r_reg%\Configuration /v Platform&quot; %nul6%&#x27;) do (set &quot;_oArch=%%b&quot;)</span><br><span class="line"></span><br><span class="line">echo &quot;%o16c2r_reg%&quot; | find /i &quot;Wow6432Node&quot; %nul1% &amp;&amp; (set _tok=9) || (set _tok=8)</span><br><span class="line">for /f &quot;tokens=%_tok% delims=\&quot; %%a in (&#x27;reg query &quot;%o16c2r_reg%\ProductReleaseIDs&quot; /s /f &quot;.16&quot; /k %nul6% ^| findstr /i &quot;Retail Volume&quot;&#x27;) do (</span><br><span class="line">if not defined _oIds (set &quot;_oIds=%%a&quot;) else (set &quot;_oIds=!_oIds! %%a&quot;)</span><br><span class="line">)</span><br><span class="line">set _oIds=%_oIds:.16=%</span><br><span class="line"></span><br><span class="line">set &quot;_oLPath=%_oRoot%\Licenses16&quot;</span><br><span class="line"></span><br><span class="line">if [%_oArch%]==[x64] (set &quot;_hookPath=%_oRoot%\vfs\System&quot;    &amp; set &quot;_hook=sppc64.dll&quot;)</span><br><span class="line">if [%_oArch%]==[x86] (set &quot;_hookPath=%_oRoot%\vfs\SystemX86&quot; &amp; set &quot;_hook=sppc32.dll&quot;)</span><br><span class="line">if not [%osarch%]==[x86] (</span><br><span class="line">if [%_oArch%]==[x64] set &quot;_sppcPath=%SystemRoot%\System32\sppc.dll&quot;</span><br><span class="line">if [%_oArch%]==[x86] set &quot;_sppcPath=%SystemRoot%\SysWOW64\sppc.dll&quot;</span><br><span class="line">) else (</span><br><span class="line">set &quot;_sppcPath=%SystemRoot%\System32\sppc.dll&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo 激活 Office 16.0 %_oArch% C2R...</span><br><span class="line"></span><br><span class="line">if not defined _oIds (</span><br><span class="line">call :dk_color %Red% &quot;Checking Installed Products             [Product IDs not found. Aborting activation...]&quot;</span><br><span class="line">set error=1</span><br><span class="line">goto :startmsi</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :oh_process</span><br><span class="line">call :oh_hookinstall</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Find remnants of Office vNext license block and remove it because it stops non vNext licenses from appearing</span><br><span class="line"></span><br><span class="line">set sub_next=</span><br><span class="line">set kNext=HKCU\SOFTWARE\Microsoft\Office\16.0\Common\Licensing</span><br><span class="line"></span><br><span class="line">reg query %kNext%\LicensingNext /v MigrationToV5Done %nul2% | find /i &quot;0x1&quot; %nul% &amp;&amp; (</span><br><span class="line">reg query %kNext%\LicensingNext %nul2% | findstr /i &quot;volume retail&quot; %nul2% | findstr /i &quot;0x2 0x3&quot; %nul% &amp;&amp; (</span><br><span class="line">set sub_next=1</span><br><span class="line">reg delete %kNext% /f %nul%</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined sub_next (</span><br><span class="line">reg query %kNext%\LicensingNext %nul% &amp;&amp; (</span><br><span class="line">call :dk_color %Red% &quot;Removing Office vNext Block             [失败]&quot;</span><br><span class="line">) || (</span><br><span class="line">echo 移除 Office vNext 块             [成功]</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Subscription licenses attempt to validate the license and may show a banner &quot;There was a problem checking this device&#x27;s license status.&quot;, other products don&#x27;t do that.</span><br><span class="line">::  A simple registry entry can skip this check</span><br><span class="line"></span><br><span class="line">if defined _sublic (</span><br><span class="line">echo 添加注册以跳过许可证检查      [成功]</span><br><span class="line">reg add HKCU\Software\Microsoft\Office\16.0\Common\Licensing\Resiliency /v &quot;TimeOfLastHeartbeatFailure&quot; /t REG_SZ /d &quot;2033-08-18T22:18:45Z&quot; /f %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  mass grave[.]dev/office-license-is-not-genuine.html</span><br><span class="line">::  Add registry keys for volume products so that &#x27;non-genuine&#x27; banner won&#x27;t appear </span><br><span class="line">::  Script already is using MAK instead of GVLK so it won&#x27;t appear anyway, but registry keys are added incase Office installs default GVLK grace key for volume products</span><br><span class="line"></span><br><span class="line">echo &quot;%_oIds%&quot; | find /i &quot;Volume&quot; %nul1% &amp;&amp; (</span><br><span class="line">if %winbuild% GEQ 9200 (</span><br><span class="line">if not [%osarch%]==[x86] (</span><br><span class="line">reg delete &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\0ff1ce15-a989-479d-af46-f275c6370663&quot; /f /reg:32 %nul%</span><br><span class="line">reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\0ff1ce15-a989-479d-af46-f275c6370663&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;10.0.0.10&quot; /reg:32 %nul%</span><br><span class="line">)</span><br><span class="line">reg delete &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\0ff1ce15-a989-479d-af46-f275c6370663&quot; /f %nul%</span><br><span class="line">reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\0ff1ce15-a989-479d-af46-f275c6370663&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;10.0.0.10&quot; %nul%</span><br><span class="line">echo 添加注册防止横幅警告          [成功]</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:startmsi</span><br><span class="line"></span><br><span class="line">if defined o15msi call :oh_processmsi 15 %o15msi_reg%</span><br><span class="line">if defined o16msi call :oh_processmsi 16 %o16msi_reg%</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Uninstall other / grace Keys</span><br><span class="line"></span><br><span class="line">set upk_result=0</span><br><span class="line">set allapplist=</span><br><span class="line"></span><br><span class="line">if %_wmic% EQU 1 set &quot;chkapp=for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;&quot;wmic path SoftwareLicensingProduct where (ApplicationID=&#x27;0ff1ce15-a989-479d-af46-f275c6370663&#x27; and PartialProductKey is not null) get ID /VALUE&quot; %nul6%&#x27;)&quot;</span><br><span class="line">if %_wmic% EQU 0 set &quot;chkapp=for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;%psc% &quot;(([WMISEARCHER]&#x27;SELECT ID FROM SoftwareLicensingProduct WHERE ApplicationID=&#x27;&#x27;0ff1ce15-a989-479d-af46-f275c6370663&#x27;&#x27; AND PartialProductKey IS NOT NULL&#x27;).Get()).ID ^| %% &#123;echo (&#x27;ID=&#x27;+$_)&#125;&quot; %nul6%&#x27;)&quot;</span><br><span class="line">%chkapp% do (if defined allapplist (call set &quot;allapplist=!allapplist! %%a&quot;) else (call set &quot;allapplist=%%a&quot;))</span><br><span class="line"></span><br><span class="line">for %%# in (%allapplist%) do (</span><br><span class="line">echo &quot;%_allactid%&quot; | find /i &quot;%%#&quot; %nul1% || (</span><br><span class="line">cscript //nologo %windir%\system32\slmgr.vbs /upk %%# %nul% &amp;&amp; (</span><br><span class="line">set upk_result=1</span><br><span class="line">) || (</span><br><span class="line">set error=1</span><br><span class="line">set upk_result=2</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not %upk_result%==0 echo:</span><br><span class="line">if %upk_result%==1 echo 卸载其他/Grace 密钥           [成功]</span><br><span class="line">if %upk_result%==2 call :dk_color %Red% &quot;卸载其他/Grace 密钥           [失败]&quot;</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Refresh Windows Insider Preview Licenses</span><br><span class="line">::  It required in Insider versions otherwise office may not activate</span><br><span class="line"></span><br><span class="line">if exist &quot;%windir%\system32\spp\store_test\2.0\tokens.dat&quot; (</span><br><span class="line">cscript //nologo %windir%\system32\slmgr.vbs /rilc %nul%</span><br><span class="line">if !errorlevel! NEQ 0 cscript //nologo %windir%\system32\slmgr.vbs /rilc %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if not defined error (</span><br><span class="line">call :dk_color %Green% &quot;Office is permanently activated.&quot;</span><br><span class="line">echo 帮助: %mas%troubleshoot</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Red% &quot;Some errors were detected.&quot;</span><br><span class="line">if not defined ierror if not defined showfix if not defined serv_cor if not defined serv_cste call :dk_color %Blue% &quot;%_fixmsg%&quot;</span><br><span class="line">echo:</span><br><span class="line">call :dk_color2 %Blue% &quot;查看此页以获得帮助&quot; %_Yellow% &quot; %mas%troubleshoot&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">goto :dk_done</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:oh_uninstall</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode 99, 28</span><br><span class="line">title  卸载 Ohook 激活</span><br><span class="line"></span><br><span class="line">set _present=</span><br><span class="line">set _unerror=</span><br><span class="line">call :oh_reset</span><br><span class="line">call :oh_getpath</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo 卸载 Ohook 激活...</span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">if defined o16c2r_reg (for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %o16c2r_reg% /v InstallPath&quot; %nul6%&#x27;) do (set &quot;_16CHook=%%b\root\vfs&quot;))</span><br><span class="line">if defined o15c2r_reg (for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %o15c2r_reg% /v InstallPath&quot; %nul6%&#x27;) do (set &quot;_15CHook=%%b\root\vfs&quot;))</span><br><span class="line">if defined o16msi_reg (for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %o16msi_reg%\Common\InstallRoot /v Path&quot; %nul6%&#x27;) do (set &quot;_16MHook=%%b&quot;))</span><br><span class="line">if defined o15msi_reg (for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %o15msi_reg%\Common\InstallRoot /v Path&quot; %nul6%&#x27;) do (set &quot;_15MHook=%%b&quot;))</span><br><span class="line"></span><br><span class="line">if defined _16CHook (if exist &quot;%_16CHook%\System\sppc*dll&quot;    (set _present=1&amp; del /s /f /q &quot;%_16CHook%\System\sppc*dll&quot;    &amp; if exist &quot;%_16CHook%\System\sppc*dll&quot;    set _unerror=1))</span><br><span class="line">if defined _16CHook (if exist &quot;%_16CHook%\SystemX86\sppc*dll&quot; (set _present=1&amp; del /s /f /q &quot;%_16CHook%\SystemX86\sppc*dll&quot; &amp; if exist &quot;%_16CHook%\SystemX86\sppc*dll&quot; set _unerror=1))</span><br><span class="line">if defined _15CHook (if exist &quot;%_15CHook%\System\sppc*dll&quot;    (set _present=1&amp; del /s /f /q &quot;%_15CHook%\System\sppc*dll&quot;    &amp; if exist &quot;%_15CHook%\System\sppc*dll&quot;    set _unerror=1))</span><br><span class="line">if defined _15CHook (if exist &quot;%_15CHook%\SystemX86\sppc*dll&quot; (set _present=1&amp; del /s /f /q &quot;%_15CHook%\SystemX86\sppc*dll&quot; &amp; if exist &quot;%_15CHook%\SystemX86\sppc*dll&quot; set _unerror=1))</span><br><span class="line">if defined _16MHook (if exist &quot;%_16MHook%sppc*dll&quot;            (set _present=1&amp; del /s /f /q &quot;%_16MHook%sppc*dll&quot;            &amp; if exist &quot;%_16MHook%sppc*dll&quot;            set _unerror=1))</span><br><span class="line">if defined _15MHook (if exist &quot;%_15MHook%sppc*dll&quot;            (set _present=1&amp; del /s /f /q &quot;%_15MHook%sppc*dll&quot;            &amp; if exist &quot;%_15MHook%sppc*dll&quot;            set _unerror=1))</span><br><span class="line"></span><br><span class="line">for %%# in (15 16) do (</span><br><span class="line">for %%A in (&quot;%ProgramFiles%&quot; &quot;%ProgramW6432%&quot; &quot;%ProgramFiles(x86)%&quot;) do (</span><br><span class="line">if exist &quot;%%~A\Microsoft Office\Office%%#\sppc*dll&quot; (set _present=1&amp; del /s /f /q &quot;%%~A\Microsoft Office\Office%%#\sppc*dll&quot; &amp; if exist &quot;%%~A\Microsoft Office\Office%%#\sppc*dll&quot; set _unerror=1)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%# in (System SystemX86) do (</span><br><span class="line">for %%G in (&quot;Office 15&quot; &quot;Office&quot;) do (</span><br><span class="line">for %%A in (&quot;%ProgramFiles%&quot; &quot;%ProgramW6432%&quot; &quot;%ProgramFiles(x86)%&quot;) do (</span><br><span class="line">if exist &quot;%%~A\Microsoft %%~G\root\vfs\%%#\sppc*dll&quot; (set _present=1&amp; del /s /f /q &quot;%%~A\Microsoft %%~G\root\vfs\%%#\sppc*dll&quot; &amp; if exist &quot;%%~A\Microsoft %%~G\root\vfs\%%#\sppc*dll&quot; set _unerror=1)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">reg query HKCU\Software\Microsoft\Office\16.0\Common\Licensing\Resiliency /s %nul2% | find /i &quot;2033&quot; %nul% &amp;&amp; (</span><br><span class="line">echo:</span><br><span class="line">echo 删除 - HKCU\Software\Microsoft\Office\16.0\Common\Licensing\Resiliency</span><br><span class="line">reg delete HKCU\Software\Microsoft\Office\16.0\Common\Licensing\Resiliency /f</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\0ff1ce15-a989-479d-af46-f275c6370663&quot; %nul% &amp;&amp; (</span><br><span class="line">echo:</span><br><span class="line">echo 删除 - 用于防止非正版横幅警告的注册表密钥</span><br><span class="line">reg delete &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\0ff1ce15-a989-479d-af46-f275c6370663&quot; /f</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\0ff1ce15-a989-479d-af46-f275c6370663&quot; %nul% &amp;&amp; (</span><br><span class="line">reg delete &quot;HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\0ff1ce15-a989-479d-af46-f275c6370663&quot; /f</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo __________________________________________________________________________________________</span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">if not defined _present (</span><br><span class="line">echo 未安装 Ohook 激活。</span><br><span class="line">) else (</span><br><span class="line">if defined _unerror (</span><br><span class="line">call :dk_color %Red% &quot;Failed to uninstall Ohook activation.&quot;</span><br><span class="line">call :dk_color %Blue% &quot;Close Office apps if they are running and try again.&quot;</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Green% &quot;Successfully uninstalled Ohook activation.&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">echo __________________________________________________________________________________________</span><br><span class="line"></span><br><span class="line">goto :dk_done</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:oh_reset</span><br><span class="line"></span><br><span class="line">set _oRoot=</span><br><span class="line">set _oArch=</span><br><span class="line">set _oIds=</span><br><span class="line">set _oLPath=</span><br><span class="line">set _hookPath=</span><br><span class="line">set _hook=</span><br><span class="line">set _sppcPath=</span><br><span class="line">set _key=</span><br><span class="line">set _actid=</span><br><span class="line">set _prod=</span><br><span class="line">set _lic=</span><br><span class="line">set _License=</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:oh_getpath</span><br><span class="line"></span><br><span class="line">set o16c2r=</span><br><span class="line">set o15c2r=</span><br><span class="line">set o16msi=</span><br><span class="line">set o15msi=</span><br><span class="line"></span><br><span class="line">set _68=HKLM\SOFTWARE\Microsoft\Office</span><br><span class="line">set _86=HKLM\SOFTWARE\Wow6432Node\Microsoft\Office</span><br><span class="line"></span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %_86%\ClickToRun /v InstallPath&quot; %nul6%&#x27;) do if exist &quot;%%b\root\Licenses16\ProPlus*.xrm-ms&quot;    (set o16c2r=1&amp;set o16c2r_reg=%_86%\ClickToRun)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %_68%\ClickToRun /v InstallPath&quot; %nul6%&#x27;) do if exist &quot;%%b\root\Licenses16\ProPlus*.xrm-ms&quot;    (set o16c2r=1&amp;set o16c2r_reg=%_68%\ClickToRun)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %_86%\15.0\ClickToRun /v InstallPath&quot; %nul6%&#x27;) do if exist &quot;%%b\root\Licenses\ProPlus*.xrm-ms&quot; (set o15c2r=1&amp;set o15c2r_reg=%_86%\15.0\ClickToRun)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %_68%\15.0\ClickToRun /v InstallPath&quot; %nul6%&#x27;) do if exist &quot;%%b\root\Licenses\ProPlus*.xrm-ms&quot; (set o15c2r=1&amp;set o15c2r_reg=%_68%\15.0\ClickToRun)</span><br><span class="line"></span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %_86%\16.0\Common\InstallRoot /v Path&quot; %nul6%&#x27;) do if exist &quot;%%b\OSPP.VBS&quot; (set o16msi=1&amp;set o16msi_reg=%_86%\16.0)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %_68%\16.0\Common\InstallRoot /v Path&quot; %nul6%&#x27;) do if exist &quot;%%b\OSPP.VBS&quot; (set o16msi=1&amp;set o16msi_reg=%_68%\16.0)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %_86%\15.0\Common\InstallRoot /v Path&quot; %nul6%&#x27;) do if exist &quot;%%b\OSPP.VBS&quot; (set o15msi=1&amp;set o15msi_reg=%_86%\15.0)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %_68%\15.0\Common\InstallRoot /v Path&quot; %nul6%&#x27;) do if exist &quot;%%b\OSPP.VBS&quot; (set o15msi=1&amp;set o15msi_reg=%_68%\15.0)</span><br><span class="line"></span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:oh_installkey</span><br><span class="line"></span><br><span class="line">if %_wmic% EQU 1 wmic path SoftwareLicensingService where __CLASS=&#x27;SoftwareLicensingService&#x27; call InstallProductKey ProductKey=&quot;%_key%&quot; %nul%</span><br><span class="line">if %_wmic% EQU 0 %psc% &quot;(([WMISEARCHER]&#x27;SELECT Version FROM SoftwareLicensingService&#x27;).Get()).InstallProductKey(&#x27;%_key%&#x27;)&quot; %nul%</span><br><span class="line">if not %errorlevel%==0 cscript //nologo %windir%\system32\slmgr.vbs /ipk %_key% %nul%</span><br><span class="line">set errorcode=%errorlevel%</span><br><span class="line">cmd /c exit /b %errorcode%</span><br><span class="line">if %errorcode% NEQ 0 set &quot;errorcode=[0x%=ExitCode%]&quot;</span><br><span class="line"></span><br><span class="line">if %errorcode% EQU 0 (</span><br><span class="line">call :dk_refresh</span><br><span class="line">echo 安装通用产品密钥          [%_key%] [%_prod%] [%_lic%] [成功]</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Red% &quot;安装通用产品密钥          [%_key%] [%_prod%] [失败] %errorcode%&quot;</span><br><span class="line">if not defined error (</span><br><span class="line">call :dk_color %Blue% &quot;%_fixmsg%&quot;</span><br><span class="line">set showfix=1</span><br><span class="line">)</span><br><span class="line">set error=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:oh_installlic</span><br><span class="line"></span><br><span class="line">if not defined _oLPath exit /b</span><br><span class="line"></span><br><span class="line">set _License=%_prod:XVolume=XC2RVL_%</span><br><span class="line"></span><br><span class="line">set _License=%_License:O365EduCloudRetail=O365EduCloudEDUR_%</span><br><span class="line"></span><br><span class="line">set _License=%_License:ProjectProRetail=ProjectProO365R_%</span><br><span class="line">set _License=%_License:ProjectStdRetail=ProjectStdO365R_%</span><br><span class="line">set _License=%_License:VisioProRetail=VisioProO365R_%</span><br><span class="line">set _License=%_License:VisioStdRetail=VisioStdO365R_%</span><br><span class="line"></span><br><span class="line">set _License=%_License:Retail=R_%</span><br><span class="line">set _License=%_License:Volume=VL_%</span><br><span class="line"></span><br><span class="line">for %%# in (&quot;!_oLPath!\client-issuance-*.xrm-ms&quot;) do (</span><br><span class="line">cscript //nologo %windir%\system32\slmgr.vbs /ilc &quot;!_oLPath!\%%~nx#&quot; %nul%</span><br><span class="line">)</span><br><span class="line">cscript //nologo %windir%\system32\slmgr.vbs /ilc &quot;!_oLPath!\pkeyconfig-office.xrm-ms&quot; %nul%</span><br><span class="line"></span><br><span class="line">for %%# in (&quot;!_oLPath!\%_License%*.xrm-ms&quot;) do (</span><br><span class="line">cscript //nologo %windir%\system32\slmgr.vbs /ilc &quot;!_oLPath!\%%~nx#&quot; %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :oh_actids</span><br><span class="line"></span><br><span class="line">echo &quot;!oapplist!&quot; | find /i &quot;!_actid!&quot; %nul1% &amp;&amp; (</span><br><span class="line">call :dk_color %Gray% &quot;Installing Missing License Files        [Office %oVer%.0 %_prod%] [成功]&quot;</span><br><span class="line">) || (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Installing Missing License Files        [Office %oVer%.0 %_prod%] [失败]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:oh_hookinstall</span><br><span class="line"></span><br><span class="line">set ierror=</span><br><span class="line">set hasherror=</span><br><span class="line"></span><br><span class="line">del /s /q &quot;%_hookPath%\sppcs.dll&quot; %nul%</span><br><span class="line">del /s /q &quot;%_hookPath%\sppc.dll&quot; %nul%</span><br><span class="line"></span><br><span class="line">if exist &quot;%_hookPath%\sppcs.dll&quot; set ierror=1</span><br><span class="line">if exist &quot;%_hookPath%\sppc.dll&quot; set ierror=1</span><br><span class="line"></span><br><span class="line">mklink &quot;%_hookPath%\sppcs.dll&quot; &quot;%_sppcPath%&quot; %nul%</span><br><span class="line">if not %errorlevel%==0 set ierror=1</span><br><span class="line"></span><br><span class="line">if not exist &quot;%_hookPath%\sppc.dll&quot; call :oh_extractdll &quot;%_hookPath%\sppc.dll&quot;</span><br><span class="line">if not exist &quot;%_hookPath%\sppc.dll&quot; set ierror=1</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if not defined ierror (</span><br><span class="line">echo 将系统的 sppc.dll 连接到         [&quot;%_hookPath%\sppcs.dll&quot;] [成功]</span><br><span class="line">echo 提取自定义 %_hook% 到         [&quot;%_hookPath%\sppc.dll&quot;] [成功]</span><br><span class="line">) else (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;将系统的 sppc.dll 连接到             [失败]&quot;</span><br><span class="line">call :dk_color %Red% &quot;提取自定义 %_hook% 到            [失败]&quot;</span><br><span class="line">echo [&quot;%_hookPath%\sppc.dll&quot;]</span><br><span class="line">call :dk_color %Blue% &quot;Close Office apps if they are running and try again.&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not defined ierror (</span><br><span class="line">if defined hasherror (</span><br><span class="line">set error=1</span><br><span class="line">set ierror=1</span><br><span class="line">call :dk_color %Red% &quot;Modifying Hash of Custom %_hook%     [失败]&quot;</span><br><span class="line">) else (</span><br><span class="line">echo 修改自定义 %_hook% 的哈希值     [成功]</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:oh_process</span><br><span class="line"></span><br><span class="line">for %%# in (%_oIds%) do (</span><br><span class="line">set _key=</span><br><span class="line">set _actid=</span><br><span class="line">set _lic=</span><br><span class="line">set _prod=%%#</span><br><span class="line"></span><br><span class="line">call :ohookdata getinfo %%#</span><br><span class="line"></span><br><span class="line">if not [!_key!]==[] (</span><br><span class="line">echo &quot;!oapplist!&quot; | find /i &quot;!_actid!&quot; %nul1% || call :oh_installlic</span><br><span class="line">call :oh_installkey</span><br><span class="line">) else (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Checking Product In Script              [Office %oVer%.0 %%# not found in script]&quot;</span><br><span class="line">echo 确保您使用的是最新的 MAS 脚本。</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:oh_msiproducts</span><br><span class="line"></span><br><span class="line">set msitemp=%SystemRoot%\Temp\_msitemp.txt</span><br><span class="line"></span><br><span class="line">if %oVer%==15 set _psmsikey=%o15msi_reg:HKLM\=HKLM:%</span><br><span class="line">if %oVer%==16 set _psmsikey=%o16msi_reg:HKLM\=HKLM:%</span><br><span class="line"></span><br><span class="line">if exist %msitemp% del /f /q %msitemp%</span><br><span class="line">%psc% &quot;$Key = &#x27;%_psmsikey%\Registration\&#123;*FF1CE&#125;&#x27;; $keydata = Get-ItemProperty -Path $Key -Name &quot;DigitalProductID&quot;; $binaryData = $keydata.&quot;DigitalProductID&quot;; $stringData = [System.Text.Encoding]::Unicode.GetString($binaryData);$stringData&quot; &gt;&gt;%msitemp%</span><br><span class="line"></span><br><span class="line">if exist %msitemp% call :ohookdata getmsiprod</span><br><span class="line">if exist %msitemp% del /f /q %msitemp%</span><br><span class="line"></span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:oh_processmsi</span><br><span class="line"></span><br><span class="line">::  Process Office MSI Version</span><br><span class="line"></span><br><span class="line">call :oh_reset</span><br><span class="line">call :oh_actids</span><br><span class="line"></span><br><span class="line">set oVer=%1</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %2\Common\InstallRoot /v Path&quot; %nul6%&#x27;) do (set &quot;_oRoot=%%b&quot;)</span><br><span class="line">if &quot;%_oRoot:~-1%&quot;==&quot;\&quot; set &quot;_oRoot=%_oRoot:~0,-1%&quot;</span><br><span class="line"></span><br><span class="line">echo &quot;%2&quot; | find /i &quot;Wow6432Node&quot; %nul1% &amp;&amp; set _oArch=x86</span><br><span class="line">if not [%osarch%]==[x86] if not defined _oArch set _oArch=x64</span><br><span class="line">if [%osarch%]==[x86] set _oArch=x86</span><br><span class="line"></span><br><span class="line">if [%_oArch%]==[x64] (set &quot;_hookPath=%_oRoot%&quot; &amp; set &quot;_hook=sppc64.dll&quot;)</span><br><span class="line">if [%_oArch%]==[x86] (set &quot;_hookPath=%_oRoot%&quot; &amp; set &quot;_hook=sppc32.dll&quot;)</span><br><span class="line">if not [%osarch%]==[x86] (</span><br><span class="line">if [%_oArch%]==[x64] set &quot;_sppcPath=%SystemRoot%\System32\sppc.dll&quot;</span><br><span class="line">if [%_oArch%]==[x86] set &quot;_sppcPath=%SystemRoot%\SysWOW64\sppc.dll&quot;</span><br><span class="line">) else (</span><br><span class="line">set &quot;_sppcPath=%SystemRoot%\System32\sppc.dll&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :oh_msiproducts</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo 激活 Office %1.0 %_oArch% MSI...</span><br><span class="line"></span><br><span class="line">if not defined _oIds (</span><br><span class="line">set error=1</span><br><span class="line">call :dk_color %Red% &quot;Checking Installed Products             [Product IDs not found. Aborting activation...]&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :oh_process</span><br><span class="line">call :oh_hookinstall</span><br><span class="line"></span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Get Office Activation IDs</span><br><span class="line"></span><br><span class="line">:oh_actids</span><br><span class="line"></span><br><span class="line">set oapplist=</span><br><span class="line">if %_wmic% EQU 1 set &quot;chkapp=for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;&quot;wmic path SoftwareLicensingProduct where (ApplicationID=&#x27;0ff1ce15-a989-479d-af46-f275c6370663&#x27;) get ID /VALUE&quot; %nul6%&#x27;)&quot;</span><br><span class="line">if %_wmic% EQU 0 set &quot;chkapp=for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;%psc% &quot;(([WMISEARCHER]&#x27;SELECT ID FROM SoftwareLicensingProduct WHERE ApplicationID=&#x27;&#x27;0ff1ce15-a989-479d-af46-f275c6370663&#x27;&#x27;&#x27;).Get()).ID ^| %% &#123;echo (&#x27;ID=&#x27;+$_)&#125;&quot; %nul6%&#x27;)&quot;</span><br><span class="line">%chkapp% do (if defined oapplist (call set &quot;oapplist=!oapplist! %%a&quot;) else (call set &quot;oapplist=%%a&quot;))</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  1st column = Office version number</span><br><span class="line">::  2nd column = Activation ID</span><br><span class="line">::  3rd column = Generic key. Preference is given in this order, Retail:TB:Sub &gt; Retail &gt; OEM:NONSLP &gt; Volume:MAK &gt; Volume:GVLK</span><br><span class="line">::  4th column = Last part of license description</span><br><span class="line">::  5th column = Edition</span><br><span class="line">::  Separator  = &quot;_&quot;</span><br><span class="line"></span><br><span class="line">:ohookdata</span><br><span class="line"></span><br><span class="line">set f=</span><br><span class="line">for %%# in (</span><br><span class="line">15_ab4d047b-97cf-4126-a69f-34df08e2f254_B7%f%RFY-7N%f%XPK-Q43%f%42-Y9%f%X2H-3JX%f%4X_Retail________AccessRetail</span><br><span class="line">15_4374022d-56b8-48c1-9bb7-d8f2fc726343_9M%f%F9G-CN%f%32B-HV7%f%XT-9X%f%J8T-9KV%f%F4_MAK___________AccessVolume</span><br><span class="line">15_1b1d9bd5-12ea-4063-964c-16e7e87d6e08_NT%f%889-MB%f%H4X-8MD%f%4H-X8%f%R2D-WQH%f%F8_Retail________ExcelRetail</span><br><span class="line">15_ac1ae7fd-b949-4e04-a330-849bc40638cf_Y3%f%N36-YC%f%HDK-XYW%f%BG-KY%f%QVV-BDT%f%J2_MAK___________ExcelVolume</span><br><span class="line">15_cfaf5356-49e3-48a8-ab3c-e729ab791250_BM%f%K4W-6N%f%88B-BP9%f%QR-PH%f%FCK-MG7%f%GF_Retail________GrooveRetail</span><br><span class="line">15_4825ac28-ce41-45a7-9e6e-1fed74057601_RN%f%84D-7H%f%CWY-FTC%f%BK-JM%f%XWM-HT7%f%GJ_MAK___________GrooveVolume</span><br><span class="line">15_c02fb62e-1cd5-4e18-ba25-e0480467ffaa_2W%f%QNF-GB%f%K4B-XVG%f%6F-BB%f%MX7-M4F%f%2Y_OEM-Perp______HomeBusinessPipcRetail</span><br><span class="line">15_a2b90e7a-a797-4713-af90-f0becf52a1dd_YW%f%D4R-CN%f%KVT-VG8%f%VJ-93%f%33B-RCW%f%9F_Subscription__HomeBusinessRetail</span><br><span class="line">15_f2de350d-3028-410a-bfae-283e00b44d0e_6W%f%W3N-BD%f%GM9-PCC%f%HD-9Q%f%PP9-P34%f%QG_Subscription__HomeStudentRetail</span><br><span class="line">15_44984381-406e-4a35-b1c3-e54f499556e2_RV%f%7NQ-HY%f%3WW-7CK%f%WH-QT%f%VMW-29V%f%HC_Retail________InfoPathRetail</span><br><span class="line">15_9e016989-4007-42a6-8051-64eb97110cf2_C4%f%TGN-QQ%f%W6Y-FYK%f%XC-6W%f%JW7-X73%f%VG_MAK___________InfoPathVolume</span><br><span class="line">15_9103f3ce-1084-447a-827e-d6097f68c895_6M%f%DN4-WF%f%3FV-4WH%f%3Q-W6%f%99V-RGC%f%MY_PrepidBypass__LyncAcademicRetail</span><br><span class="line">15_ff693bf4-0276-4ddb-bb42-74ef1a0c9f4d_N4%f%2BF-CB%f%Y9F-W2C%f%7R-X3%f%97X-DYF%f%QW_PrepidBypass__LyncEntryRetail</span><br><span class="line">15_fada6658-bfc6-4c4e-825a-59a89822cda8_89%f%P23-2N%f%K2R-JXM%f%2M-3Q%f%8R8-BWM%f%3Y_Retail________LyncRetail</span><br><span class="line">15_e1264e10-afaf-4439-a98b-256df8bb156f_3W%f%KCD-RN%f%489-4M7%f%XJ-GJ%f%2GQ-YBF%f%Q6_MAK___________LyncVolume</span><br><span class="line">15_69ec9152-153b-471a-bf35-77ec88683eae_VN%f%WHF-FK%f%FBW-Q2R%f%GD-HY%f%HWF-R3H%f%H2_Subscription__MondoRetail</span><br><span class="line">15_f33485a0-310b-4b72-9a0e-b1d605510dbd_2Y%f%NYQ-FQ%f%MVG-CB8%f%KW-6X%f%KYD-M7R%f%RJ_MAK___________MondoVolume</span><br><span class="line">15_3391e125-f6e4-4b1e-899c-a25e6092d40d_4T%f%GWV-6N%f%9P6-G2H%f%8Y-2H%f%WKB-B4F%f%F4_Bypass________OneNoteFreeRetail</span><br><span class="line">15_8b524bcc-67ea-4876-a509-45e46f6347e8_3K%f%XXQ-PV%f%N2C-8P7%f%YY-HC%f%V88-GVG%f%Q6_Retail________OneNoteRetail</span><br><span class="line">15_b067e965-7521-455b-b9f7-c740204578a2_JD%f%MWF-NJ%f%C7B-HRC%f%HY-WF%f%T8G-BPX%f%D9_MAK___________OneNoteVolume</span><br><span class="line">15_12004b48-e6c8-4ffa-ad5a-ac8d4467765a_9N%f%4RQ-CF%f%8R2-HBV%f%CB-J3%f%C9V-94P%f%4D_Retail________OutlookRetail</span><br><span class="line">15_8d577c50-ae5e-47fd-a240-24986f73d503_HN%f%G29-GG%f%WRG-RFC%f%8C-JT%f%FP4-2J9%f%FH_MAK___________OutlookVolume</span><br><span class="line">15_5aab8561-1686-43f7-9ff5-2c861da58d17_9C%f%YB3-NF%f%MRW-YFD%f%G6-XC%f%7TF-BY3%f%6J_OEM-Perp______PersonalPipcRetail</span><br><span class="line">15_17e9df2d-ed91-4382-904b-4fed6a12caf0_2N%f%CQJ-MF%f%RMH-TXV%f%83-J7%f%V4C-RVR%f%WC_Retail________PersonalRetail</span><br><span class="line">15_31743b82-bfbc-44b6-aa12-85d42e644d5b_HV%f%MN2-KP%f%HQH-DVQ%f%MK-7B%f%3CM-FGB%f%FC_Retail________PowerPointRetail</span><br><span class="line">15_e40dcb44-1d5c-4085-8e8f-943f33c4f004_47%f%DKN-HP%f%JP7-RF9%f%M3-VC%f%YT2-TMQ%f%4G_MAK___________PowerPointVolume</span><br><span class="line">15_064383fa-1538-491c-859b-0ecab169a0ab_N3%f%QMM-GK%f%DT3-JQG%f%X6-7X%f%3MQ-4GB%f%G3_Retail________ProPlusRetail</span><br><span class="line">15_2b88c4f2-ea8f-43cd-805e-4d41346e18a7_QK%f%HNX-M9%f%GGH-T3Q%f%MW-YP%f%K4Q-QRP%f%9V_MAK___________ProPlusVolume</span><br><span class="line">15_4e26cac1-e15a-4467-9069-cb47b67fe191_CF%f%9DD-6C%f%NW2-BJW%f%JQ-CV%f%CFX-Y7T%f%XD_OEM-Perp______ProfessionalPipcRetail</span><br><span class="line">15_44bc70e2-fb83-4b09-9082-e5557e0c2ede_MB%f%QBN-CQ%f%PT6-PXR%f%MC-TY%f%JFR-3C8%f%MY_Retail________ProfessionalRetail</span><br><span class="line">15_2f72340c-b555-418d-8b46-355944fe66b8_WP%f%Y8N-PD%f%PY4-FC7%f%TF-KM%f%P7P-KWY%f%FY_Subscription__ProjectProRetail</span><br><span class="line">15_ed34dc89-1c27-4ecd-8b2f-63d0f4cedc32_WF%f%CT2-NB%f%FQ7-JD7%f%VV-MF%f%JX6-6F2%f%CM_MAK___________ProjectProVolume</span><br><span class="line">15_58d95b09-6af6-453d-a976-8ef0ae0316b1_NT%f%HQT-VK%f%K6W-BRB%f%87-HV%f%346-Y96%f%W8_Subscription__ProjectStdRetail</span><br><span class="line">15_2b9e4a37-6230-4b42-bee2-e25ce86c8c7a_3C%f%NQX-T3%f%4TY-99R%f%H4-C4%f%YD2-KWY%f%GV_MAK___________ProjectStdVolume</span><br><span class="line">15_c3a0814a-70a4-471f-af37-2313a6331111_TW%f%NCJ-YR%f%84W-X7P%f%PF-6D%f%PRP-D67%f%VC_Retail________PublisherRetail</span><br><span class="line">15_38ea49f6-ad1d-43f1-9888-99a35d7c9409_DJ%f%PHV-NC%f%JV6-GWP%f%T6-K2%f%6JX-C7G%f%X6_MAK___________PublisherVolume</span><br><span class="line">15_ba3e3833-6a7e-445a-89d0-7802a9a68588_3N%f%Y6J-WH%f%T3F-47B%f%DV-JH%f%F36-234%f%3W_PrepidBypass__SPDRetail</span><br><span class="line">15_32255c0a-16b4-4ce2-b388-8a4267e219eb_V6%f%VWN-KC%f%2HR-YYD%f%D6-9V%f%7HQ-7T7%f%VP_Retail________StandardRetail</span><br><span class="line">15_a24cca51-3d54-4c41-8a76-4031f5338cb2_9T%f%N6B-PC%f%YH4-MCV%f%DQ-KT%f%83C-TMQ%f%7T_MAK___________StandardVolume</span><br><span class="line">15_a56a3b37-3a35-4bbb-a036-eee5f1898eee_NV%f%K2G-2M%f%Y4G-7JX%f%2P-7D%f%6F2-VFQ%f%BR_Subscription__VisioProRetail</span><br><span class="line">15_3e4294dd-a765-49bc-8dbd-cf8b62a4bd3d_YN%f%7CF-XR%f%H6R-CGK%f%RY-GK%f%PV3-BG7%f%WF_MAK___________VisioProVolume</span><br><span class="line">15_980f9e3e-f5a8-41c8-8596-61404addf677_NC%f%RB7-VP%f%48F-43F%f%YY-62%f%P3R-367%f%WK_Subscription__VisioStdRetail</span><br><span class="line">15_44a1f6ff-0876-4edb-9169-dbb43101ee89_RX%f%63Y-4N%f%FK2-XTY%f%C8-C6%f%B3W-YPX%f%PJ_MAK___________VisioStdVolume</span><br><span class="line">15_191509f2-6977-456f-ab30-cf0492b1e93a_NB%f%77V-RP%f%FQ6-PMM%f%KQ-T8%f%7DV-M4D%f%84_Retail________WordRetail</span><br><span class="line">15_9cedef15-be37-4ff0-a08a-13a045540641_RP%f%HPB-Y7%f%NC4-3VY%f%FM-DW%f%7VD-G8Y%f%J8_MAK___________WordVolume</span><br><span class="line">15_6337137e-7c07-4197-8986-bece6a76fc33_2P%f%3C9-BQ%f%NJH-VCV%f%PH-YD%f%Y6M-43J%f%PQ_Subscription__O365BusinessRetail</span><br><span class="line">15_537ea5b5-7d50-4876-bd38-a53a77caca32_J2%f%W28-TN%f%9C8-26P%f%WV-F7%f%J4G-72X%f%CB_Subscription1_O365HomePremRetail</span><br><span class="line">15_149dbce7-a48e-44db-8364-a53386cd4580_2N%f%382-D6%f%PKK-QTX%f%4D-2J%f%JYK-M96%f%P2_Subscription1_O365ProPlusRetail</span><br><span class="line">15_bacd4614-5bef-4a5e-bafc-de4c788037a2_HN%f%8JP-87%f%TQJ-PBF%f%3P-Y6%f%6KC-W2K%f%9V_Subscription1_O365SmallBusPremRetail</span><br><span class="line">16_bfa358b0-98f1-4125-842e-585fa13032e6_WH%f%K4N-YQ%f%GHB-XWX%f%CC-G3%f%HYC-6JF%f%94_Retail________AccessRetail</span><br><span class="line">16_9d9faf9e-d345-4b49-afce-68cb0a539c7c_RN%f%B7V-P4%f%8F4-3FY%f%Y6-2P%f%3R3-63B%f%QV_PrepidBypass__AccessRuntimeRetail</span><br><span class="line">16_3b2fa33f-cd5a-43a5-bd95-f49f3f546b0b_JJ%f%2Y4-N8%f%KM3-Y8K%f%Y3-Y2%f%2FR-R3K%f%VK_MAK___________AccessVolume</span><br><span class="line">16_424d52ff-7ad2-4bc7-8ac6-748d767b455d_RK%f%JBN-VW%f%TM2-BDK%f%XX-RK%f%QFD-JTY%f%Q2_Retail________ExcelRetail</span><br><span class="line">16_685062a7-6024-42e7-8c5f-6bb9e63e697f_FV%f%GNR-X8%f%2B2-6PR%f%JM-YT%f%4W7-8HV%f%36_MAK___________ExcelVolume</span><br><span class="line">16_c02fb62e-1cd5-4e18-ba25-e0480467ffaa_2W%f%QNF-GB%f%K4B-XVG%f%6F-BB%f%MX7-M4F%f%2Y_OEM-Perp______HomeBusinessPipcRetail</span><br><span class="line">16_86834d00-7896-4a38-8fae-32f20b86fa2b_HM%f%6FM-NV%f%F78-KV9%f%PM-F3%f%6B8-D9M%f%XD_Retail________HomeBusinessRetail</span><br><span class="line">16_c28acdb8-d8b3-4199-baa4-024d09e97c99_PN%f%PRV-F2%f%627-Q8J%f%VC-3D%f%GR9-WTY%f%RK_Retail________HomeStudentRetail</span><br><span class="line">16_e2127526-b60c-43e0-bed1-3c9dc3d5a468_YW%f%D4R-CN%f%KVT-VG8%f%VJ-93%f%33B-RC3%f%B8_Retail________HomeStudentVNextRetail</span><br><span class="line">16_69ec9152-153b-471a-bf35-77ec88683eae_VN%f%WHF-FK%f%FBW-Q2R%f%GD-HY%f%HWF-R3H%f%H2_Subscription__MondoRetail</span><br><span class="line">16_2cd0ea7e-749f-4288-a05e-567c573b2a6c_FM%f%TQQ-84%f%NR8-274%f%4R-MX%f%F4P-PGY%f%R3_MAK___________MondoVolume</span><br><span class="line">16_436366de-5579-4f24-96db-3893e4400030_XY%f%NTG-R9%f%6FY-369%f%HX-YF%f%PHY-F9C%f%PM_Bypass________OneNoteFreeRetail</span><br><span class="line">16_83ac4dd9-1b93-40ed-aa55-ede25bb6af38_FX%f%F6F-CN%f%C26-W64%f%3C-K6%f%KB7-6XX%f%W3_Retail________OneNoteRetail</span><br><span class="line">16_23b672da-a456-4860-a8f3-e062a501d7e8_9T%f%YVN-D7%f%6HK-BVM%f%WT-Y7%f%G88-9TP%f%PV_MAK___________OneNoteVolume</span><br><span class="line">16_5a670809-0983-4c2d-8aad-d3c2c5b7d5d1_7N%f%4KG-P2%f%QDH-86V%f%9C-DJ%f%FVF-369%f%W9_Retail________OutlookRetail</span><br><span class="line">16_50059979-ac6f-4458-9e79-710bcb41721a_7Q%f%PNR-3H%f%FDG-YP6%f%T9-JQ%f%CKQ-KKX%f%XC_MAK___________OutlookVolume</span><br><span class="line">16_5aab8561-1686-43f7-9ff5-2c861da58d17_9C%f%YB3-NF%f%MRW-YFD%f%G6-XC%f%7TF-BY3%f%6J_OEM-Perp______PersonalPipcRetail</span><br><span class="line">16_a9f645a1-0d6a-4978-926a-abcb363b72a6_FT%f%7VF-XB%f%N92-HPD%f%JV-RH%f%MBY-6VK%f%BF_Retail________PersonalRetail</span><br><span class="line">16_f32d1284-0792-49da-9ac6-deb2bc9c80b6_N7%f%GCB-WQ%f%T7K-QRH%f%WG-TT%f%PYD-7T9%f%XF_Retail________PowerPointRetail</span><br><span class="line">16_9b4060c9-a7f5-4a66-b732-faf248b7240f_X3%f%RT9-ND%f%G64-VMK%f%2M-KQ%f%6XY-DPF%f%GV_MAK___________PowerPointVolume</span><br><span class="line">16_de52bd50-9564-4adc-8fcb-a345c17f84f9_GM%f%43N-F7%f%42Q-6JD%f%DK-M6%f%22J-J8G%f%DV_Retail________ProPlusRetail</span><br><span class="line">16_c47456e3-265d-47b6-8ca0-c30abbd0ca36_FN%f%VK8-8D%f%VCJ-F7X%f%3J-KG%f%VQB-RC2%f%QY_MAK___________ProPlusVolume</span><br><span class="line">16_4e26cac1-e15a-4467-9069-cb47b67fe191_CF%f%9DD-6C%f%NW2-BJW%f%JQ-CV%f%CFX-Y7T%f%XD_OEM-Perp______ProfessionalPipcRetail</span><br><span class="line">16_d64edc00-7453-4301-8428-197343fafb16_NX%f%FTK-YD%f%9Y7-X9M%f%MJ-9B%f%WM6-J2Q%f%VH_Retail________ProfessionalRetail</span><br><span class="line">16_2f72340c-b555-418d-8b46-355944fe66b8_WP%f%Y8N-PD%f%PY4-FC7%f%TF-KM%f%P7P-KWY%f%FY_Subscription__ProjectProRetail</span><br><span class="line">16_82f502b5-b0b0-4349-bd2c-c560df85b248_PK%f%C3N-8F%f%99H-28M%f%VY-J4%f%RYY-CWG%f%DH_MAK___________ProjectProVolume</span><br><span class="line">16_16728639-a9ab-4994-b6d8-f81051e69833_JB%f%NPH-YF%f%2F7-Q9Y%f%29-86%f%CTG-C9Y%f%GV_MAKC2R________ProjectProXVolume</span><br><span class="line">16_58d95b09-6af6-453d-a976-8ef0ae0316b1_NT%f%HQT-VK%f%K6W-BRB%f%87-HV%f%346-Y96%f%W8_Subscription__ProjectStdRetail</span><br><span class="line">16_82e6b314-2a62-4e51-9220-61358dd230e6_4T%f%GWV-6N%f%9P6-G2H%f%8Y-2H%f%WKB-B4G%f%93_MAK___________ProjectStdVolume</span><br><span class="line">16_431058f0-c059-44c5-b9e7-ed2dd46b6789_N3%f%W2Q-69%f%MBT-27R%f%D9-BH%f%8V3-JT2%f%C8_MAKC2R________ProjectStdXVolume</span><br><span class="line">16_6e0c1d99-c72e-4968-bcb7-ab79e03e201e_WK%f%WND-X6%f%G9G-CDM%f%TV-CP%f%GYJ-6MV%f%BF_Retail________PublisherRetail</span><br><span class="line">16_fcc1757b-5d5f-486a-87cf-c4d6dedb6032_9Q%f%VN2-PX%f%XRX-8V4%f%W8-Q7%f%926-TJG%f%D8_MAK___________PublisherVolume</span><br><span class="line">16_9103f3ce-1084-447a-827e-d6097f68c895_6M%f%DN4-WF%f%3FV-4WH%f%3Q-W6%f%99V-RGC%f%MY_PrepidBypass__SkypeServiceBypassRetail</span><br><span class="line">16_971cd368-f2e1-49c1-aedd-330909ce18b6_4N%f%4D8-3J%f%7Y3-YYW%f%7C-73%f%HD2-V8R%f%HY_PrepidBypass__SkypeforBusinessEntryRetail</span><br><span class="line">16_418d2b9f-b491-4d7f-84f1-49e27cc66597_PB%f%J79-77%f%NY4-VRG%f%FG-Y8%f%WYC-CKC%f%RC_Retail________SkypeforBusinessRetail</span><br><span class="line">16_03ca3b9a-0869-4749-8988-3cbc9d9f51bb_DM%f%TCJ-KN%f%RKR-JV8%f%TQ-V2%f%CR2-VFT%f%FH_MAK___________SkypeforBusinessVolume</span><br><span class="line">16_4a31c291-3a12-4c64-b8ab-cd79212be45e_2F%f%PWN-4H%f%6CM-KD8%f%QQ-8H%f%CHC-P9X%f%YW_Retail________StandardRetail</span><br><span class="line">16_0ed94aac-2234-4309-ba29-74bdbb887083_WH%f%GMQ-JN%f%MGT-MDQ%f%VF-WD%f%R69-KQB%f%WC_MAK___________StandardVolume</span><br><span class="line">16_a56a3b37-3a35-4bbb-a036-eee5f1898eee_NV%f%K2G-2M%f%Y4G-7JX%f%2P-7D%f%6F2-VFQ%f%BR_Subscription__VisioProRetail</span><br><span class="line">16_295b2c03-4b1c-4221-b292-1411f468bd02_NR%f%KT9-C8%f%GP2-XDY%f%XQ-YW%f%72K-MG9%f%2B_MAK___________VisioProVolume</span><br><span class="line">16_0594dc12-8444-4912-936a-747ca742dbdb_G9%f%8Q2-B6%f%N77-CFH%f%9J-K8%f%24G-XQC%f%C4_MAKC2R________VisioProXVolume</span><br><span class="line">16_980f9e3e-f5a8-41c8-8596-61404addf677_NC%f%RB7-VP%f%48F-43F%f%YY-62%f%P3R-367%f%WK_Subscription__VisioStdRetail</span><br><span class="line">16_44151c2d-c398-471f-946f-7660542e3369_XN%f%CJB-YY%f%883-JRW%f%64-DP%f%XMX-JXC%f%R6_MAK___________VisioStdVolume</span><br><span class="line">16_1d1c6879-39a3-47a5-9a6d-aceefa6a289d_B2%f%HTN-JP%f%H8C-J6Y%f%6V-HC%f%HKB-43M%f%GT_MAKC2R________VisioStdXVolume</span><br><span class="line">16_cacaa1bf-da53-4c3b-9700-11738ef1c2a5_P8%f%K82-NQ%f%7GG-JKY%f%8T-6V%f%HVY-88G%f%GD_Retail________WordRetail</span><br><span class="line">16_c3000759-551f-4f4a-bcac-a4b42cbf1de2_YH%f%MWC-YN%f%6V9-WJP%f%XD-3W%f%QKP-TMV%f%CV_MAK___________WordVolume</span><br><span class="line">16_518687bd-dc55-45b9-8fa6-f918e1082e83_WR%f%YJ6-G3%f%NP7-7VH%f%94-8X%f%7KP-JB7%f%HC_Retail________Access2019Retail</span><br><span class="line">16_385b91d6-9c2c-4a2e-86b5-f44d44a48c5f_6F%f%WHX-NK%f%YXK-BW3%f%4Q-7X%f%C9F-Q9P%f%X7_MAK-AE________Access2019Volume</span><br><span class="line">16_22e6b96c-1011-4cd5-8b35-3c8fb6366b86_FG%f%QNJ-JW%f%JCG-7Q8%f%MG-RM%f%RGJ-9TQ%f%VF_PrepidBypass__AccessRuntime2019Retail</span><br><span class="line">16_c201c2b7-02a1-41a8-b496-37c72910cd4a_KB%f%PNW-64%f%CMM-8KW%f%CB-23%f%F44-8B7%f%HM_Retail________Excel2019Retail</span><br><span class="line">16_05cb4e1d-cc81-45d5-a769-f34b09b9b391_8N%f%T4X-GQ%f%MCK-62X%f%4P-TW%f%6QP-YKP%f%YF_MAK-AE________Excel2019Volume</span><br><span class="line">16_7fe09eef-5eed-4733-9a60-d7019df11cac_QB%f%N2Y-9B%f%284-9KW%f%78-K4%f%8PB-R62%f%YT_Retail________HomeBusiness2019Retail</span><br><span class="line">16_4539aa2c-5c31-4d47-9139-543a868e5741_XN%f%WPM-32%f%XQC-Y7Q%f%JC-QG%f%GBV-YY7%f%JK_Retail________HomeStudent2019Retail</span><br><span class="line">16_20e359d5-927f-47c0-8a27-38adbdd27124_WR%f%43D-NM%f%WQQ-HCQ%f%R2-VK%f%XDR-37B%f%7H_Retail________Outlook2019Retail</span><br><span class="line">16_92a99ed8-2923-4cb7-a4c5-31da6b0b8cf3_RN%f%3QB-GT%f%6D7-YB3%f%VH-F3%f%RPB-3GQ%f%YB_MAK-AE________Outlook2019Volume</span><br><span class="line">16_2747b731-0f1f-413e-a92d-386ec1277dd8_NM%f%BY8-V3%f%CV7-BX6%f%K6-29%f%22Y-43M%f%7T_Retail________Personal2019Retail</span><br><span class="line">16_7e63cc20-ba37-42a1-822d-d5f29f33a108_HN%f%27K-JH%f%J8R-7T7%f%KK-WJ%f%YC3-FM7%f%MM_Retail________PowerPoint2019Retail</span><br><span class="line">16_13c2d7bf-f10d-42eb-9e93-abf846785434_29%f%GNM-VM%f%33V-WR2%f%3K-HG%f%2DT-KTQ%f%YR_MAK-AE________PowerPoint2019Volume</span><br><span class="line">16_a3072b8f-adcc-4e75-8d62-fdeb9bdfae57_BN%f%4XJ-R9%f%DYY-96W%f%48-YK%f%8DM-MY7%f%PY_Retail________ProPlus2019Retail</span><br><span class="line">16_6755c7a7-4dfe-46f5-bce8-427be8e9dc62_T8%f%YBN-4Y%f%V3X-KK2%f%4Q-QX%f%BD7-T3C%f%63_MAK-AE________ProPlus2019Volume</span><br><span class="line">16_1717c1e0-47d3-4899-a6d3-1022db7415e0_9N%f%XDK-MR%f%Y98-2VJ%f%V8-GF%f%73J-TQ9%f%FK_Retail________Professional2019Retail</span><br><span class="line">16_0d270ef7-5aaf-4370-a372-bc806b96adb7_JD%f%TNC-PP%f%77T-T9H%f%2W-G4%f%J2J-VH8%f%JK_Retail________ProjectPro2019Retail</span><br><span class="line">16_d4ebadd6-401b-40d5-adf4-a5d4accd72d1_TB%f%XBD-FN%f%WKJ-WRH%f%BD-KB%f%PHH-XD9%f%F2_MAK-AE________ProjectPro2019Volume</span><br><span class="line">16_bb7ffe5f-daf9-4b79-b107-453e1c8427b5_R3%f%JNT-8P%f%BDP-MTW%f%CK-VD%f%2V8-HMK%f%F9_Retail________ProjectStd2019Retail</span><br><span class="line">16_fdaa3c03-dc27-4a8d-8cbf-c3d843a28ddc_RB%f%RFX-MQ%f%NDJ-4XF%f%HF-7Q%f%VDR-JHX%f%GC_MAK-AE________ProjectStd2019Volume</span><br><span class="line">16_f053a7c7-f342-4ab8-9526-a1d6e5105823_4Q%f%C36-NW%f%3YH-D2Y%f%9D-RJ%f%PC7-VVB%f%9D_Retail________Publisher2019Retail</span><br><span class="line">16_40055495-be00-444e-99cc-07446729b53e_K8%f%F2D-NB%f%M32-BF2%f%6V-YC%f%KFJ-29Y%f%9W_MAK-AE________Publisher2019Volume</span><br><span class="line">16_b639e55c-8f3e-47fe-9761-26c6a786ad6b_JB%f%DKF-6N%f%CD6-49K%f%3G-2T%f%V79-BKP%f%73_Retail________SkypeforBusiness2019Retail</span><br><span class="line">16_15a430d4-5e3f-4e6d-8a0a-14bf3caee4c7_9M%f%NQ7-YP%f%Q3B-6WJ%f%XM-G8%f%3T3-CBB%f%DK_MAK-AE________SkypeforBusiness2019Volume</span><br><span class="line">16_f88cfdec-94ce-4463-a969-037be92bc0e7_N9%f%722-BV%f%9H6-WTJ%f%TT-FP%f%B93-978%f%MK_PrepidBypass__SkypeforBusinessEntry2019Retail</span><br><span class="line">16_fdfa34dd-a472-4b85-bee6-cf07bf0aaa1c_ND%f%GVM-MD%f%27H-2XH%f%VC-KD%f%DX2-YKP%f%74_Retail________Standard2019Retail</span><br><span class="line">16_beb5065c-1872-409e-94e2-403bcfb6a878_NT%f%3V6-XM%f%BK7-Q66%f%MF-VM%f%KR4-FC3%f%3M_MAK-AE________Standard2019Volume</span><br><span class="line">16_a6f69d68-5590-4e02-80b9-e7233dff204e_2N%f%WVW-QG%f%F4T-9CP%f%MB-WY%f%DQ9-7XP%f%79_Retail________VisioPro2019Retail</span><br><span class="line">16_f41abf81-f409-4b0d-889d-92b3e3d7d005_33%f%YF4-GN%f%CQ3-J6G%f%DM-J6%f%7P3-FM7%f%QP_MAK-AE________VisioPro2019Volume</span><br><span class="line">16_4a582021-18c2-489f-9b3d-5186de48f1cd_26%f%3WK-3N%f%797-7R4%f%37-28%f%BKG-3V8%f%M8_Retail________VisioStd2019Retail</span><br><span class="line">16_933ed0e3-747d-48b0-9c2c-7ceb4c7e473d_BG%f%NHX-QT%f%PRJ-F9C%f%9G-R8%f%QQG-8T2%f%7F_MAK-AE________VisioStd2019Volume</span><br><span class="line">16_72cee1c2-3376-4377-9f25-4024b6baadf8_JX%f%R8H-NJ%f%3MK-X66%f%W8-78%f%CWD-QRV%f%R2_Retail________Word2019Retail</span><br><span class="line">16_fe5fe9d5-3b06-4015-aa35-b146f85c4709_9F%f%36R-PN%f%VHH-3DX%f%GQ-7C%f%D2H-R9D%f%3V_MAK-AE________Word2019Volume</span><br><span class="line">16_f634398e-af69-48c9-b256-477bea3078b5_P2%f%86B-N3%f%XYP-36Q%f%RQ-29%f%CMP-RVX%f%9M_Retail________Access2021Retail</span><br><span class="line">16_ae17db74-16b0-430b-912f-4fe456e271db_JB%f%H3N-P9%f%7FP-FRT%f%JD-MG%f%K2C-VFW%f%G6_MAK-AE________Access2021Volume</span><br><span class="line">16_fb099c19-d48b-4a2f-a160-4383011060aa_V6%f%QFB-7N%f%7G9-PF7%f%W9-M8%f%FQM-MY8%f%G9_Retail________Excel2021Retail</span><br><span class="line">16_9da1ecdb-3a62-4273-a234-bf6d43dc0778_WN%f%YR4-KM%f%R9H-KVC%f%8W-7H%f%J8B-K79%f%DQ_MAK-AE________Excel2021Volume</span><br><span class="line">16_38b92b63-1dff-4be7-8483-2a839441a2bc_JM%f%99N-4M%f%MD8-DQC%f%GJ-VM%f%YFY-R63%f%YK_Subscription__HomeBusiness2021Retail</span><br><span class="line">16_2f258377-738f-48dd-9397-287e43079958_N3%f%CWD-38%f%XVH-KRX%f%2Y-YR%f%P74-6RB%f%B2_Subscription__HomeStudent2021Retail</span><br><span class="line">16_279706f4-3a4b-4877-949b-f8c299cf0cc5_NB%f%2TQ-3Y%f%79C-77C%f%6M-QM%f%Y7H-7QY%f%8P_Retail________OneNote2021Retail</span><br><span class="line">16_ecea2cfa-d406-4a7f-be0d-c6163250d126_4N%f%CWR-9V%f%92Y-34V%f%B2-RP%f%THR-YTG%f%R7_Retail________Outlook2021Retail</span><br><span class="line">16_45bf67f9-0fc8-4335-8b09-9226cef8a576_JQ%f%9MJ-QY%f%N6B-67P%f%X9-GY%f%FVY-QJ6%f%TB_MAK-AE________Outlook2021Volume</span><br><span class="line">16_8f89391e-eedb-429d-af90-9d36fbf94de6_RR%f%RYB-DN%f%749-GCP%f%W4-9H%f%6VK-HCH%f%PT_Retail________Personal2021Retail</span><br><span class="line">16_c9bf5e86-f5e3-4ac6-8d52-e114a604d7bf_3K%f%XXQ-PV%f%N2C-8P7%f%YY-HC%f%V88-GVM%f%96_Retail1_______PowerPoint2021Retail</span><br><span class="line">16_716f2434-41b6-4969-ab73-e61e593a3875_39%f%G2N-3B%f%D9C-C4X%f%CM-BD%f%4QG-FVY%f%DY_MAK-AE________PowerPoint2021Volume</span><br><span class="line">16_c2f04adf-a5de-45c5-99a5-f5fddbda74a8_8W%f%XTP-MN%f%628-KY4%f%4G-VJ%f%WCK-C7P%f%CF_Retail________ProPlus2021Retail</span><br><span class="line">16_3f180b30-9b05-4fe2-aa8d-0c1c4790f811_RN%f%HJY-DT%f%FXW-HW9%f%F8-49%f%82D-MD2%f%CW_MAK-AE1_______ProPlus2021Volume</span><br><span class="line">16_96097a68-b5c5-4b19-8600-2e8d6841a0db_JR%f%JNJ-33%f%M7C-R73%f%X3-P9%f%XF7-R9F%f%6M_MAK-AE________ProPlusSPLA2021Volume</span><br><span class="line">16_711e48a6-1a79-4b00-af10-73f4ca3aaac4_DJ%f%PHV-NC%f%JV6-GWP%f%T6-K2%f%6JX-C7P%f%BG_Retail________Professional2021Retail</span><br><span class="line">16_3747d1d5-55a8-4bc3-b53d-19fff1913195_QK%f%HNX-M9%f%GGH-T3Q%f%MW-YP%f%K4Q-QRW%f%MV_Retail________ProjectPro2021Retail</span><br><span class="line">16_17739068-86c4-4924-8633-1e529abc7efc_HV%f%C34-CV%f%NPG-RVC%f%MT-X2%f%JRF-CR7%f%RK_MAK-AE1_______ProjectPro2021Volume</span><br><span class="line">16_4ea64dca-227c-436b-813f-b6624be2d54c_2B%f%96V-X9%f%NJY-WFB%f%RC-Q8%f%MP2-7CH%f%RR_Retail________ProjectStd2021Retail</span><br><span class="line">16_84313d1e-47c8-4e27-8ced-0476b7ee46c4_3C%f%NQX-T3%f%4TY-99R%f%H4-C4%f%YD2-KW6%f%WH_MAK-AE________ProjectStd2021Volume</span><br><span class="line">16_b769b746-53b1-4d89-8a68-41944dafe797_CD%f%NFG-77%f%T8D-VKQ%f%JX-B7%f%KT3-KK2%f%8V_Retail1_______Publisher2021Retail</span><br><span class="line">16_a0234cfe-99bd-4586-a812-4f296323c760_2K%f%XJH-3N%f%HTW-RDB%f%PX-QF%f%RXJ-MTG%f%XF_MAK-AE________Publisher2021Volume</span><br><span class="line">16_c3fb48b2-1fd4-4dc8-af39-819edf194288_DV%f%BXN-HF%f%T43-CVP%f%RQ-J8%f%9TF-VMM%f%HG_Retail________SkypeforBusiness2021Retail</span><br><span class="line">16_6029109c-ceb8-4ee5-b324-f8eb2981e99a_R3%f%FCY-NH%f%GC7-CBP%f%VP-8Q%f%934-YTG%f%XG_MAK-AE________SkypeforBusiness2021Volume</span><br><span class="line">16_9e7e7b8e-a0e7-467b-9749-d0de82fb7297_HX%f%NXB-J4%f%JGM-TCF%f%44-2X%f%2CV-FJV%f%VH_Retail________Standard2021Retail</span><br><span class="line">16_223a60d8-9002-4a55-abac-593f5b66ca45_2C%f%JN4-C9%f%XK2-HFP%f%Q6-YH%f%498-82T%f%XH_MAK-AE________Standard2021Volume</span><br><span class="line">16_b99ba8c4-e257-4b70-a31a-8bd308ce7073_BQ%f%WDW-NJ%f%9YF-P7Y%f%79-H6%f%DCT-MKQ%f%9C_MAK-AE________StandardSPLA2021Volume</span><br><span class="line">16_814014d3-c30b-4f63-a493-3708e0dc0ba8_T6%f%P26-NJ%f%VBR-76B%f%K8-WB%f%CDY-TX3%f%BC_Retail________VisioPro2021Retail</span><br><span class="line">16_c590605a-a08a-4cc7-8dc2-f1ffb3d06949_JN%f%KBX-MH%f%9P4-K8Y%f%YV-8C%f%G2Y-VQ2%f%C8_MAK-AE________VisioPro2021Volume</span><br><span class="line">16_16d43989-a5ef-47e2-9ff1-272784caee24_89%f%NYY-KB%f%93R-7X2%f%2F-93%f%QDF-DJ6%f%YM_Retail________VisioStd2021Retail</span><br><span class="line">16_d55f90ee-4ba2-4d02-b216-1300ee50e2af_BW%f%43B-4P%f%NFP-V63%f%7F-23%f%TR2-J47%f%TX_MAK-AE________VisioStd2021Volume</span><br><span class="line">16_fb33d997-4aa3-494e-8b58-03e9ab0f181d_VN%f%CC4-CJ%f%QVK-BKX%f%34-77%f%Y8H-CYX%f%MR_Retail________Word2021Retail</span><br><span class="line">16_0c728382-95fb-4a55-8f12-62e605f91727_BJ%f%G97-NW%f%3GM-8QQ%f%Q7-FH%f%76G-686%f%XM_MAK-AE________Word2021Volume</span><br><span class="line">16_6337137e-7c07-4197-8986-bece6a76fc33_2P%f%3C9-BQ%f%NJH-VCV%f%PH-YD%f%Y6M-43J%f%PQ_Subscription__O365BusinessRetail</span><br><span class="line">16_2f5c71b4-5b7a-4005-bb68-f9fac26f2ea3_W6%f%2NQ-26%f%7QR-RTF%f%74-PF%f%2MH-JQM%f%TH_Subscription__O365EduCloudRetail</span><br><span class="line">16_537ea5b5-7d50-4876-bd38-a53a77caca32_J2%f%W28-TN%f%9C8-26P%f%WV-F7%f%J4G-72X%f%CB_Subscription1_O365HomePremRetail</span><br><span class="line">16_149dbce7-a48e-44db-8364-a53386cd4580_2N%f%382-D6%f%PKK-QTX%f%4D-2J%f%JYK-M96%f%P2_Subscription1_O365ProPlusRetail</span><br><span class="line">16_bacd4614-5bef-4a5e-bafc-de4c788037a2_HN%f%8JP-87%f%TQJ-PBF%f%3P-Y6%f%6KC-W2K%f%9V_Subscription1_O365SmallBusPremRetail</span><br><span class="line">) do (</span><br><span class="line">for /f &quot;tokens=1-5 delims=_&quot; %%A in (&quot;%%#&quot;) do (</span><br><span class="line"></span><br><span class="line">if %1==getinfo if not defined _key (</span><br><span class="line">if %oVer%==%%A if /i &quot;%2&quot;==&quot;%%E&quot; (</span><br><span class="line">set _key=%%C</span><br><span class="line">set _actid=%%B</span><br><span class="line">set _allactid=!_allactid! %%B</span><br><span class="line">set _lic=%%D</span><br><span class="line">if %oVer%==16 (echo &quot;%%D&quot; | find /i &quot;Subscription&quot; %nul% &amp;&amp; set _sublic=1)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %1==getmsiprod if %oVer%==%%A (</span><br><span class="line">find /i &quot;%%E&quot; %msitemp% %nul% &amp;&amp; (</span><br><span class="line">if defined _oIds (set _oIds=!_oIds! %%E) else (set _oIds=%%E)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  This code is used to modify the timestamp value of sppc dll file in order to change checksums</span><br><span class="line">::  It&#x27;s done to lower the potential false positive detection by antivirus&#x27;s. On each install, it will install a unique sppc dll file</span><br><span class="line"></span><br><span class="line">:oh_extractdll</span><br><span class="line"></span><br><span class="line">set b=</span><br><span class="line">%psc% &quot;$f=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split &#x27;:%_hook%\:.*&#x27;;$bytes = [Con%b%vert]::FromBas%b%e64String($f[1]); $PePath=&#x27;%1&#x27;; $m=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split &#x27;:hexedit\:.*&#x27;;iex ($m[1]);&quot; %nul2% | find /i &quot;Error found&quot; %nul1% &amp;&amp; set hasherror=1</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:hexedit:</span><br><span class="line"># Use a MemoryStream to perform operations on the bytes</span><br><span class="line">$MemoryStream = New-Object System.IO.MemoryStream</span><br><span class="line">$Writer = New-Object System.IO.BinaryWriter($MemoryStream)</span><br><span class="line">$Writer.Write($bytes)</span><br><span class="line"></span><br><span class="line"># Define dynamic assembly, module, and type</span><br><span class="line">$AssemblyBuilder = [AppDomain]::CurrentDomain.DefineDynamicAssembly(4, 1)</span><br><span class="line">$ModuleBuilder = $AssemblyBuilder.DefineDynamicModule(2, $False)</span><br><span class="line">$TypeBuilder = $ModuleBuilder.DefineType(0)</span><br><span class="line"></span><br><span class="line"># Define P/Invoke method</span><br><span class="line">[void]$TypeBuilder.DefinePInvokeMethod(&#x27;MapFileAndCheckSum&#x27;, &#x27;imagehlp.dll&#x27;, &#x27;Public, Static&#x27;, [Reflection.CallingConventions]::Standard, [int], @([string], [int].MakeByRefType(), [int].MakeByRefType()), [Runtime.InteropServices.CallingConvention]::Winapi, [Runtime.InteropServices.CharSet]::Auto)</span><br><span class="line"></span><br><span class="line"># Create the type</span><br><span class="line">$Imagehlp = $TypeBuilder.CreateType()</span><br><span class="line"></span><br><span class="line"># Offset information</span><br><span class="line">$timestampOffset = 136</span><br><span class="line">$exportTimestampOffset = 3076</span><br><span class="line">$checkSumOffset = 216</span><br><span class="line"></span><br><span class="line"># Calculate timestamp</span><br><span class="line">$currentTimestamp = [DateTime]::UtcNow</span><br><span class="line">$unixTimestamp = [int]($currentTimestamp - (Get-Date -Year 1970 -Month 1 -Day 1 -Hour 0 -Minute 0 -Second 0)).TotalSeconds</span><br><span class="line"></span><br><span class="line"># Change timestamps</span><br><span class="line">$Writer.BaseStream.Position = $timestampOffset</span><br><span class="line">$Writer.Write($unixTimestamp)</span><br><span class="line"></span><br><span class="line">$Writer.BaseStream.Position = $exportTimestampOffset</span><br><span class="line">$Writer.Write($unixTimestamp)</span><br><span class="line"></span><br><span class="line">$Writer.Flush()</span><br><span class="line"></span><br><span class="line"># Write the current state of the MemoryStream to a temporary file</span><br><span class="line">$tempFilePath = [System.IO.Path]::Combine($env:windir, &quot;Temp&quot;, [System.IO.Path]::GetRandomFileName())</span><br><span class="line">[System.IO.File]::WriteAllBytes($tempFilePath, $MemoryStream.ToArray())</span><br><span class="line"></span><br><span class="line"># Update hash using the temporary file</span><br><span class="line">[int]$HeaderSum = 0</span><br><span class="line">[int]$CheckSum = 0</span><br><span class="line">[void]$Imagehlp::MapFileAndCheckSum($tempFilePath, [ref]$HeaderSum, [ref]$CheckSum)</span><br><span class="line"></span><br><span class="line"># If the checksums don&#x27;t match, update the checksum in the MemoryStream</span><br><span class="line">if ($HeaderSum -ne $CheckSum) &#123;</span><br><span class="line">    $Writer.BaseStream.Position = $checkSumOffset</span><br><span class="line">    $Writer.Write($CheckSum)</span><br><span class="line">    $Writer.Flush()</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    Write-host Error found</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Delete the temporary file</span><br><span class="line">Remove-Item -Path $tempFilePath -Force</span><br><span class="line"></span><br><span class="line"># Get the modified bytes</span><br><span class="line">$modifiedBytes = $MemoryStream.ToArray()</span><br><span class="line"></span><br><span class="line"># Write the modified bytes to the final file</span><br><span class="line">[System.IO.File]::WriteAllBytes($PePath, $modifiedBytes)</span><br><span class="line"></span><br><span class="line">[void]$Imagehlp::MapFileAndCheckSum($PePath, [ref]$HeaderSum, [ref]$CheckSum)</span><br><span class="line">if ($HeaderSum -ne $CheckSum) &#123;</span><br><span class="line">    Write-host Error found</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$MemoryStream.Close()</span><br><span class="line">:hexedit:</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line">::</span><br><span class="line">::  This below blocks of text is encoded in base64 format</span><br><span class="line">::  The blocks in labels &quot;sppc64.dll&quot; and &quot;sppc32.dll&quot; contains below files</span><br><span class="line">::</span><br><span class="line">::  C6DF24DEEF2E83813DEE9C81DDD9793A3D60C117A4E8E231B82E32B3192927E7 *sppc64.dll</span><br><span class="line">::  E6AC83560C19EC7EB868C50EA97EA0ED5632A397A9F43C17E24E6DE4A694D118 *sppc32.dll</span><br><span class="line">::</span><br><span class="line">::  The files are encoded in base64 to make MAS AIO version. Alternatively, you can use MAS separate files version</span><br><span class="line">::</span><br><span class="line">::  mass grave[.]dev/ohook</span><br><span class="line">::  Here you can find the files source code and info on how to rebuild the identical sppc.dll files</span><br><span class="line">::</span><br><span class="line">::  stackoverflow.com/a/35335273</span><br><span class="line">::  Here you can check how to extract sppc.dll files from base64</span><br><span class="line">::</span><br><span class="line">::  For any further question, feel free to contact us on mass grave[.]dev/contactus</span><br><span class="line">::</span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:sppc32.dll:</span><br><span class="line">TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAABQRQAATAEHAMDc0GQAAAAAAAAAAOAA</span><br><span class="line">DiMLAQIoAAIAAAAeAAAAAAAAABAAAAAQAAAAAAAAAACAagAQAAAAAgAABAAAAAEAAAAGAAAAAAAAAACQAAAABAAAi9MAAAIAQAEAACAAABAAAAAAEAAAEAAAAAAAABAAAAAAQAAAjRAAAABgAAAYAQAAAHAAAHgDAAAAAAAAAAAAAAAAAAAAAAAAAIAAABQAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsYAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC50ZXh0AAAAcAEAAAAQAAAAAgAAAAQAAAAAAAAAAAAAAAAAACAAAGAucmRhdGEAABgAAAAAIAAAAAIAAAAGAAAAAAAAAAAAAAAA</span><br><span class="line">AABAAABALmVoX2ZyYW2AAAAAADAAAAACAAAACAAAAAAAAAAAAAAAAAAAQAAAQC5lZGF0YQAAjRAAAABAAAAAEgAAAAoAAAAAAAAAAAAAAAAAAEAAAEAuaWRhdGEAABgBAAAAYAAAAAIAAAAcAAAAAAAAAAAAAAAAAABAAADALnJzcmMAAAB4AwAAAHAAAAAEAAAAHgAA</span><br><span class="line">AAAAAAAAAAAAAAAAQAAAwC5yZWxvYwAAFAAAAACAAAAAAgAAACIAAAAAAAAAAAAAAAAAAEAAAEIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALgBAAAAwgwAVYnlVlONRfCD7DDHRfAAAAAA</span><br><span class="line">iUQkFI1F9IlEJBCLRQzHRCQMAAAAAIlEJASLRQjHRCQIACCAaokEJMdF9AAAAADoAgEAAIs1eGCAaoPsGIXAicOLRfB0CokEJDHb/9ZR6zKLVfTHRCQECiCAaokEJIlUJAj/FYBggGqD7AyFwItF8IkEJHQK/9a7AQAAAFLrA//WUI1l+InYW15dw1WJ5VdWU4PsPItF</span><br><span class="line">GIt1HIlEJBCLRRSJdCQUiUQkDItFEIlEJAiLRQyJRCQEi0UIiQQk6HwAAAAxyYPsGInHhcB1XItFGDkIdlVr2SiLBgHYg3gQAHRFiUQkBItFCIlN5IkEJOj7/v//i03khcB1LAMex0MQAQAAAMdDFAAAAADHQxgAAAAAx0McAAAAAMdDIAAAAADHQyQAAAAAQeukjWX0</span><br><span class="line">ifhbXl9dwhgAkP8lcGCAapCQ/yVsYIBqkJD/////AAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATgBhAG0AZQAAAEcAcgBhAGMAZQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAF6UgABfAgBGwwEBIgBAAAQAAAAHAAAAODf//8IAAAAAAAAACQAAAAwAAAA</span><br><span class="line">1N///50AAAAAQQ4IhQJCDQVIhgODBAKPw0HGQcUMBAQoAAAAWAAAAEng//+qAAAAAEEOCIUCQg0FRocDhgSDBQKbw0HGQcdBxQwEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAADA3NBkAAAAAMZCAAABAAAAQwAAAEMAAAAoQAAANEEAAEBCAADPQgAA70IAAAVDAAApQwAAXUMAAKFDAADpQwAAF0QAADVEAABnRAAAnUQAAONEAAAtRQAAYUUAAJ9FAADTRQAADUYAADtGAABxRgAAr0YAAM9GAAD7RgAApRAAAFFHAABvRwAA</span><br><span class="line">n0cAANNHAAARSAAATUgAAG9IAAClSAAAzUgAAAVJAABBSQAAbUkAAKdJAAC7SQAA+0kAADlKAABPSgAAdUoAAJ1KAADTSgAAB0sAAD1LAABpSwAApUsAAONLAAANTAAAOUwAAIlMAADRTAAAEU0AAFlNAACjTQAA8U0AABtOAABHTgAAh04AALtOAADnTgAAK08AAFtP</span><br><span class="line">AAC1TwAA608AACdQAABdUAAA4kIAAP1CAAAaQwAARkMAAIJDAADIQwAAA0QAAClEAABRRAAAhUQAAMNEAAALRQAASkUAAINFAAC8RQAA80UAACdGAABZRgAAk0YAAMJGAADoRgAAGUcAADFHAABjRwAAikcAALxHAAD1RwAAMkgAAGFIAACNSAAAvEgAAOxIAAAmSQAA</span><br><span class="line">WkkAAI1JAAC0SQAA3kkAAB1KAABHSgAAZUoAAIxKAAC7SgAA8EoAACVLAABWSwAAiksAAMdLAAD7SwAAJkwAAGRMAACwTAAA9EwAADhNAACBTQAAzU0AAAlOAAA0TgAAak4AAKROAADUTgAADE8AAEZPAACLTwAA008AAAxQAABFUAAAeFAAAAAAAQACAAMABAAFAAYA</span><br><span class="line">BwAIAAkACgALAAwADQAOAA8AEAARABIAEwAUABUAFgAXABgAGQAaABsAHAAdAB4AHwAgACEAIgAjACQAJQAmACcAKAApACoAKwAsAC0ALgAvADAAMQAyADMANAA1ADYANwA4ADkAOgA7ADwAPQA+AD8AQABBAEIAc3BwYy5kbGwAU1BQQ1MuU0xDYWxsU2VydmVyAFNM</span><br><span class="line">Q2FsbFNlcnZlcgBTUFBDUy5TTENsb3NlAFNMQ2xvc2UAU1BQQ1MuU0xDb25zdW1lUmlnaHQAU0xDb25zdW1lUmlnaHQAU1BQQ1MuU0xEZXBvc2l0TWlncmF0aW9uQmxvYgBTTERlcG9zaXRNaWdyYXRpb25CbG9iAFNQUENTLlNMRGVwb3NpdE9mZmxpbmVDb25maXJt</span><br><span class="line">YXRpb25JZABTTERlcG9zaXRPZmZsaW5lQ29uZmlybWF0aW9uSWQAU1BQQ1MuU0xEZXBvc2l0T2ZmbGluZUNvbmZpcm1hdGlvbklkRXgAU0xEZXBvc2l0T2ZmbGluZUNvbmZpcm1hdGlvbklkRXgAU1BQQ1MuU0xEZXBvc2l0U3RvcmVUb2tlbgBTTERlcG9zaXRTdG9y</span><br><span class="line">ZVRva2VuAFNQUENTLlNMRmlyZUV2ZW50AFNMRmlyZUV2ZW50AFNQUENTLlNMR2F0aGVyTWlncmF0aW9uQmxvYgBTTEdhdGhlck1pZ3JhdGlvbkJsb2IAU1BQQ1MuU0xHYXRoZXJNaWdyYXRpb25CbG9iRXgAU0xHYXRoZXJNaWdyYXRpb25CbG9iRXgAU1BQQ1MuU0xH</span><br><span class="line">ZW5lcmF0ZU9mZmxpbmVJbnN0YWxsYXRpb25JZABTTEdlbmVyYXRlT2ZmbGluZUluc3RhbGxhdGlvbklkAFNQUENTLlNMR2VuZXJhdGVPZmZsaW5lSW5zdGFsbGF0aW9uSWRFeABTTEdlbmVyYXRlT2ZmbGluZUluc3RhbGxhdGlvbklkRXgAU1BQQ1MuU0xHZXRBY3Rp</span><br><span class="line">dmVMaWNlbnNlSW5mbwBTTEdldEFjdGl2ZUxpY2Vuc2VJbmZvAFNQUENTLlNMR2V0QXBwbGljYXRpb25JbmZvcm1hdGlvbgBTTEdldEFwcGxpY2F0aW9uSW5mb3JtYXRpb24AU1BQQ1MuU0xHZXRBcHBsaWNhdGlvblBvbGljeQBTTEdldEFwcGxpY2F0aW9uUG9saWN5</span><br><span class="line">AFNQUENTLlNMR2V0QXV0aGVudGljYXRpb25SZXN1bHQAU0xHZXRBdXRoZW50aWNhdGlvblJlc3VsdABTUFBDUy5TTEdldEVuY3J5cHRlZFBJREV4AFNMR2V0RW5jcnlwdGVkUElERXgAU1BQQ1MuU0xHZXRHZW51aW5lSW5mb3JtYXRpb24AU0xHZXRHZW51aW5lSW5m</span><br><span class="line">b3JtYXRpb24AU1BQQ1MuU0xHZXRJbnN0YWxsZWRQcm9kdWN0S2V5SWRzAFNMR2V0SW5zdGFsbGVkUHJvZHVjdEtleUlkcwBTUFBDUy5TTEdldExpY2Vuc2UAU0xHZXRMaWNlbnNlAFNQUENTLlNMR2V0TGljZW5zZUZpbGVJZABTTEdldExpY2Vuc2VGaWxlSWQAU1BQ</span><br><span class="line">Q1MuU0xHZXRMaWNlbnNlSW5mb3JtYXRpb24AU0xHZXRMaWNlbnNlSW5mb3JtYXRpb24AU0xHZXRMaWNlbnNpbmdTdGF0dXNJbmZvcm1hdGlvbgBTUFBDUy5TTEdldFBLZXlJZABTTEdldFBLZXlJZABTUFBDUy5TTEdldFBLZXlJbmZvcm1hdGlvbgBTTEdldFBLZXlJ</span><br><span class="line">bmZvcm1hdGlvbgBTUFBDUy5TTEdldFBvbGljeUluZm9ybWF0aW9uAFNMR2V0UG9saWN5SW5mb3JtYXRpb24AU1BQQ1MuU0xHZXRQb2xpY3lJbmZvcm1hdGlvbkRXT1JEAFNMR2V0UG9saWN5SW5mb3JtYXRpb25EV09SRABTUFBDUy5TTEdldFByb2R1Y3RTa3VJbmZv</span><br><span class="line">cm1hdGlvbgBTTEdldFByb2R1Y3RTa3VJbmZvcm1hdGlvbgBTUFBDUy5TTEdldFNMSURMaXN0AFNMR2V0U0xJRExpc3QAU1BQQ1MuU0xHZXRTZXJ2aWNlSW5mb3JtYXRpb24AU0xHZXRTZXJ2aWNlSW5mb3JtYXRpb24AU1BQQ1MuU0xJbnN0YWxsTGljZW5zZQBTTElu</span><br><span class="line">c3RhbGxMaWNlbnNlAFNQUENTLlNMSW5zdGFsbFByb29mT2ZQdXJjaGFzZQBTTEluc3RhbGxQcm9vZk9mUHVyY2hhc2UAU1BQQ1MuU0xJbnN0YWxsUHJvb2ZPZlB1cmNoYXNlRXgAU0xJbnN0YWxsUHJvb2ZPZlB1cmNoYXNlRXgAU1BQQ1MuU0xJc0dlbnVpbmVMb2Nh</span><br><span class="line">bEV4AFNMSXNHZW51aW5lTG9jYWxFeABTUFBDUy5TTExvYWRBcHBsaWNhdGlvblBvbGljaWVzAFNMTG9hZEFwcGxpY2F0aW9uUG9saWNpZXMAU1BQQ1MuU0xPcGVuAFNMT3BlbgBTUFBDUy5TTFBlcnNpc3RBcHBsaWNhdGlvblBvbGljaWVzAFNMUGVyc2lzdEFwcGxp</span><br><span class="line">Y2F0aW9uUG9saWNpZXMAU1BQQ1MuU0xQZXJzaXN0UlRTUGF5bG9hZE92ZXJyaWRlAFNMUGVyc2lzdFJUU1BheWxvYWRPdmVycmlkZQBTUFBDUy5TTFJlQXJtAFNMUmVBcm0AU1BQQ1MuU0xSZWdpc3RlckV2ZW50AFNMUmVnaXN0ZXJFdmVudABTUFBDUy5TTFJlZ2lz</span><br><span class="line">dGVyUGx1Z2luAFNMUmVnaXN0ZXJQbHVnaW4AU1BQQ1MuU0xTZXRBdXRoZW50aWNhdGlvbkRhdGEAU0xTZXRBdXRoZW50aWNhdGlvbkRhdGEAU1BQQ1MuU0xTZXRDdXJyZW50UHJvZHVjdEtleQBTTFNldEN1cnJlbnRQcm9kdWN0S2V5AFNQUENTLlNMU2V0R2VudWlu</span><br><span class="line">ZUluZm9ybWF0aW9uAFNMU2V0R2VudWluZUluZm9ybWF0aW9uAFNQUENTLlNMVW5pbnN0YWxsTGljZW5zZQBTTFVuaW5zdGFsbExpY2Vuc2UAU1BQQ1MuU0xVbmluc3RhbGxQcm9vZk9mUHVyY2hhc2UAU0xVbmluc3RhbGxQcm9vZk9mUHVyY2hhc2UAU1BQQ1MuU0xV</span><br><span class="line">bmxvYWRBcHBsaWNhdGlvblBvbGljaWVzAFNMVW5sb2FkQXBwbGljYXRpb25Qb2xpY2llcwBTUFBDUy5TTFVucmVnaXN0ZXJFdmVudABTTFVucmVnaXN0ZXJFdmVudABTUFBDUy5TTFVucmVnaXN0ZXJQbHVnaW4AU0xVbnJlZ2lzdGVyUGx1Z2luAFNQUENTLlNMcEF1</span><br><span class="line">dGhlbnRpY2F0ZUdlbnVpbmVUaWNrZXRSZXNwb25zZQBTTHBBdXRoZW50aWNhdGVHZW51aW5lVGlja2V0UmVzcG9uc2UAU1BQQ1MuU0xwQmVnaW5HZW51aW5lVGlja2V0VHJhbnNhY3Rpb24AU0xwQmVnaW5HZW51aW5lVGlja2V0VHJhbnNhY3Rpb24AU1BQQ1MuU0xw</span><br><span class="line">Q2xlYXJBY3RpdmF0aW9uSW5Qcm9ncmVzcwBTTHBDbGVhckFjdGl2YXRpb25JblByb2dyZXNzAFNQUENTLlNMcERlcG9zaXREb3dubGV2ZWxHZW51aW5lVGlja2V0AFNMcERlcG9zaXREb3dubGV2ZWxHZW51aW5lVGlja2V0AFNQUENTLlNMcERlcG9zaXRUb2tlbkFj</span><br><span class="line">dGl2YXRpb25SZXNwb25zZQBTTHBEZXBvc2l0VG9rZW5BY3RpdmF0aW9uUmVzcG9uc2UAU1BQQ1MuU0xwR2VuZXJhdGVUb2tlbkFjdGl2YXRpb25DaGFsbGVuZ2UAU0xwR2VuZXJhdGVUb2tlbkFjdGl2YXRpb25DaGFsbGVuZ2UAU1BQQ1MuU0xwR2V0R2VudWluZUJs</span><br><span class="line">b2IAU0xwR2V0R2VudWluZUJsb2IAU1BQQ1MuU0xwR2V0R2VudWluZUxvY2FsAFNMcEdldEdlbnVpbmVMb2NhbABTUFBDUy5TTHBHZXRMaWNlbnNlQWNxdWlzaXRpb25JbmZvAFNMcEdldExpY2Vuc2VBY3F1aXNpdGlvbkluZm8AU1BQQ1MuU0xwR2V0TVNQaWRJbmZv</span><br><span class="line">cm1hdGlvbgBTTHBHZXRNU1BpZEluZm9ybWF0aW9uAFNQUENTLlNMcEdldE1hY2hpbmVVR1VJRABTTHBHZXRNYWNoaW5lVUdVSUQAU1BQQ1MuU0xwR2V0VG9rZW5BY3RpdmF0aW9uR3JhbnRJbmZvAFNMcEdldFRva2VuQWN0aXZhdGlvbkdyYW50SW5mbwBTUFBDUy5T</span><br><span class="line">THBJQUFjdGl2YXRlUHJvZHVjdABTTHBJQUFjdGl2YXRlUHJvZHVjdABTUFBDUy5TTHBJc0N1cnJlbnRJbnN0YWxsZWRQcm9kdWN0S2V5RGVmYXVsdEtleQBTTHBJc0N1cnJlbnRJbnN0YWxsZWRQcm9kdWN0S2V5RGVmYXVsdEtleQBTUFBDUy5TTHBQcm9jZXNzVk1Q</span><br><span class="line">aXBlTWVzc2FnZQBTTHBQcm9jZXNzVk1QaXBlTWVzc2FnZQBTUFBDUy5TTHBTZXRBY3RpdmF0aW9uSW5Qcm9ncmVzcwBTTHBTZXRBY3RpdmF0aW9uSW5Qcm9ncmVzcwBTUFBDUy5TTHBUcmlnZ2VyU2VydmljZVdvcmtlcgBTTHBUcmlnZ2VyU2VydmljZVdvcmtlcgBT</span><br><span class="line">UFBDUy5TTHBWTEFjdGl2YXRlUHJvZHVjdABTTHBWTEFjdGl2YXRlUHJvZHVjdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFBgAAAAAAAAAAAAAOhgAABsYAAAXGAAAAAAAAAAAAAA</span><br><span class="line">+GAAAHhgAABkYAAAAAAAAAAAAAAMYQAAgGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiGAAAKpgAAAAAAAAyGAAAAAAAADUYAAAAAAAAIhgAACqYAAAAAAAAMhgAAAAAAAA1GAAAAAAAAACAFNMR2V0TGljZW5zaW5nU3RhdHVzSW5mb3JtYXRpb24AAQBTTEdldFByb2R1</span><br><span class="line">Y3RTa3VJbmZvcm1hdGlvbgAA3QNMb2NhbEZyZWUARwFTdHJTdHJOSVcAAGAAAABgAABzcHBjcy5kbGwAAAAUYAAAS0VSTkVMMzIuZGxsAAAAAChgAABTSExXQVBJLmRsbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABABAAAAAYAACAAAAAAAAAAAAAAAAAAAABAAEAAAAwAACAAAAAAAAAAAAAAAAAAAABAAkEAABIAAAAWHAAABwDAAAAAAAAAAAAABwDNAAAAFYAUwBfAFYARQBSAFMASQBPAE4AXwBJAE4A</span><br><span class="line">RgBPAAAAAAC9BO/+AAABAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAQABAACAAAAAAAAAAAAAAAAAAAAfAIAAAEAUwB0AHIAaQBuAGcARgBpAGwAZQBJAG4AZgBvAAAAWAIAAAEAMAA0ADAAOQAwADQARQA0AAAAegAtAAEAQwBvAG0AcABhAG4AeQBOAGEAbQBlAAAA</span><br><span class="line">AABBAG4AbwBtAGEAbABvAHUAcwAgAFMAbwBmAHQAdwBhAHIAZQAgAEQAZQB0AGUAcgBpAG8AcgBhAHQAaQBvAG4AIABDAG8AcgBwAG8AcgBhAHQAaQBvAG4AAAAAAD4ACwABAEYAaQBsAGUARABlAHMAYwByAGkAcAB0AGkAbwBuAAAAAABvAGgAbwBvAGsAIABTAFAA</span><br><span class="line">UABDAAAAAAAwAAgAAQBGAGkAbABlAFYAZQByAHMAaQBvAG4AAAAAADAALgAzAC4AMAAuADAAAAAqAAUAAQBJAG4AdABlAHIAbgBhAGwATgBhAG0AZQAAAHMAcABwAGMAAAAAAIwANAABAEwAZQBnAGEAbABDAG8AcAB5AHIAaQBnAGgAdAAAAKkAIAAyADAAMgAzACAA</span><br><span class="line">QQBuAG8AbQBhAGwAbwB1AHMAIABTAG8AZgB0AHcAYQByAGUAIABEAGUAdABlAHIAaQBvAHIAYQB0AGkAbwBuACAAQwBvAHIAcABvAHIAYQB0AGkAbwBuAAAAOgAJAAEATwByAGkAZwBpAG4AYQBsAEYAaQBsAGUAbgBhAG0AZQAAAHMAcABwAGMALgBkAGwAbAAAAAAA</span><br><span class="line">LAAGAAEAUAByAG8AZAB1AGMAdABOAGEAbQBlAAAAAABvAGgAbwBvAGsAAAA0AAgAAQBQAHIAbwBkAHUAYwB0AFYAZQByAHMAaQBvAG4AAAAwAC4AMwAuADAALgAwAAAARAAAAAEAVgBhAHIARgBpAGwAZQBJAG4AZgBvAAAAAAAkAAQAAABUAHIAYQBuAHMAbABhAHQA</span><br><span class="line">aQBvAG4AAAAAAAkE5AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAQAAAUAAAAOzBQMHEwfjBSMVoxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">:sppc32.dll:</span><br><span class="line"></span><br><span class="line">:========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:sppc64.dll:</span><br><span class="line">TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAABQRQAAZIYHAMDc0GQAAAAAAAAAAPAA</span><br><span class="line">LiILAgIoAAIAAAAeAAAAAAAAABAAAAAQAAAAAJIxAgAAAAAQAAAAAgAABAAAAAAAAAAGAAAAAAAAAACQAAAABAAA39AAAAIAYAEAACAAAAAAAAAQAAAAAAAAAAAQAAAAAAAAEAAAAAAAAAAAAAAQAAAAAFAAAI0QAAAAcAAAUAEAAACAAAB4AwAAADAAACQAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiHAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAudGV4dAAAAHABAAAAEAAAAAIAAAAEAAAAAAAAAAAAAAAAAAAgAABgLnJkYXRhAAAgAAAAACAAAAAC</span><br><span class="line">AAAABgAAAAAAAAAAAAAAAAAAQAAAQC5wZGF0YQAAJAAAAAAwAAAAAgAAAAgAAAAAAAAAAAAAAAAAAEAAAEAueGRhdGEAACQAAAAAQAAAAAIAAAAKAAAAAAAAAAAAAAAAAABAAABALmVkYXRhAACNEAAAAFAAAAASAAAADAAAAAAAAAAAAAAAAAAAQAAAQC5pZGF0YQAA</span><br><span class="line">UAEAAABwAAAAAgAAAB4AAAAAAAAAAAAAAAAAAEAAAMAucnNyYwAAAHgDAAAAgAAAAAQAAAAgAAAAAAAAAAAAAAAAAABAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALgBAAAAw0FUU0iD7EhFMclMjQXpDwAASI1E</span><br><span class="line">JDjHRCQ0AAAAAEiJRCQoSI1EJDRIiUQkIEjHRCQ4AAAAAOj/AAAASItMJDhIix1TYAAAhcBBicR0B//TRTHk6yhEi0QkNEiNFaMPAAD/FUNgAABIi0wkOEiFwHQK/9NBvAEAAADrAv/TRIngSIPESFtBXMNBVUFUVVdWU0iD7Dgx9kyLrCSQAAAASIusJJgAAABMiWwk</span><br><span class="line">IEiJz0iJbCQo6IoAAABBicSFwHVEQTl1AHY+SGveKEiLVQBIAdqDehAAdChIifnoIv///4XAdRxIA10ASMdDEAEAAABIx0MYAAAAAEjHQyAAAAAASP/G67xEieBIg8Q4W15fXUFcQV3DkJCQkJCQkP8lel8AAJCQDx+EAAAAAAD/JXpfAACQkA8fhAAAAAAA/yVKXwAA</span><br><span class="line">kJD/JTpfAACQkP//////////AAAAAAAAAAD//////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATgBhAG0AZQAAAEcAcgBhAGMAZQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABhAAAABAAAAGEAAAjhAAAARAAACOEAAAGREAABBAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAEAAAABBwMAB4IDMALAAAABDAcADGIIMAdgBnAFUATAAtAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDc0GQAAAAAxlIAAAEAAABDAAAAQwAAAChQAAA0UQAAQFIAAM9SAADvUgAABVMAAClTAABdUwAAoVMAAOlTAAAXVAAANVQAAGdU</span><br><span class="line">AACdVAAA41QAAC1VAABhVQAAn1UAANNVAAANVgAAO1YAAHFWAACvVgAAz1YAAPtWAACOEAAAUVcAAG9XAACfVwAA01cAABFYAABNWAAAb1gAAKVYAADNWAAABVkAAEFZAABtWQAAp1kAALtZAAD7WQAAOVoAAE9aAAB1WgAAnVoAANNaAAAHWwAAPVsAAGlbAAClWwAA</span><br><span class="line">41sAAA1cAAA5XAAAiVwAANFcAAARXQAAWV0AAKNdAADxXQAAG14AAEdeAACHXgAAu14AAOdeAAArXwAAW18AALVfAADrXwAAJ2AAAF1gAADiUgAA/VIAABpTAABGUwAAglMAAMhTAAADVAAAKVQAAFFUAACFVAAAw1QAAAtVAABKVQAAg1UAALxVAADzVQAAJ1YAAFlW</span><br><span class="line">AACTVgAAwlYAAOhWAAAZVwAAMVcAAGNXAACKVwAAvFcAAPVXAAAyWAAAYVgAAI1YAAC8WAAA7FgAACZZAABaWQAAjVkAALRZAADeWQAAHVoAAEdaAABlWgAAjFoAALtaAADwWgAAJVsAAFZbAACKWwAAx1sAAPtbAAAmXAAAZFwAALBcAAD0XAAAOF0AAIFdAADNXQAA</span><br><span class="line">CV4AADReAABqXgAApF4AANReAAAMXwAARl8AAItfAADTXwAADGAAAEVgAAB4YAAAAAABAAIAAwAEAAUABgAHAAgACQAKAAsADAANAA4ADwAQABEAEgATABQAFQAWABcAGAAZABoAGwAcAB0AHgAfACAAIQAiACMAJAAlACYAJwAoACkAKgArACwALQAuAC8AMAAxADIA</span><br><span class="line">MwA0ADUANgA3ADgAOQA6ADsAPAA9AD4APwBAAEEAQgBzcHBjLmRsbABTUFBDUy5TTENhbGxTZXJ2ZXIAU0xDYWxsU2VydmVyAFNQUENTLlNMQ2xvc2UAU0xDbG9zZQBTUFBDUy5TTENvbnN1bWVSaWdodABTTENvbnN1bWVSaWdodABTUFBDUy5TTERlcG9zaXRNaWdy</span><br><span class="line">YXRpb25CbG9iAFNMRGVwb3NpdE1pZ3JhdGlvbkJsb2IAU1BQQ1MuU0xEZXBvc2l0T2ZmbGluZUNvbmZpcm1hdGlvbklkAFNMRGVwb3NpdE9mZmxpbmVDb25maXJtYXRpb25JZABTUFBDUy5TTERlcG9zaXRPZmZsaW5lQ29uZmlybWF0aW9uSWRFeABTTERlcG9zaXRP</span><br><span class="line">ZmZsaW5lQ29uZmlybWF0aW9uSWRFeABTUFBDUy5TTERlcG9zaXRTdG9yZVRva2VuAFNMRGVwb3NpdFN0b3JlVG9rZW4AU1BQQ1MuU0xGaXJlRXZlbnQAU0xGaXJlRXZlbnQAU1BQQ1MuU0xHYXRoZXJNaWdyYXRpb25CbG9iAFNMR2F0aGVyTWlncmF0aW9uQmxvYgBT</span><br><span class="line">UFBDUy5TTEdhdGhlck1pZ3JhdGlvbkJsb2JFeABTTEdhdGhlck1pZ3JhdGlvbkJsb2JFeABTUFBDUy5TTEdlbmVyYXRlT2ZmbGluZUluc3RhbGxhdGlvbklkAFNMR2VuZXJhdGVPZmZsaW5lSW5zdGFsbGF0aW9uSWQAU1BQQ1MuU0xHZW5lcmF0ZU9mZmxpbmVJbnN0</span><br><span class="line">YWxsYXRpb25JZEV4AFNMR2VuZXJhdGVPZmZsaW5lSW5zdGFsbGF0aW9uSWRFeABTUFBDUy5TTEdldEFjdGl2ZUxpY2Vuc2VJbmZvAFNMR2V0QWN0aXZlTGljZW5zZUluZm8AU1BQQ1MuU0xHZXRBcHBsaWNhdGlvbkluZm9ybWF0aW9uAFNMR2V0QXBwbGljYXRpb25J</span><br><span class="line">bmZvcm1hdGlvbgBTUFBDUy5TTEdldEFwcGxpY2F0aW9uUG9saWN5AFNMR2V0QXBwbGljYXRpb25Qb2xpY3kAU1BQQ1MuU0xHZXRBdXRoZW50aWNhdGlvblJlc3VsdABTTEdldEF1dGhlbnRpY2F0aW9uUmVzdWx0AFNQUENTLlNMR2V0RW5jcnlwdGVkUElERXgAU0xH</span><br><span class="line">ZXRFbmNyeXB0ZWRQSURFeABTUFBDUy5TTEdldEdlbnVpbmVJbmZvcm1hdGlvbgBTTEdldEdlbnVpbmVJbmZvcm1hdGlvbgBTUFBDUy5TTEdldEluc3RhbGxlZFByb2R1Y3RLZXlJZHMAU0xHZXRJbnN0YWxsZWRQcm9kdWN0S2V5SWRzAFNQUENTLlNMR2V0TGljZW5z</span><br><span class="line">ZQBTTEdldExpY2Vuc2UAU1BQQ1MuU0xHZXRMaWNlbnNlRmlsZUlkAFNMR2V0TGljZW5zZUZpbGVJZABTUFBDUy5TTEdldExpY2Vuc2VJbmZvcm1hdGlvbgBTTEdldExpY2Vuc2VJbmZvcm1hdGlvbgBTTEdldExpY2Vuc2luZ1N0YXR1c0luZm9ybWF0aW9uAFNQUENT</span><br><span class="line">LlNMR2V0UEtleUlkAFNMR2V0UEtleUlkAFNQUENTLlNMR2V0UEtleUluZm9ybWF0aW9uAFNMR2V0UEtleUluZm9ybWF0aW9uAFNQUENTLlNMR2V0UG9saWN5SW5mb3JtYXRpb24AU0xHZXRQb2xpY3lJbmZvcm1hdGlvbgBTUFBDUy5TTEdldFBvbGljeUluZm9ybWF0</span><br><span class="line">aW9uRFdPUkQAU0xHZXRQb2xpY3lJbmZvcm1hdGlvbkRXT1JEAFNQUENTLlNMR2V0UHJvZHVjdFNrdUluZm9ybWF0aW9uAFNMR2V0UHJvZHVjdFNrdUluZm9ybWF0aW9uAFNQUENTLlNMR2V0U0xJRExpc3QAU0xHZXRTTElETGlzdABTUFBDUy5TTEdldFNlcnZpY2VJ</span><br><span class="line">bmZvcm1hdGlvbgBTTEdldFNlcnZpY2VJbmZvcm1hdGlvbgBTUFBDUy5TTEluc3RhbGxMaWNlbnNlAFNMSW5zdGFsbExpY2Vuc2UAU1BQQ1MuU0xJbnN0YWxsUHJvb2ZPZlB1cmNoYXNlAFNMSW5zdGFsbFByb29mT2ZQdXJjaGFzZQBTUFBDUy5TTEluc3RhbGxQcm9v</span><br><span class="line">Zk9mUHVyY2hhc2VFeABTTEluc3RhbGxQcm9vZk9mUHVyY2hhc2VFeABTUFBDUy5TTElzR2VudWluZUxvY2FsRXgAU0xJc0dlbnVpbmVMb2NhbEV4AFNQUENTLlNMTG9hZEFwcGxpY2F0aW9uUG9saWNpZXMAU0xMb2FkQXBwbGljYXRpb25Qb2xpY2llcwBTUFBDUy5T</span><br><span class="line">TE9wZW4AU0xPcGVuAFNQUENTLlNMUGVyc2lzdEFwcGxpY2F0aW9uUG9saWNpZXMAU0xQZXJzaXN0QXBwbGljYXRpb25Qb2xpY2llcwBTUFBDUy5TTFBlcnNpc3RSVFNQYXlsb2FkT3ZlcnJpZGUAU0xQZXJzaXN0UlRTUGF5bG9hZE92ZXJyaWRlAFNQUENTLlNMUmVB</span><br><span class="line">cm0AU0xSZUFybQBTUFBDUy5TTFJlZ2lzdGVyRXZlbnQAU0xSZWdpc3RlckV2ZW50AFNQUENTLlNMUmVnaXN0ZXJQbHVnaW4AU0xSZWdpc3RlclBsdWdpbgBTUFBDUy5TTFNldEF1dGhlbnRpY2F0aW9uRGF0YQBTTFNldEF1dGhlbnRpY2F0aW9uRGF0YQBTUFBDUy5T</span><br><span class="line">TFNldEN1cnJlbnRQcm9kdWN0S2V5AFNMU2V0Q3VycmVudFByb2R1Y3RLZXkAU1BQQ1MuU0xTZXRHZW51aW5lSW5mb3JtYXRpb24AU0xTZXRHZW51aW5lSW5mb3JtYXRpb24AU1BQQ1MuU0xVbmluc3RhbGxMaWNlbnNlAFNMVW5pbnN0YWxsTGljZW5zZQBTUFBDUy5T</span><br><span class="line">TFVuaW5zdGFsbFByb29mT2ZQdXJjaGFzZQBTTFVuaW5zdGFsbFByb29mT2ZQdXJjaGFzZQBTUFBDUy5TTFVubG9hZEFwcGxpY2F0aW9uUG9saWNpZXMAU0xVbmxvYWRBcHBsaWNhdGlvblBvbGljaWVzAFNQUENTLlNMVW5yZWdpc3RlckV2ZW50AFNMVW5yZWdpc3Rl</span><br><span class="line">ckV2ZW50AFNQUENTLlNMVW5yZWdpc3RlclBsdWdpbgBTTFVucmVnaXN0ZXJQbHVnaW4AU1BQQ1MuU0xwQXV0aGVudGljYXRlR2VudWluZVRpY2tldFJlc3BvbnNlAFNMcEF1dGhlbnRpY2F0ZUdlbnVpbmVUaWNrZXRSZXNwb25zZQBTUFBDUy5TTHBCZWdpbkdlbnVp</span><br><span class="line">bmVUaWNrZXRUcmFuc2FjdGlvbgBTTHBCZWdpbkdlbnVpbmVUaWNrZXRUcmFuc2FjdGlvbgBTUFBDUy5TTHBDbGVhckFjdGl2YXRpb25JblByb2dyZXNzAFNMcENsZWFyQWN0aXZhdGlvbkluUHJvZ3Jlc3MAU1BQQ1MuU0xwRGVwb3NpdERvd25sZXZlbEdlbnVpbmVU</span><br><span class="line">aWNrZXQAU0xwRGVwb3NpdERvd25sZXZlbEdlbnVpbmVUaWNrZXQAU1BQQ1MuU0xwRGVwb3NpdFRva2VuQWN0aXZhdGlvblJlc3BvbnNlAFNMcERlcG9zaXRUb2tlbkFjdGl2YXRpb25SZXNwb25zZQBTUFBDUy5TTHBHZW5lcmF0ZVRva2VuQWN0aXZhdGlvbkNoYWxs</span><br><span class="line">ZW5nZQBTTHBHZW5lcmF0ZVRva2VuQWN0aXZhdGlvbkNoYWxsZW5nZQBTUFBDUy5TTHBHZXRHZW51aW5lQmxvYgBTTHBHZXRHZW51aW5lQmxvYgBTUFBDUy5TTHBHZXRHZW51aW5lTG9jYWwAU0xwR2V0R2VudWluZUxvY2FsAFNQUENTLlNMcEdldExpY2Vuc2VBY3F1</span><br><span class="line">aXNpdGlvbkluZm8AU0xwR2V0TGljZW5zZUFjcXVpc2l0aW9uSW5mbwBTUFBDUy5TTHBHZXRNU1BpZEluZm9ybWF0aW9uAFNMcEdldE1TUGlkSW5mb3JtYXRpb24AU1BQQ1MuU0xwR2V0TWFjaGluZVVHVUlEAFNMcEdldE1hY2hpbmVVR1VJRABTUFBDUy5TTHBHZXRU</span><br><span class="line">b2tlbkFjdGl2YXRpb25HcmFudEluZm8AU0xwR2V0VG9rZW5BY3RpdmF0aW9uR3JhbnRJbmZvAFNQUENTLlNMcElBQWN0aXZhdGVQcm9kdWN0AFNMcElBQWN0aXZhdGVQcm9kdWN0AFNQUENTLlNMcElzQ3VycmVudEluc3RhbGxlZFByb2R1Y3RLZXlEZWZhdWx0S2V5</span><br><span class="line">AFNMcElzQ3VycmVudEluc3RhbGxlZFByb2R1Y3RLZXlEZWZhdWx0S2V5AFNQUENTLlNMcFByb2Nlc3NWTVBpcGVNZXNzYWdlAFNMcFByb2Nlc3NWTVBpcGVNZXNzYWdlAFNQUENTLlNMcFNldEFjdGl2YXRpb25JblByb2dyZXNzAFNMcFNldEFjdGl2YXRpb25JblBy</span><br><span class="line">b2dyZXNzAFNQUENTLlNMcFRyaWdnZXJTZXJ2aWNlV29ya2VyAFNMcFRyaWdnZXJTZXJ2aWNlV29ya2VyAFNQUENTLlNMcFZMQWN0aXZhdGVQcm9kdWN0AFNMcFZMQWN0aXZhdGVQcm9kdWN0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUHAAAAAAAAAAAAAAIHEAAIhwAABocAAAAAAAAAAAAAAwcQAAoHAAAHhwAAAAAAAAAAAAAERxAACwcAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAcAAAAAAAAOJwAAAAAAAAAAAAAAAAAAAAcQAAAAAAAAAAAAAAAAAA</span><br><span class="line">DHEAAAAAAAAAAAAAAAAAAMBwAAAAAAAA4nAAAAAAAAAAAAAAAAAAAABxAAAAAAAAAAAAAAAAAAAMcQAAAAAAAAAAAAAAAAAAAgBTTEdldExpY2Vuc2luZ1N0YXR1c0luZm9ybWF0aW9uAAEAU0xHZXRQcm9kdWN0U2t1SW5mb3JtYXRpb24AAOgDTG9jYWxGcmVlAFEB</span><br><span class="line">U3RyU3RyTklXAABwAAAAcAAAc3BwY3MuZGxsAAAAFHAAAEtFUk5FTDMyLmRsbAAAAAAocAAAU0hMV0FQSS5kbGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAEAAAABgAAIAAAAAAAAAAAAAAAAAAAAEAAQAAADAAAIAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAEACQQAAEgAAABYgAAAHAMAAAAAAAAAAAAAHAM0AAAAVgBTAF8AVgBFAFIAUwBJAE8ATgBfAEkATgBGAE8AAAAAAL0E7/4AAAEAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAABAAEAAIAAAAAAAAAAAAAAAAAAAB8AgAAAQBTAHQAcgBpAG4AZwBGAGkAbABlAEkA</span><br><span class="line">bgBmAG8AAABYAgAAAQAwADQAMAA5ADAANABFADQAAAB6AC0AAQBDAG8AbQBwAGEAbgB5AE4AYQBtAGUAAAAAAEEAbgBvAG0AYQBsAG8AdQBzACAAUwBvAGYAdAB3AGEAcgBlACAARABlAHQAZQByAGkAbwByAGEAdABpAG8AbgAgAEMAbwByAHAAbwByAGEAdABpAG8A</span><br><span class="line">bgAAAAAAPgALAAEARgBpAGwAZQBEAGUAcwBjAHIAaQBwAHQAaQBvAG4AAAAAAG8AaABvAG8AawAgAFMAUABQAEMAAAAAADAACAABAEYAaQBsAGUAVgBlAHIAcwBpAG8AbgAAAAAAMAAuADMALgAwAC4AMAAAACoABQABAEkAbgB0AGUAcgBuAGEAbABOAGEAbQBlAAAA</span><br><span class="line">cwBwAHAAYwAAAAAAjAA0AAEATABlAGcAYQBsAEMAbwBwAHkAcgBpAGcAaAB0AAAAqQAgADIAMAAyADMAIABBAG4AbwBtAGEAbABvAHUAcwAgAFMAbwBmAHQAdwBhAHIAZQAgAEQAZQB0AGUAcgBpAG8AcgBhAHQAaQBvAG4AIABDAG8AcgBwAG8AcgBhAHQAaQBvAG4A</span><br><span class="line">AAA6AAkAAQBPAHIAaQBnAGkAbgBhAGwARgBpAGwAZQBuAGEAbQBlAAAAcwBwAHAAYwAuAGQAbABsAAAAAAAsAAYAAQBQAHIAbwBkAHUAYwB0AE4AYQBtAGUAAAAAAG8AaABvAG8AawAAADQACAABAFAAcgBvAGQAdQBjAHQAVgBlAHIAcwBpAG8AbgAAADAALgAzAC4A</span><br><span class="line">MAAuADAAAABEAAAAAQBWAGEAcgBGAGkAbABlAEkAbgBmAG8AAAAAACQABAAAAFQAcgBhAG4AcwBsAGEAdABpAG8AbgAAAAAACQTkBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">:sppc64.dll:</span><br><span class="line"></span><br><span class="line">:+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class="line"></span><br><span class="line">:KMS38Activation</span><br><span class="line">@setlocal DisableDelayedExpansion</span><br><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">::  To activate, run the script with &quot;/KMS38&quot; parameter or change 0 to 1 in below line</span><br><span class="line">set _act=0</span><br><span class="line"></span><br><span class="line">::  To remove KMS38 protection, run the script with /KMS38-RemoveProtection parameter or change 0 to 1 in below line</span><br><span class="line">set _rem=0</span><br><span class="line"></span><br><span class="line">::  To disable changing edition if current edition doesn&#x27;t support KMS38 activation, change the value to 1 from 0 or run the script with &quot;/KMS38-NoEditionChange&quot; parameter</span><br><span class="line">set _NoEditionChange=0</span><br><span class="line"></span><br><span class="line">::  If value is changed in above lines or parameter is used then script will run in unattended mode</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">color 07</span><br><span class="line">title  KMS38 激活</span><br><span class="line"></span><br><span class="line">set _args=</span><br><span class="line">set _elev=</span><br><span class="line">set _unattended=0</span><br><span class="line"></span><br><span class="line">set _args=%*</span><br><span class="line">if defined _args set _args=%_args:&quot;=%</span><br><span class="line">if defined _args (</span><br><span class="line">for %%A in (%_args%) do (</span><br><span class="line">if /i &quot;%%A&quot;==&quot;/KMS38&quot;                  set _act=1</span><br><span class="line">if /i &quot;%%A&quot;==&quot;/KMS38-RemoveProtection&quot; set _rem=1</span><br><span class="line">if /i &quot;%%A&quot;==&quot;/KMS38-NoEditionChange&quot;  set _NoEditionChange=1</span><br><span class="line">if /i &quot;%%A&quot;==&quot;-el&quot;                     set _elev=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%A in (%_act% %_rem% %_NoEditionChange%) do (if &quot;%%A&quot;==&quot;1&quot; set _unattended=1)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set &quot;nul1=1&gt;nul&quot;</span><br><span class="line">set &quot;nul2=2&gt;nul&quot;</span><br><span class="line">set &quot;nul6=2^&gt;nul&quot;</span><br><span class="line">set &quot;nul=&gt;nul 2&gt;&amp;1&quot;</span><br><span class="line"></span><br><span class="line">set psc=powershell.exe</span><br><span class="line">set winbuild=1</span><br><span class="line">for /f &quot;tokens=6 delims=[]. &quot; %%G in (&#x27;ver&#x27;) do set winbuild=%%G</span><br><span class="line"></span><br><span class="line">set _NCS=1</span><br><span class="line">if %winbuild% LSS 10586 set _NCS=0</span><br><span class="line">if %winbuild% GEQ 10586 reg query &quot;HKCU\Console&quot; /v ForceV2 %nul2% | find /i &quot;0x0&quot; %nul1% &amp;&amp; (set _NCS=0)</span><br><span class="line"></span><br><span class="line">if %_NCS% EQU 1 (</span><br><span class="line">for /F %%a in (&#x27;echo prompt $E ^| cmd&#x27;) do set &quot;esc=%%a&quot;</span><br><span class="line">set     &quot;Red=&quot;41;97m&quot;&quot;</span><br><span class="line">set    &quot;Gray=&quot;100;97m&quot;&quot;</span><br><span class="line">set   &quot;Green=&quot;42;97m&quot;&quot;</span><br><span class="line">set    &quot;Blue=&quot;44;97m&quot;&quot;</span><br><span class="line">set  &quot;_White=&quot;40;37m&quot;&quot;</span><br><span class="line">set  &quot;_Green=&quot;40;92m&quot;&quot;</span><br><span class="line">set &quot;_Yellow=&quot;40;93m&quot;&quot;</span><br><span class="line">) else (</span><br><span class="line">set     &quot;Red=&quot;Red&quot; &quot;white&quot;&quot;</span><br><span class="line">set    &quot;Gray=&quot;Darkgray&quot; &quot;white&quot;&quot;</span><br><span class="line">set   &quot;Green=&quot;DarkGreen&quot; &quot;white&quot;&quot;</span><br><span class="line">set    &quot;Blue=&quot;Blue&quot; &quot;white&quot;&quot;</span><br><span class="line">set  &quot;_White=&quot;Black&quot; &quot;Gray&quot;&quot;</span><br><span class="line">set  &quot;_Green=&quot;Black&quot; &quot;Green&quot;&quot;</span><br><span class="line">set &quot;_Yellow=&quot;Black&quot; &quot;Yellow&quot;&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set _k38=</span><br><span class="line">set &quot;nceline=echo: &amp;echo ==== ERROR ==== &amp;echo:&quot;</span><br><span class="line">set &quot;eline=echo: &amp;call :dk_color %Red% &quot;==== ERROR ====&quot; &amp;echo:&quot;</span><br><span class="line">if %~z0 GEQ 200000 (</span><br><span class="line">set &quot;_exitmsg=Go back&quot;</span><br><span class="line">set &quot;_fixmsg=Go back to Main Menu, select Troubleshoot and run Fix Licensing option.&quot;</span><br><span class="line">) else (</span><br><span class="line">set &quot;_exitmsg=Exit&quot;</span><br><span class="line">set &quot;_fixmsg=In MAS folder, run Troubleshoot script and select Fix Licensing option.&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;specific_kms=SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\55c92734-d682-4d71-983e-d6ec3f16059f&quot;</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">if %winbuild% LSS 14393 (</span><br><span class="line">%eline%</span><br><span class="line">echo 检测到不支持的操作系统版本 [%winbuild%].</span><br><span class="line">echo KMS38 激活支持 Windows 10/11/Server，14393 及更高版本。</span><br><span class="line">goto dk_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Fix for the special characters limitation in path name</span><br><span class="line"></span><br><span class="line">set &quot;_work=%~dp0&quot;</span><br><span class="line">if &quot;%_work:~-1%&quot;==&quot;\&quot; set &quot;_work=%_work:~0,-1%&quot;</span><br><span class="line"></span><br><span class="line">set &quot;_batf=%~f0&quot;</span><br><span class="line">set &quot;_batp=%_batf:&#x27;=&#x27;&#x27;%&quot;</span><br><span class="line"></span><br><span class="line">set _PSarg=&quot;&quot;&quot;%~f0&quot;&quot;&quot; -el %_args%</span><br><span class="line"></span><br><span class="line">set &quot;_ttemp=%temp%&quot;</span><br><span class="line"></span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">if %_rem%==1 goto :k_uninstall</span><br><span class="line"></span><br><span class="line">:k_menu</span><br><span class="line"></span><br><span class="line">if %_unattended%==0 (</span><br><span class="line">cls</span><br><span class="line">mode 76, 25</span><br><span class="line">title  KMS38 激活</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo         ____________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">echo                 [1] KMS38 激活</span><br><span class="line">echo                 ____________________________________________</span><br><span class="line">echo:</span><br><span class="line">echo                 [2] 移除 KM38 保护</span><br><span class="line">echo:</span><br><span class="line">echo                 [0] %_exitmsg%</span><br><span class="line">echo         ____________________________________________________________</span><br><span class="line">echo: </span><br><span class="line">call :dk_color2 %_White% &quot;              &quot; %_Green% &quot;通过键盘输入菜单选项 [1,2,0]&quot;</span><br><span class="line">choice /C:120 /N</span><br><span class="line">set _el=!errorlevel!</span><br><span class="line">if !_el!==3  exit /b</span><br><span class="line">if !_el!==2  goto :k_uninstall</span><br><span class="line">if !_el!==1  goto :k_menu2</span><br><span class="line">goto :k_menu</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:k_menu2</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode 108, 34</span><br><span class="line">title  KMS38 激活</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo 初始化...</span><br><span class="line">call :dk_product</span><br><span class="line">call :dk_ckeckwmic</span><br><span class="line"></span><br><span class="line">::  Show info for potential script stuck scenario</span><br><span class="line"></span><br><span class="line">sc start sppsvc %nul%</span><br><span class="line">if %errorlevel% NEQ 1056 if %errorlevel% NEQ 0 (</span><br><span class="line">echo:</span><br><span class="line">echo 错误代码: %errorlevel%</span><br><span class="line">call :dk_color %Red% &quot;启动 [sppsvc] 服务失败，剩余过程可能需要很长时间...&quot;</span><br><span class="line">echo:</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check if system is permanently activated or not</span><br><span class="line"></span><br><span class="line">call :dk_checkperm</span><br><span class="line">if defined _perm (</span><br><span class="line">cls</span><br><span class="line">echo ___________________________________________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">call :dk_color2 %_White% &quot;     &quot; %Green% &quot;Checking: %winos% is Permanently Activated.&quot;</span><br><span class="line">call :dk_color2 %_White% &quot;     &quot; %Gray% &quot;无需激活&quot;。</span><br><span class="line">echo ___________________________________________________________________________________________</span><br><span class="line">if %_unattended%==1 goto dk_done</span><br><span class="line">echo:</span><br><span class="line">choice /C:10 /N /M &quot;&gt;    [1] 激活 [0] %_exitmsg% : &quot;</span><br><span class="line">if errorlevel 2 exit /b</span><br><span class="line">)</span><br><span class="line">cls</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check Evaluation version</span><br><span class="line"></span><br><span class="line">set _eval=</span><br><span class="line">set _evalserv=</span><br><span class="line"></span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-*EvalEdition~*.mum&quot; set _eval=1</span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-Server*EvalEdition~*.mum&quot; set _evalserv=1</span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-Server*EvalCorEdition~*.mum&quot; set _eval=1 &amp; set _evalserv=1</span><br><span class="line"></span><br><span class="line">if defined _eval (</span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; /v EditionID %nul2% | find /i &quot;Eval&quot; %nul1% &amp;&amp; (</span><br><span class="line">%eline%</span><br><span class="line">echo [%winos% ^| %winbuild%]</span><br><span class="line">if defined _evalserv (</span><br><span class="line">echo Windows Server评估版本无法激活。将其转换为完整的Windows Server操作系统。</span><br><span class="line">echo:</span><br><span class="line">echo 在 MAS 中，进入 杂项 并使用 &quot;修改Windows系统版本 &quot;选项。</span><br><span class="line">) else (</span><br><span class="line">echo 评估版无法激活。</span><br><span class="line">echo 您需要安装 %winos% 的完整版本</span><br><span class="line">echo:</span><br><span class="line">echo 从这里下载：</span><br><span class="line">echo %mas%genuine-installation-media.html</span><br><span class="line">)</span><br><span class="line">goto dk_done</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:: Check clipup.exe for the detection and activation of server cor and acor editions</span><br><span class="line"></span><br><span class="line">set a_cor=</span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-Server*CorEdition~*.mum&quot; if not exist &quot;%systemroot%\System32\clipup.exe&quot; set a_cor=1</span><br><span class="line"></span><br><span class="line">if defined a_cor (</span><br><span class="line">if not exist &quot;!_work!\clipup.exe&quot; (</span><br><span class="line">%eline%</span><br><span class="line">echo 服务器 Cor/Acor [无图形用户界面] 版本中不存在 clipup.exe。</span><br><span class="line">echo 它是 KMS38 激活所必需的。</span><br><span class="line">echo 请查看以下页面了解如何激活。</span><br><span class="line">echo %mas%kms38.html</span><br><span class="line">goto dk_done</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check SKU value / Check in multiple places to find Edition change corruption</span><br><span class="line"></span><br><span class="line">set osSKU=</span><br><span class="line">set slcSKU=</span><br><span class="line">set wmiSKU=</span><br><span class="line">set regSKU=</span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 14393 (set info=Kernel-BrandingInfo) else (set info=Kernel-ProductInfo)</span><br><span class="line">set d1=%ref% [void]$TypeBuilder.DefinePInvokeMethod(&#x27;SLGetWindowsInformationDWORD&#x27;, &#x27;slc.dll&#x27;, &#x27;Public, Static&#x27;, 1, [int], @([String], [int].MakeByRefType()), 1, 3);</span><br><span class="line">set d1=%d1% $Sku = 0; [void]$TypeBuilder.CreateType()::SLGetWindowsInformationDWORD(&#x27;%info%&#x27;, [ref]$Sku); $Sku</span><br><span class="line">for /f &quot;delims=&quot; %%s in (&#x27;&quot;%psc% %d1%&quot;&#x27;) do if not errorlevel 1 (set slcSKU=%%s)</span><br><span class="line">if &quot;%slcSKU%&quot;==&quot;0&quot; set slcSKU=</span><br><span class="line">if 1%slcSKU% NEQ +1%slcSKU% set slcSKU=</span><br><span class="line"></span><br><span class="line">for /f &quot;tokens=3 delims=.&quot; %%a in (&#x27;reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\ProductOptions&quot; /v OSProductPfn %nul6%&#x27;) do set &quot;regSKU=%%a&quot;</span><br><span class="line">if %_wmic% EQU 1 for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;&quot;wmic Path Win32_OperatingSystem Get OperatingSystemSKU /format:LIST&quot; %nul6%&#x27;) do if not errorlevel 1 set &quot;wmiSKU=%%a&quot;</span><br><span class="line">if %_wmic% EQU 0 for /f &quot;tokens=1&quot; %%a in (&#x27;%psc% &quot;([WMI]&#x27;Win32_OperatingSystem=@&#x27;).OperatingSystemSKU&quot; %nul6%&#x27;) do if not errorlevel 1 set &quot;wmiSKU=%%a&quot;</span><br><span class="line"></span><br><span class="line">set osSKU=%slcSKU%</span><br><span class="line">if not defined osSKU set osSKU=%wmiSKU%</span><br><span class="line">if not defined osSKU set osSKU=%regSKU%</span><br><span class="line"></span><br><span class="line">if not defined osSKU (</span><br><span class="line">%eline%</span><br><span class="line">echo 检测到不正确的SKU值，程序终止...</span><br><span class="line">goto dk_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set error=</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">echo:</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; /v PROCESSOR_ARCHITECTURE&#x27;) do set arch=%%b</span><br><span class="line">for /f &quot;tokens=6-7 delims=[]. &quot; %%i in (&#x27;ver&#x27;) do if &quot;%%j&quot;==&quot;&quot; (set fullbuild=%%i) else (set fullbuild=%%i.%%j)</span><br><span class="line">echo 检查操作系统信息                        [%winos% ^| %fullbuild% ^| %arch%]</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check Windows Script Host</span><br><span class="line"></span><br><span class="line">set _WSH=1</span><br><span class="line">reg query &quot;HKCU\SOFTWARE\Microsoft\Windows Script Host\Settings&quot; /v Enabled %nul2% | find /i &quot;0x0&quot; %nul1% &amp;&amp; (set _WSH=0)</span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows Script Host\Settings&quot; /v Enabled %nul2% | find /i &quot;0x0&quot; %nul1% &amp;&amp; (set _WSH=0)</span><br><span class="line"></span><br><span class="line">if %_WSH% EQU 0 (</span><br><span class="line">reg add &quot;HKLM\Software\Microsoft\Windows Script Host\Settings&quot; /v Enabled /t REG_DWORD /d 1 /f %nul%</span><br><span class="line">reg add &quot;HKCU\Software\Microsoft\Windows Script Host\Settings&quot; /v Enabled /t REG_DWORD /d 1 /f %nul%</span><br><span class="line">if not &quot;%arch%&quot;==&quot;x86&quot; reg add &quot;HKLM\Software\Microsoft\Windows Script Host\Settings&quot; /v Enabled /t REG_DWORD /d 1 /f /reg:32 %nul%</span><br><span class="line">echo 启用 Windows 脚本托管            [成功]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">echo 启动诊断测试...</span><br><span class="line"></span><br><span class="line">set &quot;_serv=ClipSVC sppsvc KeyIso Winmgmt&quot;</span><br><span class="line"></span><br><span class="line">::  Client License Service (ClipSVC)</span><br><span class="line">::  Software Protection</span><br><span class="line">::  CNG Key Isolation</span><br><span class="line">::  Windows Management Instrumentation</span><br><span class="line"></span><br><span class="line">call :dk_errorcheck</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check if GVLK (KMS key) is already installed or not</span><br><span class="line"></span><br><span class="line">set _gvlk=</span><br><span class="line">call :dk_channel</span><br><span class="line">if /i &quot;Volume:GVLK&quot;==&quot;%_channel%&quot; set _gvlk=1</span><br><span class="line"></span><br><span class="line">::  Detect Key</span><br><span class="line"></span><br><span class="line">set key=</span><br><span class="line">set pkey=</span><br><span class="line">set altkey=</span><br><span class="line">set changekey=</span><br><span class="line">set altedition=</span><br><span class="line"></span><br><span class="line">if defined applist call :kms38data getkey</span><br><span class="line"></span><br><span class="line">if not defined key call :dk_gvlk %nul%</span><br><span class="line">if defined applist if not defined key call :kms38fallback</span><br><span class="line"></span><br><span class="line">if defined altkey (set key=%altkey%&amp;set changekey=1)</span><br><span class="line"></span><br><span class="line">set /a UBR=0</span><br><span class="line">if %osSKU%==191 if defined altkey if defined altedition (</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; /v UBR 2^&gt;nul&#x27;) do if not errorlevel 1 set /a UBR=%%b</span><br><span class="line">if %winbuild% GEQ 19044 if !UBR! LSS 2788 (</span><br><span class="line">call :dk_color %Blue% &quot;要激活 IotEnterpriseS KMS38，Windows 必须升级到 19044.2788 版或更高版本。&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not defined key if defined notfoundaltactID (</span><br><span class="line">call :dk_color %Red% &quot;检查 KMS38 的备用版本   [%altedition% 未找到激活 ID]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not defined key if not defined _gvlk (</span><br><span class="line">%eline%</span><br><span class="line">echo [%winos% ^| %winbuild% ^| SKU:%osSKU%]</span><br><span class="line">echo 无法在支持的产品列表中找到此产品。</span><br><span class="line">echo 确保您使用的是最新版本的MAS脚本。</span><br><span class="line">echo %mas%</span><br><span class="line">echo:</span><br><span class="line">goto dk_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Install key</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if defined changekey (</span><br><span class="line">call :dk_color %Blue% &quot;[%altedition%] 版本产品密钥将被用于激活 KMS38。&quot;</span><br><span class="line">echo:</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set _partial=</span><br><span class="line">if not defined key (</span><br><span class="line">if %_wmic% EQU 1 for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;wmic path SoftwareLicensingProduct where &quot;ApplicationID=&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27; and PartialProductKey&lt;&gt;null&quot; Get PartialProductKey /value %nul6%&#x27;) do set &quot;_partial=%%#&quot;</span><br><span class="line">if %_wmic% EQU 0 for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;%psc% &quot;(([WMISEARCHER]&#x27;SELECT PartialProductKey FROM SoftwareLicensingProduct WHERE ApplicationID=&#x27;&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27;&#x27; AND PartialProductKey IS NOT NULL&#x27;).Get()).PartialProductKey | %% &#123;echo (&#x27;PartialProductKey=&#x27;+$_)&#125;&quot; %nul6%&#x27;) do set &quot;_partial=%%#&quot;</span><br><span class="line">call echo 检查已安装的产品密钥          [Partial Key - %%_partial%%] [Volume:GVLK]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set error_code=</span><br><span class="line">if defined key (</span><br><span class="line">if %_wmic% EQU 1 wmic path SoftwareLicensingService where __CLASS=&#x27;SoftwareLicensingService&#x27; call InstallProductKey ProductKey=&quot;%key%&quot; %nul%</span><br><span class="line">if %_wmic% EQU 0 %psc% &quot;(([WMISEARCHER]&#x27;SELECT Version FROM SoftwareLicensingService&#x27;).Get()).InstallProductKey(&#x27;%key%&#x27;)&quot; %nul%</span><br><span class="line">if not !errorlevel!==0 cscript //nologo %windir%\system32\slmgr.vbs /ipk %key% %nul%</span><br><span class="line">set error_code=!errorlevel!</span><br><span class="line">cmd /c exit /b !error_code!</span><br><span class="line">if !error_code! NEQ 0 set &quot;error_code=[0x!=ExitCode!]&quot;</span><br><span class="line"></span><br><span class="line">if !error_code! EQU 0 (</span><br><span class="line">call :dk_refresh</span><br><span class="line">echo 安装 KMS 客户端安装密钥         [%key%] [成功]</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Red% &quot;安装 KMS 客户端安装密钥         [%key%] [失败] !error_code!&quot;</span><br><span class="line">if not defined error (</span><br><span class="line">call :dk_color %Blue% &quot;%_fixmsg%&quot;</span><br><span class="line">set showfix=1</span><br><span class="line">)</span><br><span class="line">set error=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check activation ID for setting specific KMS host</span><br><span class="line"></span><br><span class="line">set app=</span><br><span class="line">if %_wmic% EQU 1 for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;&quot;wmic path SoftwareLicensingProduct where (ApplicationID=&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27; and Description like &#x27;%%KMSCLIENT%%&#x27; and PartialProductKey is not NULL) get ID /VALUE&quot; %nul6%&#x27;) do call set &quot;app=%%a&quot;</span><br><span class="line">if %_wmic% EQU 0 for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;%psc% &quot;(([WMISEARCHER]&#x27;SELECT ID FROM SoftwareLicensingProduct WHERE ApplicationID=&#x27;&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27;&#x27; AND Description like &#x27;&#x27;%%KMSCLIENT%%&#x27;&#x27; AND PartialProductKey IS NOT NULL&#x27;).Get()).ID | %% &#123;echo (&#x27;ID=&#x27;+$_)&#125;&quot; %nul6%&#x27;) do call set &quot;app=%%a&quot;</span><br><span class="line"></span><br><span class="line">if not defined app (</span><br><span class="line">call :dk_color %Red% &quot;检查已安装的 GVLK 激活 ID   [Not Found] 程序中止...&quot;</span><br><span class="line">call :dk_color2 %Blue% &quot;查看此页以获得帮助&quot; %_Yellow% &quot; %mas%troubleshoot&quot;</span><br><span class="line">goto :dk_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Set specific KMS host to Local Host</span><br><span class="line">::  By doing this, global KMS IP can not replace KMS38 activation but can be used with Office and other Windows Editions</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">%nul% reg delete &quot;HKLM\%specific_kms%&quot; /f</span><br><span class="line">%nul% reg delete &quot;HKU\S-1-5-20\%specific_kms%&quot; /f</span><br><span class="line"></span><br><span class="line">%nul% reg query &quot;HKLM\%specific_kms%&quot; &amp;&amp; (</span><br><span class="line">%psc% &quot;$f=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split &#x27;:regdel\:.*&#x27;;iex ($f[1]);&quot;</span><br><span class="line">%nul% reg delete &quot;HKLM\%specific_kms%&quot; /f</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set k_error=</span><br><span class="line">%nul% reg add &quot;HKLM\%specific_kms%\%app%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;127.0.0.2&quot; || set k_error=1</span><br><span class="line">%nul% reg add &quot;HKLM\%specific_kms%\%app%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;1688&quot; || set k_error=1</span><br><span class="line"></span><br><span class="line">if not defined k_error (</span><br><span class="line">echo 添加特定 KMS 主机                [LocalHost 127.0.0.2] [成功]</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Red% &quot;添加特定 KMS 主机                [LocalHost 127.0.0.2] [失败]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Copy clipup.exe to System32 directory to activate Server Cor/Acor editions</span><br><span class="line"></span><br><span class="line">if defined a_cor (</span><br><span class="line">set &quot;_clipup=%systemroot%\System32\clipup.exe&quot;</span><br><span class="line">pushd &quot;!_work!\&quot;</span><br><span class="line">copy /y /b &quot;ClipUp.exe&quot; &quot;!_clipup!&quot; %nul%</span><br><span class="line">popd</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if exist &quot;!_clipup!&quot; (</span><br><span class="line">echo 将 clipup.exe 文件复制到              [%systemroot%\System32\] [成功]</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Red% &quot;将 clipup.exe 文件复制到              [%systemroot%\System32\] [失败] 程序中止...&quot;</span><br><span class="line">goto :k_final</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Generate GenuineTicket.xml and apply</span><br><span class="line">::  In some cases clipup -v -o method fails and in some cases service restart method fails as well</span><br><span class="line">::  To maximize success rate and get better error details, script will install tickets two times (service restart + clipup -v -o)</span><br><span class="line"></span><br><span class="line">if not exist %SystemRoot%\system32\ClipUp.exe (</span><br><span class="line">call :dk_color %Red% &quot;检查 ClipUp.exe 文件                [Not Found, 中止进程]&quot;</span><br><span class="line">call :dk_color2 %Blue% &quot;查看此页以获得帮助&quot; %_Yellow% &quot; %mas%troubleshoot&quot;</span><br><span class="line">goto :k_final</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;tdir=%ProgramData%\Microsoft\Windows\ClipSVC\GenuineTicket&quot;</span><br><span class="line">if not exist &quot;%tdir%\&quot; md &quot;%tdir%\&quot; %nul%</span><br><span class="line"></span><br><span class="line">if exist &quot;%tdir%\Genuine*&quot; del /f /q &quot;%tdir%\Genuine*&quot; %nul%</span><br><span class="line">if exist &quot;%tdir%\*.xml&quot; del /f /q &quot;%tdir%\*.xml&quot; %nul%</span><br><span class="line">if exist &quot;%ProgramData%\Microsoft\Windows\ClipSVC\Install\Migration\*&quot; del /f /q &quot;%ProgramData%\Microsoft\Windows\ClipSVC\Install\Migration\*&quot; %nul%</span><br><span class="line"></span><br><span class="line">::  Signature value is as it is, it&#x27;s not encoded</span><br><span class="line">::  Session ID is in Base64 encoded format. It&#x27;s decoded value is &quot;OSMajorVersion=5;OSMinorVersion=1;OSPlatformId=2;PP=0;GVLKExp=2038-01-19T03:14:07Z;DownlevelGenuineState=1;&quot;</span><br><span class="line">::  Check mass grave[.]dev/kms38.html#Manual_Activation to see how it&#x27;s generated</span><br><span class="line"></span><br><span class="line">set &quot;signature=C52iGEoH+1VqzI6kEAqOhUyrWuEObnivzaVjyef8WqItVYd/xGDTZZ3bkxAI9hTpobPFNJyJx6a3uriXq3HVd7mlXfSUK9ydeoUdG4eqMeLwkxeb6jQWJzLOz41rFVSMtBL0e+ycCATebTaXS4uvFYaDHDdPw2lKY8ADj3MLgsA=&quot;</span><br><span class="line">set &quot;sessionId=TwBTAE0AYQBqAG8AcgBWAGUAcgBzAGkAbwBuAD0ANQA7AE8AUwBNAGkAbgBvAHIAVgBlAHIAcwBpAG8AbgA9ADEAOwBPAFMAUABsAGEAdABmAG8AcgBtAEkAZAA9ADIAOwBQAFAAPQAwADsARwBWAEwASwBFAHgAcAA9ADIAMAAzADgALQAwADEALQAxADkAVAAwADMAOgAxADQAOgAwADcAWgA7AEQAbwB3AG4AbABlAHYAZQBsAEcAZQBuAHUAaQBuAGUAUwB0AGEAdABlAD0AMQA7AAAA&quot;</span><br><span class="line">&lt;nul set /p &quot;=&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;genuineAuthorization xmlns=&quot;http://www.microsoft.com/DRM/SL/GenuineAuthorization/1.0&quot;&gt;&lt;version&gt;1.0&lt;/version&gt;&lt;genuineProperties origin=&quot;sppclient&quot;&gt;&lt;properties&gt;OA3xOriginalProductId=;OA3xOriginalProductKey=;SessionId=%sessionId%;TimeStampClient=2022-10-11T12:00:00Z&lt;/properties&gt;&lt;signatures&gt;&lt;signature name=&quot;clientLockboxKey&quot; method=&quot;rsa-sha256&quot;&gt;%signature%&lt;/signature&gt;&lt;/signatures&gt;&lt;/genuineProperties&gt;&lt;/genuineAuthorization&gt;&quot; &gt;&quot;%tdir%\GenuineTicket&quot;</span><br><span class="line"></span><br><span class="line">copy /y /b &quot;%tdir%\GenuineTicket&quot; &quot;%tdir%\GenuineTicket.xml&quot; %nul%</span><br><span class="line"></span><br><span class="line">if not exist &quot;%tdir%\GenuineTicket.xml&quot; (</span><br><span class="line">call :dk_color %Red% &quot;生成 GenuineTicket.xml            [失败, 中止进程]&quot;</span><br><span class="line">if exist &quot;%tdir%\Genuine*&quot; del /f /q &quot;%tdir%\Genuine*&quot; %nul%</span><br><span class="line">goto :k_final</span><br><span class="line">) else (</span><br><span class="line">echo 生成 GenuineTicket.xml            [成功]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;_xmlexist=if exist &quot;%tdir%\GenuineTicket.xml&quot;&quot;</span><br><span class="line"></span><br><span class="line">::  Stop sppsvc</span><br><span class="line"></span><br><span class="line">net stop sppsvc /y %nul%</span><br><span class="line">net stop sppsvc /y %nul%</span><br><span class="line">net stop sppsvc /y %nul%</span><br><span class="line"></span><br><span class="line">sc query sppsvc | find /i &quot;STOPPED&quot; %nul% &amp;&amp; (</span><br><span class="line">echo 停止 sppsvc 服务                 [成功]</span><br><span class="line">) || (</span><br><span class="line">call :dk_color %Gray% &quot;停止 sppsvc 服务                 [失败]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">%_xmlexist% (</span><br><span class="line">net stop ClipSVC /y %nul%</span><br><span class="line">net start ClipSVC /y %nul%</span><br><span class="line">%_xmlexist% timeout /t 2 %nul%</span><br><span class="line">%_xmlexist% timeout /t 2 %nul%</span><br><span class="line"></span><br><span class="line">%_xmlexist% (</span><br><span class="line">set error=1</span><br><span class="line">if exist &quot;%tdir%\*.xml&quot; del /f /q &quot;%tdir%\*.xml&quot; %nul%</span><br><span class="line">call :dk_color %Red% &quot;安装 GenuineTicket.xml            [ClipSVC 服务重启失败，等待中...]&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">copy /y /b &quot;%tdir%\GenuineTicket&quot; &quot;%tdir%\GenuineTicket.xml&quot; %nul%</span><br><span class="line">clipup -v -o</span><br><span class="line"></span><br><span class="line">set rebuildinfo=</span><br><span class="line"></span><br><span class="line">if not exist %ProgramData%\Microsoft\Windows\ClipSVC\tokens.dat (</span><br><span class="line">set error=1</span><br><span class="line">set rebuildinfo=1</span><br><span class="line">call :dk_color %Red% &quot;检查 ClipSVC tokens.dat             [Not Found]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">%_xmlexist% (</span><br><span class="line">set error=1</span><br><span class="line">set rebuildinfo=1</span><br><span class="line">call :dk_color %Red% &quot;安装 GenuineTicket.xml            [Failed With clipup -v -o]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if exist &quot;%ProgramData%\Microsoft\Windows\ClipSVC\Install\Migration\*.xml&quot; (</span><br><span class="line">set error=1</span><br><span class="line">set rebuildinfo=1</span><br><span class="line">call :dk_color %Red% &quot;检查 Ticket Migration               [失败]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined applist if not defined showfix if defined rebuildinfo (</span><br><span class="line">set showfix=1</span><br><span class="line">call :dk_color %Blue% &quot;%_fixmsg%&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if exist &quot;%tdir%\Genuine*&quot; del /f /q &quot;%tdir%\Genuine*&quot; %nul%</span><br><span class="line"></span><br><span class="line">::==========================================================================================================================================</span><br><span class="line"></span><br><span class="line">call :dk_product</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo 激活...</span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">call :k_checkexp</span><br><span class="line">if defined _k38 (</span><br><span class="line">call :k_actinfo</span><br><span class="line">goto :k_final</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::  Clear 180 Days KMS Activation lock with Windows SKU specific rearm and without the need to restart the system</span><br><span class="line"></span><br><span class="line">if %_wmic% EQU 1 wmic path SoftwareLicensingProduct where ID=&#x27;%app%&#x27; call ReArmsku %nul%</span><br><span class="line">if %_wmic% EQU 0 %psc% &quot;$null=([WMI]&#x27;SoftwareLicensingProduct=&#x27;&#x27;%app%&#x27;&#x27;&#x27;).ReArmsku()&quot; %nul%</span><br><span class="line"></span><br><span class="line">if %errorlevel%==0 (</span><br><span class="line">echo 激活...应用 SKU-ID Rearm                   [成功]</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Red% &quot;激活...应用 SKU-ID Rearm                   [失败]&quot;</span><br><span class="line">)</span><br><span class="line">call :dk_refresh</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">call :k_checkexp</span><br><span class="line">if defined _k38 (</span><br><span class="line">call :k_actinfo</span><br><span class="line">goto :k_final</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :dk_color %Red% &quot;Activation Failed&quot;</span><br><span class="line">if not defined error call :dk_color %Blue% &quot;%_fixmsg%&quot;</span><br><span class="line">call :dk_color2 %Blue% &quot;查看此页以获得帮助&quot; %_Yellow% &quot; %mas%troubleshoot&quot;</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:k_final</span><br><span class="line"></span><br><span class="line">::  Remove the added Specific KMS Host (Local Host) if activation is not completed</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if not defined _k38 (</span><br><span class="line">%nul% reg delete &quot;HKLM\%specific_kms%&quot; /f</span><br><span class="line">%nul% reg delete &quot;HKU\S-1-5-20\%specific_kms%&quot; /f</span><br><span class="line">%nul% reg query &quot;HKLM\%specific_kms%&quot; &amp;&amp; (</span><br><span class="line">call :dk_color %Red% &quot;删除已添加的特定 KMS 主机    [失败]&quot;</span><br><span class="line">) || (</span><br><span class="line">echo 删除已添加的特定 KMS 主机    [成功]</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::  Protect KMS38 if opted by the user and conditions are correct</span><br><span class="line"></span><br><span class="line">if defined _k38 (</span><br><span class="line">%psc% &quot;$f=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split &#x27;:regdel\:.*&#x27;;&amp; ([ScriptBlock]::Create($f[1])) -protect;&quot;</span><br><span class="line">%nul% reg delete &quot;HKLM\%specific_kms%&quot; /f</span><br><span class="line">%nul% reg query &quot;HKLM\%specific_kms%&quot; &amp;&amp; (</span><br><span class="line">echo 从 KMS 保护 KMS38                  [成功] [锁定注册表密钥]</span><br><span class="line">) || (</span><br><span class="line">call :dk_color %Red% &quot;从 KMS 保护 KMS38                  [Failed To Lock A Registry Key]&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::  clipup.exe does not exist in server cor and acor editions by default, it was copied there with this script</span><br><span class="line"></span><br><span class="line">if defined a_cor if exist &quot;%_clipup%&quot; del /f /q &quot;%_clipup%&quot; %nul%</span><br><span class="line"></span><br><span class="line">if defined a_cor (</span><br><span class="line">if exist &quot;%_clipup%&quot; (</span><br><span class="line">call :dk_color %Red% &quot;删除复制的 clipup.exe 文件         [失败]&quot;</span><br><span class="line">) else (</span><br><span class="line">echo 删除复制的 clipup.exe 文件         [成功]</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%# in (175 407) do if %osSKU%==%%# (</span><br><span class="line">call :dk_color %Red% &quot;%winos% 不支持在非 Azure 平台上激活。&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">goto :dk_done</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:k_uninstall</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode 99, 28</span><br><span class="line">title  移除 KMS38 激活</span><br><span class="line"></span><br><span class="line">%nul% reg delete &quot;HKLM\%specific_kms%&quot; /f</span><br><span class="line">%nul% reg delete &quot;HKU\S-1-5-20\%specific_kms%&quot; /f</span><br><span class="line"></span><br><span class="line">%nul% reg query &quot;HKLM\%specific_kms%&quot; &amp;&amp; (</span><br><span class="line">%psc% &quot;$f=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split &#x27;:regdel\:.*&#x27;;iex ($f[1]);&quot;</span><br><span class="line">%nul% reg delete &quot;HKLM\%specific_kms%&quot; /f</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">%nul% reg query &quot;HKLM\%specific_kms%&quot; &amp;&amp; (</span><br><span class="line">call :dk_color %Red% &quot;删除特定 KMS 主机              [失败]&quot;</span><br><span class="line">) || (</span><br><span class="line">echo 删除特定 KMS 主机              [成功]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">goto :dk_done</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  This code runs to protect/undo below registry key for KMS38 protection</span><br><span class="line">::  HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\55c92734-d682-4d71-983e-d6ec3f16059f</span><br><span class="line"></span><br><span class="line">::  KMS38 protection stops 180 days KMS Activation from replacing KMS38 activation</span><br><span class="line"></span><br><span class="line">:regdel:</span><br><span class="line">param (</span><br><span class="line">    [switch]$protect</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">$SID = New-Object System.Security.Principal.SecurityIdentifier(&#x27;S-1-5-32-544&#x27;)</span><br><span class="line">$Admin = ($SID.Translate([System.Security.Principal.NTAccount])).Value</span><br><span class="line"></span><br><span class="line">if($protect) &#123;</span><br><span class="line">$ruleArgs = @(&quot;$Admin&quot;, &quot;Delete, SetValue&quot;, &quot;ContainerInherit&quot;, &quot;None&quot;, &quot;Deny&quot;)</span><br><span class="line">&#125; else &#123;</span><br><span class="line">$ruleArgs = @(&quot;$Admin&quot;, &quot;FullControl&quot;, &quot;Allow&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$path = &#x27;SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\55c92734-d682-4d71-983e-d6ec3f16059f&#x27;</span><br><span class="line">$key = [Microsoft.Win32.RegistryKey]::OpenBaseKey(&#x27;LocalMachine&#x27;, &#x27;Registry64&#x27;).OpenSubKey($path, &#x27;ReadWriteSubTree&#x27;, &#x27;ChangePermissions&#x27;)</span><br><span class="line">$acl = $key.GetAccessControl()</span><br><span class="line"></span><br><span class="line">$rule = [System.Security.AccessControl.RegistryAccessRule]::new.Invoke($ruleArgs)</span><br><span class="line">$acl.ResetAccessRule($rule)</span><br><span class="line">$key.SetAccessControl($acl)</span><br><span class="line">:regdel:</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check KMS activation status</span><br><span class="line"></span><br><span class="line">:k_actinfo</span><br><span class="line"></span><br><span class="line">set xpr=</span><br><span class="line">for /f &quot;tokens=* delims=&quot; %%# in (&#x27;%psc% &quot;$([DateTime]::Now.addMinutes(%gpr%)).ToString(&#x27;yyyy-MM-dd HH:mm:ss&#x27;)&quot; %nul6%&#x27;) do set &quot;xpr=%%#&quot;</span><br><span class="line">call :dk_color %Green% &quot;%winos% is activated till !xpr!&quot;</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::  Check remaining KMS activation grace period</span><br><span class="line"></span><br><span class="line">:k_checkexp</span><br><span class="line"></span><br><span class="line">set gpr=0</span><br><span class="line">if %_wmic% EQU 1 for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;&quot;wmic path SoftwareLicensingProduct where (ApplicationID=&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27; and Description like &#x27;%%KMSCLIENT%%&#x27; and PartialProductKey is not NULL) get GracePeriodRemaining /VALUE&quot; %nul6%&#x27;) do set &quot;gpr=%%#&quot;</span><br><span class="line">if %_wmic% EQU 0 for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;%psc% &quot;(([WMISEARCHER]&#x27;SELECT GracePeriodRemaining FROM SoftwareLicensingProduct WHERE ApplicationID=&#x27;&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27;&#x27; AND Description like &#x27;&#x27;%%KMSCLIENT%%&#x27;&#x27; AND PartialProductKey IS NOT NULL&#x27;).Get()).GracePeriodRemaining | %% &#123;echo (&#x27;GracePeriodRemaining=&#x27;+$_)&#125;&quot; %nul6%&#x27;) do set &quot;gpr=%%#&quot;</span><br><span class="line">if %gpr% GTR 259200 (set _k38=1) else (set _k38=)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::  Get Windows installed key channel</span><br><span class="line"></span><br><span class="line">:dk_channel</span><br><span class="line"></span><br><span class="line">if %_wmic% EQU 1 for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;wmic path SoftwareLicensingProduct where &quot;ApplicationID=&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27; and PartialProductKey&lt;&gt;null&quot; Get ProductKeyChannel /value %nul6%&#x27;) do set &quot;_channel=%%#&quot;</span><br><span class="line">if %_wmic% EQU 0 for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;%psc% &quot;(([WMISEARCHER]&#x27;SELECT ProductKeyChannel FROM SoftwareLicensingProduct WHERE ApplicationID=&#x27;&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27;&#x27; AND PartialProductKey IS NOT NULL&#x27;).Get()).ProductKeyChannel | %% &#123;echo (&#x27;ProductKeyChannel=&#x27;+$_)&#125;&quot; %nul6%&#x27;) do set &quot;_channel=%%#&quot;</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Get Product Key from pkeyhelper.dll for future new editions</span><br><span class="line">::  It works on Windows 10 1803 (17134) and later builds.</span><br><span class="line"></span><br><span class="line">:dk_pkey</span><br><span class="line"></span><br><span class="line">call :dk_reflection</span><br><span class="line"></span><br><span class="line">set d1=%ref% [void]$TypeBuilder.DefinePInvokeMethod(&#x27;SkuGetProductKeyForEdition&#x27;, &#x27;pkeyhelper.dll&#x27;, &#x27;Public, Static&#x27;, 1, [int], @([int], [String], [String].MakeByRefType(), [String].MakeByRefType()), 1, 3);</span><br><span class="line">set d1=%d1% $out = &#x27;&#x27;; [void]$TypeBuilder.CreateType()::SkuGetProductKeyForEdition(%1, %2, [ref]$out, [ref]$null); $out</span><br><span class="line"></span><br><span class="line">set pkey=</span><br><span class="line">for /f %%a in (&#x27;%psc% &quot;%d1%&quot;&#x27;) do if not errorlevel 1 (set pkey=%%a)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::  Get channel name for the key which was extracted from pkeyhelper.dll</span><br><span class="line"></span><br><span class="line">:dk_pkeychannel</span><br><span class="line"></span><br><span class="line">set k=%1</span><br><span class="line">set m=[Runtime.InteropServices.Marshal]</span><br><span class="line">set p=%SystemRoot%\System32\spp\tokens\pkeyconfig\pkeyconfig.xrm-ms</span><br><span class="line"></span><br><span class="line">set d1=%ref% [void]$TypeBuilder.DefinePInvokeMethod(&#x27;PidGenX&#x27;, &#x27;pidgenx.dll&#x27;, &#x27;Public, Static&#x27;, 1, [int], @([String], [String], [String], [int], [IntPtr], [IntPtr], [IntPtr]), 1, 3);</span><br><span class="line">set d1=%d1% $r = [byte[]]::new(0x04F8); $r[0] = 0xF8; $r[1] = 0x04; $f = %m%::AllocHGlobal(0x04F8); %m%::Copy($r, 0, $f, 0x04F8);</span><br><span class="line">set d1=%d1% [void]$TypeBuilder.CreateType()::PidGenX(&#x27;%k%&#x27;, &#x27;%p%&#x27;, &#x27;00000&#x27;, 0, 0, 0, $f); %m%::Copy($f, $r, 0, 0x04F8); %m%::FreeHGlobal($f); [Text.Encoding]::Unicode.GetString($r, 1016, 128)</span><br><span class="line"></span><br><span class="line">set pkeychannel=</span><br><span class="line">for /f %%a in (&#x27;%psc% &quot;%d1%&quot;&#x27;) do if not errorlevel 1 (set pkeychannel=%%a)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:dk_gvlk</span><br><span class="line"></span><br><span class="line">for %%# in (pkeyhelper.dll) do @if &quot;%%~$PATH:#&quot;==&quot;&quot; exit /b</span><br><span class="line">for %%# in (Volume:GVLK) do (</span><br><span class="line">call :dk_pkey %osSKU% &#x27;%%#&#x27;</span><br><span class="line">if defined pkey call :dk_pkeychannel !pkey!</span><br><span class="line">if /i [!pkeychannel!]==[%%#] (</span><br><span class="line">set key=!pkey!</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  1st column = Activation ID</span><br><span class="line">::  2nd column = GVLK (Generic volume licensing key)</span><br><span class="line">::  3rd column = SKU ID</span><br><span class="line">::  4th column = WMI Edition ID (For reference only)</span><br><span class="line">::  5th column = Build Branch name incase same Edition ID is used in different OS versions with different key (For reference only)</span><br><span class="line">::  Separator  = &quot;_&quot;</span><br><span class="line"></span><br><span class="line">:kms38data</span><br><span class="line"></span><br><span class="line">set f=</span><br><span class="line">for %%# in (</span><br><span class="line">73111121-5638-40f6-bc11-f1d7b0d64300_NPP%f%R9-FW%f%DCX-D2C%f%8J-H8%f%72K-2Y%f%T43___4_Enterprise</span><br><span class="line">9bd77860-9b31-4b7b-96ad-2564017315bf_VDY%f%BN-27%f%WPP-V4H%f%QT-9V%f%MD4-VM%f%K7H___7_ServerStandard_FE</span><br><span class="line">de32eafd-aaee-4662-9444-c1befb41bde2_N69%f%G4-B8%f%9J2-4G8%f%F4-WW%f%YCC-J4%f%64C___7_ServerStandard_RS5</span><br><span class="line">8c1c5410-9f39-4805-8c9d-63a07706358f_WC2%f%BQ-8N%f%RM3-FDD%f%YY-2B%f%FGV-KH%f%KQY___7_ServerStandard_RS1</span><br><span class="line">ef6cfc9f-8c5d-44ac-9aad-de6a2ea0ae03_WX4%f%NM-KY%f%WYW-QJJ%f%R4-XV%f%3QB-6V%f%M33___8_ServerDatacenter_FE</span><br><span class="line">34e1ae55-27f8-4950-8877-7a03be5fb181_WMD%f%GN-G9%f%PQG-XVV%f%XX-R3%f%X43-63%f%DFG___8_ServerDatacenter_RS5</span><br><span class="line">21c56779-b449-4d20-adfc-eece0e1ad74b_CB7%f%KF-BW%f%N84-R7R%f%2Y-79%f%3K2-8X%f%DDG___8_ServerDatacenter_RS1</span><br><span class="line">e272e3e2-732f-4c65-a8f0-484747d0d947_DPH%f%2V-TT%f%NVB-4X9%f%Q3-TJ%f%R4H-KH%f%JW4__27_EnterpriseN</span><br><span class="line">2de67392-b7a7-462a-b1ca-108dd189f588_W26%f%9N-WF%f%GWX-YVC%f%9B-4J%f%6C9-T8%f%3GX__48_Professional</span><br><span class="line">a80b5abf-76ad-428b-b05d-a47d2dffeebf_MH3%f%7W-N4%f%7XK-V7X%f%M9-C7%f%227-GC%f%QG9__49_ProfessionalN</span><br><span class="line">034d3cbb-5d4b-4245-b3f8-f84571314078_WVD%f%HN-86%f%M7X-466%f%P6-VH%f%XV7-YY%f%726__50_ServerSolution_RS5</span><br><span class="line">2b5a1b0f-a5ab-4c54-ac2f-a6d94824a283_JCK%f%RF-N3%f%7P4-C2D%f%82-9Y%f%XRT-4M%f%63B__50_ServerSolution_RS1</span><br><span class="line">7b9e1751-a8da-4f75-9560-5fadfe3d8e38_3KH%f%Y7-WN%f%T83-DGQ%f%KR-F7%f%HPR-84%f%4BM__98_CoreN</span><br><span class="line">a9107544-f4a0-4053-a96a-1479abdef912_PVM%f%JN-6D%f%FY6-9CC%f%P6-7B%f%KTT-D3%f%WVR__99_CoreCountrySpecific</span><br><span class="line">cd918a57-a41b-4c82-8dce-1a538e221a83_7HN%f%RX-D7%f%KGG-3K4%f%RQ-4W%f%PJ4-YT%f%DFH_100_CoreSingleLanguage</span><br><span class="line">58e97c99-f377-4ef1-81d5-4ad5522b5fd8_TX9%f%XD-98%f%N7V-6WM%f%Q6-BX%f%7FG-H8%f%Q99_101_Core</span><br><span class="line">7b4433f4-b1e7-4788-895a-c45378d38253_QN4%f%C6-GB%f%JD2-FB4%f%22-GH%f%WJK-GJ%f%G2R_110_ServerCloudStorage</span><br><span class="line">8de8eb62-bbe0-40ac-ac17-f75595071ea3_GRF%f%BW-QN%f%DC4-6QB%f%HG-CC%f%K3B-2P%f%R88_120_ServerARM64_RS5</span><br><span class="line">43d9af6e-5e86-4be8-a797-d072a046896c_K9F%f%YF-G6%f%NCK-73M%f%32-XM%f%VPY-F9%f%DRR_120_ServerARM64_RS4</span><br><span class="line">e0c42288-980c-4788-a014-c080d2e1926e_NW6%f%C2-QM%f%PVW-D7K%f%KK-3G%f%KT6-VC%f%FB2_121_Education</span><br><span class="line">3c102355-d027-42c6-ad23-2e7ef8a02585_2WH%f%4N-8Q%f%GBV-H22%f%JP-CT%f%43Q-MD%f%WWJ_122_EducationN</span><br><span class="line">32d2fab3-e4a8-42c2-923b-4bf4fd13e6ee_M7X%f%TQ-FN%f%8P6-TTK%f%YV-9D%f%4CC-J4%f%62D_125_EnterpriseS_RS5,VB,Ge</span><br><span class="line">2d5a5a60-3040-48bf-beb0-fcd770c20ce0_DCP%f%HK-NF%f%MTC-H88%f%MJ-PF%f%HPY-QJ%f%4BJ_125_EnterpriseS_RS1</span><br><span class="line">7b51a46c-0c04-4e8f-9af4-8496cca90d5e_WNM%f%TR-4C%f%88C-JK8%f%YV-HQ%f%7T2-76%f%DF9_125_EnterpriseS_TH1</span><br><span class="line">7103a333-b8c8-49cc-93ce-d37c09687f92_92N%f%FX-8D%f%JQP-P6B%f%BQ-TH%f%F9C-7C%f%G2H_126_EnterpriseSN_RS5,VB,Ge</span><br><span class="line">9f776d83-7156-45b2-8a5c-359b9c9f22a3_QFF%f%DN-GR%f%T3P-VKW%f%WX-X7%f%T3R-8B%f%639_126_EnterpriseSN_RS1</span><br><span class="line">87b838b7-41b6-4590-8318-5797951d8529_2F7%f%7B-TN%f%FGY-69Q%f%QF-B8%f%YKP-D6%f%9TJ_126_EnterpriseSN_TH1</span><br><span class="line">39e69c41-42b4-4a0a-abad-8e3c10a797cc_QFN%f%D9-D3%f%Y9C-J3K%f%KY-6R%f%PVP-2D%f%PYV_145_ServerDatacenterACor_FE</span><br><span class="line">90c362e5-0da1-4bfd-b53b-b87d309ade43_6NM%f%RW-2C%f%8FM-D24%f%W7-TQ%f%WMY-CW%f%H2D_145_ServerDatacenterACor_RS5</span><br><span class="line">e49c08e7-da82-42f8-bde2-b570fbcae76c_2HX%f%DN-KR%f%XHB-GPY%f%C7-YC%f%KFJ-7F%f%VDG_145_ServerDatacenterACor_RS3</span><br><span class="line">f5e9429c-f50b-4b98-b15c-ef92eb5cff39_67K%f%N8-4F%f%YJW-248%f%7Q-MQ%f%2J7-4C%f%4RG_146_ServerStandardACor_FE</span><br><span class="line">73e3957c-fc0c-400d-9184-5f7b6f2eb409_N2K%f%JX-J9%f%4YW-TQV%f%FB-DG%f%9YT-72%f%4CC_146_ServerStandardACor_RS5</span><br><span class="line">61c5ef22-f14f-4553-a824-c4b31e84b100_PTX%f%N8-JF%f%HJM-4WC%f%78-MP%f%CBR-9W%f%4KR_146_ServerStandardACor_RS3</span><br><span class="line">82bbc092-bc50-4e16-8e18-b74fc486aec3_NRG%f%8B-VK%f%K3Q-CXV%f%CJ-9G%f%2XF-6Q%f%84J_161_ProfessionalWorkstation</span><br><span class="line">4b1571d3-bafb-4b40-8087-a961be2caf65_9FN%f%HH-K3%f%HBT-3W4%f%TD-63%f%83H-6X%f%YWF_162_ProfessionalWorkstationN</span><br><span class="line">3f1afc82-f8ac-4f6c-8005-1d233e606eee_6TP%f%4R-GN%f%PTD-KYY%f%HQ-7B%f%7DP-J4%f%47Y_164_ProfessionalEducation</span><br><span class="line">5300b18c-2e33-4dc2-8291-47ffcec746dd_YVW%f%GF-BX%f%NMC-HTQ%f%YQ-CP%f%Q99-66%f%QFC_165_ProfessionalEducationN</span><br><span class="line">8c8f0ad3-9a43-4e05-b840-93b8d1475cbc_6N3%f%79-GG%f%TMK-23C%f%6M-XV%f%VTC-CK%f%FRQ_168_ServerAzureCor_FE</span><br><span class="line">a99cc1f0-7719-4306-9645-294102fbff95_FDN%f%H6-VW%f%9RW-BXP%f%J7-4X%f%TYG-23%f%9TB_168_ServerAzureCor_RS5</span><br><span class="line">3dbf341b-5f6c-4fa7-b936-699dce9e263f_VP3%f%4G-4N%f%PPG-79J%f%TQ-86%f%4T4-R3%f%MQX_168_ServerAzureCor_RS1</span><br><span class="line">e0b2d383-d112-413f-8a80-97f373a5820c_YYV%f%X9-NT%f%FWV-6MD%f%M3-9P%f%T4T-4M%f%68B_171_EnterpriseG</span><br><span class="line">e38454fb-41a4-4f59-a5dc-25080e354730_44R%f%PN-FT%f%Y23-9VT%f%TB-MP%f%9BX-T8%f%4FV_172_EnterpriseGN</span><br><span class="line">ec868e65-fadf-4759-b23e-93fe37f2cc29_CPW%f%HC-NT%f%2C7-VYW%f%78-DH%f%DB2-PG%f%3GK_175_ServerRdsh_RS5</span><br><span class="line">e4db50ea-bda1-4566-b047-0ca50abc6f07_7NB%f%T4-WG%f%BQX-MP4%f%H7-QX%f%FF8-YP%f%3KX_175_ServerRdsh_RS3</span><br><span class="line">0df4f814-3f57-4b8b-9a9d-fddadcd69fac_NBT%f%WJ-3D%f%R69-3C4%f%V8-C2%f%6MC-GQ%f%9M6_183_CloudE</span><br><span class="line">59eb965c-9150-42b7-a0ec-22151b9897c5_KBN%f%8V-HF%f%GQ4-MGX%f%VD-34%f%7P6-PD%f%QGT_191_IoTEnterpriseS_VB,NI</span><br><span class="line">d30136fc-cb4b-416e-a23d-87207abc44a9_6XN%f%7V-PC%f%BDC-BDB%f%RH-8D%f%QY7-G6%f%R44_202_CloudEditionN</span><br><span class="line">ca7df2e3-5ea0-47b8-9ac1-b1be4d8edd69_37D%f%7F-N4%f%9CB-WQR%f%8W-TB%f%J73-FM%f%8RX_203_CloudEdition</span><br><span class="line">19b5e0fb-4431-46bc-bac1-2f1873e4ae73_NTB%f%V8-9K%f%7Q8-V27%f%C6-M2%f%BTV-KH%f%MXV_407_ServerTurbine</span><br><span class="line">) do (</span><br><span class="line">for /f &quot;tokens=1-5 delims=_&quot; %%A in (&quot;%%#&quot;) do if %osSKU%==%%C (</span><br><span class="line">if %1==getkey if not defined key echo &quot;!applist!&quot; | find /i &quot;%%A&quot; %nul1% &amp;&amp; set key=%%B</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Below code is used to get alternate edition name and key if current edition doesn&#x27;t support KMS38 activation</span><br><span class="line"></span><br><span class="line">::  1st column = Current SKU ID</span><br><span class="line">::  2nd column = Current Edition Name</span><br><span class="line">::  3rd column = Current Edition Activation ID</span><br><span class="line">::  4th column = Alternate Edition Activation ID</span><br><span class="line">::  5th column = Alternate Edition GVLK</span><br><span class="line">::  6th column = Alternate Edition Name</span><br><span class="line">::  Separator  = _</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:kms38fallback</span><br><span class="line"></span><br><span class="line">set notfoundaltactID=</span><br><span class="line">if %_NoEditionChange%==1 exit /b</span><br><span class="line"></span><br><span class="line">for %%# in (</span><br><span class="line">188_IoTEnterprise__________________8ab9bdd1-1f67-4997-82d9-8878520837d9_73111121-5638-40f6-bc11-f1d7b0d64300_NPP%f%R9-FWD%f%CX-D2%f%C8J-H872%f%K-2Y%f%T43_Enterprise</span><br><span class="line">191_IoTEnterpriseS-2021____________ed655016-a9e8-4434-95d9-4345352c2552_32d2fab3-e4a8-42c2-923b-4bf4fd13e6ee_M7X%f%TQ-FN8%f%P6-TT%f%KYV-9D4C%f%C-J4%f%62D_EnterpriseS-2021</span><br><span class="line">205_IoTEnterpriseSK________________d4f9b41f-205c-405e-8e08-3d16e88e02be_59eb965c-9150-42b7-a0ec-22151b9897c5_KBN%f%8V-HFG%f%Q4-MG%f%XVD-347P%f%6-PD%f%QGT_IoTEnterpriseS</span><br><span class="line">138_ProfessionalSingleLanguage_____a48938aa-62fa-4966-9d44-9f04da3f72f2_2de67392-b7a7-462a-b1ca-108dd189f588_W26%f%9N-WFG%f%WX-YV%f%C9B-4J6C%f%9-T8%f%3GX_Professional</span><br><span class="line">139_ProfessionalCountrySpecific____f7af7d09-40e4-419c-a49b-eae366689ebd_2de67392-b7a7-462a-b1ca-108dd189f588_W26%f%9N-WFG%f%WX-YV%f%C9B-4J6C%f%9-T8%f%3GX_Professional</span><br><span class="line">139_ProfessionalCountrySpecific-Zn_01eb852c-424d-4060-94b8-c10d799d7364_2de67392-b7a7-462a-b1ca-108dd189f588_W26%f%9N-WFG%f%WX-YV%f%C9B-4J6C%f%9-T8%f%3GX_Professional</span><br><span class="line">) do (</span><br><span class="line">for /f &quot;tokens=1-6 delims=_&quot; %%A in (&quot;%%#&quot;) do if %osSKU%==%%A (</span><br><span class="line">echo &quot;!applist!&quot; | find /i &quot;%%C&quot; %nul1% &amp;&amp; (</span><br><span class="line">echo &quot;!applist!&quot; | find /i &quot;%%D&quot; %nul1% &amp;&amp; (</span><br><span class="line">set altkey=%%E</span><br><span class="line">set altedition=%%F</span><br><span class="line">) || (</span><br><span class="line">set altedition=%%F</span><br><span class="line">set notfoundaltactID=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class="line"></span><br><span class="line">:KMSActivation</span><br><span class="line">@setlocal DisableDelayedExpansion</span><br><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">color 07</span><br><span class="line">title  在线 KMS 激活</span><br><span class="line"></span><br><span class="line">::  You are not supposed to edit anything below this.</span><br><span class="line"></span><br><span class="line">set WMI_VBS=0</span><br><span class="line">set _Debug=0</span><br><span class="line">set Silent=0</span><br><span class="line">set Logger=0</span><br><span class="line">set AutoR2V=1</span><br><span class="line">set SkipKMS38=1</span><br><span class="line">set vNextOverride=1</span><br><span class="line">set ActWindows=1</span><br><span class="line">set ActOffice=1</span><br><span class="line"></span><br><span class="line">set _uni=</span><br><span class="line">set _args=</span><br><span class="line">set _elev=</span><br><span class="line">set _renetask=</span><br><span class="line">set _renacttask=</span><br><span class="line">set _unattended=</span><br><span class="line">set _unattendedact=</span><br><span class="line"></span><br><span class="line">set _args=%*</span><br><span class="line">if defined _args set _args=%_args:&quot;=%</span><br><span class="line">if defined _args (</span><br><span class="line">echo &quot;%_args%&quot; | find /i &quot;/KMS&quot; &gt;nul &amp;&amp; set _unattended=1</span><br><span class="line"></span><br><span class="line">for %%A in (%_args%) do (</span><br><span class="line">if /i &quot;%%A&quot;==&quot;-el&quot;  (set _elev=1</span><br><span class="line">) else if /i &quot;%%A&quot;==&quot;/KMS-RenewalTask&quot;  (set _renetask=1</span><br><span class="line">) else if /i &quot;%%A&quot;==&quot;/KMS-ActAndRenewalTask&quot; (set _renacttask=1</span><br><span class="line">) else if /i &quot;%%A&quot;==&quot;/KMS-Uninstall&quot; (set _uni=1</span><br><span class="line">) else if /i &quot;%%A&quot;==&quot;/KMS-Windows&quot;   (set ActWindows=1&amp;set ActOffice=0&amp;set _unattendedact=1</span><br><span class="line">) else if /i &quot;%%A&quot;==&quot;/KMS-Office&quot;   (set ActWindows=0&amp;set ActOffice=1&amp;set _unattendedact=1</span><br><span class="line">) else if /i &quot;%%A&quot;==&quot;/KMS-WindowsOffice&quot;  (set ActWindows=1&amp;set ActOffice=1&amp;set _unattendedact=1</span><br><span class="line">) else if /i &quot;%%A&quot;==&quot;/KMS-KeepvNext&quot;  (set vNextOverride=0</span><br><span class="line">) else if /i &quot;%%A&quot;==&quot;/KMS-Debug&quot;   (set _Debug=1</span><br><span class="line">) else if /i &quot;%%A&quot;==&quot;/KMS-Logger&quot;   (set Logger=1&amp;set Silent=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set &quot;nul=&gt;nul 2&gt;&amp;1&quot;</span><br><span class="line">set psc=powershell.exe</span><br><span class="line">set winbuild=1</span><br><span class="line">for /f &quot;tokens=6 delims=[]. &quot; %%G in (&#x27;ver&#x27;) do set winbuild=%%G</span><br><span class="line"></span><br><span class="line">set _NCS=1</span><br><span class="line">if %winbuild% LSS 10586 set _NCS=0</span><br><span class="line">if %winbuild% GEQ 10586 reg query &quot;HKCU\Console&quot; /v ForceV2 2&gt;nul | find /i &quot;0x0&quot; 1&gt;nul &amp;&amp; (set _NCS=0)</span><br><span class="line"></span><br><span class="line">call :_colorprep</span><br><span class="line">set &quot;_buf=&#123;$W=$Host.UI.RawUI.WindowSize;$B=$Host.UI.RawUI.BufferSize;$W.Height=31;$B.Height=300;$Host.UI.RawUI.WindowSize=$W;$Host.UI.RawUI.BufferSize=$B;&#125;&quot;</span><br><span class="line"></span><br><span class="line">set &quot;nceline=echo. &amp;echo ==== ERROR ==== &amp;echo.&quot;</span><br><span class="line">set &quot;eline=echo. &amp;call :_color %Red% &quot;==== ERROR ====&quot; &amp;echo.&quot;</span><br><span class="line">if %_Debug% EQU 1 set _unattended=1</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Fix for the special characters limitation in path name</span><br><span class="line"></span><br><span class="line">set &quot;_work=%~dp0&quot;</span><br><span class="line">if &quot;%_work:~-1%&quot;==&quot;\&quot; set &quot;_work=%_work:~0,-1%&quot;</span><br><span class="line"></span><br><span class="line">set &quot;_batf=%~f0&quot;</span><br><span class="line">set &quot;_batp=%_batf:&#x27;=&#x27;&#x27;%&quot;</span><br><span class="line"></span><br><span class="line">set _PSarg=&quot;&quot;&quot;%~f0&quot;&quot;&quot; -el %_args%</span><br><span class="line"></span><br><span class="line">set &quot;_ttemp=%temp%&quot;</span><br><span class="line">set &quot;_Local=%LocalAppData%&quot;</span><br><span class="line"></span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">if %~z0 GEQ 300000 (set &quot;_exitmsg=Go back&quot;) else (set &quot;_exitmsg=Exit&quot;)</span><br><span class="line"></span><br><span class="line">::  Check not x86 Windows</span><br><span class="line"></span><br><span class="line">set notx86=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; /v PROCESSOR_ARCHITECTURE&#x27;) do set arch=%%b</span><br><span class="line">if /i not &quot;%arch%&quot;==&quot;x86&quot; set notx86=1</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">for %%# in (wmic.exe) do @if &quot;%%~$PATH:#&quot;==&quot;&quot; (</span><br><span class="line">%nceline%</span><br><span class="line">echo 无法在系统中找到 wmic.exe。</span><br><span class="line">if %winbuild% GEQ 22621 echo  确保在可选功能中启用了 WMIC。</span><br><span class="line">goto Done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">wmic path Win32_ComputerSystem get CreationClassName /value 2&gt;nul | find /i &quot;ComputerSystem&quot; 1&gt;nul || (</span><br><span class="line">%nceline%</span><br><span class="line">echo WMI 在系统中无响应。</span><br><span class="line">echo:</span><br><span class="line">echo 在 MAS 中，转到故障排除并运行修复 WMI 选项。</span><br><span class="line">goto Done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set _WSH=1</span><br><span class="line">reg query &quot;HKCU\SOFTWARE\Microsoft\Windows Script Host\Settings&quot; /v Enabled 2&gt;nul | find /i &quot;0x0&quot; 1&gt;nul &amp;&amp; (set _WSH=0)</span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows Script Host\Settings&quot; /v Enabled 2&gt;nul | find /i &quot;0x0&quot; 1&gt;nul &amp;&amp; (set _WSH=0)</span><br><span class="line"></span><br><span class="line">if %_WSH% EQU 0 (</span><br><span class="line">reg add &quot;HKLM\Software\Microsoft\Windows Script Host\Settings&quot; /v Enabled /t REG_DWORD /d 1 /f %nul%</span><br><span class="line">reg add &quot;HKCU\Software\Microsoft\Windows Script Host\Settings&quot; /v Enabled /t REG_DWORD /d 1 /f %nul%</span><br><span class="line">if defined notx86 reg add &quot;HKLM\Software\Microsoft\Windows Script Host\Settings&quot; /v Enabled /t REG_DWORD /d 1 /f /reg:32 %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">if defined _uni goto _Complete_Uninstall</span><br><span class="line"></span><br><span class="line">if defined _renetask set ActTask=&amp;call:RenTask&amp;timeout /t 2</span><br><span class="line">cls</span><br><span class="line">if defined _renacttask set ActTask=1&amp;call:RenTask&amp;timeout /t 2</span><br><span class="line">cls</span><br><span class="line">if defined _unattended if not defined _unattendedact goto Done</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set &quot;_title=在线 KMS 激活&quot;</span><br><span class="line">set _gui=</span><br><span class="line"></span><br><span class="line">:_KMS_Menu</span><br><span class="line"></span><br><span class="line">set sub_next=0</span><br><span class="line">set sub_o365=0</span><br><span class="line">set sub_proj=0</span><br><span class="line">set sub_vsio=0</span><br><span class="line">set kNext=HKCU\SOFTWARE\Microsoft\Office\16.0\Common\Licensing\LicensingNext</span><br><span class="line">reg query %kNext% /v MigrationToV5Done 2&gt;nul | find /i &quot;0x1&quot; %nul% &amp;&amp; call :officeSub %nul%</span><br><span class="line"></span><br><span class="line">set _tskinstalled=</span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\taskcache\tasks&quot; /f Path /s | find /i &quot;\Activation-Renewal&quot; &gt;nul &amp;&amp; (</span><br><span class="line">find /i &quot;Ver:1.9&quot; &quot;%ProgramFiles%\Activation-Renewal\Activation_task.cmd&quot; %nul% &amp;&amp; set _tskinstalled=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set _oldtsk=</span><br><span class="line">if not defined _tskinstalled (</span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\taskcache\tasks&quot; /f Path /s | findstr /i &quot;\Activation-Renewal \Online_KMS_Activation_Script-Renewal&quot; &gt;nul &amp;&amp; (</span><br><span class="line">set _oldtsk=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined _unattended (</span><br><span class="line">call :Activation_Start</span><br><span class="line">timeout /t 2</span><br><span class="line">goto Done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">set _gui=1</span><br><span class="line">title  %_title%</span><br><span class="line">mode con: cols=76 lines=30</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line">echo.</span><br><span class="line">echo.</span><br><span class="line">echo.</span><br><span class="line">echo.       ______________________________________________________________</span><br><span class="line">echo.</span><br><span class="line">echo.              [1] 激活 - Windows</span><br><span class="line">echo.              [2] 激活 - Office</span><br><span class="line">echo.              [3] 激活 - 全部</span><br><span class="line">echo.</span><br><span class="line">if defined _tskinstalled call :_color2 %_White% &quot;              [4] 安装自动续订功能      &quot; %_Green% &quot;[Installed]&quot;</span><br><span class="line">if defined _oldtsk       call :_color2 %_White% &quot;              [4] 安装自动续订功能      &quot; %_Red% &quot;[Old Installed]&quot;</span><br><span class="line">if not defined _tskinstalled if not defined _oldtsk echo.              [4] 安装自动续订功能</span><br><span class="line">echo.              [5] 卸载</span><br><span class="line">echo.              _______________________________________________  </span><br><span class="line">echo.</span><br><span class="line">if %_Debug%==0 (</span><br><span class="line">echo.              [6] 开启调试模式         [No]</span><br><span class="line">) else (</span><br><span class="line">call :_color2 %_White% &quot;              [6] 开启调试模式         &quot; %_Red% &quot;[Yes]&quot;</span><br><span class="line">)</span><br><span class="line">if %vNextOverride% EQU 1 (</span><br><span class="line">if %sub_next% EQU 1 (</span><br><span class="line">call :_color2 %_White% &quot;              [7] 覆盖 Office vNext     &quot; %_Red% &quot;[Yes]&quot;</span><br><span class="line">) else (</span><br><span class="line">echo               [7] 覆盖 Office vNext     [Yes]</span><br><span class="line">)</span><br><span class="line">) else (</span><br><span class="line">if %sub_next% EQU 1 (</span><br><span class="line">call :_color2 %_White% &quot;              [7] 覆盖 Office vNext     &quot; %_Yellow% &quot;[No]&quot;</span><br><span class="line">) else (</span><br><span class="line">echo               [7] 覆盖 Office vNext     [No]</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">echo.              _______________________________________________       </span><br><span class="line">echo.</span><br><span class="line">echo.              [0] %_exitmsg%</span><br><span class="line">echo.       ______________________________________________________________</span><br><span class="line">echo.</span><br><span class="line">call :_color2 %_White% &quot;           &quot; %_Green% &quot;通过键盘输入菜单选项 [1,2,3,4,5,6,7,0]&quot;</span><br><span class="line">choice /C:12345670 /N</span><br><span class="line">set _el=%errorlevel%</span><br><span class="line"></span><br><span class="line">if %_el%==8 exit /b</span><br><span class="line">if %_el%==7 (if %vNextOverride% EQU 0 (set vNextOverride=1) else (set vNextOverride=0))&amp;goto _KMS_Menu</span><br><span class="line">if %_el%==6 (if %_Debug%==0 (set _Debug=1) else (set _Debug=0)) &amp;goto _KMS_Menu</span><br><span class="line">if %_el%==5 call:_Complete_Uninstall&amp;cls&amp;goto _KMS_Menu</span><br><span class="line">if %_el%==4 set ActTask=&amp;call:RenTask&amp;goto _KMS_Menu</span><br><span class="line">if %_el%==3 cls&amp;setlocal&amp;set &quot;ActWindows=1&quot;&amp;set &quot;ActOffice=1&quot;&amp;call :Activation_Start&amp;endlocal&amp;cls&amp;goto _KMS_Menu</span><br><span class="line">if %_el%==2 cls&amp;setlocal&amp;set &quot;ActWindows=0&quot;&amp;set &quot;ActOffice=1&quot;&amp;call :Activation_Start&amp;endlocal&amp;cls&amp;goto _KMS_Menu</span><br><span class="line">if %_el%==1 cls&amp;setlocal&amp;set &quot;ActWindows=1&quot;&amp;set &quot;ActOffice=0&quot;&amp;call :Activation_Start&amp;endlocal&amp;cls&amp;goto _KMS_Menu</span><br><span class="line">goto _KMS_Menu</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:Done</span><br><span class="line"></span><br><span class="line">if defined _unattended exit /b</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line">echo 按任意键退出....</span><br><span class="line">pause &gt;nul</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:=========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:Activation_Start</span><br><span class="line"></span><br><span class="line">@setlocal DisableDelayedExpansion</span><br><span class="line"></span><br><span class="line">set nil=</span><br><span class="line">for %%# in (SppE%nil%xtComObj.exe,sppsvc.exe,osppsvc.exe) do (</span><br><span class="line">reg delete &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ima%nil%ge File Execu%nil%tion Options\%%#&quot; /f %nul%)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :Clear-KMS-Cache %nul%</span><br><span class="line"></span><br><span class="line">set &quot;_Null=1&gt;nul 2&gt;nul&quot;</span><br><span class="line">set KMS_Port=1688</span><br><span class="line">if %_Debug% EQU 1 set _unattended=1</span><br><span class="line">set &quot;_run=nul&quot;</span><br><span class="line">if %Logger% EQU 1 set _run=&quot;%~dpn0_Silent.log&quot;</span><br><span class="line"></span><br><span class="line">set &quot;SysPath=%SystemRoot%\System32&quot;</span><br><span class="line">set &quot;Path=%SystemRoot%\System32;%SystemRoot%\System32\Wbem;%SystemRoot%\System32\WindowsPowerShell\v1.0\&quot;</span><br><span class="line">if exist &quot;%SystemRoot%\Sysnative\reg.exe&quot; (</span><br><span class="line">set &quot;SysPath=%SystemRoot%\Sysnative&quot;</span><br><span class="line">set &quot;Path=%SystemRoot%\Sysnative;%SystemRoot%\Sysnative\Wbem;%SystemRoot%\Sysnative\WindowsPowerShell\v1.0\;%Path%&quot;</span><br><span class="line">)</span><br><span class="line">set &quot;_bit=64&quot;</span><br><span class="line">set &quot;_wow=1&quot;</span><br><span class="line">if /i &quot;%PROCESSOR_ARCHITECTURE%&quot;==&quot;amd64&quot; set &quot;xBit=x64&quot;&amp;set &quot;xOS=x64&quot;</span><br><span class="line">if /i &quot;%PROCESSOR_ARCHITECTURE%&quot;==&quot;arm64&quot; set &quot;xBit=x86&quot;&amp;set &quot;xOS=A64&quot;</span><br><span class="line">if /i &quot;%PROCESSOR_ARCHITECTURE%&quot;==&quot;x86&quot; if &quot;%PROCESSOR_ARCHITEW6432%&quot;==&quot;&quot; set &quot;xBit=x86&quot;&amp;set &quot;xOS=x86&quot;&amp;set &quot;_wow=0&quot;&amp;set &quot;_bit=32&quot;</span><br><span class="line">if /i &quot;%PROCESSOR_ARCHITEW6432%&quot;==&quot;amd64&quot; set &quot;xBit=x64&quot;&amp;set &quot;xOS=x64&quot;</span><br><span class="line">if /i &quot;%PROCESSOR_ARCHITEW6432%&quot;==&quot;arm64&quot; set &quot;xBit=x86&quot;&amp;set &quot;xOS=A64&quot;</span><br><span class="line">if not defined xBit set &quot;xBit=x64&quot;&amp;set &quot;xOS=x64&quot;</span><br><span class="line"></span><br><span class="line">set _cwmi=0</span><br><span class="line">for %%# in (wmic.exe) do @if not &quot;%%~$PATH:#&quot;==&quot;&quot; (</span><br><span class="line">wmic path Win32_ComputerSystem get CreationClassName /value 2&gt;nul | find /i &quot;ComputerSystem&quot; 1&gt;nul &amp;&amp; set _cwmi=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;_Local=%LocalAppData%&quot;</span><br><span class="line">set &quot;_temp=%SystemRoot%\Temp&quot;</span><br><span class="line">set &quot;_log=%~dpn0&quot;</span><br><span class="line">set &quot;_work=%~dp0&quot;</span><br><span class="line">if &quot;%_work:~-1%&quot;==&quot;\&quot; set &quot;_work=%_work:~0,-1%&quot;</span><br><span class="line">set _UNC=0</span><br><span class="line">if &quot;%_work:~0,2%&quot;==&quot;\\&quot; (</span><br><span class="line">set _UNC=1</span><br><span class="line">) else (</span><br><span class="line">net use %~d0 %_Null%</span><br><span class="line">if not errorlevel 1 set _UNC=1</span><br><span class="line">)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders&quot; /v Desktop&#x27;) do call set &quot;_dsk=%%b&quot;</span><br><span class="line">if exist &quot;%PUBLIC%\Desktop\desktop.ini&quot; set &quot;_dsk=%PUBLIC%\Desktop&quot;</span><br><span class="line">set &quot;_mO21a=Detected Office 2021 C2R Retail is activated&quot;</span><br><span class="line">set &quot;_mO19a=Detected Office 2019 C2R Retail is activated&quot;</span><br><span class="line">set &quot;_mO16a=Detected Office 2016 C2R Retail is activated&quot;</span><br><span class="line">set &quot;_mO15a=Detected Office 2013 C2R Retail is activated&quot;</span><br><span class="line">set &quot;_mO21c=Detected Office 2021 C2R Retail could not be converted to Volume&quot;</span><br><span class="line">set &quot;_mO19c=Detected Office 2019 C2R Retail could not be converted to Volume&quot;</span><br><span class="line">set &quot;_mO16c=Detected Office 2016 C2R Retail could not be converted to Volume&quot;</span><br><span class="line">set &quot;_mO15c=Detected Office 2013 C2R Retail could not be converted to Volume&quot;</span><br><span class="line">set &quot;_mO14c=Detected Office 2010 C2R Retail is not supported by this script&quot;</span><br><span class="line">set &quot;_mO14m=Detected Office 2010 MSI Retail is not supported by this script&quot;</span><br><span class="line">set &quot;_mO15m=Detected Office 2013 MSI Retail is not supported by this script&quot;</span><br><span class="line">set &quot;_mO16m=Detected Office 2016 MSI Retail is not supported by this script&quot;</span><br><span class="line">set &quot;_mOuwp=Detected Office 365/2016 UWP is not supported by this script&quot;</span><br><span class="line">set DO15Ids=ProPlus,Standard,Access,Lync,Excel,Groove,InfoPath,OneNote,Outlook,PowerPoint,Publisher,Word</span><br><span class="line">set DO16Ids=ProPlus,Standard,Access,SkypeforBusiness,Excel,Outlook,PowerPoint,Publisher,Word</span><br><span class="line">set LV16Ids=Mondo,ProPlus,ProjectPro,VisioPro,Standard,ProjectStd,VisioStd,Access,SkypeforBusiness,OneNote,Excel,Outlook,PowerPoint,Publisher,Word</span><br><span class="line">set LR16Ids=%LV16Ids%,Professional,HomeBusiness,HomeStudent,O365Business,O365SmallBusPrem,O365HomePrem,O365EduCloud</span><br><span class="line">set &quot;ESUEditions=Enterprise,EnterpriseE,EnterpriseN,Professional,ProfessionalE,ProfessionalN,Ultimate,UltimateE,UltimateN&quot;</span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-Server*Edition~*.mum&quot; (</span><br><span class="line">set &quot;ESUEditions=ServerDatacenter,ServerDatacenterCore,ServerDatacenterV,ServerDatacenterVCore,ServerStandard,ServerStandardCore,ServerStandardV,ServerStandardVCore,ServerEnterprise,ServerEnterpriseCore,ServerEnterpriseV,ServerEnterpriseVCore&quot;</span><br><span class="line">)</span><br><span class="line">for /f &quot;tokens=6 delims=[]. &quot; %%G in (&#x27;ver&#x27;) do set winbuild=%%G</span><br><span class="line">set UBR=0</span><br><span class="line">if %winbuild% GEQ 7601 for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; /v UBR 2^&gt;nul&#x27;) do if not errorlevel 1 set /a UBR=%%b</span><br><span class="line">set &quot;_csq=cscript.exe //NoLogo //Job:WmiQuery &quot;%~nx0?.wsf&quot;&quot;</span><br><span class="line">set &quot;_csm=cscript.exe //NoLogo //Job:WmiMethod &quot;%~nx0?.wsf&quot;&quot;</span><br><span class="line">set &quot;_csp=cscript.exe //NoLogo //Job:WmiPKey &quot;%~nx0?.wsf&quot;&quot;</span><br><span class="line">set &quot;_csd=cscript.exe //NoLogo //Job:MPS &quot;%~nx0?.wsf&quot;&quot;</span><br><span class="line">if %_cwmi% EQU 0 set WMI_VBS=1</span><br><span class="line">if %WMI_VBS% EQU 0 (</span><br><span class="line">set &quot;_zz1=wmic path&quot;</span><br><span class="line">set &quot;_zz2=where&quot;</span><br><span class="line">set &quot;_zz3=get&quot;</span><br><span class="line">set &quot;_zz4=/value&quot;</span><br><span class="line">set &quot;_zz5=(&quot;</span><br><span class="line">set &quot;_zz6=)&quot;</span><br><span class="line">set &quot;_zz7=&quot;wmic path&quot;</span><br><span class="line">set &quot;_zz8=/value&quot;&quot;</span><br><span class="line">) else (</span><br><span class="line">set &quot;_zz1=%_csq%&quot;</span><br><span class="line">set &quot;_zz2=&quot;</span><br><span class="line">set &quot;_zz3=&quot;</span><br><span class="line">set &quot;_zz4=&quot;</span><br><span class="line">set &quot;_zz5=&quot;&quot;</span><br><span class="line">set &quot;_zz6=&quot;&quot;</span><br><span class="line">set &quot;_zz7=%_csq%&quot;</span><br><span class="line">set &quot;_zz8=&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line">pushd &quot;!_work!&quot;</span><br><span class="line"></span><br><span class="line">if not defined _unattended (</span><br><span class="line">mode con cols=98 lines=31</span><br><span class="line">%psc% &quot;&amp;%_buf%&quot;</span><br><span class="line">title  %_title%</span><br><span class="line">) else (</span><br><span class="line">title  在线 KMS 激活</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined _gui if %_Debug%==1 mode con cols=98 lines=30</span><br><span class="line"></span><br><span class="line">if %_Debug% EQU 0 (</span><br><span class="line">  set &quot;_Nul1=1&gt;nul&quot;</span><br><span class="line">  set &quot;_Nul2=2&gt;nul&quot;</span><br><span class="line">  set &quot;_Nul6=2^&gt;nul&quot;</span><br><span class="line">  set &quot;_Nul3=1&gt;nul 2&gt;nul&quot;</span><br><span class="line">  set &quot;_Pause=pause &gt;nul&quot;</span><br><span class="line">  if %Silent% EQU 0 (call :Begin) else (call :Begin &gt;!_run! 2&gt;&amp;1)</span><br><span class="line">) else (</span><br><span class="line">  set &quot;_Nul1=&quot;</span><br><span class="line">  set &quot;_Nul2=&quot;</span><br><span class="line">  set &quot;_Nul6=&quot;</span><br><span class="line">  set &quot;_Nul3=&quot;</span><br><span class="line">  set &quot;_log=!_dsk!\%~n0&quot;</span><br><span class="line">  if %Silent% EQU 0 (</span><br><span class="line">  echo.</span><br><span class="line">  echo 正在运行调试模式...</span><br><span class="line">  if not defined _args (echo The window will be closed when finished) else (echo please wait...)</span><br><span class="line">  echo.</span><br><span class="line">  echo 将调试日志写入到:</span><br><span class="line">  echo &quot;!_log!_Debug.log&quot;</span><br><span class="line">  )</span><br><span class="line">  @echo on</span><br><span class="line">  @prompt $G</span><br><span class="line">  @call :Begin &gt;&quot;!_log!_tmp.log&quot; 2&gt;&amp;1 &amp;cmd /u /c type &quot;!_log!_tmp.log&quot;&gt;&quot;!_log!_Debug.log&quot;&amp;del &quot;!_log!_tmp.log&quot;</span><br><span class="line">)</span><br><span class="line">@echo off</span><br><span class="line">if defined _gui if %_Debug%==1 (</span><br><span class="line">echo.</span><br><span class="line">call :_color %_Yellow% &quot;按任意键返回...&quot;</span><br><span class="line">pause &gt;nul</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">@exit /b</span><br><span class="line"></span><br><span class="line">:Begin</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set act_failed=0</span><br><span class="line">set /a act_attempt=0</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line">echo 初始化...</span><br><span class="line"></span><br><span class="line">:: Check Internet connection. Works even if ICMP echo is disabled.</span><br><span class="line"></span><br><span class="line">call :setserv</span><br><span class="line">for %%a in (%srvlist%) do (</span><br><span class="line">for /f &quot;delims=[] tokens=2&quot; %%# in (&#x27;ping -n 1 %%a&#x27;) do (</span><br><span class="line">if not [%%#]==[] goto IntConnected</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">nslookup dns.msftncsi.com 2&gt;nul | find &quot;131.107.255.255&quot; 1&gt;nul</span><br><span class="line">if [%errorlevel%]==[0] goto IntConnected</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">if %_Debug%==1 (</span><br><span class="line">echo Error: Internet is not connected.</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined _unattended (</span><br><span class="line">echo.</span><br><span class="line">call :_color %_Red% &quot;网络未连接，但仍可继续执行。&quot;</span><br><span class="line">) else (</span><br><span class="line">%eline%</span><br><span class="line">echo Internet is not connected.</span><br><span class="line">echo:</span><br><span class="line">call :_color %_Yellow% &quot;按任意键返回...&quot;</span><br><span class="line">pause &gt;nul</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:IntConnected</span><br><span class="line"></span><br><span class="line">call :getserv</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set &quot;_wApp=55c92734-d682-4d71-983e-d6ec3f16059f&quot;</span><br><span class="line">set &quot;_oApp=0ff1ce15-a989-479d-af46-f275c6370663&quot;</span><br><span class="line">set &quot;_oA14=59a52881-a989-479d-af46-f275c6370663&quot;</span><br><span class="line">set &quot;IFEO=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options&quot;</span><br><span class="line">set &quot;OPPk=SOFTWARE\Microsoft\OfficeSoftwareProtectionPlatform&quot;</span><br><span class="line">set &quot;SPPk=SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform&quot;</span><br><span class="line">set SSppHook=0</span><br><span class="line">for /f %%A in (&#x27;dir /b /ad %SysPath%\spp\tokens\skus&#x27;) do (</span><br><span class="line">  if %winbuild% GEQ 9200 if exist &quot;%SysPath%\spp\tokens\skus\%%A\*GVLK*.xrm-ms&quot; set SSppHook=1</span><br><span class="line">  if %winbuild% LSS 9200 if exist &quot;%SysPath%\spp\tokens\skus\%%A\*VLKMS*.xrm-ms&quot; set SSppHook=1</span><br><span class="line">  if %winbuild% LSS 9200 if exist &quot;%SysPath%\spp\tokens\skus\%%A\*VL-BYPASS*.xrm-ms&quot; set SSppHook=1</span><br><span class="line">)</span><br><span class="line">set OsppHook=1</span><br><span class="line">sc query osppsvc %_Nul3%</span><br><span class="line">if %errorlevel% EQU 1060 set OsppHook=0</span><br><span class="line"></span><br><span class="line">set ESU_KMS=0</span><br><span class="line">if %winbuild% LSS 9200 for /f %%A in (&#x27;dir /b /ad %SysPath%\spp\tokens\channels&#x27;) do (</span><br><span class="line">  if exist &quot;%SysPath%\spp\tokens\channels\%%A\*VL-BYPASS*.xrm-ms&quot; set ESU_KMS=1</span><br><span class="line">)</span><br><span class="line">if %ESU_KMS% EQU 1 (set &quot;adoff=and LicenseDependsOn is NULL&quot;&amp;set &quot;addon=and LicenseDependsOn is not NULL&quot;) else (set &quot;adoff=&quot;&amp;set &quot;addon=&quot;)</span><br><span class="line">set ESU_EDT=0</span><br><span class="line">if %ESU_KMS% EQU 1 for %%A in (%ESUEditions%) do (</span><br><span class="line">  if exist &quot;%SysPath%\spp\tokens\skus\Security-SPP-Component-SKU-%%A\*.xrm-ms&quot; set ESU_EDT=1</span><br><span class="line">)</span><br><span class="line">:: if %ESU_EDT% EQU 1 set SSppHook=1</span><br><span class="line">set ESU_ADD=0</span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 9200 (</span><br><span class="line">  set OSType=Win8</span><br><span class="line">  set SppVer=SppExtComObj.exe</span><br><span class="line">) else if %winbuild% GEQ 7600 (</span><br><span class="line">  set OSType=Win7</span><br><span class="line">  set SppVer=sppsvc.exe</span><br><span class="line">) else (</span><br><span class="line">  goto :UnsupportedVersion</span><br><span class="line">)</span><br><span class="line">if %OSType% EQU Win8 reg query &quot;%IFEO%\sppsvc.exe&quot; %_Nul3% &amp;&amp; (</span><br><span class="line">reg delete &quot;%IFEO%\sppsvc.exe&quot; /f %_Nul3%</span><br><span class="line">call :StopService sppsvc</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %ActWindows% EQU 0 if %ActOffice% EQU 0 set ActWindows=1</span><br><span class="line">set _AUR=1</span><br><span class="line">if %winbuild% GEQ 9600 (</span><br><span class="line">  reg add &quot;HKLM\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform&quot; /v NoGenTicket /t REG_DWORD /d 1 /f %_Nul3%</span><br><span class="line">  if %winbuild% EQU 14393 reg add &quot;HKLM\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform&quot; /v NoAcquireGT /t REG_DWORD /d 1 /f %_Nul3%</span><br><span class="line">)</span><br><span class="line">call :StopService sppsvc</span><br><span class="line">if %OsppHook% NEQ 0 call :StopService osppsvc</span><br><span class="line"></span><br><span class="line">:ReturnHook</span><br><span class="line">call :UpdateOSPPEntry osppsvc.exe</span><br><span class="line"></span><br><span class="line">SET Win10Gov=0</span><br><span class="line">SET &quot;EditionWMI=&quot;</span><br><span class="line">SET &quot;EditionID=&quot;</span><br><span class="line">IF %winbuild% LSS 14393 if %SSppHook% NEQ 0 GOTO :Main</span><br><span class="line">SET &quot;RegKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages&quot;</span><br><span class="line">SET &quot;Pattern=Microsoft-Windows-*Edition~31bf3856ad364e35&quot;</span><br><span class="line">SET &quot;EditionPKG=FFFFFFFF&quot;</span><br><span class="line">FOR /F &quot;TOKENS=8 DELIMS=\&quot; %%A IN (&#x27;REG QUERY &quot;%RegKey%&quot; /f &quot;%Pattern%&quot; /k %_Nul6% ^| FIND /I &quot;CurrentVersion&quot;&#x27;) DO (</span><br><span class="line">  REG QUERY &quot;%RegKey%\%%A&quot; /v &quot;CurrentState&quot; %_Nul2% | FIND /I &quot;0x70&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">    FOR /F &quot;TOKENS=3 DELIMS=-~&quot; %%B IN (&#x27;ECHO %%A&#x27;) DO SET &quot;EditionPKG=%%B&quot;</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">IF /I &quot;%EditionPKG:~-7%&quot;==&quot;Edition&quot; (</span><br><span class="line">SET &quot;EditionID=%EditionPKG:~0,-7%&quot;</span><br><span class="line">) ELSE (</span><br><span class="line">FOR /F &quot;TOKENS=3 DELIMS=: &quot; %%A IN (&#x27;DISM /English /Online /Get-CurrentEdition %_Nul6% ^| FIND /I &quot;Current Edition :&quot;&#x27;) DO SET &quot;EditionID=%%A&quot;</span><br><span class="line">)</span><br><span class="line">net start sppsvc /y %_Nul3%</span><br><span class="line">set &quot;_qr=%_zz7% SoftwareLicensingProduct %_zz2% %_zz5%ApplicationID=&#x27;%_wApp%&#x27; %adoff% AND PartialProductKey is not NULL%_zz6% %_zz3% LicenseFamily %_zz8%&quot;</span><br><span class="line">FOR /F &quot;TOKENS=2 DELIMS==&quot; %%A IN (&#x27;%_qr% %_Nul6%&#x27;) DO SET &quot;EditionWMI=%%A&quot;</span><br><span class="line">IF &quot;%EditionWMI%&quot;==&quot;&quot; (</span><br><span class="line">IF %winbuild% GEQ 17063 FOR /F &quot;SKIP=2 TOKENS=2*&quot; %%A IN (&#x27;REG QUERY &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; /v EditionId&#x27;) DO SET &quot;EditionID=%%B&quot;</span><br><span class="line">IF %winbuild% LSS 14393 (</span><br><span class="line">  FOR /F &quot;SKIP=2 TOKENS=2*&quot; %%A IN (&#x27;REG QUERY &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; /v EditionId&#x27;) DO SET &quot;EditionID=%%B&quot;</span><br><span class="line">  GOTO :Main</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">IF NOT &quot;%EditionWMI%&quot;==&quot;&quot; SET &quot;EditionID=%EditionWMI%&quot;</span><br><span class="line">IF /I &quot;%EditionID%&quot;==&quot;IoTEnterprise&quot; SET &quot;EditionID=Enterprise&quot;</span><br><span class="line">IF /I &quot;%EditionID%&quot;==&quot;IoTEnterpriseS&quot; IF %winbuild% LSS 22610 (</span><br><span class="line">SET &quot;EditionID=EnterpriseS&quot;</span><br><span class="line">IF %winbuild% GEQ 19041 IF %UBR% GEQ 2788 SET &quot;EditionID=IoTEnterpriseS&quot;</span><br><span class="line">)</span><br><span class="line">IF /I &quot;%EditionID%&quot;==&quot;ProfessionalSingleLanguage&quot; SET &quot;EditionID=Professional&quot;</span><br><span class="line">IF /I &quot;%EditionID%&quot;==&quot;ProfessionalCountrySpecific&quot; SET &quot;EditionID=Professional&quot;</span><br><span class="line">IF /I &quot;%EditionID%&quot;==&quot;EnterpriseG&quot; SET Win10Gov=1</span><br><span class="line">IF /I &quot;%EditionID%&quot;==&quot;EnterpriseGN&quot; SET Win10Gov=1</span><br><span class="line"></span><br><span class="line">:Main</span><br><span class="line">if defined EditionID (set &quot;_winos=Windows %EditionID% edition&quot;) else (set &quot;_winos=Detected Windows&quot;)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; /v ProductName %_Nul6%&#x27;) do if not errorlevel 1 set &quot;_winos=%%b&quot;</span><br><span class="line">set &quot;nKMS=does not support KMS activation...&quot;</span><br><span class="line">set &quot;nEval=Evaluation Editions cannot be activated. Please install full Windows OS.&quot;</span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-*EvalEdition~*.mum&quot; set _eval=1</span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-Server*EvalEdition~*.mum&quot; set &quot;nEval=Server Evaluation cannot be activated. Please convert to full Server OS.&quot;</span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-Server*EvalCorEdition~*.mum&quot; set _eval=1&amp;set &quot;nEval=Server Evaluation cannot be activated. Please convert to full Server OS.&quot;</span><br><span class="line">set &quot;_C16R=&quot;</span><br><span class="line">reg query HKLM\SOFTWARE\Microsoft\Office\ClickToRun /v InstallPath %_Nul3% &amp;&amp; for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do if exist &quot;%%b\root\Licenses16\ProPlus*.xrm-ms&quot; (</span><br><span class="line">reg query HKLM\SOFTWARE\Microsoft\Office\ClickToRun\Configuration /v ProductReleaseIds %_Nul3% &amp;&amp; set &quot;_C16R=HKLM\SOFTWARE\Microsoft\Office\ClickToRun\Configuration&quot;</span><br><span class="line">)</span><br><span class="line">if not defined _C16R reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun /v InstallPath %_Nul3% &amp;&amp; for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do if exist &quot;%%b\root\Licenses16\ProPlus*.xrm-ms&quot; (</span><br><span class="line">reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun\Configuration /v ProductReleaseIds %_Nul3% &amp;&amp; set &quot;_C16R=HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun\Configuration&quot;</span><br><span class="line">)</span><br><span class="line">set &quot;_C15R=&quot;</span><br><span class="line">reg query HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun /v InstallPath %_Nul3% &amp;&amp; for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do if exist &quot;%%b\root\Licenses\ProPlus*.xrm-ms&quot; (</span><br><span class="line">reg query HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun\Configuration /v ProductReleaseIds %_Nul3% &amp;&amp; call set &quot;_C15R=HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun\Configuration&quot;</span><br><span class="line">if not defined _C15R reg query HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun\propertyBag /v productreleaseid %_Nul3% &amp;&amp; call set &quot;_C15R=HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun\propertyBag&quot;</span><br><span class="line">)</span><br><span class="line">set &quot;_C14R=&quot;</span><br><span class="line">if %_wow%==0 (reg query HKLM\SOFTWARE\Microsoft\Office\14.0\CVH /f Click2run /k %_Nul3% &amp;&amp; set &quot;_C14R=1&quot;) else (reg query HKLM\SOFTWARE\Wow6432Node\Microsoft\Office\14.0\CVH /f Click2run /k %_Nul3% &amp;&amp; set &quot;_C14R=1&quot;)</span><br><span class="line">for %%A in (14,15,16,19,21) do call :officeLoc %%A</span><br><span class="line">if %_O14MSI% EQU 1 set &quot;_C14R=&quot;</span><br><span class="line"></span><br><span class="line">set S_OK=1</span><br><span class="line">call :RunSPP</span><br><span class="line">if %ActOffice% NEQ 0 call :RunOSPP</span><br><span class="line">if %ActOffice% EQU 0 (echo.&amp;echo Office activation is OFF...)</span><br><span class="line"></span><br><span class="line">if exist &quot;!_temp!\crv*.txt&quot; del /f /q &quot;!_temp!\crv*.txt&quot;</span><br><span class="line">if exist &quot;!_temp!\*chk.txt&quot; del /f /q &quot;!_temp!\*chk.txt&quot;</span><br><span class="line">if exist &quot;!_temp!\slmgr.vbs&quot; del /f /q &quot;!_temp!\slmgr.vbs&quot;</span><br><span class="line">call :StopService sppsvc</span><br><span class="line">if %OsppHook% NEQ 0 call :StopService osppsvc</span><br><span class="line"></span><br><span class="line">sc start sppsvc trigger=timer;sessionid=0 %_Nul3%</span><br><span class="line"></span><br><span class="line">goto TheEnd</span><br><span class="line"></span><br><span class="line">:RunSPP</span><br><span class="line">set spp=SoftwareLicensingProduct</span><br><span class="line">set sps=SoftwareLicensingService</span><br><span class="line">set W1nd0ws=1</span><br><span class="line">set WinPerm=0</span><br><span class="line">set WinVL=0</span><br><span class="line">set Off1ce=0</span><br><span class="line">set RanR2V=0</span><br><span class="line">set aC2R21=0</span><br><span class="line">set aC2R19=0</span><br><span class="line">set aC2R16=0</span><br><span class="line">set aC2R15=0</span><br><span class="line">if %winbuild% GEQ 9200 if %ActOffice% NEQ 0 call :sppoff</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%Description like &#x27;%%KMSCLIENT%%&#x27; %_zz6% %_zz3% Name %_zz4%&quot;</span><br><span class="line">%_qr% %_Nul2% | findstr /i Windows %_Nul1% &amp;&amp; (set WinVL=1)</span><br><span class="line">if %WinVL% EQU 0 (</span><br><span class="line">if %ActWindows% EQU 0 (</span><br><span class="line">  echo.&amp;echo Windows activation is OFF...</span><br><span class="line">  ) else (</span><br><span class="line">  if %SSppHook% EQU 0 (</span><br><span class="line">    echo.&amp;echo %_winos% %nKMS%</span><br><span class="line">    if defined _eval echo %nEval%</span><br><span class="line">    ) else (</span><br><span class="line">    echo.&amp;echo Failed checking KMS Activation ID^(s^) for Windows. &amp;call :CheckWS</span><br><span class="line">    exit /b</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">if %WinVL% EQU 0 if %Off1ce% EQU 0 exit /b</span><br><span class="line">set _gvlk=0</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_wApp%&#x27; and Description like &#x27;%%KMSCLIENT%%&#x27; and PartialProductKey is not NULL%_zz6% %_zz3% Name %_zz4%&quot;</span><br><span class="line">if %winbuild% GEQ 10240 %_qr% %_Nul2% | findstr /i Windows %_Nul1% &amp;&amp; (set _gvlk=1)</span><br><span class="line">set gpr=0</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_wApp%&#x27; and Description like &#x27;%%KMSCLIENT%%&#x27; and PartialProductKey is not NULL%_zz6% %_zz3% GracePeriodRemaining %_zz8%&quot;</span><br><span class="line">if %winbuild% GEQ 10240 if %SkipKMS38% NEQ 0 if %_gvlk% EQU 1 for /f &quot;tokens=2 delims==&quot; %%A in (&#x27;%_qr% %_Nul6%&#x27;) do set &quot;gpr=%%A&quot;</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% &quot;ApplicationID=&#x27;%_wApp%&#x27; and Description like &#x27;%%KMSCLIENT%%&#x27; and PartialProductKey is not NULL&quot; %_zz3% LicenseFamily %_zz4%&quot;</span><br><span class="line">if %gpr% NEQ 0 if %gpr% GTR 259200 (</span><br><span class="line">set W1nd0ws=0</span><br><span class="line">%_qr% %_Nul2% | findstr /i EnterpriseG %_Nul1% &amp;&amp; (call set W1nd0ws=1)</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz7% %sps% %_zz3% Version %_zz8%&quot;</span><br><span class="line">for /f &quot;tokens=2 delims==&quot; %%A in (&#x27;%_qr%&#x27;) do set slsv=%%A</span><br><span class="line">reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;%KMS_IP%&quot; %_Nul3%</span><br><span class="line">reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;%KMS_Port%&quot; %_Nul3%</span><br><span class="line">if %winbuild% GEQ 9200 (</span><br><span class="line">if not %xOS%==x86 (</span><br><span class="line">reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;%KMS_IP%&quot; /reg:32 %_Nul3%</span><br><span class="line">reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;%KMS_Port%&quot; /reg:32 %_Nul3%</span><br><span class="line">reg delete &quot;HKLM\%SPPk%\%_oApp%&quot; /f /reg:32 %_Null%</span><br><span class="line">reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;%KMS_IP%&quot; /reg:32 %_Nul3%</span><br><span class="line">reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;%KMS_Port%&quot; /reg:32 %_Nul3%</span><br><span class="line">)</span><br><span class="line">reg delete &quot;HKLM\%SPPk%\%_oApp%&quot; /f %_Null%</span><br><span class="line">reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;%KMS_IP%&quot; %_Nul3%</span><br><span class="line">reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;%KMS_Port%&quot; %_Nul3%</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_wApp%&#x27; and Description like &#x27;%%KMSCLIENT%%&#x27; %_zz6% %_zz3% ID %_zz8%&quot;</span><br><span class="line">if %W1nd0ws% EQU 0 for /f &quot;tokens=2 delims==&quot; %%G in (&#x27;%_qr%&#x27;) do (set app=%%G&amp;call :sppchkwin)</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_wApp%&#x27; and Description like &#x27;%%KMSCLIENT%%&#x27; %adoff% %_zz6% %_zz3% ID %_zz8%&quot;</span><br><span class="line">if %W1nd0ws% EQU 1 if %ActWindows% NEQ 0 for /f &quot;tokens=2 delims==&quot; %%G in (&#x27;%_qr%&#x27;) do (set app=%%G&amp;call :sppchkwin)</span><br><span class="line">:: set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_wApp%&#x27; and Description like &#x27;%%KMSCLIENT%%&#x27; %addon% %_zz6% %_zz3% ID %_zz8%&quot;</span><br><span class="line">:: if %ESU_EDT% EQU 1 if %ActWindows% NEQ 0 for /f &quot;tokens=2 delims==&quot; %%G in (&#x27;%_qr%&#x27;) do (set app=%%G&amp;call :esuchk)</span><br><span class="line">if %W1nd0ws% EQU 1 if %ActWindows% EQU 0 (echo.&amp;echo Windows activation is OFF...)</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_oApp%&#x27; and Description like &#x27;%%KMSCLIENT%%&#x27; %_zz6% %_zz3% ID %_zz8%&quot;</span><br><span class="line">if %Off1ce% EQU 1 if %ActOffice% NEQ 0 for /f &quot;tokens=2 delims==&quot; %%G in (&#x27;%_qr%&#x27;) do (set app=%%G&amp;call :sppchkoff 1)</span><br><span class="line">reg delete &quot;HKLM\%SPPk%&quot; /f /v DisableDnsPublishing %_Null%</span><br><span class="line">reg delete &quot;HKLM\%SPPk%&quot; /f /v DisableKeyManagementServiceHostCaching %_Null%</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:sppoff</span><br><span class="line">set OffUWP=0</span><br><span class="line">if %winbuild% GEQ 10240 reg query &quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\msoxmled.exe&quot; %_Nul3% &amp;&amp; (</span><br><span class="line">dir /b &quot;%ProgramFiles%\WindowsApps\Microsoft.Office.Desktop*&quot; %_Nul3% &amp;&amp; set OffUWP=1</span><br><span class="line">if not %xOS%==x86 dir /b &quot;%ProgramW6432%\WindowsApps\Microsoft.Office.Desktop*&quot; %_Nul3% &amp;&amp; set OffUWP=1</span><br><span class="line">)</span><br><span class="line">rem nothing installed</span><br><span class="line">if %loc_off21% EQU 0 if %loc_off19% EQU 0 if %loc_off16% EQU 0 if %loc_off15% EQU 0 (</span><br><span class="line">if %winbuild% GEQ 9200 (</span><br><span class="line">  if %OffUWP% EQU 0 (echo.&amp;echo No Installed Office 2013-2021 Product Detected...) else (echo.&amp;echo %_mOuwp%)</span><br><span class="line">  exit /b</span><br><span class="line">  )</span><br><span class="line">if %winbuild% LSS 9200 (if %loc_off14% EQU 0 (echo.&amp;echo No Installed Office %aword% Product Detected...&amp;exit /b))</span><br><span class="line">)</span><br><span class="line">if %vNextOverride% EQU 1 if %AutoR2V% EQU 1 (</span><br><span class="line">set sub_o365=0</span><br><span class="line">set sub_proj=0</span><br><span class="line">set sub_vsio=0</span><br><span class="line">if %sub_next% EQU 1 reg delete HKCU\SOFTWARE\Microsoft\Office\16.0\Common\Licensing /f %_Nul3%</span><br><span class="line">)</span><br><span class="line">set Off1ce=1</span><br><span class="line">set _sC2R=sppoff</span><br><span class="line">set _fC2R=ReturnSPP</span><br><span class="line"></span><br><span class="line">set vol_off14=0&amp;set vol_off15=0&amp;set vol_off16=0&amp;set vol_off19=0&amp;set vol_off21=0</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%Description like &#x27;%%KMSCLIENT%%&#x27; AND NOT Name like &#x27;%%MondoR_KMS_Automation%%&#x27; %_zz6% %_zz3% Name %_zz4%&quot;</span><br><span class="line">%_qr% &gt; &quot;!_temp!\sppchk.txt&quot; 2&gt;&amp;1</span><br><span class="line">find /i &quot;Office 21&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (set vol_off21=1)</span><br><span class="line">find /i &quot;Office 19&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (set vol_off19=1)</span><br><span class="line">find /i &quot;Office 16&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (set vol_off16=1)</span><br><span class="line">find /i &quot;Office 15&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (set vol_off15=1)</span><br><span class="line">if %winbuild% LSS 9200 find /i &quot;Office 14&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (set vol_off14=1)</span><br><span class="line">for %%A in (14,15,16,19,21) do if !loc_off%%A! EQU 0 set vol_off%%A=0</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% &quot;ApplicationID=&#x27;%_oApp%&#x27; AND LicenseFamily like &#x27;Office16O365%%&#x27;&quot; %_zz3% LicenseFamily %_zz4%&quot;</span><br><span class="line">if %vol_off16% EQU 1 find /i &quot;Office16MondoVL_KMS_Client&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">%_qr% %_Nul2% | find /i &quot;O365&quot; %_Nul1% || (set vol_off16=0)</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% &quot;ApplicationID=&#x27;%_oApp%&#x27; AND LicenseFamily like &#x27;OfficeO365%%&#x27;&quot; %_zz3% LicenseFamily %_zz4%&quot;</span><br><span class="line">if %vol_off15% EQU 1 find /i &quot;OfficeMondoVL_KMS_Client&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">%_qr% %_Nul2% | find /i &quot;O365&quot; %_Nul1% || (set vol_off15=0)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set ret_off14=0&amp;set ret_off15=0&amp;set ret_off16=0&amp;set ret_off19=0&amp;set ret_off21=0</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_oApp%&#x27; AND NOT Name like &#x27;%%O365%%&#x27; %_zz6% %_zz3% Name %_zz4%&quot;</span><br><span class="line">%_qr% &gt; &quot;!_temp!\sppchk.txt&quot; 2&gt;&amp;1</span><br><span class="line">find /i &quot;R_Retail&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul2% | find /i &quot;Office 21&quot; %_Nul1% &amp;&amp; (set ret_off21=1)</span><br><span class="line">find /i &quot;R_Retail&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul2% | find /i &quot;Office 19&quot; %_Nul1% &amp;&amp; (set ret_off19=1)</span><br><span class="line">find /i &quot;R_Retail&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul2% | find /i &quot;Office 16&quot; %_Nul1% &amp;&amp; (set ret_off16=1)</span><br><span class="line">find /i &quot;R_Retail&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul2% | find /i &quot;Office 15&quot; %_Nul1% &amp;&amp; (set ret_off15=1)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_oA14%&#x27;%_zz6% %_zz3% Description %_zz4%&quot;</span><br><span class="line">if %winbuild% LSS 9200 if %vol_off14% EQU 0 %_qr% %_Nul2% | findstr /i channel %_Nul1% &amp;&amp; (set ret_off14=1)</span><br><span class="line"></span><br><span class="line">set run_off21=0&amp;set prr_off21=0&amp;set prv_off21=0</span><br><span class="line">if %loc_off21% EQU 1 if %ret_off21% EQU 1 if %_O16MSI% EQU 0 if %vol_off21% EQU 0 set run_off21=1</span><br><span class="line">if %loc_off21% EQU 1 if %ret_off21% EQU 1 if %_O16MSI% EQU 0 if %vol_off21% EQU 1 (</span><br><span class="line">for %%a in (%DO16Ids%) do find /i &quot;Office21%%a2021R&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off21+=1</span><br><span class="line">  find /i &quot;Office21%%a2021VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off21+=1</span><br><span class="line">  )</span><br><span class="line">for %%a in (Professional) do find /i &quot;Office21%%a2021R&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off21+=1</span><br><span class="line">  find /i &quot;Office21ProPlus2021VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off21+=1</span><br><span class="line">  )</span><br><span class="line">for %%a in (HomeBusiness,HomeStudent) do find /i &quot;Office21%%a2021R&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off21+=1</span><br><span class="line">  find /i &quot;Office21Standard2021VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off21+=1</span><br><span class="line">  )</span><br><span class="line">if %sub_proj% EQU 0 for %%a in (ProjectPro,ProjectStd) do find /i &quot;Office21%%a2021R&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off21+=1</span><br><span class="line">  find /i &quot;Office21%%a2021VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off21+=1</span><br><span class="line">  )</span><br><span class="line">if %sub_vsio% EQU 0 for %%a in (VisioPro,VisioStd) do find /i &quot;Office21%%a2021R&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off21+=1</span><br><span class="line">  find /i &quot;Office21%%a2021VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off21+=1</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">if %loc_off21% EQU 1 if %ret_off21% EQU 1 if %_O16MSI% EQU 0 if %vol_off21% EQU 1 if %prv_off21% LSS %prr_off21% (set vol_off21=0&amp;set run_off21=1)</span><br><span class="line"></span><br><span class="line">set run_off19=0&amp;set prr_off19=0&amp;set prv_off19=0</span><br><span class="line">if %loc_off19% EQU 1 if %ret_off19% EQU 1 if %_O16MSI% EQU 0 if %vol_off19% EQU 0 set run_off19=1</span><br><span class="line">if %loc_off19% EQU 1 if %ret_off19% EQU 1 if %_O16MSI% EQU 0 if %vol_off19% EQU 1 (</span><br><span class="line">for %%a in (%DO16Ids%) do find /i &quot;Office19%%a2019R&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off19+=1</span><br><span class="line">  find /i &quot;Office19%%a2019VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off19+=1</span><br><span class="line">  )</span><br><span class="line">for %%a in (Professional) do find /i &quot;Office19%%a2019R&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off19+=1</span><br><span class="line">  find /i &quot;Office19ProPlus2019VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off19+=1</span><br><span class="line">  )</span><br><span class="line">for %%a in (HomeBusiness,HomeStudent) do find /i &quot;Office19%%a2019R&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off19+=1</span><br><span class="line">  find /i &quot;Office19Standard2019VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off19+=1</span><br><span class="line">  )</span><br><span class="line">if %sub_proj% EQU 0 for %%a in (ProjectPro,ProjectStd) do find /i &quot;Office19%%a2019R&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off19+=1</span><br><span class="line">  find /i &quot;Office19%%a2019VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off19+=1</span><br><span class="line">  )</span><br><span class="line">if %sub_vsio% EQU 0 for %%a in (VisioPro,VisioStd) do find /i &quot;Office19%%a2019R&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off19+=1</span><br><span class="line">  find /i &quot;Office19%%a2019VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off19+=1</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">if %loc_off19% EQU 1 if %ret_off19% EQU 1 if %_O16MSI% EQU 0 if %vol_off19% EQU 1 if %prv_off19% LSS %prr_off19% (set vol_off19=0&amp;set run_off19=1)</span><br><span class="line"></span><br><span class="line">set run_off16=0&amp;set prr_off16=0&amp;set prv_off16=0</span><br><span class="line">if %loc_off16% EQU 1 if %ret_off16% EQU 1 if %_O16MSI% EQU 0 if defined _C16R (</span><br><span class="line">for %%a in (%DO16Ids%) do find /i &quot;Office16%%aR&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off16+=1</span><br><span class="line">  if %vol_off16% EQU 1 if %vol_off21% EQU 0 if %vol_off19% EQU 0 find /i &quot;Office16%%aVL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  if %vol_off16% EQU 0 if %vol_off21% EQU 1 find /i &quot;Office21%%a2021VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  if %vol_off16% EQU 0 if %vol_off19% EQU 1 find /i &quot;Office19%%a2019VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  )</span><br><span class="line">for %%a in (Professional) do find /i &quot;Office16%%aR&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off16+=1</span><br><span class="line">  if %vol_off16% EQU 1 if %vol_off21% EQU 0 if %vol_off19% EQU 0 find /i &quot;Office16ProPlusVL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  if %vol_off16% EQU 0 if %vol_off21% EQU 1 find /i &quot;Office21ProPlus2021VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  if %vol_off16% EQU 0 if %vol_off19% EQU 1 find /i &quot;Office19ProPlus2019VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  )</span><br><span class="line">for %%a in (HomeBusiness,HomeStudent) do find /i &quot;Office16%%aR&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off16+=1</span><br><span class="line">  if %vol_off16% EQU 1 if %vol_off21% EQU 0 if %vol_off19% EQU 0 find /i &quot;Office16StandardVL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  if %vol_off16% EQU 0 if %vol_off21% EQU 1 find /i &quot;Office21Standard2021VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  if %vol_off16% EQU 0 if %vol_off19% EQU 1 find /i &quot;Office19Standard2019VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  )</span><br><span class="line">if %sub_proj% EQU 0 for %%a in (ProjectPro,ProjectStd) do find /i &quot;Office16%%aR&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off16+=1</span><br><span class="line">  if %vol_off16% EQU 1 if %vol_off21% EQU 0 if %vol_off19% EQU 0 find /i &quot;Office16%%aVL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  if %vol_off16% EQU 0 if %vol_off21% EQU 1 find /i &quot;Office21%%a2021VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  if %vol_off16% EQU 0 if %vol_off19% EQU 1 find /i &quot;Office19%%a2019VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  )</span><br><span class="line">if %sub_vsio% EQU 0 for %%a in (VisioPro,VisioStd) do find /i &quot;Office16%%aR&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off16+=1</span><br><span class="line">  if %vol_off16% EQU 1 if %vol_off21% EQU 0 if %vol_off19% EQU 0 find /i &quot;Office16%%aVL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  if %vol_off16% EQU 0 if %vol_off21% EQU 1 find /i &quot;Office21%%a2021VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  if %vol_off16% EQU 0 if %vol_off19% EQU 1 find /i &quot;Office19%%a2019VL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off16+=1</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">if %loc_off16% EQU 1 if %ret_off16% EQU 1 if %_O16MSI% EQU 0 if defined _C16R if %prv_off16% LSS %prr_off16% (set vol_off16=0&amp;set run_off16=1)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_oApp%&#x27; AND LicenseFamily like &#x27;Office16O365%%&#x27; %_zz6% %_zz3% LicenseFamily %_zz4%&quot;</span><br><span class="line">if %loc_off16% EQU 1 if %run_off16% EQU 0 if %sub_o365% EQU 0 if defined _C16R %_qr% %_Nul2% | find /i &quot;O365&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">find /i &quot;Office16MondoVL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% || set run_off16=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set run_off15=0&amp;set prr_off15=0&amp;set prv_off15=0</span><br><span class="line">if %loc_off15% EQU 1 if %ret_off15% EQU 1 if %_O15MSI% EQU 0 if %vol_off15% EQU 0 if defined _C15R set run_off15=1</span><br><span class="line">if %loc_off15% EQU 1 if %ret_off15% EQU 1 if %_O15MSI% EQU 0 if %vol_off15% EQU 1 if defined _C15R (</span><br><span class="line">for %%a in (%DO15Ids%) do find /i &quot;Office%%aR&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off15+=1</span><br><span class="line">  find /i &quot;Office%%aVL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off15+=1</span><br><span class="line">  )</span><br><span class="line">for %%a in (Professional) do find /i &quot;Office%%aR&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off15+=1</span><br><span class="line">  find /i &quot;OfficeProPlusVL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off15+=1</span><br><span class="line">  )</span><br><span class="line">for %%a in (HomeBusiness,HomeStudent) do find /i &quot;Office%%aR&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off15+=1</span><br><span class="line">  find /i &quot;OfficeStandardVL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off15+=1</span><br><span class="line">  )</span><br><span class="line">if %sub_proj% EQU 0 for %%a in (ProjectPro,ProjectStd) do find /i &quot;Office%%aR&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off15+=1</span><br><span class="line">  find /i &quot;Office%%aVL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off15+=1</span><br><span class="line">  )</span><br><span class="line">if %sub_vsio% EQU 0 for %%a in (VisioPro,VisioStd) do find /i &quot;Office%%aR&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  call set /a prr_off15+=1</span><br><span class="line">  find /i &quot;Office%%aVL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; call set /a prv_off15+=1</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">if %loc_off15% EQU 1 if %ret_off15% EQU 1 if %_O15MSI% EQU 0 if %vol_off15% EQU 1 if defined _C15R if %prv_off15% LSS %prr_off15% (set vol_off15=0&amp;set run_off15=1)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_oApp%&#x27; AND LicenseFamily like &#x27;OfficeO365%%&#x27; %_zz6% %_zz3% LicenseFamily %_zz4%&quot;</span><br><span class="line">if %loc_off15% EQU 1 if %run_off15% EQU 0 if defined _C15R %_qr% %_Nul2% | find /i &quot;O365&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">find /i &quot;OfficeMondoVL&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% || set run_off15=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set vol_offgl=1</span><br><span class="line">if %vol_off21% EQU 0 if %vol_off19% EQU 0 if %vol_off16% EQU 0 if %vol_off15% EQU 0 (</span><br><span class="line">if %winbuild% GEQ 9200 set vol_offgl=0</span><br><span class="line">if %winbuild% LSS 9200 if %vol_off14% EQU 0 set vol_offgl=0</span><br><span class="line">)</span><br><span class="line">rem mixed Volume + Retail</span><br><span class="line">if %run_off21% EQU 1 if %AutoR2V% EQU 1 if %RanR2V% EQU 0 goto :C2RR2V</span><br><span class="line">if %run_off19% EQU 1 if %AutoR2V% EQU 1 if %RanR2V% EQU 0 goto :C2RR2V</span><br><span class="line">if %run_off16% EQU 1 if %AutoR2V% EQU 1 if %RanR2V% EQU 0 goto :C2RR2V</span><br><span class="line">if %run_off15% EQU 1 if %AutoR2V% EQU 1 if %RanR2V% EQU 0 goto :C2RR2V</span><br><span class="line">rem all supported Volume + message for unsupported</span><br><span class="line">if %loc_off16% EQU 0 if %ret_off16% EQU 1 if %_O16MSI% EQU 0 if %OffUWP% EQU 1 (echo.&amp;echo %_mOuwp%)</span><br><span class="line">if %vol_offgl% EQU 1 (</span><br><span class="line">if %ret_off16% EQU 1 if %_O16MSI% EQU 1 (echo.&amp;echo %_mO16m%)</span><br><span class="line">if %ret_off15% EQU 1 if %_O15MSI% EQU 1 (echo.&amp;echo %_mO15m%)</span><br><span class="line">if %winbuild% LSS 9200 if %loc_off14% EQU 1 if %vol_off14% EQU 0 (if defined _C14R (echo.&amp;echo %_mO14c%) else if %_O14MSI% EQU 1 (if %ret_off14% EQU 1 echo.&amp;echo %_mO14m%))</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">set Off1ce=0</span><br><span class="line">rem Retail C2R</span><br><span class="line">if %AutoR2V% EQU 1 if %RanR2V% EQU 0 goto :C2RR2V</span><br><span class="line">:ReturnSPP</span><br><span class="line">rem Retail MSI/C2R or failed C2R-R2V</span><br><span class="line">if %loc_off21% EQU 1 if %vol_off21% EQU 0 (</span><br><span class="line">if %aC2R21% EQU 1 (echo.&amp;echo %_mO21a%) else (echo.&amp;echo %_mO21c%)</span><br><span class="line">)</span><br><span class="line">if %loc_off19% EQU 1 if %vol_off19% EQU 0 (</span><br><span class="line">if %aC2R19% EQU 1 (echo.&amp;echo %_mO19a%) else (echo.&amp;echo %_mO19c%)</span><br><span class="line">)</span><br><span class="line">if %loc_off16% EQU 1 if %vol_off16% EQU 0 (</span><br><span class="line">if defined _C16R (if %aC2R16% EQU 1 (echo.&amp;echo %_mO16a%) else (if %sub_o365% EQU 0 echo.&amp;echo %_mO16c%)) else if %_O16MSI% EQU 1 (if %ret_off16% EQU 1 echo.&amp;echo %_mO16m%)</span><br><span class="line">)</span><br><span class="line">if %loc_off15% EQU 1 if %vol_off15% EQU 0 (</span><br><span class="line">if defined _C15R (if %aC2R15% EQU 1 (echo.&amp;echo %_mO15a%) else (echo.&amp;echo %_mO15c%)) else if %_O15MSI% EQU 1 (if %ret_off15% EQU 1 echo.&amp;echo %_mO15m%)</span><br><span class="line">)</span><br><span class="line">if %winbuild% LSS 9200 if %loc_off14% EQU 1 if %vol_off14% EQU 0 (</span><br><span class="line">if defined _C14R (echo.&amp;echo %_mO14c%) else if %_O14MSI% EQU 1 (if %ret_off14% EQU 1 echo.&amp;echo %_mO14m%)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:sppchkoff</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ID=&#x27;%app%&#x27;%_zz6% %_zz3% Name %_zz4%&quot;</span><br><span class="line">%_qr% &gt; &quot;!_temp!\sppchk.txt&quot;</span><br><span class="line">if %winbuild% LSS 9200 find /i &quot;Office 14&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (if %loc_off14% EQU 0 exit /b)</span><br><span class="line">find /i &quot;Office 15&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (if %loc_off15% EQU 0 exit /b)</span><br><span class="line">find /i &quot;Office 16&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (if %loc_off16% EQU 0 exit /b)</span><br><span class="line">find /i &quot;Office 19&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (if %loc_off19% EQU 0 exit /b)</span><br><span class="line">find /i &quot;Office 21&quot; &quot;!_temp!\sppchk.txt&quot; %_Nul1% &amp;&amp; (if %loc_off21% EQU 0 exit /b)</span><br><span class="line">if %1 EQU 1 (set _officespp=1) else (set _officespp=0)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%PartialProductKey is not NULL%_zz6% %_zz3% ID %_zz4%&quot;</span><br><span class="line">%_qr% %_Nul2% | findstr /i &quot;%app%&quot; %_Nul1% &amp;&amp; (echo.&amp;call :activate&amp;exit /b)</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%ID=&#x27;%app%&#x27;%_zz6% %_zz3% Name %_zz8%&quot;</span><br><span class="line">for /f &quot;tokens=3 delims==, &quot; %%G in (&#x27;%_qr%&#x27;) do set OffVer=%%G</span><br><span class="line">call :offchk%OffVer%</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:sppchkwin</span><br><span class="line">set _officespp=0</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_wApp%&#x27; and Description like &#x27;%%KMSCLIENT%%&#x27; and PartialProductKey is not NULL%_zz6% %_zz3% Name %_zz4%&quot;</span><br><span class="line">if %winbuild% GEQ 14393 if %WinPerm% EQU 0 if %_gvlk% EQU 0 %_qr% %_Nul2% | findstr /i Windows %_Nul1% &amp;&amp; (set _gvlk=1)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ID=&#x27;%app%&#x27;%_zz6% %_zz3% LicenseStatus %_zz4%&quot;</span><br><span class="line">%_qr% %_Nul2% | findstr &quot;1&quot; %_Nul1% &amp;&amp; (echo.&amp;call :activate&amp;exit /b)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%PartialProductKey is not NULL%_zz6% %_zz3% ID %_zz4%&quot;</span><br><span class="line">%_qr% %_Nul2% | findstr /i &quot;%app%&quot; %_Nul1% &amp;&amp; (echo.&amp;call :activate&amp;exit /b)</span><br><span class="line">if %winbuild% GEQ 14393 if %_gvlk% EQU 1 exit /b</span><br><span class="line">if %WinPerm% EQU 1 exit /b</span><br><span class="line">if %winbuild% LSS 10240 (call :winchk&amp;exit /b)</span><br><span class="line">for %%A in (</span><br><span class="line">b71515d9-89a2-4c60-88c8-656fbcca7f3a,af43f7f0-3b1e-4266-a123-1fdb53f4323b,075aca1f-05d7-42e5-a3ce-e349e7be7078</span><br><span class="line">11a37f09-fb7f-4002-bd84-f3ae71d11e90,43f2ab05-7c87-4d56-b27c-44d0f9a3dabd,2cf5af84-abab-4ff0-83f8-f040fb2576eb</span><br><span class="line">6ae51eeb-c268-4a21-9aae-df74c38b586d,ff808201-fec6-4fd4-ae16-abbddade5706,34260150-69ac-49a3-8a0d-4a403ab55763</span><br><span class="line">4dfd543d-caa6-4f69-a95f-5ddfe2b89567,5fe40dd6-cf1f-4cf2-8729-92121ac2e997,903663f7-d2ab-49c9-8942-14aa9e0a9c72</span><br><span class="line">2cc171ef-db48-4adc-af09-7c574b37f139,5b2add49-b8f4-42e0-a77c-adad4efeeeb1</span><br><span class="line">) do (</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;%%A&#x27; exit /b</span><br><span class="line">)</span><br><span class="line">if not defined EditionID (call :winchk&amp;exit /b)</span><br><span class="line">if %winbuild% LSS 14393 (call :winchk&amp;exit /b)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;32d2fab3-e4a8-42c2-923b-4bf4fd13e6ee&#x27; if /i %EditionID% NEQ EnterpriseS exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;ca7df2e3-5ea0-47b8-9ac1-b1be4d8edd69&#x27; if /i %EditionID% NEQ CloudEdition exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;d30136fc-cb4b-416e-a23d-87207abc44a9&#x27; if /i %EditionID% NEQ CloudEditionN exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;0df4f814-3f57-4b8b-9a9d-fddadcd69fac&#x27; if /i %EditionID% NEQ CloudE exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;e0c42288-980c-4788-a014-c080d2e1926e&#x27; if /i %EditionID% NEQ Education exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;73111121-5638-40f6-bc11-f1d7b0d64300&#x27; if /i %EditionID% NEQ Enterprise exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;2de67392-b7a7-462a-b1ca-108dd189f588&#x27; if /i %EditionID% NEQ Professional exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;3f1afc82-f8ac-4f6c-8005-1d233e606eee&#x27; if /i %EditionID% NEQ ProfessionalEducation exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;82bbc092-bc50-4e16-8e18-b74fc486aec3&#x27; if /i %EditionID% NEQ ProfessionalWorkstation exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;3c102355-d027-42c6-ad23-2e7ef8a02585&#x27; if /i %EditionID% NEQ EducationN exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;e272e3e2-732f-4c65-a8f0-484747d0d947&#x27; if /i %EditionID% NEQ EnterpriseN exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;a80b5abf-76ad-428b-b05d-a47d2dffeebf&#x27; if /i %EditionID% NEQ ProfessionalN exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;5300b18c-2e33-4dc2-8291-47ffcec746dd&#x27; if /i %EditionID% NEQ ProfessionalEducationN exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;4b1571d3-bafb-4b40-8087-a961be2caf65&#x27; if /i %EditionID% NEQ ProfessionalWorkstationN exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;58e97c99-f377-4ef1-81d5-4ad5522b5fd8&#x27; if /i %EditionID% NEQ Core exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;cd918a57-a41b-4c82-8dce-1a538e221a83&#x27; if /i %EditionID% NEQ CoreSingleLanguage exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;ec868e65-fadf-4759-b23e-93fe37f2cc29&#x27; if /i %EditionID% NEQ ServerRdsh exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;e4db50ea-bda1-4566-b047-0ca50abc6f07&#x27; if /i %EditionID% NEQ ServerRdsh exit /b</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% &quot;Description like &#x27;%%KMSCLIENT%%&#x27;&quot; %_zz3% ID %_zz4%&quot;</span><br><span class="line">if /i &quot;%app%&quot; EQU &quot;e4db50ea-bda1-4566-b047-0ca50abc6f07&quot; (</span><br><span class="line">%_qr% | findstr /i &quot;ec868e65-fadf-4759-b23e-93fe37f2cc29&quot; %_Nul3% &amp;&amp; (exit /b)</span><br><span class="line">)</span><br><span class="line">call :winchk</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:winchk</span><br><span class="line">if not defined tok (if %winbuild% GEQ 9200 (set &quot;tok=4&quot;) else (set &quot;tok=7&quot;))</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%LicenseStatus=&#x27;1&#x27; and Description like &#x27;%%KMSCLIENT%%&#x27; %adoff% %_zz6% %_zz3% Name %_zz4%&quot;</span><br><span class="line">%_qr% %_Nul2% | findstr /i &quot;Windows&quot; %_Nul3% &amp;&amp; (exit /b)</span><br><span class="line">echo.</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%LicenseStatus=&#x27;1&#x27; and GracePeriodRemaining=&#x27;0&#x27; %adoff% and PartialProductKey is not NULL%_zz6% %_zz3% Name %_zz4%&quot;</span><br><span class="line">%_qr% %_Nul2% | findstr /i &quot;Windows&quot; %_Nul3% &amp;&amp; (</span><br><span class="line">set WinPerm=1</span><br><span class="line">)</span><br><span class="line">set WinOEM=0</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_wApp%&#x27; and LicenseStatus=&#x27;1&#x27; %adoff% %_zz6% %_zz3% Name %_zz4%&quot;</span><br><span class="line">if %WinPerm% EQU 0 %_qr% %_Nul2% | findstr /i &quot;Windows&quot; %_Nul3% &amp;&amp; set WinOEM=1</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_wApp%&#x27; and LicenseStatus=&#x27;1&#x27; %adoff% %_zz6% %_zz3% Description %_zz8%&quot;</span><br><span class="line">if %WinOEM% EQU 1 (</span><br><span class="line">for /f &quot;tokens=%tok% delims=, &quot; %%G in (&#x27;%_qr%&#x27;) do set &quot;channel=%%G&quot;</span><br><span class="line">for %%A in (VOLUME_MAK, RETAIL, OEM_DM, OEM_SLP, OEM_COA, OEM_COA_SLP, OEM_COA_NSLP, OEM_NONSLP, OEM) do if /i &quot;%%A&quot;==&quot;!channel!&quot; set WinPerm=1</span><br><span class="line">)</span><br><span class="line">if %WinPerm% EQU 0 (</span><br><span class="line">copy /y %SysPath%\slmgr.vbs &quot;!_temp!\slmgr.vbs&quot; %_Nul3%</span><br><span class="line">cscript //nologo &quot;!_temp!\slmgr.vbs&quot; /xpr %_Nul2% | findstr /i &quot;permanently&quot; %_Nul3% &amp;&amp; set WinPerm=1</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%ApplicationID=&#x27;%_wApp%&#x27; and LicenseStatus=&#x27;1&#x27; %adoff% %_zz6% %_zz3% Name %_zz8%&quot;</span><br><span class="line">if %WinPerm% EQU 1 (</span><br><span class="line">for /f &quot;tokens=2 delims==&quot; %%x in (&#x27;%_qr%&#x27;) do echo Checking: %%x</span><br><span class="line">echo Product is Permanently Activated.</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">call :insKey</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:esuchk</span><br><span class="line">set _officespp=0</span><br><span class="line">set ESU_ADD=1</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ID=&#x27;%app%&#x27;%_zz6% %_zz3% LicenseStatus %_zz4%&quot;</span><br><span class="line">%_qr% %_Nul2% | findstr &quot;1&quot; %_Nul1% &amp;&amp; (echo.&amp;call :activate&amp;exit /b)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ID=&#x27;77db037b-95c3-48d7-a3ab-a9c6d41093e0&#x27;%_zz6% %_zz3% LicenseStatus %_zz4%&quot;</span><br><span class="line">if /i &quot;%app%&quot; EQU &quot;3fcc2df2-f625-428d-909a-1f76efc849b6&quot; (</span><br><span class="line">%_qr% %_Nul2% | findstr &quot;1&quot; %_Nul1% &amp;&amp; (exit /b)</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ID=&#x27;0e00c25d-8795-4fb7-9572-3803d91b6880&#x27;%_zz6% %_zz3% LicenseStatus %_zz4%&quot;</span><br><span class="line">if /i &quot;%app%&quot; EQU &quot;dadfcd24-6e37-47be-8f7f-4ceda614cece&quot; (</span><br><span class="line">%_qr% %_Nul2% | findstr &quot;1&quot; %_Nul1% &amp;&amp; (exit /b)</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ID=&#x27;4220f546-f522-46df-8202-4d07afd26454&#x27;%_zz6% %_zz3% LicenseStatus %_zz4%&quot;</span><br><span class="line">if /i &quot;%app%&quot; EQU &quot;0c29c85e-12d7-4af8-8e4d-ca1e424c480c&quot; (</span><br><span class="line">%_qr% %_Nul2% | findstr &quot;1&quot; %_Nul1% &amp;&amp; (exit /b)</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ID=&#x27;553673ed-6ddf-419c-a153-b760283472fd&#x27;%_zz6% %_zz3% LicenseStatus %_zz4%&quot;</span><br><span class="line">if /i &quot;%app%&quot; EQU &quot;f2b21bfc-a6b0-4413-b4bb-9f06b55f2812&quot; (</span><br><span class="line">%_qr% %_Nul2% | findstr &quot;1&quot; %_Nul1% &amp;&amp; (exit /b)</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ID=&#x27;04fa0286-fa74-401e-bbe9-fbfbb158010d&#x27;%_zz6% %_zz3% LicenseStatus %_zz4%&quot;</span><br><span class="line">if /i &quot;%app%&quot; EQU &quot;bfc078d0-8c7f-475c-8519-accc46773113&quot; (</span><br><span class="line">%_qr% %_Nul2% | findstr &quot;1&quot; %_Nul1% &amp;&amp; (exit /b)</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ID=&#x27;16c08c85-0c8b-4009-9b2b-f1f7319e45f9&#x27;%_zz6% %_zz3% LicenseStatus %_zz4%&quot;</span><br><span class="line">if /i &quot;%app%&quot; EQU &quot;23c6188f-c9d8-457e-81b6-adb6dacb8779&quot; (</span><br><span class="line">%_qr% %_Nul2% | findstr &quot;1&quot; %_Nul1% &amp;&amp; (exit /b)</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%ID=&#x27;8e7bfb1e-acc1-4f56-abae-b80fce56cd4b&#x27;%_zz6% %_zz3% LicenseStatus %_zz4%&quot;</span><br><span class="line">if /i &quot;%app%&quot; EQU &quot;e7cce015-33d6-41c1-9831-022ba63fe1da&quot; (</span><br><span class="line">%_qr% %_Nul2% | findstr &quot;1&quot; %_Nul1% &amp;&amp; (exit /b)</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz2% %_zz5%PartialProductKey is not NULL%_zz6% %_zz3% ID %_zz4%&quot;</span><br><span class="line">%_qr% %_Nul2% | findstr /i &quot;%app%&quot; %_Nul1% &amp;&amp; (echo.&amp;call :activate&amp;exit /b)</span><br><span class="line">call :insKey</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:RunOSPP</span><br><span class="line">set spp=OfficeSoftwareProtectionProduct</span><br><span class="line">set sps=OfficeSoftwareProtectionService</span><br><span class="line">set Off1ce=0</span><br><span class="line">set RanR2V=0</span><br><span class="line">set aC2R21=0</span><br><span class="line">set aC2R19=0</span><br><span class="line">set aC2R16=0</span><br><span class="line">set aC2R15=0</span><br><span class="line">if %winbuild% LSS 9200 (set &quot;aword=2010-2021&quot;) else (set &quot;aword=2010&quot;)</span><br><span class="line">if %OsppHook% EQU 0 (echo.&amp;echo No Installed Office %aword% Product Detected...&amp;exit /b)</span><br><span class="line">if %winbuild% GEQ 9200 if %loc_off14% EQU 0 (echo.&amp;echo No Installed Office %aword% Product Detected...&amp;exit /b)</span><br><span class="line">set err_offsvc=0</span><br><span class="line">net start osppsvc /y %_Nul3% || (</span><br><span class="line">sc start osppsvc %_Nul3%</span><br><span class="line">if !errorlevel! EQU 1053 set err_offsvc=1</span><br><span class="line">)</span><br><span class="line">if %err_offsvc% EQU 1 (echo.&amp;echo Error: osppsvc service is not running...&amp;exit /b)</span><br><span class="line">if %winbuild% GEQ 9200 call :oppoff</span><br><span class="line">if %winbuild% LSS 9200 call :sppoff</span><br><span class="line">if %Off1ce% EQU 0 exit /b</span><br><span class="line">set &quot;vPrem=&quot;&amp;set &quot;vProf=&quot;</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%LicenseFamily=&#x27;OfficeVisioPrem-MAK&#x27;%_zz6% %_zz3% LicenseStatus %_zz8%&quot;</span><br><span class="line">if %loc_off14% EQU 1 for /f &quot;tokens=2 delims==&quot; %%A in (&#x27;%_qr% %_Nul6%&#x27;) do set vPrem=%%A</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%LicenseFamily=&#x27;OfficeVisioPro-MAK&#x27;%_zz6% %_zz3% LicenseStatus %_zz8%&quot;</span><br><span class="line">if %loc_off14% EQU 1 for /f &quot;tokens=2 delims==&quot; %%A in (&#x27;%_qr% %_Nul6%&#x27;) do set vProf=%%A</span><br><span class="line">set &quot;_qr=%_zz7% %sps% %_zz3% Version %_zz8%&quot;</span><br><span class="line">for /f &quot;tokens=2 delims==&quot; %%A in (&#x27;%_qr% %_Nul6%&#x27;) do set slsv=%%A</span><br><span class="line">reg add &quot;HKLM\%OPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;%KMS_IP%&quot; %_Nul3%</span><br><span class="line">reg add &quot;HKLM\%OPPk%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;%KMS_Port%&quot; %_Nul3%</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%Description like &#x27;%%KMSCLIENT%%&#x27; %_zz6% %_zz3% ID %_zz8%&quot;</span><br><span class="line">for /f &quot;tokens=2 delims==&quot; %%G in (&#x27;%_qr%&#x27;) do (set app=%%G&amp;call :sppchkoff 2)</span><br><span class="line">reg delete &quot;HKLM\%OPPk%&quot; /f /v DisableDnsPublishing %_Null%</span><br><span class="line">reg delete &quot;HKLM\%OPPk%&quot; /f /v DisableKeyManagementServiceHostCaching %_Null%</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:oppoff</span><br><span class="line">set &quot;_qr=%_zz1% %spp% %_zz3% Description %_zz4%&quot;</span><br><span class="line">%_qr% %_Nul2% | findstr /i KMSCLIENT %_Nul1% &amp;&amp; (</span><br><span class="line">set Off1ce=1</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">set ret_off14=0</span><br><span class="line">%_qr% %_Nul2% | findstr /i channel %_Nul1% &amp;&amp; (set ret_off14=1)</span><br><span class="line">if defined _C14R (echo.&amp;echo %_mO14c%) else if %_O14MSI% EQU 1 (if %ret_off14% EQU 1 echo.&amp;echo %_mO14m%)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:offchk</span><br><span class="line">set ls=0</span><br><span class="line">set ls2=0</span><br><span class="line">set ls3=0</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%LicenseFamily=&#x27;Office%~1&#x27;%_zz6% %_zz3% LicenseStatus %_zz8%&quot;</span><br><span class="line">for /f &quot;tokens=2 delims==&quot; %%A in (&#x27;%_qr% %_Nul6%&#x27;) do set /a ls=%%A</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%LicenseFamily=&#x27;Office%~3&#x27;%_zz6% %_zz3% LicenseStatus %_zz8%&quot;</span><br><span class="line">if /i not &quot;%~3&quot;==&quot;&quot; for /f &quot;tokens=2 delims==&quot; %%A in (&#x27;%_qr% %_Nul6%&#x27;) do set /a ls2=%%A</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%LicenseFamily=&#x27;Office%~5&#x27;%_zz6% %_zz3% LicenseStatus %_zz8%&quot;</span><br><span class="line">if /i not &quot;%~5&quot;==&quot;&quot; for /f &quot;tokens=2 delims==&quot; %%A in (&#x27;%_qr% %_Nul6%&#x27;) do set /a ls3=%%A</span><br><span class="line">if &quot;%ls3%&quot;==&quot;1&quot; (</span><br><span class="line">echo Checking: %~6</span><br><span class="line">echo Product is Permanently Activated.</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if &quot;%ls2%&quot;==&quot;1&quot; (</span><br><span class="line">echo Checking: %~4</span><br><span class="line">echo Product is Permanently Activated.</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if &quot;%ls%&quot;==&quot;1&quot; (</span><br><span class="line">echo Checking: %~2</span><br><span class="line">echo Product is Permanently Activated.</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">call :insKey</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:offchk21</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;f3fb2d68-83dd-4c8b-8f09-08e0d950ac3b&#x27; exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;76093b1b-7057-49d7-b970-638ebcbfd873&#x27; exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;a3b44174-2451-4cd6-b25f-66638bfb9046&#x27; exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;fbdb3e18-a8ef-4fb3-9183-dffd60bd0984&#x27; (</span><br><span class="line">call :offchk &quot;21ProPlus2021VL_MAK_AE1&quot; &quot;Office ProPlus 2021&quot; &quot;21ProPlus2021VL_MAK_AE2&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;080a45c5-9f9f-49eb-b4b0-c3c610a5ebd3&#x27; (</span><br><span class="line">call :offchk &quot;21Standard2021VL_MAK_AE&quot; &quot;Office Standard 2021&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;76881159-155c-43e0-9db7-2d70a9a3a4ca&#x27; (</span><br><span class="line">call :offchk &quot;21ProjectPro2021VL_MAK_AE1&quot; &quot;Project Pro 2021&quot; &quot;21ProjectPro2021VL_MAK_AE2&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;6dd72704-f752-4b71-94c7-11cec6bfc355&#x27; (</span><br><span class="line">call :offchk &quot;21ProjectStd2021VL_MAK_AE&quot; &quot;Project Standard 2021&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;fb61ac9a-1688-45d2-8f6b-0674dbffa33c&#x27; (</span><br><span class="line">call :offchk &quot;21VisioPro2021VL_MAK_AE&quot; &quot;Visio Pro 2021&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;72fce797-1884-48dd-a860-b2f6a5efd3ca&#x27; (</span><br><span class="line">call :offchk &quot;21VisioStd2021VL_MAK_AE&quot; &quot;Visio Standard 2021&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">call :insKey</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:offchk19</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;0bc88885-718c-491d-921f-6f214349e79c&#x27; exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;fc7c4d0c-2e85-4bb9-afd4-01ed1476b5e9&#x27; exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;500f6619-ef93-4b75-bcb4-82819998a3ca&#x27; exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;85dd8b5f-eaa4-4af3-a628-cce9e77c9a03&#x27; (</span><br><span class="line">call :offchk &quot;19ProPlus2019VL_MAK_AE&quot; &quot;Office ProPlus 2019&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;6912a74b-a5fb-401a-bfdb-2e3ab46f4b02&#x27; (</span><br><span class="line">call :offchk &quot;19Standard2019VL_MAK_AE&quot; &quot;Office Standard 2019&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;2ca2bf3f-949e-446a-82c7-e25a15ec78c4&#x27; (</span><br><span class="line">call :offchk &quot;19ProjectPro2019VL_MAK_AE&quot; &quot;Project Pro 2019&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;1777f0e3-7392-4198-97ea-8ae4de6f6381&#x27; (</span><br><span class="line">call :offchk &quot;19ProjectStd2019VL_MAK_AE&quot; &quot;Project Standard 2019&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;5b5cf08f-b81a-431d-b080-3450d8620565&#x27; (</span><br><span class="line">call :offchk &quot;19VisioPro2019VL_MAK_AE&quot; &quot;Visio Pro 2019&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;e06d7df3-aad0-419d-8dfb-0ac37e2bdf39&#x27; (</span><br><span class="line">call :offchk &quot;19VisioStd2019VL_MAK_AE&quot; &quot;Visio Standard 2019&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">call :insKey</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:offchk16</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;d450596f-894d-49e0-966a-fd39ed4c4c64&#x27; (</span><br><span class="line">call :offchk &quot;16ProPlusVL_MAK&quot; &quot;Office ProPlus 2016&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;dedfa23d-6ed1-45a6-85dc-63cae0546de6&#x27; (</span><br><span class="line">call :offchk &quot;16StandardVL_MAK&quot; &quot;Office Standard 2016&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;4f414197-0fc2-4c01-b68a-86cbb9ac254c&#x27; (</span><br><span class="line">call :offchk &quot;16ProjectProVL_MAK&quot; &quot;Project Pro 2016&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;da7ddabc-3fbe-4447-9e01-6ab7440b4cd4&#x27; (</span><br><span class="line">call :offchk &quot;16ProjectStdVL_MAK&quot; &quot;Project Standard 2016&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;6bf301c1-b94a-43e9-ba31-d494598c47fb&#x27; (</span><br><span class="line">call :offchk &quot;16VisioProVL_MAK&quot; &quot;Visio Pro 2016&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;aa2a7821-1827-4c2c-8f1d-4513a34dda97&#x27; (</span><br><span class="line">call :offchk &quot;16VisioStdVL_MAK&quot; &quot;Visio Standard 2016&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;829b8110-0e6f-4349-bca4-42803577788d&#x27; (</span><br><span class="line">call :offchk &quot;16ProjectProXC2RVL_MAKC2R&quot; &quot;Project Pro 2016 C2R&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;cbbaca45-556a-4416-ad03-bda598eaa7c8&#x27; (</span><br><span class="line">call :offchk &quot;16ProjectStdXC2RVL_MAKC2R&quot; &quot;Project Standard 2016 C2R&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;b234abe3-0857-4f9c-b05a-4dc314f85557&#x27; (</span><br><span class="line">call :offchk &quot;16VisioProXC2RVL_MAKC2R&quot; &quot;Visio Pro 2016 C2R&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;361fe620-64f4-41b5-ba77-84f8e079b1f7&#x27; (</span><br><span class="line">call :offchk &quot;16VisioStdXC2RVL_MAKC2R&quot; &quot;Visio Standard 2016 C2R&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">call :insKey</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:offchk15</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;b322da9c-a2e2-4058-9e4e-f59a6970bd69&#x27; (</span><br><span class="line">call :offchk &quot;ProPlusVL_MAK&quot; &quot;Office ProPlus 2013&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;b13afb38-cd79-4ae5-9f7f-eed058d750ca&#x27; (</span><br><span class="line">call :offchk &quot;StandardVL_MAK&quot; &quot;Office Standard 2013&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;4a5d124a-e620-44ba-b6ff-658961b33b9a&#x27; (</span><br><span class="line">call :offchk &quot;ProjectProVL_MAK&quot; &quot;Project Pro 2013&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;427a28d1-d17c-4abf-b717-32c780ba6f07&#x27; (</span><br><span class="line">call :offchk &quot;ProjectStdVL_MAK&quot; &quot;Project Standard 2013&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;e13ac10e-75d0-4aff-a0cd-764982cf541c&#x27; (</span><br><span class="line">call :offchk &quot;VisioProVL_MAK&quot; &quot;Visio Pro 2013&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;ac4efaf0-f81f-4f61-bdf7-ea32b02ab117&#x27; (</span><br><span class="line">call :offchk &quot;VisioStdVL_MAK&quot; &quot;Visio Standard 2013&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">call :insKey</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:offchk14</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;6f327760-8c5c-417c-9b61-836a98287e0c&#x27; (</span><br><span class="line">call :offchk &quot;ProPlus-MAK&quot; &quot;Office ProPlus 2010&quot; &quot;ProPlusAcad-MAK&quot; &quot;Office Professional Academic 2010&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;9da2a678-fb6b-4e67-ab84-60dd6a9c819a&#x27; (</span><br><span class="line">call :offchk &quot;Standard-MAK&quot; &quot;Office Standard 2010&quot; &quot;StandardAcad-MAK&quot;  &quot;Office Standard Academic 2010&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;ea509e87-07a1-4a45-9edc-eba5a39f36af&#x27; (</span><br><span class="line">call :offchk &quot;SmallBusBasics-MAK&quot; &quot;Office Small Business Basics 2010&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;df133ff7-bf14-4f95-afe3-7b48e7e331ef&#x27; (</span><br><span class="line">call :offchk &quot;ProjectPro-MAK&quot; &quot;Project Pro 2010&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;5dc7bf61-5ec9-4996-9ccb-df806a2d0efe&#x27; (</span><br><span class="line">call :offchk &quot;ProjectStd-MAK&quot; &quot;Project Standard 2010&quot; &quot;ProjectStd-MAK2&quot; &quot;Project Standard 2010&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;92236105-bb67-494f-94c7-7f7a607929bd&#x27; (</span><br><span class="line">call :offchk &quot;VisioPrem-MAK&quot; &quot;Visio Premium 2010&quot; &quot;VisioPro-MAK&quot; &quot;Visio Pro 2010&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if defined vPrem exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;e558389c-83c3-4b29-adfe-5e4d7f46c358&#x27; (</span><br><span class="line">call :offchk &quot;VisioPro-MAK&quot; &quot;Visio Pro 2010&quot; &quot;VisioStd-MAK&quot; &quot;Visio Standard 2010&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if defined vProf exit /b</span><br><span class="line">if /i &#x27;%app%&#x27; EQU &#x27;9ed833ff-4f92-4f36-b370-8683a4f13275&#x27; (</span><br><span class="line">call :offchk &quot;VisioStd-MAK&quot; &quot;Visio Standard 2010&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">call :insKey</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:officeLoc</span><br><span class="line">set loc_off%1=0</span><br><span class="line">set _O%1MSI=0</span><br><span class="line">if %1 EQU 19 (</span><br><span class="line">if defined _C16R reg query %_C16R% /v ProductReleaseIds %_Nul2% | findstr 2019 %_Nul1% &amp;&amp; set loc_off%1=1</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if %1 EQU 21 (</span><br><span class="line">if defined _C16R reg query %_C16R% /v ProductReleaseIds %_Nul2% | findstr 2021 %_Nul1% &amp;&amp; set loc_off%1=1</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\%1.0\Common\InstallRoot /v Path&quot; %_Nul6%&#x27;) do if exist &quot;%%b\OSPP.VBS&quot; (</span><br><span class="line">set loc_off%1=1</span><br><span class="line">set _O%1MSI=1</span><br><span class="line">)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Wow6432Node\Microsoft\Office\%1.0\Common\InstallRoot /v Path&quot; %_Nul6%&#x27;) do if exist &quot;%%b\OSPP.VBS&quot; (</span><br><span class="line">set loc_off%1=1</span><br><span class="line">set _O%1MSI=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %1 EQU 16 if defined _C16R (</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query %_C16R% /v ProductReleaseIds&#x27;) do echo %%b&gt; &quot;!_temp!\c2rchk.txt&quot;</span><br><span class="line">for %%a in (%LV16Ids%,ProjectProX,ProjectStdX,VisioProX,VisioStdX) do (</span><br><span class="line">  findstr /I /C:&quot;%%aVolume&quot; &quot;!_temp!\c2rchk.txt&quot; %_Nul1% &amp;&amp; set loc_off%1=1</span><br><span class="line">  )</span><br><span class="line">for %%a in (%LR16Ids%) do (</span><br><span class="line">  findstr /I /C:&quot;%%aRetail&quot; &quot;!_temp!\c2rchk.txt&quot; %_Nul1% &amp;&amp; set loc_off%1=1</span><br><span class="line">  )</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %1 EQU 15 if defined _C15R (</span><br><span class="line">set loc_off%1=1</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if exist &quot;%ProgramFiles%\Microsoft Office\Office%1\OSPP.VBS&quot; set loc_off%1=1</span><br><span class="line">if not %xOS%==x86 if exist &quot;%ProgramW6432%\Microsoft Office\Office%1\OSPP.VBS&quot; set loc_off%1=1</span><br><span class="line">if not %xOS%==x86 if exist &quot;%ProgramFiles(x86)%\Microsoft Office\Office%1\OSPP.VBS&quot; set loc_off%1=1</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:officeSub</span><br><span class="line">reg query %kNext% | findstr /i /r &quot;.*retail&quot; %_Nul2% | findstr /i /v &quot;project visio&quot; %_Nul2% | find /i &quot;0x2&quot; %_Nul1% &amp;&amp; (set sub_o365=1)</span><br><span class="line">reg query %kNext% | findstr /i /r &quot;.*retail&quot; %_Nul2% | findstr /i /v &quot;project visio&quot; %_Nul2% | find /i &quot;0x3&quot; %_Nul1% &amp;&amp; (set sub_o365=1)</span><br><span class="line">reg query %kNext% | findstr /i /r &quot;.*volume&quot; %_Nul2% | findstr /i /v &quot;project visio&quot; %_Nul2% | find /i &quot;0x2&quot; %_Nul1% &amp;&amp; (set sub_o365=1)</span><br><span class="line">reg query %kNext% | findstr /i /r &quot;.*volume&quot; %_Nul2% | findstr /i /v &quot;project visio&quot; %_Nul2% | find /i &quot;0x3&quot; %_Nul1% &amp;&amp; (set sub_o365=1)</span><br><span class="line">reg query %kNext% | findstr /i /r &quot;project.*&quot; %_Nul2% | find /i &quot;0x2&quot; %_Nul1% &amp;&amp; set sub_proj=1</span><br><span class="line">reg query %kNext% | findstr /i /r &quot;project.*&quot; %_Nul2% | find /i &quot;0x3&quot; %_Nul1% &amp;&amp; set sub_proj=1</span><br><span class="line">reg query %kNext% | findstr /i /r &quot;visio.*&quot; %_Nul2% | find /i &quot;0x2&quot; %_Nul1% &amp;&amp; set sub_vsio=1</span><br><span class="line">reg query %kNext% | findstr /i /r &quot;visio.*&quot; %_Nul2% | find /i &quot;0x3&quot; %_Nul1% &amp;&amp; set sub_vsio=1</span><br><span class="line">if %sub_o365% EQU 1 set sub_next=1</span><br><span class="line">if %sub_proj% EQU 1 set sub_next=1</span><br><span class="line">if %sub_vsio% EQU 1 set sub_next=1</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:insKey</span><br><span class="line">set S_OK=1</span><br><span class="line">echo.</span><br><span class="line">set &quot;_key=&quot;</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%ID=&#x27;%app%&#x27;%_zz6% %_zz3% Name %_zz8%&quot;</span><br><span class="line">if %ESU_ADD% EQU 0 for /f &quot;tokens=2 delims==&quot; %%x in (&#x27;%_qr%&#x27;) do echo Installing Key: %%x</span><br><span class="line">if %ESU_ADD% EQU 1 for /f &quot;tokens=2 delims==f&quot; %%x in (&#x27;%_qr%&#x27;) do echo Installing Key: %%x</span><br><span class="line">set ESU_ADD=0</span><br><span class="line">call :keys %app%</span><br><span class="line">if &quot;%_key%&quot;==&quot;&quot; (echo No associated KMS Client key found&amp;exit /b)</span><br><span class="line">set &quot;_qr=wmic path %sps% where Version=&#x27;%slsv%&#x27; call InstallProductKey ProductKey=&quot;%_key%&quot;&quot;</span><br><span class="line">if %WMI_VBS% NEQ 0 set &quot;_qr=%_csp% %sps% &quot;%_key%&quot;&quot;</span><br><span class="line">%_qr% %_Nul3%</span><br><span class="line">set ERRORCODE=%ERRORLEVEL%</span><br><span class="line">if %ERRORCODE% NEQ 0 (</span><br><span class="line">cmd /c exit /b %ERRORCODE%</span><br><span class="line">echo Failed: 0x!=ExitCode!</span><br><span class="line">set S_OK=0</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=wmic path %sps% where Version=&#x27;%slsv%&#x27; call RefreshLicenseStatus&quot;</span><br><span class="line">if %WMI_VBS% NEQ 0 set &quot;_qr=%_csm% &quot;%sps%.Version=&#x27;%slsv%&#x27;&quot; RefreshLicenseStatus&quot;</span><br><span class="line">if %sps% EQU SoftwareLicensingService %_qr% %_Nul3%</span><br><span class="line"></span><br><span class="line">:activate</span><br><span class="line">set S_OK=1</span><br><span class="line">if %sps% EQU SoftwareLicensingService (</span><br><span class="line">if %_officespp% EQU 0 (reg delete &quot;HKLM\%SPPk%\%_wApp%\%app%&quot; /f %_Null%) else (reg delete &quot;HKLM\%SPPk%\%_oApp%\%app%&quot; /f %_Null%)</span><br><span class="line">) else (</span><br><span class="line">reg delete &quot;HKLM\%OPPk%\%_oA14%\%app%&quot; /f %_Null%</span><br><span class="line">reg delete &quot;HKLM\%OPPk%\%_oApp%\%app%&quot; /f %_Null%</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%ID=&#x27;%app%&#x27;%_zz6% %_zz3% Name %_zz8%&quot;</span><br><span class="line">if %W1nd0ws% EQU 0 if %_officespp% EQU 0 if %sps% EQU SoftwareLicensingService (</span><br><span class="line">reg add &quot;HKLM\%SPPk%\%_wApp%\%app%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;127.0.0.2&quot; %_Nul3%</span><br><span class="line">reg add &quot;HKLM\%SPPk%\%_wApp%\%app%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;%KMS_Port%&quot; %_Nul3%</span><br><span class="line">for /f &quot;tokens=2 delims==&quot; %%x in (&#x27;%_qr%&#x27;) do echo Checking: %%x</span><br><span class="line">echo Product is KMS 2038 Activated.</span><br><span class="line">set _keepkms38=1</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%ID=&#x27;%app%&#x27;%_zz6% %_zz3% Name %_zz8%&quot;</span><br><span class="line">if %act_attempt% LSS 1 (</span><br><span class="line">if %ESU_ADD% EQU 0 for /f &quot;tokens=2 delims==&quot; %%x in (&#x27;%_qr%&#x27;) do echo Activating: %%x</span><br><span class="line">if %ESU_ADD% EQU 1 for /f &quot;tokens=2 delims==f&quot; %%x in (&#x27;%_qr%&#x27;) do echo Activating: %%x</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set ESU_ADD=0</span><br><span class="line">set &quot;_qr=wmic path %spp% where ID=&#x27;%app%&#x27; call Activate&quot;</span><br><span class="line">if %WMI_VBS% NEQ 0 set &quot;_qr=%_csm% &quot;%spp%.ID=&#x27;%app%&#x27;&quot; Activate&quot;</span><br><span class="line">%_qr% %_Nul3%</span><br><span class="line">call set ERRORCODE=%ERRORLEVEL%</span><br><span class="line">if %act_attempt% LSS 1 if %ERRORCODE% EQU -1073418187 (</span><br><span class="line">echo Product Activation Failed: 0xC004F035</span><br><span class="line">if %OSType% EQU Win7 echo Windows 7 cannot be KMS-activated on this computer due to unqualified OEM BIOS.</span><br><span class="line">echo See Read Me for details.</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if %act_attempt% LSS 1 if %ERRORCODE% EQU -1073417728 (</span><br><span class="line">echo Product Activation Failed: 0xC004F200</span><br><span class="line">echo Windows needs to rebuild the activation-related files.</span><br><span class="line">echo See KB2736303 for details.</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if %act_attempt% LSS 1 if %ERRORCODE% EQU -1073422315 (</span><br><span class="line">echo Product Activation Failed: 0xC004E015</span><br><span class="line">echo Running slmgr.vbs /rilc to mitigate.</span><br><span class="line">cscript //Nologo //B %SysPath%\slmgr.vbs /rilc</span><br><span class="line">)</span><br><span class="line">set gpr=0</span><br><span class="line">set gpr2=0</span><br><span class="line">set &quot;_qr=%_zz7% %spp% %_zz2% %_zz5%ID=&#x27;%app%&#x27;%_zz6% %_zz3% GracePeriodRemaining %_zz8%&quot;</span><br><span class="line">for /f &quot;tokens=2 delims==&quot; %%x in (&#x27;%_qr%&#x27;) do (set gpr=%%x&amp;set /a &quot;gpr2=(%%x+1440-1)/1440&quot;)</span><br><span class="line">if %act_attempt% LSS 1 if %ERRORCODE% EQU 0 if %gpr% EQU 0 (</span><br><span class="line">echo Product Activation succeeded, but Remaining Period failed to increase.</span><br><span class="line">if %OSType% EQU Win7 echo This could be related to the error described in KB4487266</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">set Act_OK=0</span><br><span class="line">if %gpr% EQU 43200 if %_officespp% EQU 0 if %winbuild% GEQ 9200 set Act_OK=1</span><br><span class="line">if %gpr% EQU 64800 set Act_OK=1</span><br><span class="line">if %gpr% GTR 259200 if %Win10Gov% EQU 1 set Act_OK=1</span><br><span class="line">if %gpr% EQU 259200 set Act_OK=1</span><br><span class="line"></span><br><span class="line">if %ERRORCODE% EQU 0 if %Act_OK% EQU 1 (</span><br><span class="line">call :_color %_Green% &quot;产品激活成功&quot;</span><br><span class="line">echo Remaining Period: %gpr2% days ^(%gpr% minutes^)</span><br><span class="line">set /a act_attempt=0</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not !server_num! gtr %max_servers% (</span><br><span class="line">if %act_attempt% LSS 3 (</span><br><span class="line">set /a act_attempt+=1</span><br><span class="line">call :getserv</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;!KMS_IP!&quot;</span><br><span class="line">%nul% reg add &quot;HKLM\%OPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;!KMS_IP!&quot;</span><br><span class="line">if %winbuild% GEQ 9200 (</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;!KMS_IP!&quot;</span><br><span class="line">if defined notx86 (</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;!KMS_IP!&quot; /reg:32</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;!KMS_IP!&quot; /reg:32</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">goto :activate</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">cmd /c exit /b %ERRORCODE%</span><br><span class="line">if %ERRORCODE% NEQ 0 (</span><br><span class="line">call :_color %_Red% &quot;产品激活失败: 0x!=ExitCode!&quot;</span><br><span class="line">) else (</span><br><span class="line">call :_color %_Red% &quot;产品激活失败&quot;</span><br><span class="line">)</span><br><span class="line">echo Remaining Period: %gpr2% days ^(%gpr% minutes^)</span><br><span class="line">set S_OK=0</span><br><span class="line">set act_failed=1</span><br><span class="line">set /a act_attempt=0</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:StopService</span><br><span class="line">sc query %1 | find /i &quot;STOPPED&quot; %_Nul1% || net stop %1 /y %_Nul3%</span><br><span class="line">sc query %1 | find /i &quot;STOPPED&quot; %_Nul1% || sc stop %1 %_Nul3%</span><br><span class="line">goto :eof</span><br><span class="line"></span><br><span class="line">:UpdateOSPPEntry</span><br><span class="line">if /i %1 EQU osppsvc.exe (</span><br><span class="line">reg add &quot;HKLM\%OPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;!KMS_IP!&quot; %_Nul3%</span><br><span class="line">reg add &quot;HKLM\%OPPk%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;%KMS_Port%&quot; %_Nul3%</span><br><span class="line">)</span><br><span class="line">goto :eof</span><br><span class="line"></span><br><span class="line">:CheckFR</span><br><span class="line"></span><br><span class="line">set WMIe=0</span><br><span class="line">call :CheckWS</span><br><span class="line">if %WMIe% EQU 1 (</span><br><span class="line">echo.</span><br><span class="line">echo %_err%</span><br><span class="line">echo Failed running WMI query check.</span><br><span class="line">)</span><br><span class="line">goto :eof</span><br><span class="line"></span><br><span class="line">:CheckWS</span><br><span class="line">set &quot;_qrw=%_zz1% Win32_ComputerSystem %_zz3% CreationClassName %_zz4%&quot;</span><br><span class="line">set &quot;_qrs=%_zz1% SoftwareLicensingService %_zz3% Version %_zz4%&quot;</span><br><span class="line"></span><br><span class="line">%_qrs% %_Nul2% | findstr /r &quot;[0-9]*\.[0-9]*\.[0-9]*\.[0-9]*&quot; %_Nul1% || (</span><br><span class="line">  set WMIe=1</span><br><span class="line">  %_qrw% %_Nul2% | find /i &quot;ComputerSystem&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">    echo Error: SPP is not responding</span><br><span class="line">    ) || (</span><br><span class="line">    echo Error: WMI ^&amp; SPP are not responding</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">goto :eof</span><br><span class="line"></span><br><span class="line">:C2RR2V</span><br><span class="line">set RanR2V=1</span><br><span class="line">set &quot;_SLMGR=%SysPath%\slmgr.vbs&quot;</span><br><span class="line">if %_Debug% EQU 0 (</span><br><span class="line">set &quot;_cscript=cscript //Nologo //B&quot;</span><br><span class="line">) else (</span><br><span class="line">set &quot;_cscript=cscript //Nologo&quot;</span><br><span class="line">)</span><br><span class="line">set _LTSC=0</span><br><span class="line">set &quot;_tag=&quot;&amp;set &quot;_ons= 2016&quot;</span><br><span class="line">sc query ClickToRunSvc %_Nul3%</span><br><span class="line">set error1=%errorlevel%</span><br><span class="line">sc query OfficeSvc %_Nul3%</span><br><span class="line">set error2=%errorlevel%</span><br><span class="line">if %error1% EQU 1060 if %error2% EQU 1060 (</span><br><span class="line">echo Error: Office C2R service is not detected</span><br><span class="line">goto :%_fC2R%</span><br><span class="line">)</span><br><span class="line">set _Office16=0</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do if exist &quot;%%b\root\Licenses16\ProPlus*.xrm-ms&quot; (</span><br><span class="line">  set _Office16=1</span><br><span class="line">)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do if exist &quot;%%b\root\Licenses16\ProPlus*.xrm-ms&quot; (</span><br><span class="line">  set _Office16=1</span><br><span class="line">)</span><br><span class="line">set _Office15=0</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do if exist &quot;%%b\root\Licenses\ProPlus*.xrm-ms&quot; (</span><br><span class="line">  set _Office15=1</span><br><span class="line">)</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do if exist &quot;%%b\root\Licenses\ProPlus*.xrm-ms&quot; (</span><br><span class="line">  set _Office15=1</span><br><span class="line">)</span><br><span class="line">if %_Office16% EQU 0 if %_Office15% EQU 0 (</span><br><span class="line">echo Error: Office C2R InstallPath is not detected</span><br><span class="line">goto :%_fC2R%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:Reg16istry</span><br><span class="line">if %_Office16% EQU 0 goto :Reg15istry</span><br><span class="line">set &quot;_InstallRoot=&quot;</span><br><span class="line">set &quot;_ProductIds=&quot;</span><br><span class="line">set &quot;_GUID=&quot;</span><br><span class="line">set &quot;_Config=&quot;</span><br><span class="line">set &quot;_PRIDs=&quot;</span><br><span class="line">set &quot;_LicensesPath=&quot;</span><br><span class="line">set &quot;_Integrator=&quot;</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do (set &quot;_InstallRoot=%%b\root&quot;)</span><br><span class="line">if not &quot;%_InstallRoot%&quot;==&quot;&quot; (</span><br><span class="line">  for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do (set &quot;_OSPPVBS=%%b\Office16\OSPP.VBS&quot;)</span><br><span class="line">  for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\ClickToRun /v PackageGUID&quot; %_Nul6%&#x27;) do (set &quot;_GUID=%%b&quot;)</span><br><span class="line">  for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\ClickToRun\Configuration /v ProductReleaseIds&quot; %_Nul6%&#x27;) do (set &quot;_ProductIds=%%b&quot;)</span><br><span class="line">  set &quot;_Config=HKLM\SOFTWARE\Microsoft\Office\ClickToRun\Configuration&quot;</span><br><span class="line">  set &quot;_PRIDs=HKLM\SOFTWARE\Microsoft\Office\ClickToRun\ProductReleaseIDs&quot;</span><br><span class="line">) else (</span><br><span class="line">  for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do (set &quot;_InstallRoot=%%b\root&quot;)</span><br><span class="line">  for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do (set &quot;_OSPPVBS=%%b\Office16\OSPP.VBS&quot;)</span><br><span class="line">  for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun /v PackageGUID&quot; %_Nul6%&#x27;) do (set &quot;_GUID=%%b&quot;)</span><br><span class="line">  for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun\Configuration /v ProductReleaseIds&quot; %_Nul6%&#x27;) do (set &quot;_ProductIds=%%b&quot;)</span><br><span class="line">  set &quot;_Config=HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun\Configuration&quot;</span><br><span class="line">  set &quot;_PRIDs=HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun\ProductReleaseIDs&quot;</span><br><span class="line">)</span><br><span class="line">set &quot;_LicensesPath=%_InstallRoot%\Licenses16&quot;</span><br><span class="line">set &quot;_Integrator=%_InstallRoot%\integration\integrator.exe&quot;</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query %_PRIDs% /v ActiveConfiguration&quot; %_Nul6%&#x27;) do set &quot;_PRIDs=%_PRIDs%\%%b&quot;</span><br><span class="line">if &quot;%_ProductIds%&quot;==&quot;&quot; (</span><br><span class="line">if %_Office15% EQU 0 (echo Error: Office C2R ProductIDs are not detected&amp;goto :%_fC2R%) else (goto :Reg15istry)</span><br><span class="line">)</span><br><span class="line">if not exist &quot;%_LicensesPath%\ProPlus*.xrm-ms&quot; (</span><br><span class="line">if %_Office15% EQU 0 (echo Error: Office C2R Licenses files are not detected&amp;goto :%_fC2R%) else (goto :Reg15istry)</span><br><span class="line">)</span><br><span class="line">if not exist &quot;%_Integrator%&quot; (</span><br><span class="line">if %_Office15% EQU 0 (echo Error: Office C2R Licenses Integrator is not detected&amp;goto :%_fC2R%) else (goto :Reg15istry)</span><br><span class="line">)</span><br><span class="line">if exist &quot;%_LicensesPath%\Word2019VL_KMS_Client_AE*.xrm-ms&quot; (set &quot;_tag=2019&quot;&amp;set &quot;_ons= 2019&quot;)</span><br><span class="line">if exist &quot;%_LicensesPath%\Word2021VL_KMS_Client_AE*.xrm-ms&quot; (set _LTSC=1)</span><br><span class="line">if %winbuild% LSS 10240 if !_LTSC! EQU 1 (set &quot;_tag=2021&quot;&amp;set &quot;_ons= 2021&quot;)</span><br><span class="line">if %_Office15% EQU 0 goto :CheckC2R</span><br><span class="line"></span><br><span class="line">:Reg15istry</span><br><span class="line">set &quot;_Install15Root=&quot;</span><br><span class="line">set &quot;_Product15Ids=&quot;</span><br><span class="line">set &quot;_Con15fig=&quot;</span><br><span class="line">set &quot;_PR15IDs=&quot;</span><br><span class="line">set &quot;_OSPP15Ready=&quot;</span><br><span class="line">set &quot;_Licenses15Path=&quot;</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do (set &quot;_Install15Root=%%b\root&quot;)</span><br><span class="line">if not &quot;%_Install15Root%&quot;==&quot;&quot; (</span><br><span class="line">  for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun\Configuration /v ProductReleaseIds&quot; %_Nul6%&#x27;) do (set &quot;_Product15Ids=%%b&quot;)</span><br><span class="line">  set &quot;_Con15fig=HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun\Configuration /v ProductReleaseIds&quot;</span><br><span class="line">  set &quot;_PR15IDs=HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun\ProductReleaseIDs&quot;</span><br><span class="line">  set &quot;_OSPP15Ready=HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun\Configuration&quot;</span><br><span class="line">) else (</span><br><span class="line">  for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\ClickToRun /v InstallPath&quot; %_Nul6%&#x27;) do (set &quot;_Install15Root=%%b\root&quot;)</span><br><span class="line">  for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\ClickToRun\Configuration /v ProductReleaseIds&quot; %_Nul6%&#x27;) do (set &quot;_Product15Ids=%%b&quot;)</span><br><span class="line">  set &quot;_Con15fig=HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\ClickToRun\Configuration /v ProductReleaseIds&quot;</span><br><span class="line">  set &quot;_PR15IDs=HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\ClickToRun\ProductReleaseIDs&quot;</span><br><span class="line">  set &quot;_OSPP15Ready=HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\ClickToRun\Configuration&quot;</span><br><span class="line">)</span><br><span class="line">set &quot;_OSPP15ReadT=REG_SZ&quot;</span><br><span class="line">if &quot;%_Product15Ids%&quot;==&quot;&quot; (</span><br><span class="line">reg query HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun\propertyBag /v productreleaseid %_Nul3% &amp;&amp; (</span><br><span class="line">  for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun\propertyBag /v productreleaseid&quot; %_Nul6%&#x27;) do (set &quot;_Product15Ids=%%b&quot;)</span><br><span class="line">  set &quot;_Con15fig=HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun\propertyBag /v productreleaseid&quot;</span><br><span class="line">  set &quot;_OSPP15Ready=HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun&quot;</span><br><span class="line">  set &quot;_OSPP15ReadT=REG_DWORD&quot;</span><br><span class="line">  )</span><br><span class="line">reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\ClickToRun\propertyBag /v productreleaseid %_Nul3% &amp;&amp; (</span><br><span class="line">  for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\ClickToRun\propertyBag /v productreleaseid&quot; %_Nul6%&#x27;) do (set &quot;_Product15Ids=%%b&quot;)</span><br><span class="line">  set &quot;_Con15fig=HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\ClickToRun\propertyBag /v productreleaseid&quot;</span><br><span class="line">  set &quot;_OSPP15Ready=HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\ClickToRun&quot;</span><br><span class="line">  set &quot;_OSPP15ReadT=REG_DWORD&quot;</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">set &quot;_Licenses15Path=%_Install15Root%\Licenses&quot;</span><br><span class="line">if exist &quot;%ProgramFiles%\Microsoft Office\Office15\OSPP.VBS&quot; (</span><br><span class="line">  set &quot;_OSPP15VBS=%ProgramFiles%\Microsoft Office\Office15\OSPP.VBS&quot;</span><br><span class="line">) else if exist &quot;%ProgramW6432%\Microsoft Office\Office15\OSPP.VBS&quot; (</span><br><span class="line">  set &quot;_OSPP15VBS=%ProgramW6432%\Microsoft Office\Office15\OSPP.VBS&quot;</span><br><span class="line">) else if exist &quot;%ProgramFiles(x86)%\Microsoft Office\Office15\OSPP.VBS&quot; (</span><br><span class="line">  set &quot;_OSPP15VBS=%ProgramFiles(x86)%\Microsoft Office\Office15\OSPP.VBS&quot;</span><br><span class="line">)</span><br><span class="line">if &quot;%_Product15Ids%&quot;==&quot;&quot; (</span><br><span class="line">if %_Office16% EQU 0 (echo Error: Office 2013 C2R ProductIDs are not detected&amp;goto :%_fC2R%) else (goto :CheckC2R)</span><br><span class="line">)</span><br><span class="line">if not exist &quot;%_Licenses15Path%\ProPlus*.xrm-ms&quot; (</span><br><span class="line">if %_Office16% EQU 0 (echo Error: Office 2013 C2R Licenses files are not detected&amp;goto :%_fC2R%) else (goto :CheckC2R)</span><br><span class="line">)</span><br><span class="line">if %winbuild% LSS 9200 if not exist &quot;%_OSPP15VBS%&quot; (</span><br><span class="line">if %_Office16% EQU 0 (echo Error: Office 2013 C2R Licensing tool OSPP.vbs is not detected&amp;goto :%_fC2R%) else (goto :CheckC2R)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:CheckC2R</span><br><span class="line">set _OMSI=0</span><br><span class="line">if %_Office16% EQU 0 (</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\16.0\Common\InstallRoot /v Path&quot; %_Nul6%&#x27;) do if exist &quot;%%b\OSPP.VBS&quot; set _OMSI=1</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Wow6432Node\Microsoft\Office\16.0\Common\InstallRoot /v Path&quot; %_Nul6%&#x27;) do if exist &quot;%%b\OSPP.VBS&quot; set _OMSI=1</span><br><span class="line">)</span><br><span class="line">if %_Office15% EQU 0 (</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\15.0\Common\InstallRoot /v Path&quot; %_Nul6%&#x27;) do if exist &quot;%%b\OSPP.VBS&quot; set _OMSI=1</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Wow6432Node\Microsoft\Office\15.0\Common\InstallRoot /v Path&quot; %_Nul6%&#x27;) do if exist &quot;%%b\OSPP.VBS&quot; set _OMSI=1</span><br><span class="line">)</span><br><span class="line">if %winbuild% GEQ 9200 (</span><br><span class="line">set _spp=SoftwareLicensingProduct</span><br><span class="line">set _sps=SoftwareLicensingService</span><br><span class="line">set &quot;_vbsi=%_SLMGR% /ilc &quot;</span><br><span class="line">set &quot;_vbsf=%_SLMGR% /ilc &quot;</span><br><span class="line">) else (</span><br><span class="line">set _spp=OfficeSoftwareProtectionProduct</span><br><span class="line">set _sps=OfficeSoftwareProtectionService</span><br><span class="line">set _vbsi=&quot;!_OSPP15VBS!&quot; /inslic:</span><br><span class="line">set _vbsf=&quot;!_OSPPVBS!&quot; /inslic:</span><br><span class="line">)</span><br><span class="line">set &quot;_wmi=&quot;</span><br><span class="line">set &quot;_qr=%_zz7% %_sps% %_zz3% Version %_zz8%&quot;</span><br><span class="line">for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;%_qr%&#x27;) do set _wmi=%%#</span><br><span class="line">if &quot;%_wmi%&quot;==&quot;&quot; (</span><br><span class="line">echo Error: %_sps% WMI version is not detected</span><br><span class="line">call :CheckWS</span><br><span class="line">goto :%_fC2R%</span><br><span class="line">)</span><br><span class="line">set _Retail=0</span><br><span class="line">set &quot;_ocq=ApplicationID=&#x27;%_oApp%&#x27; AND LicenseStatus=&#x27;1&#x27; AND PartialProductKey is not NULL&quot;</span><br><span class="line">if %WMI_VBS% EQU 0 wmic path %_spp% where (%_ocq%) get Description %_Nul2% |findstr /V /R &quot;^$&quot; &gt;&quot;!_temp!\crvRetail.txt&quot;</span><br><span class="line">set &quot;_qr=%_csq% %_spp% &quot;%_ocq%&quot; Description&quot;</span><br><span class="line">if %WMI_VBS% NEQ 0 %_qr% %_Nul2% &gt;&quot;!_temp!\crvRetail.txt&quot;</span><br><span class="line">find /i &quot;RETAIL channel&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; set _Retail=1</span><br><span class="line">find /i &quot;RETAIL(MAK) channel&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; set _Retail=1</span><br><span class="line">find /i &quot;TIMEBASED_SUB channel&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; set _Retail=1</span><br><span class="line">set rancopp=0</span><br><span class="line">if %_Retail% EQU 0 if %_OMSI% EQU 0 (</span><br><span class="line">set rancopp=1</span><br><span class="line">%_Nul3% powershell &quot;$f=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split &#x27;:cleanlicense\:.*&#x27;;iex ($f[1]);&quot;</span><br><span class="line">)</span><br><span class="line">set _O16O365=0</span><br><span class="line">set _C16Msg=0</span><br><span class="line">set _C15Msg=0</span><br><span class="line">set &quot;_qr=%_csq% %_spp% &quot;%_ocq%&quot; LicenseFamily&quot;</span><br><span class="line">if %_Retail% EQU 1 if %WMI_VBS% EQU 0 wmic path %_spp% where (%_ocq%) get LicenseFamily %_Nul2% |findstr /V /R &quot;^$&quot; &gt;&quot;!_temp!\crvRetail.txt&quot;</span><br><span class="line">if %_Retail% EQU 1 if %WMI_VBS% NEQ 0 %_qr% %_Nul2% &gt;&quot;!_temp!\crvRetail.txt&quot;</span><br><span class="line">set &quot;_qr=%_csq% %_spp% &quot;ApplicationID=&#x27;%_oApp%&#x27;&quot; LicenseFamily&quot;</span><br><span class="line">if %WMI_VBS% EQU 0 wmic path %_spp% where &quot;ApplicationID=&#x27;%_oApp%&#x27;&quot; get LicenseFamily %_Nul2% |findstr /V /R &quot;^$&quot; &gt;&quot;!_temp!\crvVolume.txt&quot; 2&gt;&amp;1</span><br><span class="line">if %WMI_VBS% NEQ 0 %_qr% %_Nul2% &gt;&quot;!_temp!\crvVolume.txt&quot; 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line">if %_Office16% EQU 0 goto :R15V</span><br><span class="line"></span><br><span class="line">set _O21Ids=ProPlus2021,ProjectPro2021,VisioPro2021,Standard2021,ProjectStd2021,VisioStd2021,Access2021,SkypeforBusiness2021</span><br><span class="line">set _O19Ids=ProPlus2019,ProjectPro2019,VisioPro2019,Standard2019,ProjectStd2019,VisioStd2019,Access2019,SkypeforBusiness2019</span><br><span class="line">set _O16Ids=ProjectPro,VisioPro,Standard,ProjectStd,VisioStd,Access,SkypeforBusiness</span><br><span class="line">set _A21Ids=Excel2021,Outlook2021,PowerPoint2021,Publisher2021,Word2021</span><br><span class="line">set _A19Ids=Excel2019,Outlook2019,PowerPoint2019,Publisher2019,Word2019</span><br><span class="line">set _A16Ids=Excel,Outlook,PowerPoint,Publisher,Word</span><br><span class="line">set _V21Ids=%_O21Ids%,%_A21Ids%</span><br><span class="line">set _V19Ids=%_O19Ids%,%_A19Ids%</span><br><span class="line">set _V16Ids=Mondo,%_O16Ids%,%_A16Ids%,OneNote</span><br><span class="line">set _R16Ids=%_V16Ids%,Professional,HomeBusiness,HomeStudent,O365ProPlus,O365Business,O365SmallBusPrem,O365HomePrem,O365EduCloud</span><br><span class="line">set _RetIds=%_V21Ids%,Professional2021,HomeBusiness2021,HomeStudent2021,%_V19Ids%,Professional2019,HomeBusiness2019,HomeStudent2019,%_R16Ids%</span><br><span class="line">set _Suites=Mondo,O365ProPlus,O365Business,O365SmallBusPrem,O365HomePrem,O365EduCloud,ProPlus,Standard,Professional,HomeBusiness,HomeStudent,ProPlus2019,Standard2019,Professional2019,HomeBusiness2019,HomeStudent2019,ProPlus2021,Standard2021,Professional2021,HomeBusiness2021,HomeStudent2021</span><br><span class="line">set _PrjSKU=ProjectPro,ProjectStd,ProjectPro2019,ProjectStd2019,ProjectPro2021,ProjectStd2021</span><br><span class="line">set _VisSKU=VisioPro,VisioStd,VisioPro2019,VisioStd2019,VisioPro2021,VisioStd2021</span><br><span class="line"></span><br><span class="line">echo %_ProductIds%&gt;&quot;!_temp!\crvProductIds.txt&quot;</span><br><span class="line">for %%a in (%_RetIds%,ProPlus) do (</span><br><span class="line">set _%%a=0</span><br><span class="line">)</span><br><span class="line">for %%a in (%_RetIds%) do (</span><br><span class="line">findstr /I /C:&quot;%%aRetail&quot; &quot;!_temp!\crvProductIds.txt&quot; %_Nul1% &amp;&amp; set _%%a=1</span><br><span class="line">)</span><br><span class="line">if !_LTSC! EQU 0 for %%a in (%_V21Ids%) do (</span><br><span class="line">set _%%a=0</span><br><span class="line">)</span><br><span class="line">if !_LTSC! EQU 1 for %%a in (%_V21Ids%) do (</span><br><span class="line">findstr /I /C:&quot;%%aVolume&quot; &quot;!_temp!\crvProductIds.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  find /i &quot;Office21%%aVL_KMS_Client&quot; &quot;!_temp!\crvVolume.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0) || (set _%%a=1)</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (%_V19Ids%) do (</span><br><span class="line">findstr /I /C:&quot;%%aVolume&quot; &quot;!_temp!\crvProductIds.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  find /i &quot;Office19%%aVL_KMS_Client&quot; &quot;!_temp!\crvVolume.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0) || (set _%%a=1)</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (%_V16Ids%) do (</span><br><span class="line">findstr /I /C:&quot;%%aVolume&quot; &quot;!_temp!\crvProductIds.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  find /i &quot;Office16%%aVL_KMS_Client&quot; &quot;!_temp!\crvVolume.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0) || (set _%%a=1)</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">reg query %_PRIDs%\ProPlusRetail.16 %_Nul3% &amp;&amp; (</span><br><span class="line">  find /i &quot;Office16ProPlusVL_KMS_Client&quot; &quot;!_temp!\crvVolume.txt&quot; %_Nul1% &amp;&amp; (set _ProPlus=0) || (set _ProPlus=1)</span><br><span class="line">)</span><br><span class="line">reg query %_PRIDs%\ProPlusVolume.16 %_Nul3% &amp;&amp; (</span><br><span class="line">  find /i &quot;Office16ProPlusVL_KMS_Client&quot; &quot;!_temp!\crvVolume.txt&quot; %_Nul1% &amp;&amp; (set _ProPlus=0) || (set _ProPlus=1)</span><br><span class="line">)</span><br><span class="line">if %_Retail% EQU 1 for %%a in (%_RetIds%) do (</span><br><span class="line">findstr /I /C:&quot;%%aRetail&quot; &quot;!_temp!\crvProductIds.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  find /i &quot;Office16%%aR_Retail&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16%%aR_OEM&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16%%aR_Sub&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16%%aR_PIN&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16%%aE5R_&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16%%aEDUR_&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16%%aMSDNR_&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16%%aO365R_&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16%%aCO365R_&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16%%aVL_MAK&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16%%aXC2RVL_MAKC2R&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office19%%aR_Retail&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R19=1)</span><br><span class="line">  find /i &quot;Office19%%aR_OEM&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R19=1)</span><br><span class="line">  find /i &quot;Office19%%aMSDNR_&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R19=1)</span><br><span class="line">  find /i &quot;Office19%%aVL_MAK&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R19=1)</span><br><span class="line">  find /i &quot;Office21%%aR_Retail&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R21=1)</span><br><span class="line">  find /i &quot;Office21%%aR_OEM&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R21=1)</span><br><span class="line">  find /i &quot;Office21%%aMSDNR_&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R21=1)</span><br><span class="line">  find /i &quot;Office21%%aVL_MAK&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R21=1)</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">if %_Retail% EQU 1 reg query %_PRIDs%\ProPlusRetail.16 %_Nul3% &amp;&amp; (</span><br><span class="line">  find /i &quot;Office16ProPlusR_Retail&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _ProPlus=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16ProPlusR_OEM&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _ProPlus=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16ProPlusMSDNR_&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _ProPlus=0 &amp; set aC2R16=1)</span><br><span class="line">  find /i &quot;Office16ProPlusVL_MAK&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _ProPlus=0 &amp; set aC2R16=1)</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz1% %_spp% %_zz2% &quot;ApplicationID=&#x27;%_oApp%&#x27; AND LicenseFamily like &#x27;Office16O365%%&#x27;&quot; %_zz3% LicenseFamily %_zz4%&quot;</span><br><span class="line">find /i &quot;Office16MondoVL_KMS_Client&quot; &quot;!_temp!\crvVolume.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">%_qr% %_Nul2% | find /i &quot;O365&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  for %%a in (O365ProPlus,O365Business,O365SmallBusPrem,O365HomePrem,O365EduCloud) do set _%%a=0</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">if %sub_o365% EQU 1 (</span><br><span class="line">  for %%a in (%_Suites%) do set _%%a=0</span><br><span class="line">echo.</span><br><span class="line">echo Microsoft Office is activated with a vNext license.</span><br><span class="line">)</span><br><span class="line">if %sub_proj% EQU 1 (</span><br><span class="line">  for %%a in (%_PrjSKU%) do set _%%a=0</span><br><span class="line">echo.</span><br><span class="line">echo Microsoft Project is activated with a vNext license.</span><br><span class="line">)</span><br><span class="line">if %sub_vsio% EQU 1 (</span><br><span class="line">  for %%a in (%_VisSKU%) do set _%%a=0</span><br><span class="line">echo.</span><br><span class="line">echo Microsoft Visio is activated with a vNext license.</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%a in (%_RetIds%,ProPlus) do if !_%%a! EQU 1 (</span><br><span class="line">set _C16Msg=1</span><br><span class="line">)</span><br><span class="line">if %_C16Msg% EQU 1 (</span><br><span class="line">echo.</span><br><span class="line">echo Converting Office C2R Retail-to-Volume:</span><br><span class="line">)</span><br><span class="line">if %_C16Msg% EQU 0 (if %_Office15% EQU 1 (goto :R15V) else (goto :GVLKC2R))</span><br><span class="line"></span><br><span class="line">for %%# in (&quot;!_LicensesPath!\client-issuance-*.xrm-ms&quot;) do (</span><br><span class="line">%_cscript% %_vbsf%&quot;!_LicensesPath!\%%~nx#&quot;</span><br><span class="line">)</span><br><span class="line">%_cscript% %_vbsf%&quot;!_LicensesPath!\pkeyconfig-office.xrm-ms&quot;</span><br><span class="line"></span><br><span class="line">if !_Mondo! EQU 1 (</span><br><span class="line">call :InsLic Mondo</span><br><span class="line">)</span><br><span class="line">if !_O365ProPlus! EQU 1 (</span><br><span class="line">echo O365ProPlus 2016 Suite ^&lt;-^&gt; Mondo 2016 Licenses</span><br><span class="line">call :InsLic O365ProPlus DRNV7-VGMM2-B3G9T-4BF84-VMFTK</span><br><span class="line">if !_Mondo! EQU 0 call :InsLic Mondo</span><br><span class="line">)</span><br><span class="line">if !_O365Business! EQU 1 if !_O365ProPlus! EQU 0 (</span><br><span class="line">set _O365ProPlus=1</span><br><span class="line">echo O365Business 2016 Suite ^&lt;-^&gt; Mondo 2016 Licenses</span><br><span class="line">call :InsLic O365Business NCHRJ-3VPGW-X73DM-6B36K-3RQ6B</span><br><span class="line">if !_Mondo! EQU 0 call :InsLic Mondo</span><br><span class="line">)</span><br><span class="line">if !_O365SmallBusPrem! EQU 1 if !_O365Business! EQU 0 if !_O365ProPlus! EQU 0 (</span><br><span class="line">set _O365ProPlus=1</span><br><span class="line">echo O365SmallBusPrem 2016 Suite ^&lt;-^&gt; Mondo 2016 Licenses</span><br><span class="line">call :InsLic O365SmallBusPrem 3FBRX-NFP7C-6JWVK-F2YGK-H499R</span><br><span class="line">if !_Mondo! EQU 0 call :InsLic Mondo</span><br><span class="line">)</span><br><span class="line">if !_O365HomePrem! EQU 1 if !_O365SmallBusPrem! EQU 0 if !_O365Business! EQU 0 if !_O365ProPlus! EQU 0 (</span><br><span class="line">set _O365ProPlus=1</span><br><span class="line">echo O365HomePrem 2016 Suite ^&lt;-^&gt; Mondo 2016 Licenses</span><br><span class="line">call :InsLic O365HomePrem 9FNY8-PWWTY-8RY4F-GJMTV-KHGM9</span><br><span class="line">if !_Mondo! EQU 0 call :InsLic Mondo</span><br><span class="line">)</span><br><span class="line">if !_O365EduCloud! EQU 1 if !_O365HomePrem! EQU 0 if !_O365SmallBusPrem! EQU 0 if !_O365Business! EQU 0 if !_O365ProPlus! EQU 0 (</span><br><span class="line">set _O365ProPlus=1</span><br><span class="line">echo O365EduCloud 2016 Suite ^&lt;-^&gt; Mondo 2016 Licenses</span><br><span class="line">call :InsLic O365EduCloud 8843N-BCXXD-Q84H8-R4Q37-T3CPT</span><br><span class="line">if !_Mondo! EQU 0 call :InsLic Mondo</span><br><span class="line">)</span><br><span class="line">if !_O365ProPlus! EQU 1 set _O16O365=1</span><br><span class="line">if !_Mondo! EQU 1 if !_O365ProPlus! EQU 0 (</span><br><span class="line">echo Mondo 2016 Suite</span><br><span class="line">call :InsLic O365ProPlus DRNV7-VGMM2-B3G9T-4BF84-VMFTK</span><br><span class="line">if %_Office15% EQU 1 (goto :R15V) else (goto :GVLKC2R)</span><br><span class="line">)</span><br><span class="line">if !_ProPlus2021! EQU 1 if !_O365ProPlus! EQU 0 (</span><br><span class="line">echo ProPlus 2021 Suite</span><br><span class="line">call :InsLic ProPlus2021</span><br><span class="line">)</span><br><span class="line">if !_ProPlus2019! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 (</span><br><span class="line">echo ProPlus 2019 Suite -^&gt; ProPlus%_ons% Licenses</span><br><span class="line">call :InsLic ProPlus%_tag%</span><br><span class="line">)</span><br><span class="line">if !_ProPlus! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 (</span><br><span class="line">echo ProPlus 2016 Suite -^&gt; ProPlus%_ons% Licenses</span><br><span class="line">call :InsLic ProPlus%_tag%</span><br><span class="line">)</span><br><span class="line">if !_Professional2021! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 (</span><br><span class="line">echo Professional 2021 Suite -^&gt; ProPlus 2021 Licenses</span><br><span class="line">call :InsLic ProPlus2021</span><br><span class="line">)</span><br><span class="line">if !_Professional2019! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 (</span><br><span class="line">echo Professional 2019 Suite -^&gt; ProPlus%_ons% Licenses</span><br><span class="line">call :InsLic ProPlus%_tag%</span><br><span class="line">)</span><br><span class="line">if !_Professional! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 (</span><br><span class="line">echo Professional 2016 Suite -^&gt; ProPlus%_ons% Licenses</span><br><span class="line">call :InsLic ProPlus%_tag%</span><br><span class="line">)</span><br><span class="line">if !_Standard2021! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 (</span><br><span class="line">echo Standard 2021 Suite</span><br><span class="line">call :InsLic Standard2021</span><br><span class="line">)</span><br><span class="line">if !_Standard2019! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 (</span><br><span class="line">echo Standard 2019 Suite -^&gt; Standard%_ons% Licenses</span><br><span class="line">call :InsLic Standard%_tag%</span><br><span class="line">)</span><br><span class="line">if !_Standard! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 (</span><br><span class="line">echo Standard 2016 Suite -^&gt; Standard%_ons% Licenses</span><br><span class="line">call :InsLic Standard%_tag%</span><br><span class="line">)</span><br><span class="line">for %%a in (ProjectPro,VisioPro,ProjectStd,VisioStd) do if !_%%a2021! EQU 1 (</span><br><span class="line">  echo %%a 2021 SKU</span><br><span class="line">  call :InsLic %%a2021</span><br><span class="line">)</span><br><span class="line">for %%a in (ProjectPro,VisioPro,ProjectStd,VisioStd) do if !_%%a2019! EQU 1 (</span><br><span class="line">if !_%%a2021! EQU 0 (</span><br><span class="line">  echo %%a 2019 SKU -^&gt; %%a%_ons% Licenses</span><br><span class="line">  call :InsLic %%a%_tag%</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (ProjectPro,VisioPro,ProjectStd,VisioStd) do if !_%%a! EQU 1 (</span><br><span class="line">if !_%%a2021! EQU 0 if !_%%a2019! EQU 0 (</span><br><span class="line">  echo %%a 2016 SKU -^&gt; %%a%_ons% Licenses</span><br><span class="line">  call :InsLic %%a%_tag%</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (HomeBusiness,HomeStudent) do if !_%%a2021! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 if !_Standard! EQU 0 (</span><br><span class="line">  set _Standard2021=1</span><br><span class="line">  echo %%a 2021 Suite -^&gt; Standard 2021 Licenses</span><br><span class="line">  call :InsLic Standard2021</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (HomeBusiness,HomeStudent) do if !_%%a2019! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 if !_Standard! EQU 0 if !_%%a2021! EQU 0 (</span><br><span class="line">  set _Standard2019=1</span><br><span class="line">  echo %%a 2019 Suite -^&gt; Standard%_ons% Licenses</span><br><span class="line">  call :InsLic Standard%_tag%</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (HomeBusiness,HomeStudent) do if !_%%a! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 if !_Standard! EQU 0 if !_%%a2021! EQU 0 if !_%%a2019! EQU 0 (</span><br><span class="line">  set _Standard=1</span><br><span class="line">  echo %%a 2016 Suite -^&gt; Standard%_ons% Licenses</span><br><span class="line">  call :InsLic Standard%_tag%</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (%_A21Ids%,OneNote) do if !_%%a! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 if !_Standard! EQU 0 (</span><br><span class="line">  echo %%a App</span><br><span class="line">  call :InsLic %%a</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (%_A16Ids%) do if !_%%a2019! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 if !_Standard! EQU 0 if !_%%a2021! EQU 0 (</span><br><span class="line">  echo %%a 2019 App -^&gt; %%a%_ons% Licenses</span><br><span class="line">  call :InsLic %%a%_tag%</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (%_A16Ids%) do if !_%%a! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 if !_Standard! EQU 0 if !_%%a2021! EQU 0 if !_%%a2019! EQU 0 (</span><br><span class="line">  echo %%a 2016 App -^&gt; %%a%_ons% Licenses</span><br><span class="line">  call :InsLic %%a%_tag%</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (Access) do if !_%%a2021! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 (</span><br><span class="line">  echo %%a 2021 App</span><br><span class="line">  call :InsLic %%a2021</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (Access) do if !_%%a2019! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_%%a2021! EQU 0 (</span><br><span class="line">  echo %%a 2019 App -^&gt; %%a%_ons% Licenses</span><br><span class="line">  call :InsLic %%a%_tag%</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (Access) do if !_%%a! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_%%a2021! EQU 0 if !_%%a2019! EQU 0 (</span><br><span class="line">  echo %%a 2016 App -^&gt; %%a%_ons% Licenses</span><br><span class="line">  call :InsLic %%a%_tag%</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (SkypeforBusiness) do if !_%%a2021! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 (</span><br><span class="line">  echo %%a 2021 App</span><br><span class="line">  call :InsLic %%a2021</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (SkypeforBusiness) do if !_%%a2019! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_%%a2021! EQU 0 (</span><br><span class="line">  echo %%a 2019 App -^&gt; %%a%_ons% Licenses</span><br><span class="line">  call :InsLic %%a%_tag%</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (SkypeforBusiness) do if !_%%a! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_%%a2021! EQU 0 if !_%%a2019! EQU 0 (</span><br><span class="line">  echo %%a 2016 App -^&gt; %%a%_ons% Licenses</span><br><span class="line">  call :InsLic %%a%_tag%</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">if %_Office15% EQU 1 (goto :R15V) else (goto :GVLKC2R)</span><br><span class="line"></span><br><span class="line">:R15V</span><br><span class="line">set _O15Ids=Standard,ProjectPro,VisioPro,ProjectStd,VisioStd,Access,Lync</span><br><span class="line">set _A15Ids=Excel,Groove,InfoPath,OneNote,Outlook,PowerPoint,Publisher,Word</span><br><span class="line">set _R15Ids=SPD,Mondo,%_O15Ids%,%_A15Ids%,Professional,HomeBusiness,HomeStudent,O365ProPlus,O365Business,O365SmallBusPrem,O365HomePrem</span><br><span class="line">set _V15Ids=Mondo,%_O15Ids%,%_A15Ids%</span><br><span class="line"></span><br><span class="line">echo %_Product15Ids%&gt;&quot;!_temp!\crvProduct15s.txt&quot;</span><br><span class="line">for %%a in (%_R15Ids%,ProPlus) do (</span><br><span class="line">set _%%a=0</span><br><span class="line">)</span><br><span class="line">for %%a in (%_R15Ids%) do (</span><br><span class="line">findstr /I /C:&quot;%%aRetail&quot; &quot;!_temp!\crvProduct15s.txt&quot; %_Nul1% &amp;&amp; set _%%a=1</span><br><span class="line">)</span><br><span class="line">for %%a in (%_V15Ids%) do (</span><br><span class="line">findstr /I /C:&quot;%%aVolume&quot; &quot;!_temp!\crvProduct15s.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  find /i &quot;Office%%aVL_KMS_Client&quot; &quot;!_temp!\crvVolume.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0) || (set _%%a=1)</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">reg query %_PR15IDs%\Active\ProPlusRetail\x-none %_Nul3% &amp;&amp; (</span><br><span class="line">  find /i &quot;OfficeProPlusVL_KMS_Client&quot; &quot;!_temp!\crvVolume.txt&quot; %_Nul1% &amp;&amp; (set _ProPlus=0) || (set _ProPlus=1)</span><br><span class="line">)</span><br><span class="line">reg query %_PR15IDs%\Active\ProPlusVolume\x-none %_Nul3% &amp;&amp; (</span><br><span class="line">  find /i &quot;OfficeProPlusVL_KMS_Client&quot; &quot;!_temp!\crvVolume.txt&quot; %_Nul1% &amp;&amp; (set _ProPlus=0) || (set _ProPlus=1)</span><br><span class="line">)</span><br><span class="line">if %_Retail% EQU 1 for %%a in (%_R15Ids%) do (</span><br><span class="line">findstr /I /C:&quot;%%aRetail&quot; &quot;!_temp!\crvProduct15s.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  find /i &quot;Office%%aR_Retail&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R15=1)</span><br><span class="line">  find /i &quot;Office%%aR_OEM&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R15=1)</span><br><span class="line">  find /i &quot;Office%%aR_Sub&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R15=1)</span><br><span class="line">  find /i &quot;Office%%aR_PIN&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R15=1)</span><br><span class="line">  find /i &quot;Office%%aMSDNR_&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R15=1)</span><br><span class="line">  find /i &quot;Office%%aO365R_&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R15=1)</span><br><span class="line">  find /i &quot;Office%%aCO365R_&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R15=1)</span><br><span class="line">  find /i &quot;Office%%aVL_MAK&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _%%a=0 &amp; set aC2R15=1)</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">if %_Retail% EQU 1 reg query %_PR15IDs%\Active\ProPlusRetail\x-none %_Nul3% &amp;&amp; (</span><br><span class="line">  find /i &quot;OfficeProPlusR_Retail&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _ProPlus=0 &amp; set aC2R15=1)</span><br><span class="line">  find /i &quot;OfficeProPlusR_OEM&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _ProPlus=0 &amp; set aC2R15=1)</span><br><span class="line">  find /i &quot;OfficeProPlusMSDNR_&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _ProPlus=0 &amp; set aC2R15=1)</span><br><span class="line">  find /i &quot;OfficeProPlusVL_MAK&quot; &quot;!_temp!\crvRetail.txt&quot; %_Nul1% &amp;&amp; (set _ProPlus=0 &amp; set aC2R15=1)</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz1% %_spp% %_zz2% &quot;ApplicationID=&#x27;%_oApp%&#x27; AND LicenseFamily like &#x27;OfficeO365%%&#x27;&quot; %_zz3% LicenseFamily %_zz4%&quot;</span><br><span class="line">find /i &quot;OfficeMondoVL_KMS_Client&quot; &quot;!_temp!\crvVolume.txt&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">%_qr% %_Nul2% | find /i &quot;O365&quot; %_Nul1% &amp;&amp; (</span><br><span class="line">  for %%a in (O365ProPlus,O365Business,O365SmallBusPrem,O365HomePrem) do set _%%a=0</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%a in (%_R15Ids%,ProPlus) do if !_%%a! EQU 1 (</span><br><span class="line">set _C15Msg=1</span><br><span class="line">)</span><br><span class="line">if %_C15Msg% EQU 1 if %_C16Msg% EQU 0 (</span><br><span class="line">echo.</span><br><span class="line">echo Converting Office C2R Retail-to-Volume:</span><br><span class="line">)</span><br><span class="line">if %_C15Msg% EQU 0 goto :GVLKC2R</span><br><span class="line"></span><br><span class="line">for %%# in (&quot;!_Licenses15Path!\client-issuance-*.xrm-ms&quot;) do (</span><br><span class="line">%_cscript% %_vbsi%&quot;!_Licenses15Path!\%%~nx#&quot;</span><br><span class="line">)</span><br><span class="line">%_cscript% %_vbsi%&quot;!_Licenses15Path!\pkeyconfig-office.xrm-ms&quot;</span><br><span class="line"></span><br><span class="line">if !_Mondo! EQU 1 (</span><br><span class="line">call :Ins15Lic Mondo</span><br><span class="line">)</span><br><span class="line">if !_O365ProPlus! EQU 1 if !_O16O365! EQU 0 (</span><br><span class="line">echo O365ProPlus 2013 Suite ^&lt;-^&gt; Mondo 2013 Licenses</span><br><span class="line">call :Ins15Lic O365ProPlus DRNV7-VGMM2-B3G9T-4BF84-VMFTK</span><br><span class="line">if !_Mondo! EQU 0 call :Ins15Lic Mondo</span><br><span class="line">)</span><br><span class="line">if !_O365SmallBusPrem! EQU 1 if !_O365ProPlus! EQU 0 if !_O16O365! EQU 0 (</span><br><span class="line">set _O365ProPlus=1</span><br><span class="line">echo O365SmallBusPrem 2013 Suite ^&lt;-^&gt; Mondo 2013 Licenses</span><br><span class="line">call :Ins15Lic O365SmallBusPrem 3FBRX-NFP7C-6JWVK-F2YGK-H499R</span><br><span class="line">if !_Mondo! EQU 0 call :Ins15Lic Mondo</span><br><span class="line">)</span><br><span class="line">if !_O365HomePrem! EQU 1 if !_O365SmallBusPrem! EQU 0 if !_O365ProPlus! EQU 0 if !_O16O365! EQU 0 (</span><br><span class="line">set _O365ProPlus=1</span><br><span class="line">echo O365HomePrem 2013 Suite ^&lt;-^&gt; Mondo 2013 Licenses</span><br><span class="line">call :Ins15Lic O365HomePrem 9FNY8-PWWTY-8RY4F-GJMTV-KHGM9</span><br><span class="line">if !_Mondo! EQU 0 call :Ins15Lic Mondo</span><br><span class="line">)</span><br><span class="line">if !_O365Business! EQU 1 if !_O365HomePrem! EQU 0 if !_O365SmallBusPrem! EQU 0 if !_O365ProPlus! EQU 0 if !_O16O365! EQU 0 (</span><br><span class="line">set _O365ProPlus=1</span><br><span class="line">echo O365Business 2013 Suite ^&lt;-^&gt; Mondo 2013 Licenses</span><br><span class="line">call :Ins15Lic O365Business MCPBN-CPY7X-3PK9R-P6GTT-H8P8Y</span><br><span class="line">if !_Mondo! EQU 0 call :Ins15Lic Mondo</span><br><span class="line">)</span><br><span class="line">if !_Mondo! EQU 1 if !_O365ProPlus! EQU 0 if !_O16O365! EQU 0 (</span><br><span class="line">echo Mondo 2013 Suite</span><br><span class="line">call :Ins15Lic O365ProPlus DRNV7-VGMM2-B3G9T-4BF84-VMFTK</span><br><span class="line">goto :GVLKC2R</span><br><span class="line">)</span><br><span class="line">if !_SPD! EQU 1 if !_Mondo! EQU 0 if !_O365ProPlus! EQU 0 (</span><br><span class="line">echo SharePoint Designer 2013 App -^&gt; Mondo 2013 Licenses</span><br><span class="line">call :Ins15Lic Mondo</span><br><span class="line">goto :GVLKC2R</span><br><span class="line">)</span><br><span class="line">if !_ProPlus! EQU 1 if !_O365ProPlus! EQU 0 (</span><br><span class="line">echo ProPlus 2013 Suite</span><br><span class="line">call :Ins15Lic ProPlus</span><br><span class="line">)</span><br><span class="line">if !_Professional! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus! EQU 0 (</span><br><span class="line">echo Professional 2013 Suite -^&gt; ProPlus 2013 Licenses</span><br><span class="line">call :Ins15Lic ProPlus</span><br><span class="line">)</span><br><span class="line">if !_Standard! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus! EQU 0 if !_Professional! EQU 0 (</span><br><span class="line">echo Standard 2013 Suite</span><br><span class="line">call :Ins15Lic Standard</span><br><span class="line">)</span><br><span class="line">for %%a in (ProjectPro,VisioPro,ProjectStd,VisioStd) do if !_%%a! EQU 1 (</span><br><span class="line">echo %%a 2013 SKU</span><br><span class="line">call :Ins15Lic %%a</span><br><span class="line">)</span><br><span class="line">for %%a in (HomeBusiness,HomeStudent) do if !_%%a! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus! EQU 0 if !_Professional! EQU 0 if !_Standard! EQU 0 (</span><br><span class="line">  set _Standard=1</span><br><span class="line">  echo %%a 2013 Suite -^&gt; Standard 2013 Licenses</span><br><span class="line">  call :Ins15Lic Standard</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (%_A15Ids%) do if !_%%a! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus! EQU 0 if !_Professional! EQU 0 if !_Standard! EQU 0 (</span><br><span class="line">  echo %%a 2013 App</span><br><span class="line">  call :Ins15Lic %%a</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (Access) do if !_%%a! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus! EQU 0 if !_Professional! EQU 0 (</span><br><span class="line">  echo %%a 2013 App</span><br><span class="line">  call :Ins15Lic %%a</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%a in (Lync) do if !_%%a! EQU 1 (</span><br><span class="line">if !_O365ProPlus! EQU 0 if !_ProPlus! EQU 0 (</span><br><span class="line">  echo SkypeforBusiness 2015 App</span><br><span class="line">  call :Ins15Lic %%a</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">goto :GVLKC2R</span><br><span class="line"></span><br><span class="line">:InsLic</span><br><span class="line">set &quot;_ID=%1Volume&quot;</span><br><span class="line">set &quot;_patt=%1VL_&quot;</span><br><span class="line">set &quot;_pkey=&quot;</span><br><span class="line">set &quot;_kpey=&quot;</span><br><span class="line">if not &quot;%2&quot;==&quot;&quot; (</span><br><span class="line">set &quot;_ID=%1Retail&quot;</span><br><span class="line">set &quot;_patt=%1R_&quot;</span><br><span class="line">set &quot;_pkey=PidKey=%2&quot;</span><br><span class="line">set &quot;_kpey=%2&quot;</span><br><span class="line">)</span><br><span class="line">reg delete %_Config% /f /v %_ID%.OSPPReady %_Nul3%</span><br><span class="line">&quot;!_Integrator!&quot; /I /License PRIDName=%_ID%.16 %_pkey% PackageGUID=&quot;%_GUID%&quot; PackageRoot=&quot;!_InstallRoot!&quot; %_Nul1%</span><br><span class="line"></span><br><span class="line">set fallback=0</span><br><span class="line">set &quot;_qr=wmic path %_spp% where ApplicationID=&#x27;%_oApp%&#x27; get LicenseFamily&quot;</span><br><span class="line">if %WMI_VBS% NEQ 0 set &quot;_qr=%_csq% %_spp% &quot;ApplicationID=&#x27;%_oApp%&#x27;&quot; LicenseFamily&quot;</span><br><span class="line">%_qr% %_Nul2% | find /i &quot;%_patt%&quot; %_Nul1% || (set fallback=1)</span><br><span class="line">if %fallback% equ 0 goto :IntOK</span><br><span class="line"></span><br><span class="line">set &quot;_lsfs=&quot;</span><br><span class="line">for %%# in (&quot;!_LicensesPath!\%_patt%*.xrm-ms&quot;) do (</span><br><span class="line">set &quot;_lsfs=!_lsfs! %%~nx#&quot;</span><br><span class="line">)</span><br><span class="line">if defined _kpey (</span><br><span class="line">  for %%# in (&quot;!_LicensesPath!\%1DemoR*.xrm-ms&quot;) do (</span><br><span class="line">  set &quot;_lsfs=!_lsfs! %%~nx#&quot;</span><br><span class="line">  )</span><br><span class="line">  for %%# in (&quot;!_LicensesPath!\%1E5R*.xrm-ms&quot;) do (</span><br><span class="line">  set &quot;_lsfs=!_lsfs! %%~nx#&quot;</span><br><span class="line">  )</span><br><span class="line">  for %%# in (&quot;!_LicensesPath!\%1EDUR*.xrm-ms&quot;) do (</span><br><span class="line">  set &quot;_lsfs=!_lsfs! %%~nx#&quot;</span><br><span class="line">  )</span><br><span class="line">  for %%# in (&quot;!_LicensesPath!\%1MSDNR*.xrm-ms&quot;) do (</span><br><span class="line">  set &quot;_lsfs=!_lsfs! %%~nx#&quot;</span><br><span class="line">  )</span><br><span class="line">  for %%# in (&quot;!_LicensesPath!\%1O365R*.xrm-ms&quot;) do (</span><br><span class="line">  set &quot;_lsfs=!_lsfs! %%~nx#&quot;</span><br><span class="line">  )</span><br><span class="line">  for %%# in (&quot;!_LicensesPath!\%1CO365R*.xrm-ms&quot;) do (</span><br><span class="line">  set &quot;_lsfs=!_lsfs! %%~nx#&quot;</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">for %%# in (!_lsfs!) do (</span><br><span class="line">%_cscript% %_vbsf%&quot;!_LicensesPath!\%%#&quot;</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=wmic path %_sps% where Version=&#x27;%_wmi%&#x27; call InstallProductKey ProductKey=&quot;%_kpey%&quot;&quot;</span><br><span class="line">if %WMI_VBS% NEQ 0 set &quot;_qr=%_csp% %_sps% &quot;%_kpey%&quot;&quot;</span><br><span class="line">if defined _kpey %_qr% %_Nul3%</span><br><span class="line"></span><br><span class="line">:IntOK</span><br><span class="line">reg add %_Config% /f /v %_ID%.OSPPReady /t REG_SZ /d 1 %_Nul1%</span><br><span class="line">reg query %_Config% /v ProductReleaseIds | findstr /I &quot;%_ID%&quot; %_Nul1%</span><br><span class="line">if %errorlevel% NEQ 0 (</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query %_Config% /v ProductReleaseIds&#x27;) do reg add %_Config% /v ProductReleaseIds /t REG_SZ /d &quot;%%b,%_ID%&quot; /f %_Nul1%</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:Ins15Lic</span><br><span class="line">set &quot;_ID=%1Volume&quot;</span><br><span class="line">set &quot;_patt=%1VL_&quot;</span><br><span class="line">set &quot;_pkey=&quot;</span><br><span class="line">if not &quot;%2&quot;==&quot;&quot; (</span><br><span class="line">set &quot;_ID=%1Retail&quot;</span><br><span class="line">set &quot;_patt=%1R_&quot;</span><br><span class="line">set &quot;_pkey=%2&quot;</span><br><span class="line">)</span><br><span class="line">reg delete %_OSPP15Ready% /f /v %_ID%.OSPPReady %_Nul3%</span><br><span class="line">for %%# in (&quot;!_Licenses15Path!\%_patt%*.xrm-ms&quot;) do (</span><br><span class="line">%_cscript% %_vbsi%&quot;!_Licenses15Path!\%%~nx#&quot;</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=wmic path %_sps% where Version=&#x27;%_wmi%&#x27; call InstallProductKey ProductKey=&quot;%_pkey%&quot;&quot;</span><br><span class="line">if %WMI_VBS% NEQ 0 set &quot;_qr=%_csp% %_sps% &quot;%_pkey%&quot;&quot;</span><br><span class="line">if defined _pkey %_qr% %_Nul3%</span><br><span class="line">reg add %_OSPP15Ready% /f /v %_ID%.OSPPReady /t %_OSPP15ReadT% /d 1 %_Nul1%</span><br><span class="line">reg query %_Con15fig% %_Nul2% | findstr /I &quot;%_ID%&quot; %_Nul1%</span><br><span class="line">if %errorlevel% NEQ 0 (</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query %_Con15fig% %_Nul6%&#x27;) do reg add %_Con15fig% /t REG_SZ /d &quot;%%b,%_ID%&quot; /f %_Nul1%</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:GVLKC2R</span><br><span class="line">set _CtRMsg=0</span><br><span class="line">if %_C16Msg% EQU 1 set _CtRMsg=1</span><br><span class="line">if %_C15Msg% EQU 1 set _CtRMsg=1</span><br><span class="line">if %_Office16% EQU 1 (</span><br><span class="line">for %%a in (%_RetIds%,ProPlus) do set &quot;_%%a=&quot;</span><br><span class="line">for %%A in (19,21) do call :officeLoc %%A</span><br><span class="line">)</span><br><span class="line">if %_Office15% EQU 1 (</span><br><span class="line">for %%a in (%_R15Ids%,ProPlus) do set &quot;_%%a=&quot;</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=wmic path %_sps% where version=&#x27;%_wmi%&#x27; call RefreshLicenseStatus&quot;</span><br><span class="line">if %WMI_VBS% NEQ 0 set &quot;_qr=%_csm% &quot;%_sps%.Version=&#x27;%_wmi%&#x27;&quot; RefreshLicenseStatus&quot;</span><br><span class="line">if %winbuild% GEQ 9200 %_qr% %_Nul3%</span><br><span class="line">if exist &quot;%SysPath%\spp\store_test\2.0\tokens.dat&quot; if %rancopp% EQU 1 if %_CtRMsg% EQU 1 (</span><br><span class="line">%_cscript% %_SLMGR% /rilc</span><br><span class="line">if !ERRORLEVEL! NEQ 0 %_cscript% %_SLMGR% /rilc</span><br><span class="line">)</span><br><span class="line">goto :%_sC2R%</span><br><span class="line"></span><br><span class="line">:keys</span><br><span class="line">if &quot;%~1&quot;==&quot;&quot; exit /b</span><br><span class="line">set yh=-</span><br><span class="line">goto :%1 %_Nul2%</span><br><span class="line"></span><br><span class="line">:: Windows 11 [Ni]</span><br><span class="line">:59eb965c-9150-42b7-a0ec-22151b9897c5</span><br><span class="line">set &quot;_key=KBN8V%yh%HFGQ4%yh%MGXVD%yh%347P6%yh%PDQGT&quot; &amp;:: IoT Enterprise LTSC</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows 11 [Co]</span><br><span class="line">:ca7df2e3-5ea0-47b8-9ac1-b1be4d8edd69</span><br><span class="line">set &quot;_key=37D7F%yh%N49CB%yh%WQR8W%yh%TBJ73%yh%FM8RX&quot; &amp;:: SE &#123;Cloud&#125;</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:d30136fc-cb4b-416e-a23d-87207abc44a9</span><br><span class="line">set &quot;_key=6XN7V%yh%PCBDC%yh%BDBRH%yh%8DQY7%yh%G6R44&quot; &amp;:: SE N &#123;Cloud N&#125;</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows 10 [RS5]</span><br><span class="line">:32d2fab3-e4a8-42c2-923b-4bf4fd13e6ee</span><br><span class="line">set &quot;_key=M7XTQ%yh%FN8P6%yh%TTKYV%yh%9D4CC%yh%J462D&quot; &amp;:: Enterprise LTSC 2019</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:7103a333-b8c8-49cc-93ce-d37c09687f92</span><br><span class="line">set &quot;_key=92NFX%yh%8DJQP%yh%P6BBQ%yh%THF9C%yh%7CG2H&quot; &amp;:: Enterprise LTSC 2019 N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ec868e65-fadf-4759-b23e-93fe37f2cc29</span><br><span class="line">set &quot;_key=CPWHC%yh%NT2C7%yh%VYW78%yh%DHDB2%yh%PG3GK&quot; &amp;:: Enterprise for Virtual Desktops</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:0df4f814-3f57-4b8b-9a9d-fddadcd69fac</span><br><span class="line">set &quot;_key=NBTWJ%yh%3DR69%yh%3C4V8%yh%C26MC%yh%GQ9M6&quot; &amp;:: Lean</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows 10 [RS3]</span><br><span class="line">:82bbc092-bc50-4e16-8e18-b74fc486aec3</span><br><span class="line">set &quot;_key=NRG8B%yh%VKK3Q%yh%CXVCJ%yh%9G2XF%yh%6Q84J&quot; &amp;:: Pro Workstation</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:4b1571d3-bafb-4b40-8087-a961be2caf65</span><br><span class="line">set &quot;_key=9FNHH%yh%K3HBT%yh%3W4TD%yh%6383H%yh%6XYWF&quot; &amp;:: Pro Workstation N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e4db50ea-bda1-4566-b047-0ca50abc6f07</span><br><span class="line">set &quot;_key=7NBT4%yh%WGBQX%yh%MP4H7%yh%QXFF8%yh%YP3KX&quot; &amp;:: Enterprise Remote Server</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows 10 [RS2]</span><br><span class="line">:e0b2d383-d112-413f-8a80-97f373a5820c</span><br><span class="line">set &quot;_key=YYVX9%yh%NTFWV%yh%6MDM3%yh%9PT4T%yh%4M68B&quot; &amp;:: Enterprise G</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e38454fb-41a4-4f59-a5dc-25080e354730</span><br><span class="line">set &quot;_key=44RPN%yh%FTY23%yh%9VTTB%yh%MP9BX%yh%T84FV&quot; &amp;:: Enterprise G N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows 10 [RS1]</span><br><span class="line">:2d5a5a60-3040-48bf-beb0-fcd770c20ce0</span><br><span class="line">set &quot;_key=DCPHK%yh%NFMTC%yh%H88MJ%yh%PFHPY%yh%QJ4BJ&quot; &amp;:: Enterprise 2016 LTSB</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:9f776d83-7156-45b2-8a5c-359b9c9f22a3</span><br><span class="line">set &quot;_key=QFFDN%yh%GRT3P%yh%VKWWX%yh%X7T3R%yh%8B639&quot; &amp;:: Enterprise 2016 LTSB N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:3f1afc82-f8ac-4f6c-8005-1d233e606eee</span><br><span class="line">set &quot;_key=6TP4R%yh%GNPTD%yh%KYYHQ%yh%7B7DP%yh%J447Y&quot; &amp;:: Pro Education</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:5300b18c-2e33-4dc2-8291-47ffcec746dd</span><br><span class="line">set &quot;_key=YVWGF%yh%BXNMC%yh%HTQYQ%yh%CPQ99%yh%66QFC&quot; &amp;:: Pro Education N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows 10 [TH]</span><br><span class="line">:58e97c99-f377-4ef1-81d5-4ad5522b5fd8</span><br><span class="line">set &quot;_key=TX9XD%yh%98N7V%yh%6WMQ6%yh%BX7FG%yh%H8Q99&quot; &amp;:: Home</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:7b9e1751-a8da-4f75-9560-5fadfe3d8e38</span><br><span class="line">set &quot;_key=3KHY7%yh%WNT83%yh%DGQKR%yh%F7HPR%yh%844BM&quot; &amp;:: Home N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:cd918a57-a41b-4c82-8dce-1a538e221a83</span><br><span class="line">set &quot;_key=7HNRX%yh%D7KGG%yh%3K4RQ%yh%4WPJ4%yh%YTDFH&quot; &amp;:: Home Single Language</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:a9107544-f4a0-4053-a96a-1479abdef912</span><br><span class="line">set &quot;_key=PVMJN%yh%6DFY6%yh%9CCP6%yh%7BKTT%yh%D3WVR&quot; &amp;:: Home China</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:2de67392-b7a7-462a-b1ca-108dd189f588</span><br><span class="line">set &quot;_key=W269N%yh%WFGWX%yh%YVC9B%yh%4J6C9%yh%T83GX&quot; &amp;:: Pro</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:a80b5abf-76ad-428b-b05d-a47d2dffeebf</span><br><span class="line">set &quot;_key=MH37W%yh%N47XK%yh%V7XM9%yh%C7227%yh%GCQG9&quot; &amp;:: Pro N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e0c42288-980c-4788-a014-c080d2e1926e</span><br><span class="line">set &quot;_key=NW6C2%yh%QMPVW%yh%D7KKK%yh%3GKT6%yh%VCFB2&quot; &amp;:: Education</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:3c102355-d027-42c6-ad23-2e7ef8a02585</span><br><span class="line">set &quot;_key=2WH4N%yh%8QGBV%yh%H22JP%yh%CT43Q%yh%MDWWJ&quot; &amp;:: Education N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:73111121-5638-40f6-bc11-f1d7b0d64300</span><br><span class="line">set &quot;_key=NPPR9%yh%FWDCX%yh%D2C8J%yh%H872K%yh%2YT43&quot; &amp;:: Enterprise</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e272e3e2-732f-4c65-a8f0-484747d0d947</span><br><span class="line">set &quot;_key=DPH2V%yh%TTNVB%yh%4X9Q3%yh%TJR4H%yh%KHJW4&quot; &amp;:: Enterprise N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:7b51a46c-0c04-4e8f-9af4-8496cca90d5e</span><br><span class="line">set &quot;_key=WNMTR%yh%4C88C%yh%JK8YV%yh%HQ7T2%yh%76DF9&quot; &amp;:: Enterprise 2015 LTSB</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:87b838b7-41b6-4590-8318-5797951d8529</span><br><span class="line">set &quot;_key=2F77B%yh%TNFGY%yh%69QQF%yh%B8YKP%yh%D69TJ&quot; &amp;:: Enterprise 2015 LTSB N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows Server 2022 [Fe]</span><br><span class="line">:9bd77860-9b31-4b7b-96ad-2564017315bf</span><br><span class="line">set &quot;_key=VDYBN%yh%27WPP%yh%V4HQT%yh%9VMD4%yh%VMK7H&quot; &amp;:: Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ef6cfc9f-8c5d-44ac-9aad-de6a2ea0ae03</span><br><span class="line">set &quot;_key=WX4NM%yh%KYWYW%yh%QJJR4%yh%XV3QB%yh%6VM33&quot; &amp;:: Datacenter</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:8c8f0ad3-9a43-4e05-b840-93b8d1475cbc</span><br><span class="line">set &quot;_key=6N379%yh%GGTMK%yh%23C6M%yh%XVVTC%yh%CKFRQ&quot; &amp;:: Azure Core</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:f5e9429c-f50b-4b98-b15c-ef92eb5cff39</span><br><span class="line">set &quot;_key=67KN8%yh%4FYJW%yh%2487Q%yh%MQ2J7%yh%4C4RG&quot; &amp;:: Standard ACor</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:39e69c41-42b4-4a0a-abad-8e3c10a797cc</span><br><span class="line">set &quot;_key=QFND9%yh%D3Y9C%yh%J3KKY%yh%6RPVP%yh%2DPYV&quot; &amp;:: Datacenter ACor</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows Server 2019 [RS5]</span><br><span class="line">:de32eafd-aaee-4662-9444-c1befb41bde2</span><br><span class="line">set &quot;_key=N69G4%yh%B89J2%yh%4G8F4%yh%WWYCC%yh%J464C&quot; &amp;:: Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:34e1ae55-27f8-4950-8877-7a03be5fb181</span><br><span class="line">set &quot;_key=WMDGN%yh%G9PQG%yh%XVVXX%yh%R3X43%yh%63DFG&quot; &amp;:: Datacenter</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:a99cc1f0-7719-4306-9645-294102fbff95</span><br><span class="line">set &quot;_key=FDNH6%yh%VW9RW%yh%BXPJ7%yh%4XTYG%yh%239TB&quot; &amp;:: Azure Core</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:73e3957c-fc0c-400d-9184-5f7b6f2eb409</span><br><span class="line">set &quot;_key=N2KJX%yh%J94YW%yh%TQVFB%yh%DG9YT%yh%724CC&quot; &amp;:: Standard ACor</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:90c362e5-0da1-4bfd-b53b-b87d309ade43</span><br><span class="line">set &quot;_key=6NMRW%yh%2C8FM%yh%D24W7%yh%TQWMY%yh%CWH2D&quot; &amp;:: Datacenter ACor</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:034d3cbb-5d4b-4245-b3f8-f84571314078</span><br><span class="line">set &quot;_key=WVDHN%yh%86M7X%yh%466P6%yh%VHXV7%yh%YY726&quot; &amp;:: Essentials</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:8de8eb62-bbe0-40ac-ac17-f75595071ea3</span><br><span class="line">set &quot;_key=GRFBW%yh%QNDC4%yh%6QBHG%yh%CCK3B%yh%2PR88&quot; &amp;:: ServerARM64</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:19b5e0fb-4431-46bc-bac1-2f1873e4ae73</span><br><span class="line">set &quot;_key=NTBV8%yh%9K7Q8%yh%V27C6%yh%M2BTV%yh%KHMXV&quot; &amp;:: Azure Datacenter - ServerTurbine</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows Server 2016 [RS4]</span><br><span class="line">:43d9af6e-5e86-4be8-a797-d072a046896c</span><br><span class="line">set &quot;_key=K9FYF%yh%G6NCK%yh%73M32%yh%XMVPY%yh%F9DRR&quot; &amp;:: ServerARM64</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows Server 2016 [RS3]</span><br><span class="line">:61c5ef22-f14f-4553-a824-c4b31e84b100</span><br><span class="line">set &quot;_key=PTXN8%yh%JFHJM%yh%4WC78%yh%MPCBR%yh%9W4KR&quot; &amp;:: Standard ACor</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e49c08e7-da82-42f8-bde2-b570fbcae76c</span><br><span class="line">set &quot;_key=2HXDN%yh%KRXHB%yh%GPYC7%yh%YCKFJ%yh%7FVDG&quot; &amp;:: Datacenter ACor</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows Server 2016 [RS1]</span><br><span class="line">:8c1c5410-9f39-4805-8c9d-63a07706358f</span><br><span class="line">set &quot;_key=WC2BQ%yh%8NRM3%yh%FDDYY%yh%2BFGV%yh%KHKQY&quot; &amp;:: Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:21c56779-b449-4d20-adfc-eece0e1ad74b</span><br><span class="line">set &quot;_key=CB7KF%yh%BWN84%yh%R7R2Y%yh%793K2%yh%8XDDG&quot; &amp;:: Datacenter</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:3dbf341b-5f6c-4fa7-b936-699dce9e263f</span><br><span class="line">set &quot;_key=VP34G%yh%4NPPG%yh%79JTQ%yh%864T4%yh%R3MQX&quot; &amp;:: Azure Core</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:2b5a1b0f-a5ab-4c54-ac2f-a6d94824a283</span><br><span class="line">set &quot;_key=JCKRF%yh%N37P4%yh%C2D82%yh%9YXRT%yh%4M63B&quot; &amp;:: Essentials</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:7b4433f4-b1e7-4788-895a-c45378d38253</span><br><span class="line">set &quot;_key=QN4C6%yh%GBJD2%yh%FB422%yh%GHWJK%yh%GJG2R&quot; &amp;:: Cloud Storage</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows 8.1</span><br><span class="line">:fe1c3238-432a-43a1-8e25-97e7d1ef10f3</span><br><span class="line">set &quot;_key=M9Q9P%yh%WNJJT%yh%6PXPY%yh%DWX8H%yh%6XWKK&quot; &amp;:: Core</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:78558a64-dc19-43fe-a0d0-8075b2a370a3</span><br><span class="line">set &quot;_key=7B9N3%yh%D94CG%yh%YTVHR%yh%QBPX3%yh%RJP64&quot; &amp;:: Core N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:c72c6a1d-f252-4e7e-bdd1-3fca342acb35</span><br><span class="line">set &quot;_key=BB6NG%yh%PQ82V%yh%VRDPW%yh%8XVD2%yh%V8P66&quot; &amp;:: Core Single Language</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:db78b74f-ef1c-4892-abfe-1e66b8231df6</span><br><span class="line">set &quot;_key=NCTT7%yh%2RGK8%yh%WMHRF%yh%RY7YQ%yh%JTXG3&quot; &amp;:: Core China</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ffee456a-cd87-4390-8e07-16146c672fd0</span><br><span class="line">set &quot;_key=XYTND%yh%K6QKT%yh%K2MRH%yh%66RTM%yh%43JKP&quot; &amp;:: Core ARM</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:c06b6981-d7fd-4a35-b7b4-054742b7af67</span><br><span class="line">set &quot;_key=GCRJD%yh%8NW9H%yh%F2CDX%yh%CCM8D%yh%9D6T9&quot; &amp;:: Pro</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:7476d79f-8e48-49b4-ab63-4d0b813a16e4</span><br><span class="line">set &quot;_key=HMCNV%yh%VVBFX%yh%7HMBH%yh%CTY9B%yh%B4FXY&quot; &amp;:: Pro N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:096ce63d-4fac-48a9-82a9-61ae9e800e5f</span><br><span class="line">set &quot;_key=789NJ%yh%TQK6T%yh%6XTH8%yh%J39CJ%yh%J8D3P&quot; &amp;:: Pro with Media Center</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:81671aaf-79d1-4eb1-b004-8cbbe173afea</span><br><span class="line">set &quot;_key=MHF9N%yh%XY6XB%yh%WVXMC%yh%BTDCT%yh%MKKG7&quot; &amp;:: Enterprise</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:113e705c-fa49-48a4-beea-7dd879b46b14</span><br><span class="line">set &quot;_key=TT4HM%yh%HN7YT%yh%62K67%yh%RGRQJ%yh%JFFXW&quot; &amp;:: Enterprise N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:0ab82d54-47f4-4acb-818c-cc5bf0ecb649</span><br><span class="line">set &quot;_key=NMMPB%yh%38DD4%yh%R2823%yh%62W8D%yh%VXKJB&quot; &amp;:: Embedded Industry Pro</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:cd4e2d9f-5059-4a50-a92d-05d5bb1267c7</span><br><span class="line">set &quot;_key=FNFKF%yh%PWTVT%yh%9RC8H%yh%32HB2%yh%JB34X&quot; &amp;:: Embedded Industry Enterprise</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:f7e88590-dfc7-4c78-bccb-6f3865b99d1a</span><br><span class="line">set &quot;_key=VHXM3%yh%NR6FT%yh%RY6RT%yh%CK882%yh%KW2CJ&quot; &amp;:: Embedded Industry Automotive</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e9942b32-2e55-4197-b0bd-5ff58cba8860</span><br><span class="line">set &quot;_key=3PY8R%yh%QHNP9%yh%W7XQD%yh%G6DPH%yh%3J2C9&quot; &amp;:: with Bing</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:c6ddecd6-2354-4c19-909b-306a3058484e</span><br><span class="line">set &quot;_key=Q6HTR%yh%N24GM%yh%PMJFP%yh%69CD8%yh%2GXKR&quot; &amp;:: with Bing N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:b8f5e3a3-ed33-4608-81e1-37d6c9dcfd9c</span><br><span class="line">set &quot;_key=KF37N%yh%VDV38%yh%GRRTV%yh%XH8X6%yh%6F3BB&quot; &amp;:: with Bing Single Language</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ba998212-460a-44db-bfb5-71bf09d1c68b</span><br><span class="line">set &quot;_key=R962J%yh%37N87%yh%9VVK2%yh%WJ74P%yh%XTMHR&quot; &amp;:: with Bing China</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e58d87b5-8126-4580-80fb-861b22f79296</span><br><span class="line">set &quot;_key=MX3RK%yh%9HNGX%yh%K3QKC%yh%6PJ3F%yh%W8D7B&quot; &amp;:: Pro for Students</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:cab491c7-a918-4f60-b502-dab75e334f40</span><br><span class="line">set &quot;_key=TNFGH%yh%2R6PB%yh%8XM3K%yh%QYHX2%yh%J4296&quot; &amp;:: Pro for Students N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows Server 2012 R2</span><br><span class="line">:b3ca044e-a358-4d68-9883-aaa2941aca99</span><br><span class="line">set &quot;_key=D2N9P%yh%3P6X9%yh%2R39C%yh%7RTCD%yh%MDVJX&quot; &amp;:: Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:00091344-1ea4-4f37-b789-01750ba6988c</span><br><span class="line">set &quot;_key=W3GGN%yh%FT8W3%yh%Y4M27%yh%J84CP%yh%Q3VJ9&quot; &amp;:: Datacenter</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:21db6ba4-9a7b-4a14-9e29-64a60c59301d</span><br><span class="line">set &quot;_key=KNC87%yh%3J2TX%yh%XB4WP%yh%VCPJV%yh%M4FWM&quot; &amp;:: Essentials</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:b743a2be-68d4-4dd3-af32-92425b7bb623</span><br><span class="line">set &quot;_key=3NPTF%yh%33KPT%yh%GGBPR%yh%YX76B%yh%39KDD&quot; &amp;:: Cloud Storage</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows 8</span><br><span class="line">:c04ed6bf-55c8-4b47-9f8e-5a1f31ceee60</span><br><span class="line">set &quot;_key=BN3D2%yh%R7TKB%yh%3YPBD%yh%8DRP2%yh%27GG4&quot; &amp;:: Core</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:197390a0-65f6-4a95-bdc4-55d58a3b0253</span><br><span class="line">set &quot;_key=8N2M2%yh%HWPGY%yh%7PGT9%yh%HGDD8%yh%GVGGY&quot; &amp;:: Core N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:8860fcd4-a77b-4a20-9045-a150ff11d609</span><br><span class="line">set &quot;_key=2WN2H%yh%YGCQR%yh%KFX6K%yh%CD6TF%yh%84YXQ&quot; &amp;:: Core Single Language</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:9d5584a2-2d85-419a-982c-a00888bb9ddf</span><br><span class="line">set &quot;_key=4K36P%yh%JN4VD%yh%GDC6V%yh%KDT89%yh%DYFKP&quot; &amp;:: Core China</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:af35d7b7-5035-4b63-8972-f0b747b9f4dc</span><br><span class="line">set &quot;_key=DXHJF%yh%N9KQX%yh%MFPVR%yh%GHGQK%yh%Y7RKV&quot; &amp;:: Core ARM</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:a98bcd6d-5343-4603-8afe-5908e4611112</span><br><span class="line">set &quot;_key=NG4HW%yh%VH26C%yh%733KW%yh%K6F98%yh%J8CK4&quot; &amp;:: Pro</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ebf245c1-29a8-4daf-9cb1-38dfc608a8c8</span><br><span class="line">set &quot;_key=XCVCF%yh%2NXM9%yh%723PB%yh%MHCB7%yh%2RYQQ&quot; &amp;:: Pro N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:a00018a3-f20f-4632-bf7c-8daa5351c914</span><br><span class="line">set &quot;_key=GNBB8%yh%YVD74%yh%QJHX6%yh%27H4K%yh%8QHDG&quot; &amp;:: Pro with Media Center</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:458e1bec-837a-45f6-b9d5-925ed5d299de</span><br><span class="line">set &quot;_key=32JNW%yh%9KQ84%yh%P47T8%yh%D8GGY%yh%CWCK7&quot; &amp;:: Enterprise</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e14997e7-800a-4cf7-ad10-de4b45b578db</span><br><span class="line">set &quot;_key=JMNMF%yh%RHW7P%yh%DMY6X%yh%RF3DR%yh%X2BQT&quot; &amp;:: Enterprise N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:10018baf-ce21-4060-80bd-47fe74ed4dab</span><br><span class="line">set &quot;_key=RYXVT%yh%BNQG7%yh%VD29F%yh%DBMRY%yh%HT73M&quot; &amp;:: Embedded Industry Pro</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:18db1848-12e0-4167-b9d7-da7fcda507db</span><br><span class="line">set &quot;_key=NKB3R%yh%R2F8T%yh%3XCDP%yh%7Q2KW%yh%XWYQ2&quot; &amp;:: Embedded Industry Enterprise</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows Server 2012</span><br><span class="line">:f0f5ec41-0d55-4732-af02-440a44a3cf0f</span><br><span class="line">set &quot;_key=XC9B7%yh%NBPP2%yh%83J2H%yh%RHMBY%yh%92BT4&quot; &amp;:: Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:d3643d60-0c42-412d-a7d6-52e6635327f6</span><br><span class="line">set &quot;_key=48HP8%yh%DN98B%yh%MYWDG%yh%T2DCC%yh%8W83P&quot; &amp;:: Datacenter</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:7d5486c7-e120-4771-b7f1-7b56c6d3170c</span><br><span class="line">set &quot;_key=HM7DN%yh%YVMH3%yh%46JC3%yh%XYTG7%yh%CYQJJ&quot; &amp;:: MultiPoint Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:95fd1c83-7df5-494a-be8b-1300e1c9d1cd</span><br><span class="line">set &quot;_key=XNH6W%yh%2V9GX%yh%RGJ4K%yh%Y8X6F%yh%QGJ2G&quot; &amp;:: MultiPoint Premium</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows 7</span><br><span class="line">:b92e9980-b9d5-4821-9c94-140f632f6312</span><br><span class="line">set &quot;_key=FJ82H%yh%XT6CR%yh%J8D7P%yh%XQJJ2%yh%GPDD4&quot; &amp;:: Professional</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:54a09a0d-d57b-4c10-8b69-a842d6590ad5</span><br><span class="line">set &quot;_key=MRPKT%yh%YTG23%yh%K7D7T%yh%X2JMM%yh%QY7MG&quot; &amp;:: Professional N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:5a041529-fef8-4d07-b06f-b59b573b32d2</span><br><span class="line">set &quot;_key=W82YF%yh%2Q76Y%yh%63HXB%yh%FGJG9%yh%GF7QX&quot; &amp;:: Professional E</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ae2ee509-1b34-41c0-acb7-6d4650168915</span><br><span class="line">set &quot;_key=33PXH%yh%7Y6KF%yh%2VJC9%yh%XBBR8%yh%HVTHH&quot; &amp;:: Enterprise</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:1cb6d605-11b3-4e14-bb30-da91c8e3983a</span><br><span class="line">set &quot;_key=YDRBP%yh%3D83W%yh%TY26F%yh%D46B2%yh%XCKRJ&quot; &amp;:: Enterprise N</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:46bbed08-9c7b-48fc-a614-95250573f4ea</span><br><span class="line">set &quot;_key=C29WB%yh%22CC8%yh%VJ326%yh%GHFJW%yh%H9DH4&quot; &amp;:: Enterprise E</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:db537896-376f-48ae-a492-53d0547773d0</span><br><span class="line">set &quot;_key=YBYF6%yh%BHCR3%yh%JPKRB%yh%CDW7B%yh%F9BK4&quot; &amp;:: Embedded POSReady 7</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e1a8296a-db37-44d1-8cce-7bc961d59c54</span><br><span class="line">set &quot;_key=XGY72%yh%BRBBT%yh%FF8MH%yh%2GG8H%yh%W7KCW&quot; &amp;:: Embedded Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:aa6dd3aa-c2b4-40e2-a544-a6bbb3f5c395</span><br><span class="line">set &quot;_key=73KQT%yh%CD9G6%yh%K7TQG%yh%66MRP%yh%CQ22C&quot; &amp;:: Embedded ThinPC</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Windows Server 2008 R2</span><br><span class="line">:a78b8bd9-8017-4df5-b86a-09f756affa7c</span><br><span class="line">set &quot;_key=6TPJF%yh%RBVHG%yh%WBW2R%yh%86QPH%yh%6RTM4&quot; &amp;:: Web</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:cda18cf3-c196-46ad-b289-60c072869994</span><br><span class="line">set &quot;_key=TT8MH%yh%CG224%yh%D3D7Q%yh%498W2%yh%9QCTX&quot; &amp;:: HPC</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:68531fb9-5511-4989-97be-d11a0f55633f</span><br><span class="line">set &quot;_key=YC6KT%yh%GKW9T%yh%YTKYR%yh%T4X34%yh%R7VHC&quot; &amp;:: Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:7482e61b-c589-4b7f-8ecc-46d455ac3b87</span><br><span class="line">set &quot;_key=74YFP%yh%3QFB3%yh%KQT8W%yh%PMXWJ%yh%7M648&quot; &amp;:: Datacenter</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:620e2b3d-09e7-42fd-802a-17a13652fe7a</span><br><span class="line">set &quot;_key=489J6%yh%VHDMP%yh%X63PK%yh%3K798%yh%CPX3Y&quot; &amp;:: Enterprise</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:8a26851c-1c7e-48d3-a687-fbca9b9ac16b</span><br><span class="line">set &quot;_key=GT63C%yh%RJFQ3%yh%4GMB6%yh%BRFB9%yh%CB83V&quot; &amp;:: Itanium</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:f772515c-0e87-48d5-a676-e6962c3e1195</span><br><span class="line">set &quot;_key=736RG%yh%XDKJK%yh%V34PF%yh%BHK87%yh%J6X3K&quot; &amp;:: MultiPoint Server - ServerEmbeddedSolution</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Office 2021</span><br><span class="line">:fbdb3e18-a8ef-4fb3-9183-dffd60bd0984</span><br><span class="line">set &quot;_key=FXYTK%yh%NJJ8C%yh%GB6DW%yh%3DYQT%yh%6F7TH&quot; &amp;:: Professional Plus</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:080a45c5-9f9f-49eb-b4b0-c3c610a5ebd3</span><br><span class="line">set &quot;_key=KDX7X%yh%BNVR8%yh%TXXGX%yh%4Q7Y8%yh%78VT3&quot; &amp;:: Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:76881159-155c-43e0-9db7-2d70a9a3a4ca</span><br><span class="line">set &quot;_key=FTNWT%yh%C6WBT%yh%8HMGF%yh%K9PRX%yh%QV9H8&quot; &amp;:: Project Professional</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:6dd72704-f752-4b71-94c7-11cec6bfc355</span><br><span class="line">set &quot;_key=J2JDC%yh%NJCYY%yh%9RGQ4%yh%YXWMH%yh%T3D4T&quot; &amp;:: Project Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:fb61ac9a-1688-45d2-8f6b-0674dbffa33c</span><br><span class="line">set &quot;_key=KNH8D%yh%FGHT4%yh%T8RK3%yh%CTDYJ%yh%K2HT4&quot; &amp;:: Visio Professional</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:72fce797-1884-48dd-a860-b2f6a5efd3ca</span><br><span class="line">set &quot;_key=MJVNY%yh%BYWPY%yh%CWV6J%yh%2RKRT%yh%4M8QG&quot; &amp;:: Visio Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:1fe429d8-3fa7-4a39-b6f0-03dded42fe14</span><br><span class="line">set &quot;_key=WM8YG%yh%YNGDD%yh%4JHDC%yh%PG3F4%yh%FC4T4&quot; &amp;:: Access</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ea71effc-69f1-4925-9991-2f5e319bbc24</span><br><span class="line">set &quot;_key=NWG3X%yh%87C9K%yh%TC7YY%yh%BC2G7%yh%G6RVC&quot; &amp;:: Excel</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:a5799e4c-f83c-4c6e-9516-dfe9b696150b</span><br><span class="line">set &quot;_key=C9FM6%yh%3N72F%yh%HFJXB%yh%TM3V9%yh%T86R9&quot; &amp;:: Outlook</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:6e166cc3-495d-438a-89e7-d7c9e6fd4dea</span><br><span class="line">set &quot;_key=TY7XF%yh%NFRBR%yh%KJ44C%yh%G83KF%yh%GX27K&quot; &amp;:: PowerPoint</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:aa66521f-2370-4ad8-a2bb-c095e3e4338f</span><br><span class="line">set &quot;_key=2MW9D%yh%N4BXM%yh%9VBPG%yh%Q7W6M%yh%KFBGQ&quot; &amp;:: Publisher</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:1f32a9af-1274-48bd-ba1e-1ab7508a23e8</span><br><span class="line">set &quot;_key=HWCXN%yh%K3WBT%yh%WJBKY%yh%R8BD9%yh%XK29P&quot; &amp;:: Skype for Business</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:abe28aea-625a-43b1-8e30-225eb8fbd9e5</span><br><span class="line">set &quot;_key=TN8H9%yh%M34D3%yh%Y64V9%yh%TR72V%yh%X79KV&quot; &amp;:: Word</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Office 2019</span><br><span class="line">:85dd8b5f-eaa4-4af3-a628-cce9e77c9a03</span><br><span class="line">set &quot;_key=NMMKJ%yh%6RK4F%yh%KMJVX%yh%8D9MJ%yh%6MWKP&quot; &amp;:: Professional Plus</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:6912a74b-a5fb-401a-bfdb-2e3ab46f4b02</span><br><span class="line">set &quot;_key=6NWWJ%yh%YQWMR%yh%QKGCB%yh%6TMB3%yh%9D9HK&quot; &amp;:: Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:2ca2bf3f-949e-446a-82c7-e25a15ec78c4</span><br><span class="line">set &quot;_key=B4NPR%yh%3FKK7%yh%T2MBV%yh%FRQ4W%yh%PKD2B&quot; &amp;:: Project Professional</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:1777f0e3-7392-4198-97ea-8ae4de6f6381</span><br><span class="line">set &quot;_key=C4F7P%yh%NCP8C%yh%6CQPT%yh%MQHV9%yh%JXD2M&quot; &amp;:: Project Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:5b5cf08f-b81a-431d-b080-3450d8620565</span><br><span class="line">set &quot;_key=9BGNQ%yh%K37YR%yh%RQHF2%yh%38RQ3%yh%7VCBB&quot; &amp;:: Visio Professional</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e06d7df3-aad0-419d-8dfb-0ac37e2bdf39</span><br><span class="line">set &quot;_key=7TQNQ%yh%K3YQQ%yh%3PFH7%yh%CCPPM%yh%X4VQ2&quot; &amp;:: Visio Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:9e9bceeb-e736-4f26-88de-763f87dcc485</span><br><span class="line">set &quot;_key=9N9PT%yh%27V4Y%yh%VJ2PD%yh%YXFMF%yh%YTFQT&quot; &amp;:: Access</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:237854e9-79fc-4497-a0c1-a70969691c6b</span><br><span class="line">set &quot;_key=TMJWT%yh%YYNMB%yh%3BKTF%yh%644FC%yh%RVXBD&quot; &amp;:: Excel</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:c8f8a301-19f5-4132-96ce-2de9d4adbd33</span><br><span class="line">set &quot;_key=7HD7K%yh%N4PVK%yh%BHBCQ%yh%YWQRW%yh%XW4VK&quot; &amp;:: Outlook</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:3131fd61-5e4f-4308-8d6d-62be1987c92c</span><br><span class="line">set &quot;_key=RRNCX%yh%C64HY%yh%W2MM7%yh%MCH9G%yh%TJHMQ&quot; &amp;:: PowerPoint</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:9d3e4cca-e172-46f1-a2f4-1d2107051444</span><br><span class="line">set &quot;_key=G2KWX%yh%3NW6P%yh%PY93R%yh%JXK2T%yh%C9Y9V&quot; &amp;:: Publisher</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:734c6c6e-b0ba-4298-a891-671772b2bd1b</span><br><span class="line">set &quot;_key=NCJ33%yh%JHBBY%yh%HTK98%yh%MYCV8%yh%HMKHJ&quot; &amp;:: Skype for Business</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:059834fe-a8ea-4bff-b67b-4d006b5447d3</span><br><span class="line">set &quot;_key=PBX3G%yh%NWMT6%yh%Q7XBW%yh%PYJGG%yh%WXD33&quot; &amp;:: Word</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:0bc88885-718c-491d-921f-6f214349e79c</span><br><span class="line">set &quot;_key=VQ9DP%yh%NVHPH%yh%T9HJC%yh%J9PDT%yh%KTQRG&quot; &amp;:: Pro Plus 2019 Preview</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:fc7c4d0c-2e85-4bb9-afd4-01ed1476b5e9</span><br><span class="line">set &quot;_key=XM2V9%yh%DN9HH%yh%QB449%yh%XDGKC%yh%W2RMW&quot; &amp;:: Project Pro 2019 Preview</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:500f6619-ef93-4b75-bcb4-82819998a3ca</span><br><span class="line">set &quot;_key=N2CG9%yh%YD3YK%yh%936X4%yh%3WR82%yh%Q3X4H&quot; &amp;:: Visio Pro 2019 Preview</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:f3fb2d68-83dd-4c8b-8f09-08e0d950ac3b</span><br><span class="line">set &quot;_key=HFPBN%yh%RYGG8%yh%HQWCW%yh%26CH6%yh%PDPVF&quot; &amp;:: Pro Plus 2021 Preview</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:76093b1b-7057-49d7-b970-638ebcbfd873</span><br><span class="line">set &quot;_key=WDNBY%yh%PCYFY%yh%9WP6G%yh%BXVXM%yh%92HDV&quot; &amp;:: Project Pro 2021 Preview</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:a3b44174-2451-4cd6-b25f-66638bfb9046</span><br><span class="line">set &quot;_key=2XYX7%yh%NXXBK%yh%9CK7W%yh%K2TKW%yh%JFJ7G&quot; &amp;:: Visio Pro 2021 Preview</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Office 2016</span><br><span class="line">:829b8110-0e6f-4349-bca4-42803577788d</span><br><span class="line">set &quot;_key=WGT24%yh%HCNMF%yh%FQ7XH%yh%6M8K7%yh%DRTW9&quot; &amp;:: Project Professional C2R-P</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:cbbaca45-556a-4416-ad03-bda598eaa7c8</span><br><span class="line">set &quot;_key=D8NRQ%yh%JTYM3%yh%7J2DX%yh%646CT%yh%6836M&quot; &amp;:: Project Standard C2R-P</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:b234abe3-0857-4f9c-b05a-4dc314f85557</span><br><span class="line">set &quot;_key=69WXN%yh%MBYV6%yh%22PQG%yh%3WGHK%yh%RM6XC&quot; &amp;:: Visio Professional C2R-P</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:361fe620-64f4-41b5-ba77-84f8e079b1f7</span><br><span class="line">set &quot;_key=NY48V%yh%PPYYH%yh%3F4PX%yh%XJRKJ%yh%W4423&quot; &amp;:: Visio Standard C2R-P</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e914ea6e-a5fa-4439-a394-a9bb3293ca09</span><br><span class="line">set &quot;_key=DMTCJ%yh%KNRKX%yh%26982%yh%JYCKT%yh%P7KB6&quot; &amp;:: MondoR</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:9caabccb-61b1-4b4b-8bec-d10a3c3ac2ce</span><br><span class="line">set &quot;_key=HFTND%yh%W9MK4%yh%8B7MJ%yh%B6C4G%yh%XQBR2&quot; &amp;:: Mondo</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:d450596f-894d-49e0-966a-fd39ed4c4c64</span><br><span class="line">set &quot;_key=XQNVK%yh%8JYDB%yh%WJ9W3%yh%YJ8YR%yh%WFG99&quot; &amp;:: Professional Plus</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:dedfa23d-6ed1-45a6-85dc-63cae0546de6</span><br><span class="line">set &quot;_key=JNRGM%yh%WHDWX%yh%FJJG3%yh%K47QV%yh%DRTFM&quot; &amp;:: Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:4f414197-0fc2-4c01-b68a-86cbb9ac254c</span><br><span class="line">set &quot;_key=YG9NW%yh%3K39V%yh%2T3HJ%yh%93F3Q%yh%G83KT&quot; &amp;:: Project Professional</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:da7ddabc-3fbe-4447-9e01-6ab7440b4cd4</span><br><span class="line">set &quot;_key=GNFHQ%yh%F6YQM%yh%KQDGJ%yh%327XX%yh%KQBVC&quot; &amp;:: Project Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:6bf301c1-b94a-43e9-ba31-d494598c47fb</span><br><span class="line">set &quot;_key=PD3PC%yh%RHNGV%yh%FXJ29%yh%8JK7D%yh%RJRJK&quot; &amp;:: Visio Professional</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:aa2a7821-1827-4c2c-8f1d-4513a34dda97</span><br><span class="line">set &quot;_key=7WHWN%yh%4T7MP%yh%G96JF%yh%G33KR%yh%W8GF4&quot; &amp;:: Visio Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:67c0fc0c-deba-401b-bf8b-9c8ad8395804</span><br><span class="line">set &quot;_key=GNH9Y%yh%D2J4T%yh%FJHGG%yh%QRVH7%yh%QPFDW&quot; &amp;:: Access</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:c3e65d36-141f-4d2f-a303-a842ee756a29</span><br><span class="line">set &quot;_key=9C2PK%yh%NWTVB%yh%JMPW8%yh%BFT28%yh%7FTBF&quot; &amp;:: Excel</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:d8cace59-33d2-4ac7-9b1b-9b72339c51c8</span><br><span class="line">set &quot;_key=DR92N%yh%9HTF2%yh%97XKM%yh%XW2WJ%yh%XW3J6&quot; &amp;:: OneNote</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ec9d9265-9d1e-4ed0-838a-cdc20f2551a1</span><br><span class="line">set &quot;_key=R69KK%yh%NTPKF%yh%7M3Q4%yh%QYBHW%yh%6MT9B&quot; &amp;:: Outlook</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:d70b1bba-b893-4544-96e2-b7a318091c33</span><br><span class="line">set &quot;_key=J7MQP%yh%HNJ4Y%yh%WJ7YM%yh%PFYGF%yh%BY6C6&quot; &amp;:: Powerpoint</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:041a06cb-c5b8-4772-809f-416d03d16654</span><br><span class="line">set &quot;_key=F47MM%yh%N3XJP%yh%TQXJ9%yh%BP99D%yh%8K837&quot; &amp;:: Publisher</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:83e04ee1-fa8d-436d-8994-d31a862cab77</span><br><span class="line">set &quot;_key=869NQ%yh%FJ69K%yh%466HW%yh%QYCP2%yh%DDBV6&quot; &amp;:: Skype for Business</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:bb11badf-d8aa-470e-9311-20eaf80fe5cc</span><br><span class="line">set &quot;_key=WXY84%yh%JN2Q9%yh%RBCCQ%yh%3Q3J3%yh%3PFJ6&quot; &amp;:: Word</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Office 2013</span><br><span class="line">:dc981c6b-fc8e-420f-aa43-f8f33e5c0923</span><br><span class="line">set &quot;_key=42QTK%yh%RN8M7%yh%J3C4G%yh%BBGYM%yh%88CYV&quot; &amp;:: Mondo</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:b322da9c-a2e2-4058-9e4e-f59a6970bd69</span><br><span class="line">set &quot;_key=YC7DK%yh%G2NP3%yh%2QQC3%yh%J6H88%yh%GVGXT&quot; &amp;:: Professional Plus</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:b13afb38-cd79-4ae5-9f7f-eed058d750ca</span><br><span class="line">set &quot;_key=KBKQT%yh%2NMXY%yh%JJWGP%yh%M62JB%yh%92CD4&quot; &amp;:: Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:4a5d124a-e620-44ba-b6ff-658961b33b9a</span><br><span class="line">set &quot;_key=FN8TT%yh%7WMH6%yh%2D4X9%yh%M337T%yh%2342K&quot; &amp;:: Project Professional</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:427a28d1-d17c-4abf-b717-32c780ba6f07</span><br><span class="line">set &quot;_key=6NTH3%yh%CW976%yh%3G3Y2%yh%JK3TX%yh%8QHTT&quot; &amp;:: Project Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e13ac10e-75d0-4aff-a0cd-764982cf541c</span><br><span class="line">set &quot;_key=C2FG9%yh%N6J68%yh%H8BTJ%yh%BW3QX%yh%RM3B3&quot; &amp;:: Visio Professional</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ac4efaf0-f81f-4f61-bdf7-ea32b02ab117</span><br><span class="line">set &quot;_key=J484Y%yh%4NKBF%yh%W2HMG%yh%DBMJC%yh%PGWR7&quot; &amp;:: Visio Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:6ee7622c-18d8-4005-9fb7-92db644a279b</span><br><span class="line">set &quot;_key=NG2JY%yh%H4JBT%yh%HQXYP%yh%78QH9%yh%4JM2D&quot; &amp;:: Access</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:f7461d52-7c2b-43b2-8744-ea958e0bd09a</span><br><span class="line">set &quot;_key=VGPNG%yh%Y7HQW%yh%9RHP7%yh%TKPV3%yh%BG7GB&quot; &amp;:: Excel</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:fb4875ec-0c6b-450f-b82b-ab57d8d1677f</span><br><span class="line">set &quot;_key=H7R7V%yh%WPNXQ%yh%WCYYC%yh%76BGV%yh%VT7GH&quot; &amp;:: Groove</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:a30b8040-d68a-423f-b0b5-9ce292ea5a8f</span><br><span class="line">set &quot;_key=DKT8B%yh%N7VXH%yh%D963P%yh%Q4PHY%yh%F8894&quot; &amp;:: InfoPath</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:1b9f11e3-c85c-4e1b-bb29-879ad2c909e3</span><br><span class="line">set &quot;_key=2MG3G%yh%3BNTT%yh%3MFW9%yh%KDQW3%yh%TCK7R&quot; &amp;:: Lync</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:efe1f3e6-aea2-4144-a208-32aa872b6545</span><br><span class="line">set &quot;_key=TGN6P%yh%8MMBC%yh%37P2F%yh%XHXXK%yh%P34VW&quot; &amp;:: OneNote</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:771c3afa-50c5-443f-b151-ff2546d863a0</span><br><span class="line">set &quot;_key=QPN8Q%yh%BJBTJ%yh%334K3%yh%93TGY%yh%2PMBT&quot; &amp;:: Outlook</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:8c762649-97d1-4953-ad27-b7e2c25b972e</span><br><span class="line">set &quot;_key=4NT99%yh%8RJFH%yh%Q2VDH%yh%KYG2C%yh%4RD4F&quot; &amp;:: Powerpoint</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:00c79ff1-6850-443d-bf61-71cde0de305f</span><br><span class="line">set &quot;_key=PN2WF%yh%29XG2%yh%T9HJ7%yh%JQPJR%yh%FCXK4&quot; &amp;:: Publisher</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:d9f5b1c6-5386-495a-88f9-9ad6b41ac9b3</span><br><span class="line">set &quot;_key=6Q7VD%yh%NX8JD%yh%WJ2VH%yh%88V73%yh%4GBJ7&quot; &amp;:: Word</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:: Office 2010</span><br><span class="line">:09ed9640-f020-400a-acd8-d7d867dfd9c2</span><br><span class="line">set &quot;_key=YBJTT%yh%JG6MD%yh%V9Q7P%yh%DBKXJ%yh%38W9R&quot; &amp;:: Mondo</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ef3d4e49-a53d-4d81-a2b1-2ca6c2556b2c</span><br><span class="line">set &quot;_key=7TC2V%yh%WXF6P%yh%TD7RT%yh%BQRXR%yh%B8K32&quot; &amp;:: Mondo2</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:6f327760-8c5c-417c-9b61-836a98287e0c</span><br><span class="line">set &quot;_key=VYBBJ%yh%TRJPB%yh%QFQRF%yh%QFT4D%yh%H3GVB&quot; &amp;:: Professional Plus</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:9da2a678-fb6b-4e67-ab84-60dd6a9c819a</span><br><span class="line">set &quot;_key=V7QKV%yh%4XVVR%yh%XYV4D%yh%F7DFM%yh%8R6BM&quot; &amp;:: Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:df133ff7-bf14-4f95-afe3-7b48e7e331ef</span><br><span class="line">set &quot;_key=YGX6F%yh%PGV49%yh%PGW3J%yh%9BTGG%yh%VHKC6&quot; &amp;:: Project Professional</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:5dc7bf61-5ec9-4996-9ccb-df806a2d0efe</span><br><span class="line">set &quot;_key=4HP3K%yh%88W3F%yh%W2K3D%yh%6677X%yh%F9PGB&quot; &amp;:: Project Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:92236105-bb67-494f-94c7-7f7a607929bd</span><br><span class="line">set &quot;_key=D9DWC%yh%HPYVV%yh%JGF4P%yh%BTWQB%yh%WX8BJ&quot; &amp;:: Visio Premium</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:e558389c-83c3-4b29-adfe-5e4d7f46c358</span><br><span class="line">set &quot;_key=7MCW8%yh%VRQVK%yh%G677T%yh%PDJCM%yh%Q8TCP&quot; &amp;:: Visio Professional</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:9ed833ff-4f92-4f36-b370-8683a4f13275</span><br><span class="line">set &quot;_key=767HD%yh%QGMWX%yh%8QTDB%yh%9G3R2%yh%KHFGJ&quot; &amp;:: Visio Standard</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:8ce7e872-188c-4b98-9d90-f8f90b7aad02</span><br><span class="line">set &quot;_key=V7Y44%yh%9T38C%yh%R2VJK%yh%666HK%yh%T7DDX&quot; &amp;:: Access</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:cee5d470-6e3b-4fcc-8c2b-d17428568a9f</span><br><span class="line">set &quot;_key=H62QG%yh%HXVKF%yh%PP4HP%yh%66KMR%yh%CW9BM&quot; &amp;:: Excel</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:8947d0b8-c33b-43e1-8c56-9b674c052832</span><br><span class="line">set &quot;_key=QYYW6%yh%QP4CB%yh%MBV6G%yh%HYMCJ%yh%4T3J4&quot; &amp;:: Groove - SharePoint Workspace</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ca6b6639-4ad6-40ae-a575-14dee07f6430</span><br><span class="line">set &quot;_key=K96W8%yh%67RPQ%yh%62T9Y%yh%J8FQJ%yh%BT37T&quot; &amp;:: InfoPath</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ab586f5c-5256-4632-962f-fefd8b49e6f4</span><br><span class="line">set &quot;_key=Q4Y4M%yh%RHWJM%yh%PY37F%yh%MTKWH%yh%D3XHX&quot; &amp;:: OneNote</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ecb7c192-73ab-4ded-acf4-2399b095d0cc</span><br><span class="line">set &quot;_key=7YDC2%yh%CWM8M%yh%RRTJC%yh%8MDVC%yh%X3DWQ&quot; &amp;:: Outlook</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:45593b1d-dfb1-4e91-bbfb-2d5d0ce2227a</span><br><span class="line">set &quot;_key=RC8FX%yh%88JRY%yh%3PF7C%yh%X8P67%yh%P4VTT&quot; &amp;:: Powerpoint</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:b50c4f75-599b-43e8-8dcd-1081a7967241</span><br><span class="line">set &quot;_key=BFK7F%yh%9MYHM%yh%V68C7%yh%DRQ66%yh%83YTP&quot; &amp;:: Publisher</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:2d0882e7-a4e7-423b-8ccc-70d91e0158b1</span><br><span class="line">set &quot;_key=HVHB3%yh%C6FV7%yh%KQX9W%yh%YQG79%yh%CRY7T&quot; &amp;:: Word</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:ea509e87-07a1-4a45-9edc-eba5a39f36af</span><br><span class="line">set &quot;_key=D6QFG%yh%VBYP2%yh%XQHM7%yh%J97RH%yh%VVRCK&quot; &amp;:: Small Business Basics</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:TheEnd</span><br><span class="line"></span><br><span class="line">if %act_failed% EQU 1 (</span><br><span class="line">echo ____________________________________________________________________</span><br><span class="line">echo.</span><br><span class="line">call :_errorinfo</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not defined _tskinstalled if not defined _oldtsk (</span><br><span class="line">echo.</span><br><span class="line">if %winbuild% GEQ 9200 (</span><br><span class="line">call :leavenonexistentkms %nul%</span><br><span class="line">echo Keeping the non-existent IP address 10.0.0.10 as KMS Server.</span><br><span class="line">) else (</span><br><span class="line">call :Clear-KMS-Cache</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not [%Act_OK%]==[1] (</span><br><span class="line">echo.</span><br><span class="line">echo In case of any issues, check https://mass%-%grave.dev/troubleshoot</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined _unattended exit /b</span><br><span class="line"></span><br><span class="line">echo ____________________________________________________________________</span><br><span class="line">echo.</span><br><span class="line">call :_color %_Yellow% &quot;按任意键返回...&quot;</span><br><span class="line">pause &gt;nul</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:_errorinfo</span><br><span class="line"></span><br><span class="line">call :CheckFR</span><br><span class="line"></span><br><span class="line">set _intcon=</span><br><span class="line">for %%a in (l.root-servers.net resolver1.opendns.com download.windowsupdate.com google.com) do if not defined _intcon (</span><br><span class="line">for /f &quot;delims=[] tokens=2&quot; %%# in (&#x27;ping -n 1 %%a&#x27;) do (if not [%%#]==[] set _intcon=1)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not defined _intcon (</span><br><span class="line">call :_color %_Red% &quot;网络未连接&quot;</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if [%ERRORCODE%]==[-1073418124] (</span><br><span class="line">echo Checking Port 1688 connection, it may take a while...</span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">set /a count=0</span><br><span class="line">set _portcon=</span><br><span class="line">for %%a in (%srvlist%) do if not defined _portcon if !count! LEQ 7 (</span><br><span class="line">set /a count+=1</span><br><span class="line">%psc% &quot;$t = New-Object Net.Sockets.TcpClient;try&#123;$t.Connect(&quot;&quot;&quot;%%a&quot;&quot;&quot;, 1688)&#125;catch&#123;&#125;;$t.Connected&quot; | findstr /i true 1&gt;nul &amp;&amp; set _portcon=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not defined _portcon (</span><br><span class="line">call :_color %Red% &quot;1688端口在您的连接中被阻止。&quot;</span><br><span class="line">echo.</span><br><span class="line">echo Reason:   Probably restricted Internet [Office/College] is connected,</span><br><span class="line">echo           or Firewall is blocking the connection.</span><br><span class="line">echo.</span><br><span class="line">echo Solution: Either use another Internet connection or use offline KMS</span><br><span class="line">echo           https://github.com/abbodi1406/KMS_VL_ALL_AIO</span><br><span class="line">) else (</span><br><span class="line">echo Port 1688 connection test is passed.</span><br><span class="line">echo.</span><br><span class="line">echo Make sure system files are not blocked by your firewall.</span><br><span class="line">echo If the issue persists, try offline KMS</span><br><span class="line">echo https://github.com/abbodi1406/KMS_VL_ALL_AIO</span><br><span class="line">)</span><br><span class="line">echo.</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo KMS server is not an issue in this case.</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:setserv</span><br><span class="line"></span><br><span class="line">::  Multi KMS servers integration and servers randomization</span><br><span class="line"></span><br><span class="line">set srvlist=</span><br><span class="line">set -=</span><br><span class="line"></span><br><span class="line">set &quot;srvlist=kms.zhu%-%xiaole.org kms-default.cangs%-%hui.net kms.six%-%yin.com kms.moe%-%club.org kms.cgt%-%soft.com&quot;</span><br><span class="line">set &quot;srvlist=%srvlist% kms.id%-%ina.cn kms.moe%-%yuuko.com xinch%-%eng213618.cn kms.wl%-%rxy.cn kms.ca%-%tqu.com&quot;</span><br><span class="line">set &quot;srvlist=%srvlist% kms.0%-%t.net.cn kms.its%-%jzx.com kms.wx%-%lost.com kms.moe%-%yuuko.top kms.gh%-%pym.com&quot;</span><br><span class="line"></span><br><span class="line">set n=1</span><br><span class="line">for %%a in (%srvlist%) do (set %%a=&amp;set server!n!=%%a&amp;set /a n+=1)</span><br><span class="line">set max_servers=15</span><br><span class="line">set /a server_num=0</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:getserv</span><br><span class="line"></span><br><span class="line">if %server_num% equ %max_servers% set /a server_num+=1&amp;set KMS_IP=222.184.9.98&amp;exit /b</span><br><span class="line">set /a rand=%Random%%%(15+1-1)+1</span><br><span class="line">if defined !server%rand%! goto :getserv</span><br><span class="line">set KMS_IP=!server%rand%!</span><br><span class="line">set !server%rand%!=1</span><br><span class="line"></span><br><span class="line">::  Get IPv4 address of KMS server to use for the activation, works even if ICMP echo is disabled.</span><br><span class="line">::  Microsoft and Antivirus&#x27;s may flag the issue if public KMS server host name is directly used for the activation.</span><br><span class="line"></span><br><span class="line">set /a server_num+=1</span><br><span class="line">(for /f &quot;delims=[] tokens=2&quot; %%a in (&#x27;ping -4 -n 1 %KMS_IP% 2^&gt;nul&#x27;) do set &quot;KMS_IP=%%a&quot;</span><br><span class="line">if [%KMS_IP%]==[!KMS_IP!] for /f &quot;delims=[] tokens=2&quot; %%# in (&#x27;pathping -4 -h 1 -n -p 1 -q 1 -w 1 %KMS_IP% 2^&gt;nul&#x27;) do set &quot;KMS_IP=%%#&quot;</span><br><span class="line">if not [%KMS_IP%]==[!KMS_IP!] exit /b</span><br><span class="line">goto :getserv</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:==========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:Clear-KMS-Cache</span><br><span class="line"></span><br><span class="line">set OPPk=SOFTWARE\Microsoft\OfficeSoftwareProtectionPlatform</span><br><span class="line">set SPPk=SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform</span><br><span class="line"></span><br><span class="line">set _wApp=55c92734-d682-4d71-983e-d6ec3f16059f</span><br><span class="line">set _oApp=0ff1ce15-a989-479d-af46-f275c6370663</span><br><span class="line">set _oA14=59a52881-a989-479d-af46-f275c6370663</span><br><span class="line"></span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServiceName</span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServicePort</span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%&quot; /f /v DisableDnsPublishing</span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%&quot; /f /v DisableKeyManagementServiceHostCaching</span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%\%_wApp%&quot; /f</span><br><span class="line">if %winbuild% GEQ 9200 (</span><br><span class="line">if defined notx86 (</span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServiceName /reg:32</span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServicePort /reg:32</span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%\%_oApp%&quot; /f /reg:32</span><br><span class="line">)</span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%\%_oApp%&quot; /f</span><br><span class="line">)</span><br><span class="line">if %winbuild% GEQ 9600 (</span><br><span class="line">%nul% reg delete &quot;HKU\S-1-5-20\%SPPk%\%_wApp%&quot; /f</span><br><span class="line">%nul% reg delete &quot;HKU\S-1-5-20\%SPPk%\%_oApp%&quot; /f</span><br><span class="line">)</span><br><span class="line">%nul% reg delete &quot;HKLM\%OPPk%&quot; /f /v KeyManagementServiceName</span><br><span class="line">%nul% reg delete &quot;HKLM\%OPPk%&quot; /f /v KeyManagementServicePort</span><br><span class="line">%nul% reg delete &quot;HKLM\%OPPk%&quot; /f /v DisableDnsPublishing</span><br><span class="line">%nul% reg delete &quot;HKLM\%OPPk%&quot; /f /v DisableKeyManagementServiceHostCaching</span><br><span class="line">%nul% reg delete &quot;HKLM\%OPPk%\%_oA14%&quot; /f</span><br><span class="line">%nul% reg delete &quot;HKLM\%OPPk%\%_oApp%&quot; /f</span><br><span class="line"></span><br><span class="line">:: check KMS38 lock</span><br><span class="line"></span><br><span class="line">%nul% reg query &quot;HKLM\%SPPk%\%_wApp%&quot; &amp;&amp; (</span><br><span class="line">set error_=9</span><br><span class="line">echo Failed to completely clear KMS Cache.</span><br><span class="line">reg query &quot;HKLM\%SPPk%\%_wApp%&quot; /s 2&gt;nul | findstr /i &quot;127.0.0.2&quot; &gt;nul &amp;&amp; echo KMS38 activation is locked.</span><br><span class="line">) || (</span><br><span class="line">echo Cleared KMS Cache successfully.</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:=========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:leavenonexistentkms</span><br><span class="line"></span><br><span class="line">reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;10.0.0.10&quot;</span><br><span class="line">reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;1688&quot;</span><br><span class="line">reg delete &quot;HKLM\%SPPk%&quot; /f /v DisableDnsPublishing</span><br><span class="line">reg delete &quot;HKLM\%SPPk%&quot; /f /v DisableKeyManagementServiceHostCaching</span><br><span class="line">if not defined _keepkms38 reg delete &quot;HKLM\%SPPk%\%_wApp%&quot; /f</span><br><span class="line">if %winbuild% GEQ 9200 (</span><br><span class="line">if not %xOS%==x86 (</span><br><span class="line">reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;10.0.0.10&quot; /reg:32</span><br><span class="line">reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;1688&quot; /reg:32</span><br><span class="line">reg delete &quot;HKLM\%SPPk%\%_oApp%&quot; /f /reg:32</span><br><span class="line">reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;10.0.0.10&quot; /reg:32</span><br><span class="line">reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;1688&quot; /reg:32</span><br><span class="line">)</span><br><span class="line">reg delete &quot;HKLM\%SPPk%\%_oApp%&quot; /f</span><br><span class="line">reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;10.0.0.10&quot;</span><br><span class="line">reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;1688&quot;</span><br><span class="line">)</span><br><span class="line">if %winbuild% GEQ 9600 (</span><br><span class="line">reg delete &quot;HKU\S-1-5-20\%SPPk%\%_wApp%&quot; /f</span><br><span class="line">reg delete &quot;HKU\S-1-5-20\%SPPk%\%_oApp%&quot; /f</span><br><span class="line">)</span><br><span class="line">reg add &quot;HKLM\%OPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;10.0.0.10&quot;</span><br><span class="line">reg delete &quot;HKLM\%OPPk%&quot; /f /v KeyManagementServicePort</span><br><span class="line">reg delete &quot;HKLM\%OPPk%&quot; /f /v DisableDnsPublishing</span><br><span class="line">reg delete &quot;HKLM\%OPPk%&quot; /f /v DisableKeyManagementServiceHostCaching</span><br><span class="line">reg delete &quot;HKLM\%OPPk%\%_oA14%&quot; /f</span><br><span class="line">reg delete &quot;HKLM\%OPPk%\%_oApp%&quot; /f</span><br><span class="line">goto :eof</span><br><span class="line"></span><br><span class="line">:=========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:_Complete_Uninstall</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode con: cols=91 lines=30</span><br><span class="line">title 在线 KMS 卸载完成</span><br><span class="line"></span><br><span class="line">set &quot;key=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\taskcache\tasks&quot;</span><br><span class="line"></span><br><span class="line">set &quot;_C16R=&quot;</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\ClickToRun /v InstallPath&quot; 2^&gt;nul&#x27;) do if exist &quot;%%b\root\Licenses16\ProPlus*.xrm-ms&quot; set &quot;_C16R=1&quot;</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\ClickToRun /v InstallPath /reg:32&quot; 2^&gt;nul&#x27;) do if exist &quot;%%b\root\Licenses16\ProPlus*.xrm-ms&quot; set &quot;_C16R=1&quot;</span><br><span class="line">if %winbuild% GEQ 9200 if defined _C16R (</span><br><span class="line">echo.</span><br><span class="line">echo ## Notice ##</span><br><span class="line">echo.</span><br><span class="line">echo To make sure Office programs do not show a non-genuine banner,</span><br><span class="line">echo please run the activation option once, and don&#x27;t uninstall afterward.</span><br><span class="line">echo __________________________________________________________________________________________</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set error_=</span><br><span class="line">echo.</span><br><span class="line">call :Clear-KMS-Cache</span><br><span class="line">call :clearstuff</span><br><span class="line"></span><br><span class="line">if defined error_ (</span><br><span class="line">if [%error_%]==[1] (</span><br><span class="line">echo __________________________________________________________________________________________</span><br><span class="line">%eline%</span><br><span class="line">echo Try Again / Restart the System</span><br><span class="line">echo __________________________________________________________________________________________</span><br><span class="line">)</span><br><span class="line">) else (</span><br><span class="line">echo __________________________________________________________________________________________</span><br><span class="line">echo.</span><br><span class="line">call :_color %Green% &quot;在线 KMS 完全卸载已成功完成。&quot;</span><br><span class="line">echo __________________________________________________________________________________________</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined _unattended timeout /t 2 &amp; exit /b</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line">call :_color %_Yellow% &quot;按任意键返回...&quot;</span><br><span class="line">pause &gt;nul</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:clearstuff</span><br><span class="line"></span><br><span class="line">reg query &quot;%key%&quot; /f Path /s | find /i &quot;\Activation-Renewal&quot; &gt;nul &amp;&amp; (</span><br><span class="line">echo Deleting [Task] Activation-Renewal</span><br><span class="line">schtasks /delete /tn Activation-Renewal /f %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">reg query &quot;%key%&quot; /f Path /s | find /i &quot;\Activation-Run_Once&quot; &gt;nul &amp;&amp; (</span><br><span class="line">echo Deleting [Task] Activation-Run_Once</span><br><span class="line">schtasks /delete /tn Activation-Run_Once /f %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">reg query &quot;%key%&quot; /f Path /s | find /i &quot;\Online_KMS_Activation_Script-Renewal&quot; &gt;nul &amp;&amp; (</span><br><span class="line">echo Deleting [Task] Online_KMS_Activation_Script-Renewal</span><br><span class="line">schtasks /delete /tn Online_KMS_Activation_Script-Renewal /f %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">reg query &quot;%key%&quot; /f Path /s | find /i &quot;\Online_KMS_Activation_Script-Run_Once&quot; &gt;nul &amp;&amp; (</span><br><span class="line">echo Deleting [Task] Online_KMS_Activation_Script-Run_Once</span><br><span class="line">schtasks /delete /tn Online_KMS_Activation_Script-Run_Once /f %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">If exist &quot;%windir%\Online_KMS_Activation_Script\&quot; (</span><br><span class="line">echo Deleting [Folder] %windir%\Online_KMS_Activation_Script\</span><br><span class="line">rmdir /s /q &quot;%windir%\Online_KMS_Activation_Script\&quot; %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if exist &quot;%ProgramData%\Online_KMS_Activation.cmd&quot; (</span><br><span class="line">echo Deleting [File] %ProgramData%\Online_KMS_Activation.cmd</span><br><span class="line">del /f /q &quot;%ProgramData%\Online_KMS_Activation.cmd&quot; %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">If exist &quot;%ProgramData%\Online_KMS_Activation\&quot; (</span><br><span class="line">echo Deleting [Folder] %ProgramData%\Online_KMS_Activation\</span><br><span class="line">rmdir /s /q &quot;%ProgramData%\Online_KMS_Activation\&quot; %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">If exist &quot;%ProgramData%\Activation-Renewal\&quot; (</span><br><span class="line">echo Deleting [Folder] %ProgramData%\Activation-Renewal\</span><br><span class="line">rmdir /s /q &quot;%ProgramData%\Activation-Renewal\&quot; %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">If exist &quot;%ProgramFiles%\Activation-Renewal\&quot; (</span><br><span class="line">echo Deleting [Folder] %ProgramFiles%\Activation-Renewal\</span><br><span class="line">rmdir /s /q &quot;%ProgramFiles%\Activation-Renewal\&quot; %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">reg query &quot;HKCR\DesktopBackground\shell\Activate Windows - Office&quot; %nul% &amp;&amp; (</span><br><span class="line">echo Deleting [Registry] HKCR\DesktopBackground\shell\Activate Windows - Office</span><br><span class="line">Reg delete &quot;HKCR\DesktopBackground\shell\Activate Windows - Office&quot; /f %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">reg query &quot;%key%&quot; /f Path /s | find /i &quot;\Activation-Renewal&quot; &gt;nul &amp;&amp; (set error_=1)</span><br><span class="line">reg query &quot;%key%&quot; /f Path /s | find /i &quot;\Activation-Run_Once&quot; &gt;nul &amp;&amp; (set error_=1)</span><br><span class="line">reg query &quot;%key%&quot; /f Path /s | find /i &quot;\Online_KMS_Activation_Script&quot; &gt;nul &amp;&amp; (set error_=1)</span><br><span class="line">If exist &quot;%windir%\Online_KMS_Activation_Script\&quot; (set error_=1)</span><br><span class="line">reg query &quot;HKCR\DesktopBackground\shell\Activate Windows - Office&quot; %nul% &amp;&amp; (set error_=1)</span><br><span class="line">if exist &quot;%ProgramData%\Online_KMS_Activation.cmd&quot; (set error_=1)</span><br><span class="line">if exist &quot;%ProgramData%\Online_KMS_Activation\&quot; (set error_=1)</span><br><span class="line">if exist &quot;%ProgramData%\Activation-Renewal\&quot; (set error_=1)</span><br><span class="line">if exist &quot;%ProgramFiles%\Activation-Renewal\&quot; (set error_=1)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:=========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:RenTask</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode con cols=91 lines=30</span><br><span class="line">title  安装 自动永久激活</span><br><span class="line"></span><br><span class="line">set error_=</span><br><span class="line">set &quot;_dest=%ProgramFiles%\Activation-Renewal&quot;</span><br><span class="line">set &quot;key=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\taskcache\tasks&quot;</span><br><span class="line"></span><br><span class="line">call :clearstuff %nul%</span><br><span class="line"></span><br><span class="line">if defined error_ (</span><br><span class="line">%eline%</span><br><span class="line">echo Failed to completely clear KMS related folders/tasks.</span><br><span class="line">echo Run the Uninstall option and then try again.</span><br><span class="line">goto :RenDone</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not exist &quot;%_dest%\&quot; md &quot;%_dest%\&quot; %nul%</span><br><span class="line">set &quot;_temp=%SystemRoot%\Temp\_taskwork_%Random%&quot;</span><br><span class="line"></span><br><span class="line">set nil=</span><br><span class="line">if exist &quot;%_temp%\.*&quot; rmdir /s /q &quot;%_temp%\&quot; %nul%</span><br><span class="line">md &quot;%_temp%\&quot; %nul%</span><br><span class="line">call :RenExport renewal &quot;%_temp%\Renewal.xml&quot; Unicode</span><br><span class="line">if defined ActTask (call :RenExport run_once &quot;%_temp%\Run_Once.xml&quot; Unicode)</span><br><span class="line">s%nil%cht%nil%asks /cre%nil%ate /tn &quot;Activation-Renewal&quot; /ru &quot;SYS%nil%TEM&quot; /xml &quot;%_temp%\Renewal.xml&quot; %nul%</span><br><span class="line">if defined ActTask (s%nil%cht%nil%asks /cre%nil%ate /tn &quot;Activation-Run_Once&quot; /ru &quot;SYS%nil%TEM&quot; /xml &quot;%_temp%\Run_Once.xml&quot; %nul%)</span><br><span class="line">if exist &quot;%_temp%\.*&quot; rmdir /s /q &quot;%_temp%\&quot; %nul%</span><br><span class="line"></span><br><span class="line">call :createInfo.txt</span><br><span class="line">%psc% &quot;$f=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split \&quot;:_extracttask\:.*`r`n\&quot;; [io.file]::WriteAllText(&#x27;%_dest%\Activation_task.cmd&#x27;, &#x27;@REM Dummy &#x27; + &#x27;%random%&#x27; + [Environment]::NewLine + $f[1].Trim(), [System.Text.Encoding]::ASCII);&quot;</span><br><span class="line">title  安装 自动永久激活</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">reg query &quot;%key%&quot; /f Path /s | find /i &quot;\Activation-Renewal&quot; &gt;nul || (set error_=1)</span><br><span class="line">if defined ActTask reg query &quot;%key%&quot; /f Path /s | find /i &quot;\Activation-Run_Once&quot; &gt;nul || (set error_=1)</span><br><span class="line"></span><br><span class="line">If not exist &quot;%_dest%\Activation_task.cmd&quot; (set error_=1)</span><br><span class="line">If not exist &quot;%_dest%\Info.txt&quot; (set error_=1)</span><br><span class="line"></span><br><span class="line">if defined error_ (</span><br><span class="line"></span><br><span class="line">reg query &quot;%key%&quot; /f Path /s | find /i &quot;\Activation-Renewal&quot; &gt;nul &amp;&amp; (</span><br><span class="line">schtasks /delete /tn Activation-Renewal /f %nul%</span><br><span class="line">)</span><br><span class="line">reg query &quot;%key%&quot; /f Path /s | find /i &quot;\Activation-Run_Once&quot; &gt;nul &amp;&amp; (</span><br><span class="line">schtasks /delete /tn Activation-Run_Once /f %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">If exist &quot;%_dest%\&quot; (</span><br><span class="line">rmdir /s /q &quot;%_dest%\&quot; %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">%eline%</span><br><span class="line">echo Run the Uninstall option and then try again.</span><br><span class="line">goto :RenDone</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo __________________________________________________________________________________________</span><br><span class="line">echo.</span><br><span class="line">echo Files created:</span><br><span class="line">echo %_dest%\Activation_task.cmd</span><br><span class="line">echo %_dest%\Info.txt</span><br><span class="line">echo.</span><br><span class="line">(if defined ActTask (echo Scheduled Tasks created:) else (echo Scheduled Task created:))</span><br><span class="line">echo \Activation-Renewal [Weekly]</span><br><span class="line">if defined ActTask (echo \Activation-Run_Once)</span><br><span class="line">echo __________________________________________________________________________________________</span><br><span class="line">echo.</span><br><span class="line">echo Info:</span><br><span class="line">echo Activation will be renewed every week if the Internet connection is found.</span><br><span class="line">echo It&#x27;ll only renew installed KMS licenses. It won&#x27;t convert any license to KMS.</span><br><span class="line">echo __________________________________________________________________________________________</span><br><span class="line">echo.</span><br><span class="line">if defined ActTask (</span><br><span class="line">call :_color %Green% &quot;已成功创建续订和激活任务。&quot;</span><br><span class="line">) else (</span><br><span class="line">call :_color %Green% &quot;已成功创建续订任务。&quot;</span><br><span class="line">)</span><br><span class="line">echo.</span><br><span class="line">call :_color %Gray% &quot;请确保至少运行过一次激活选项。&quot;</span><br><span class="line">echo __________________________________________________________________________________________</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:RenDone</span><br><span class="line"></span><br><span class="line">if defined _unattended exit /b</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line">call :_color %_Yellow% &quot;按任意键返回...&quot;</span><br><span class="line">pause &gt;nul</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:createInfo.txt</span><br><span class="line"></span><br><span class="line">(</span><br><span class="line">echo   The use of this script is to renew your Windows/Office KMS license using online KMS.</span><br><span class="line">echo:</span><br><span class="line">echo   If renewal/activation Scheduled tasks were created then following would exist,</span><br><span class="line">echo:</span><br><span class="line">echo   - Scheduled tasks</span><br><span class="line">echo     Activation-Renewal    [Renewal / Weekly]</span><br><span class="line">echo     Activation-Run_Once   [Activation Task - deletes itself once activated]</span><br><span class="line">echo     The scheduled tasks runs only if the system is connected to the Internet.</span><br><span class="line">echo:</span><br><span class="line">echo   - Files</span><br><span class="line">echo     C:\Program Files\Activation-Renewal\Activation_task.cmd</span><br><span class="line">echo     C:\Program Files\Activation-Renewal\Info.txt</span><br><span class="line">echo     C:\Program Files\Activation-Renewal\Logs.txt</span><br><span class="line">echo ______________________________________________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">echo   Online KMS Activation Script is a part of &#x27;微软激活脚本【由feifei汉化】&#x27; [MAS] project.</span><br><span class="line">echo:   </span><br><span class="line">echo   Homepage: mass grave[.]dev</span><br><span class="line">echo      Email: windowsaddict@protonmail.com</span><br><span class="line">)&gt;&quot;%_dest%\Info.txt&quot;</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:renewal:</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-16&quot;?&gt;</span><br><span class="line">&lt;Task version=&quot;1.3&quot; xmlns=&quot;http://schemas.microsoft.com/windows/2004/02/mit/task&quot;&gt;</span><br><span class="line">  &lt;RegistrationInfo&gt;</span><br><span class="line">    &lt;Source&gt;Microsoft Corporation&lt;/Source&gt;</span><br><span class="line">    &lt;Date&gt;1999-01-01T12:00:00.34375&lt;/Date&gt;</span><br><span class="line">    &lt;Author&gt;WindowsAddict&lt;/Author&gt;</span><br><span class="line">    &lt;Version&gt;1.0&lt;/Version&gt;</span><br><span class="line">    &lt;Description&gt;Online K-M-S Activation-Renewal - Weekly Task&lt;/Description&gt;</span><br><span class="line">    &lt;URI&gt;\Activation-Renewal&lt;/URI&gt;</span><br><span class="line">    &lt;SecurityDescriptor&gt;D:P(A;;FA;;;SY)(A;;FA;;;BA)(A;;FRFX;;;LS)(A;;FRFW;;;S-1-5-80-123231216-2592883651-3715271367-3753151631-4175906628)(A;;FR;;;S-1-5-4)&lt;/SecurityDescriptor&gt;</span><br><span class="line">  &lt;/RegistrationInfo&gt;</span><br><span class="line">  &lt;Triggers&gt;</span><br><span class="line">    &lt;CalendarTrigger&gt;</span><br><span class="line">      &lt;StartBoundary&gt;1999-01-01T12:00:00&lt;/StartBoundary&gt;</span><br><span class="line">      &lt;Enabled&gt;true&lt;/Enabled&gt;</span><br><span class="line">      &lt;ScheduleByWeek&gt;</span><br><span class="line">        &lt;DaysOfWeek&gt;</span><br><span class="line">          &lt;Sunday /&gt;</span><br><span class="line">        &lt;/DaysOfWeek&gt;</span><br><span class="line">        &lt;WeeksInterval&gt;1&lt;/WeeksInterval&gt;</span><br><span class="line">      &lt;/ScheduleByWeek&gt;</span><br><span class="line">    &lt;/CalendarTrigger&gt;</span><br><span class="line">  &lt;/Triggers&gt;</span><br><span class="line">  &lt;Principals&gt;</span><br><span class="line">    &lt;Principal id=&quot;LocalSystem&quot;&gt;</span><br><span class="line">      &lt;UserId&gt;S-1-5-18&lt;/UserId&gt;</span><br><span class="line">      &lt;RunLevel&gt;HighestAvailable&lt;/RunLevel&gt;</span><br><span class="line">    &lt;/Principal&gt;</span><br><span class="line">  &lt;/Principals&gt;</span><br><span class="line">  &lt;Settings&gt;</span><br><span class="line">    &lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;</span><br><span class="line">    &lt;DisallowStartIfOnBatteries&gt;false&lt;/DisallowStartIfOnBatteries&gt;</span><br><span class="line">    &lt;StopIfGoingOnBatteries&gt;false&lt;/StopIfGoingOnBatteries&gt;</span><br><span class="line">    &lt;AllowHardTerminate&gt;true&lt;/AllowHardTerminate&gt;</span><br><span class="line">    &lt;StartWhenAvailable&gt;true&lt;/StartWhenAvailable&gt;</span><br><span class="line">    &lt;RunOnlyIfNetworkAvailable&gt;true&lt;/RunOnlyIfNetworkAvailable&gt;</span><br><span class="line">    &lt;IdleSettings&gt;</span><br><span class="line">      &lt;StopOnIdleEnd&gt;false&lt;/StopOnIdleEnd&gt;</span><br><span class="line">      &lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt;</span><br><span class="line">    &lt;/IdleSettings&gt;</span><br><span class="line">    &lt;AllowStartOnDemand&gt;true&lt;/AllowStartOnDemand&gt;</span><br><span class="line">    &lt;Enabled&gt;true&lt;/Enabled&gt;</span><br><span class="line">    &lt;Hidden&gt;true&lt;/Hidden&gt;</span><br><span class="line">    &lt;RunOnlyIfIdle&gt;false&lt;/RunOnlyIfIdle&gt;</span><br><span class="line">    &lt;DisallowStartOnRemoteAppSession&gt;false&lt;/DisallowStartOnRemoteAppSession&gt;</span><br><span class="line">    &lt;UseUnifiedSchedulingEngine&gt;true&lt;/UseUnifiedSchedulingEngine&gt;</span><br><span class="line">    &lt;WakeToRun&gt;false&lt;/WakeToRun&gt;</span><br><span class="line">    &lt;ExecutionTimeLimit&gt;PT10M&lt;/ExecutionTimeLimit&gt;</span><br><span class="line">    &lt;Priority&gt;7&lt;/Priority&gt;</span><br><span class="line">    &lt;RestartOnFailure&gt;</span><br><span class="line">      &lt;Interval&gt;PT2M&lt;/Interval&gt;</span><br><span class="line">      &lt;Count&gt;3&lt;/Count&gt;</span><br><span class="line">    &lt;/RestartOnFailure&gt;</span><br><span class="line">  &lt;/Settings&gt;</span><br><span class="line">  &lt;Actions Context=&quot;LocalSystem&quot;&gt;</span><br><span class="line">    &lt;Exec&gt;</span><br><span class="line">      &lt;Command&gt;%ProgramFiles%\Activation-Renewal\Activation_task.cmd&lt;/Command&gt;</span><br><span class="line">    &lt;Arguments&gt;Task&lt;/Arguments&gt;</span><br><span class="line">    &lt;/Exec&gt;</span><br><span class="line">  &lt;/Actions&gt;</span><br><span class="line">&lt;/Task&gt;</span><br><span class="line">:renewal:</span><br><span class="line"></span><br><span class="line">:run_once:</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-16&quot;?&gt;</span><br><span class="line">&lt;Task version=&quot;1.3&quot; xmlns=&quot;http://schemas.microsoft.com/windows/2004/02/mit/task&quot;&gt;</span><br><span class="line">  &lt;RegistrationInfo&gt;</span><br><span class="line">    &lt;Source&gt;Microsoft Corporation&lt;/Source&gt;</span><br><span class="line">    &lt;Date&gt;1999-01-01T12:00:00.34375&lt;/Date&gt;</span><br><span class="line">    &lt;Author&gt;WindowsAddict&lt;/Author&gt;</span><br><span class="line">    &lt;Version&gt;1.0&lt;/Version&gt;</span><br><span class="line">    &lt;Description&gt;Online K-M-S Activation Run Once - Run and Delete itself on first Internet Contact&lt;/Description&gt;</span><br><span class="line">    &lt;URI&gt;\Activation-Run_Once&lt;/URI&gt;</span><br><span class="line">    &lt;SecurityDescriptor&gt;D:P(A;;FA;;;SY)(A;;FA;;;BA)(A;;FRFX;;;LS)(A;;FRFW;;;S-1-5-80-123231216-2592883651-3715271367-3753151631-4175906628)(A;;FR;;;S-1-5-4)&lt;/SecurityDescriptor&gt;</span><br><span class="line">  &lt;/RegistrationInfo&gt;</span><br><span class="line">  &lt;Triggers&gt;</span><br><span class="line">    &lt;LogonTrigger&gt;</span><br><span class="line">      &lt;Enabled&gt;true&lt;/Enabled&gt;</span><br><span class="line">    &lt;/LogonTrigger&gt;</span><br><span class="line">  &lt;/Triggers&gt;</span><br><span class="line">  &lt;Principals&gt;</span><br><span class="line">    &lt;Principal id=&quot;LocalSystem&quot;&gt;</span><br><span class="line">      &lt;UserId&gt;S-1-5-18&lt;/UserId&gt;</span><br><span class="line">      &lt;RunLevel&gt;HighestAvailable&lt;/RunLevel&gt;</span><br><span class="line">    &lt;/Principal&gt;</span><br><span class="line">  &lt;/Principals&gt;</span><br><span class="line">  &lt;Settings&gt;</span><br><span class="line">    &lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;</span><br><span class="line">    &lt;DisallowStartIfOnBatteries&gt;false&lt;/DisallowStartIfOnBatteries&gt;</span><br><span class="line">    &lt;StopIfGoingOnBatteries&gt;false&lt;/StopIfGoingOnBatteries&gt;</span><br><span class="line">    &lt;AllowHardTerminate&gt;true&lt;/AllowHardTerminate&gt;</span><br><span class="line">    &lt;StartWhenAvailable&gt;true&lt;/StartWhenAvailable&gt;</span><br><span class="line">    &lt;RunOnlyIfNetworkAvailable&gt;true&lt;/RunOnlyIfNetworkAvailable&gt;</span><br><span class="line">    &lt;IdleSettings&gt;</span><br><span class="line">      &lt;StopOnIdleEnd&gt;false&lt;/StopOnIdleEnd&gt;</span><br><span class="line">      &lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt;</span><br><span class="line">    &lt;/IdleSettings&gt;</span><br><span class="line">    &lt;AllowStartOnDemand&gt;true&lt;/AllowStartOnDemand&gt;</span><br><span class="line">    &lt;Enabled&gt;true&lt;/Enabled&gt;</span><br><span class="line">    &lt;Hidden&gt;true&lt;/Hidden&gt;</span><br><span class="line">    &lt;RunOnlyIfIdle&gt;false&lt;/RunOnlyIfIdle&gt;</span><br><span class="line">    &lt;DisallowStartOnRemoteAppSession&gt;false&lt;/DisallowStartOnRemoteAppSession&gt;</span><br><span class="line">    &lt;UseUnifiedSchedulingEngine&gt;true&lt;/UseUnifiedSchedulingEngine&gt;</span><br><span class="line">    &lt;WakeToRun&gt;false&lt;/WakeToRun&gt;</span><br><span class="line">    &lt;ExecutionTimeLimit&gt;PT10M&lt;/ExecutionTimeLimit&gt;</span><br><span class="line">    &lt;Priority&gt;7&lt;/Priority&gt;</span><br><span class="line">    &lt;RestartOnFailure&gt;</span><br><span class="line">      &lt;Interval&gt;PT2M&lt;/Interval&gt;</span><br><span class="line">      &lt;Count&gt;3&lt;/Count&gt;</span><br><span class="line">    &lt;/RestartOnFailure&gt;</span><br><span class="line">  &lt;/Settings&gt;</span><br><span class="line">  &lt;Actions Context=&quot;LocalSystem&quot;&gt;</span><br><span class="line">    &lt;Exec&gt;</span><br><span class="line">      &lt;Command&gt;%ProgramFiles%\Activation-Renewal\Activation_task.cmd&lt;/Command&gt;</span><br><span class="line">    &lt;Arguments&gt;Task&lt;/Arguments&gt;</span><br><span class="line">    &lt;/Exec&gt;</span><br><span class="line">  &lt;/Actions&gt;</span><br><span class="line">&lt;/Task&gt;</span><br><span class="line">:run_once:</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Extract the text from batch script without character and file encoding issue</span><br><span class="line"></span><br><span class="line">:RenExport</span><br><span class="line"></span><br><span class="line">%psc% &quot;$f=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split \&quot;:%~1\:.*`r`n\&quot;; [io.file]::WriteAllText(&#x27;%~2&#x27;,$f[1].Trim(),[System.Text.Encoding]::%~3);&quot;</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:_extracttask:</span><br><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">::   Renew K-M-S activation with Online servers via scheduled task</span><br><span class="line"></span><br><span class="line">::============================================================================</span><br><span class="line">::</span><br><span class="line">::   This script is a part of &#x27;微软激活脚本【由feifei汉化】&#x27; (MAS) project.</span><br><span class="line">::</span><br><span class="line">::   Homepage: mass grave[.]dev</span><br><span class="line">::      Email: windowsaddict@protonmail.com</span><br><span class="line">::</span><br><span class="line">::============================================================================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if not &quot;%~1&quot;==&quot;Task&quot; (</span><br><span class="line">echo.</span><br><span class="line">echo ====== Error ======</span><br><span class="line">echo.</span><br><span class="line">echo This file is supposed to be run only by the scheduled task.</span><br><span class="line">echo.</span><br><span class="line">echo Press any key to exit</span><br><span class="line">pause &gt;nul</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::  Set Path variable, it helps if it is misconfigured in the system</span><br><span class="line"></span><br><span class="line">set &quot;PATH=%SystemRoot%\System32;%SystemRoot%\System32\wbem;%SystemRoot%\System32\WindowsPowerShell\v1.0\&quot;</span><br><span class="line">if exist &quot;%SystemRoot%\Sysnative\reg.exe&quot; (</span><br><span class="line">set &quot;PATH=%SystemRoot%\Sysnative;%SystemRoot%\Sysnative\wbem;%SystemRoot%\Sysnative\WindowsPowerShell\v1.0\;%PATH%&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">&gt;nul fltmc || exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set _tserror=</span><br><span class="line">set winbuild=1</span><br><span class="line">set &quot;nul=&gt;nul 2&gt;&amp;1&quot;</span><br><span class="line">for /f &quot;tokens=6 delims=[]. &quot; %%G in (&#x27;ver&#x27;) do set winbuild=%%G</span><br><span class="line">set psc=powershell.exe</span><br><span class="line"></span><br><span class="line">set run_once=</span><br><span class="line">set t_name=Renewal Task</span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\taskcache\tasks&quot; /f Path /s | find /i &quot;\Activation-Run_Once&quot; &gt;nul &amp;&amp; (</span><br><span class="line">set run_once=1</span><br><span class="line">set t_name=Run Once Task</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set _wmic=0</span><br><span class="line">for %%# in (wmic.exe) do @if not &quot;%%~$PATH:#&quot;==&quot;&quot; (</span><br><span class="line">wmic path Win32_ComputerSystem get CreationClassName /value 2&gt;nul | find /i &quot;computersystem&quot; 1&gt;nul &amp;&amp; set _wmic=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line">if exist &quot;%ProgramFiles%\Activation-Renewal\&quot; call :_taskstart&gt;&gt;&quot;%ProgramFiles%\Activation-Renewal\Logs.txt&quot; &amp; exit</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:_taskstart</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line">echo %date%, %time%</span><br><span class="line"></span><br><span class="line">set /a loop=1</span><br><span class="line">set /a max_loop=4</span><br><span class="line"></span><br><span class="line">call :_tasksetserv</span><br><span class="line"></span><br><span class="line">:_intrepeat</span><br><span class="line"></span><br><span class="line">::  Check Internet connection. Works even if ICMP echo is disabled.</span><br><span class="line"></span><br><span class="line">for %%a in (%srvlist%) do (</span><br><span class="line">for /f &quot;delims=[] tokens=2&quot; %%# in (&#x27;ping -n 1 %%a&#x27;) do (</span><br><span class="line">if not [%%#]==[] goto _taskIntConnected</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">nslookup dns.msftncsi.com 2&gt;nul | find &quot;131.107.255.255&quot; 1&gt;nul</span><br><span class="line">if [%errorlevel%]==[0] goto _taskIntConnected</span><br><span class="line"></span><br><span class="line">if %loop%==%max_loop% (</span><br><span class="line">set _tserror=1</span><br><span class="line">goto _taskend</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line">echo Error: Internet is not connected</span><br><span class="line">echo Waiting 30 seconds</span><br><span class="line"></span><br><span class="line">timeout /t 30 &gt;nul</span><br><span class="line">set /a loop=%loop%+1</span><br><span class="line">goto _intrepeat</span><br><span class="line"></span><br><span class="line">:_taskIntConnected</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check not x86 Windows</span><br><span class="line"></span><br><span class="line">set notx86=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; /v PROCESSOR_ARCHITECTURE&#x27;) do set arch=%%b</span><br><span class="line">if /i not &quot;%arch%&quot;==&quot;x86&quot; set notx86=1</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set &quot;OPPk=SOFTWARE\Microsoft\OfficeSoftwareProtectionPlatform&quot;</span><br><span class="line">set &quot;SPPk=SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform&quot;</span><br><span class="line"></span><br><span class="line">set &quot;slp=SoftwareLicensingProduct&quot;</span><br><span class="line">set &quot;ospp=OfficeSoftwareProtectionProduct&quot;</span><br><span class="line"></span><br><span class="line">set &quot;_wApp=55c92734-d682-4d71-983e-d6ec3f16059f&quot;</span><br><span class="line">set &quot;_oApp=0ff1ce15-a989-479d-af46-f275c6370663&quot;</span><br><span class="line">set &quot;_oA14=59a52881-a989-479d-af46-f275c6370663&quot;</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Clean existing KMS cache from the registry / Set port value to 1688</span><br><span class="line"></span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServiceName</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;1688&quot;</span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%\%_wApp%&quot; /f</span><br><span class="line">if %winbuild% GEQ 9200 (</span><br><span class="line">if defined notx86 (</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;1688&quot; /reg:32</span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%\%_oApp%&quot; /f /reg:32</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;1688&quot; /reg:32</span><br><span class="line">)</span><br><span class="line">%nul% reg delete &quot;HKLM\%SPPk%\%_oApp%&quot; /f</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;1688&quot;</span><br><span class="line">)</span><br><span class="line">if %winbuild% GEQ 9600 (</span><br><span class="line">%nul% reg delete &quot;HKU\S-1-5-20\%SPPk%\%_wApp%&quot; /f</span><br><span class="line">%nul% reg delete &quot;HKU\S-1-5-20\%SPPk%\%_oApp%&quot; /f</span><br><span class="line">)</span><br><span class="line">%nul% reg add &quot;HKLM\%OPPk%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;1688&quot;</span><br><span class="line">%nul% reg delete &quot;HKLM\%OPPk%\%_oA14%&quot; /f</span><br><span class="line">%nul% reg delete &quot;HKLM\%OPPk%\%_oApp%&quot; /f</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check WMI and sppsvc Errors</span><br><span class="line"></span><br><span class="line">set applist=</span><br><span class="line">net start sppsvc /y %nul%</span><br><span class="line">if %_wmic% EQU 1 set &quot;chkapp=for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;&quot;wmic path %slp% where (ApplicationID=&#x27;%_wApp%&#x27;) get ID /VALUE&quot; 2^&gt;nul&#x27;)&quot;</span><br><span class="line">if %_wmic% EQU 0 set &quot;chkapp=for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;%psc% &quot;(([WMISEARCHER]&#x27;SELECT ID FROM %slp% WHERE ApplicationID=&#x27;&#x27;%_wApp%&#x27;&#x27;&#x27;).Get()).ID ^| %% &#123;echo (&#x27;ID=&#x27;+$_)&#125;&quot; 2^&gt;nul&#x27;)&quot;</span><br><span class="line">%chkapp% do (if defined applist (call set &quot;applist=!applist! %%a&quot;) else (call set &quot;applist=%%a&quot;))</span><br><span class="line"></span><br><span class="line">if not defined applist (</span><br><span class="line">set _tserror=1</span><br><span class="line">if %_wmic% EQU 1 wmic path Win32_ComputerSystem get CreationClassName /value 2&gt;nul | find /i &quot;computersystem&quot; 1&gt;nul</span><br><span class="line">if %_wmic% EQU 0 %psc% &quot;Get-CIMInstance -Class Win32_ComputerSystem | Select-Object -Property CreationClassName&quot; 2&gt;nul | find /i &quot;computersystem&quot; 1&gt;nul</span><br><span class="line">if !errorlevel! NEQ 0 (set e_wmispp=WMI, SPP) else (set e_wmispp=SPP)</span><br><span class="line">echo.</span><br><span class="line">echo Error: Not Respoding- !e_wmispp!</span><br><span class="line">echo.</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check installed volume products activation ID&#x27;s</span><br><span class="line"></span><br><span class="line">call :_taskgetids sppwid %slp% windows</span><br><span class="line">call :_taskgetids sppoid %slp% office</span><br><span class="line">call :_taskgetids osppid %ospp% office</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line">echo Renewing KMS activation for all installed Volume products</span><br><span class="line"></span><br><span class="line">if not defined sppwid if not defined sppoid if not defined osppid (</span><br><span class="line">echo.</span><br><span class="line">echo No installed Volume Windows / Office product found</span><br><span class="line">echo.</span><br><span class="line">echo Renewing KMS server</span><br><span class="line">call :_taskgetserv</span><br><span class="line">call :_taskregserv</span><br><span class="line">goto :_skipact</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:: Check KMS38 activation</span><br><span class="line"></span><br><span class="line">set gpr=0</span><br><span class="line">set _kms38=0</span><br><span class="line">if defined sppwid if %winbuild% GEQ 14393 (</span><br><span class="line">set _path=%slp%</span><br><span class="line">set _actid=%sppwid%</span><br><span class="line">call :_taskgetgrace</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %gpr% NEQ 0 if %gpr% GTR 259200 (</span><br><span class="line">set _kms38=1</span><br><span class="line">call :_taskchkEnterpriseG _kms38</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:: Set specific KMS host to Local Host so that global KMS IP can not replace KMS38 activation but can be used with Office and other Windows Editions.</span><br><span class="line"></span><br><span class="line">if %_kms38% EQU 1 (</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%\%_wApp%\%sppwid%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;127.0.0.2&quot;</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%\%_wApp%\%sppwid%&quot; /f /v KeyManagementServicePort /t REG_SZ /d &quot;1688&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line">if defined sppwid (</span><br><span class="line">set _path=%slp%</span><br><span class="line">set _actid=%sppwid%</span><br><span class="line">call :_actprod</span><br><span class="line">call :_act act_win</span><br><span class="line">call :_actinfo act_win</span><br><span class="line">) else (</span><br><span class="line">echo Checking: Volume version of Windows is not installed</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined sppoid (</span><br><span class="line">set _path=%slp%</span><br><span class="line">for %%# in (%sppoid%) do (</span><br><span class="line">echo.</span><br><span class="line">set _actid=%%#</span><br><span class="line">call :_actprod</span><br><span class="line">call :_act</span><br><span class="line">call :_actinfo</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined osppid (</span><br><span class="line">set _path=%ospp%</span><br><span class="line">for %%# in (%osppid%) do (</span><br><span class="line">echo.</span><br><span class="line">set _actid=%%#</span><br><span class="line">call :_actprod</span><br><span class="line">call :_act</span><br><span class="line">call :_actinfo</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not defined sppoid if not defined osppid (</span><br><span class="line">echo.</span><br><span class="line">echo Checking: Volume version of Office is not installed</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:_skipact</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">if defined run_once (</span><br><span class="line">echo.</span><br><span class="line">echo Deleting Scheduled Task Activation-Run_Once</span><br><span class="line">schtasks /delete /tn Activation-Run_Once /f %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:_taskend</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line">echo Exiting</span><br><span class="line">echo ______________________________________________________________________</span><br><span class="line"></span><br><span class="line">if defined _tserror (exit /b 123456789) else (exit /b 0)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:_act</span><br><span class="line"></span><br><span class="line">set errorcode=12345</span><br><span class="line">set /a act_attempt=0</span><br><span class="line"></span><br><span class="line">:_act2</span><br><span class="line"></span><br><span class="line">if %act_attempt% GTR 4 exit /b</span><br><span class="line"></span><br><span class="line">if not [%act_ok%]==[1] (</span><br><span class="line">call :_taskgetserv</span><br><span class="line">call :_taskregserv</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not !server_num! GTR %max_servers% (</span><br><span class="line"></span><br><span class="line">if [%1]==[act_win] if %_kms38% EQU 1 (</span><br><span class="line">set act_ok=1</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %_wmic% EQU 1 wmic path !_path! where ID=&#x27;!_actid!&#x27; call Activate %nul%</span><br><span class="line">if %_wmic% EQU 0 %psc% &quot;try &#123;$null=(([WMISEARCHER]&#x27;SELECT ID FROM !_path! where ID=&#x27;&#x27;!_actid!&#x27;&#x27;&#x27;).Get()).Activate(); exit 0&#125; catch &#123; exit $_.Exception.InnerException.HResult &#125;&quot;</span><br><span class="line"></span><br><span class="line">call set errorcode=!errorlevel!</span><br><span class="line"></span><br><span class="line">if !errorcode! EQU 0 (</span><br><span class="line">set act_ok=1</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if [%1]==[act_win] if !errorcode! EQU -1073418187 if %winbuild% LSS 9200 (</span><br><span class="line">set act_ok=1</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set act_ok=0</span><br><span class="line">set /a act_attempt+=1</span><br><span class="line">goto _act2</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:_actprod</span><br><span class="line"></span><br><span class="line">if %_wmic% EQU 1 for /f &quot;tokens=2 delims==&quot; %%x in (&#x27;&quot;wmic path !_path! where ID=&#x27;!_actid!&#x27; get Name /VALUE&quot; 2^&gt;nul&#x27;) do call echo Activating: %%x</span><br><span class="line">if %_wmic% EQU 0 for /f &quot;tokens=2 delims==&quot; %%x in (&#x27;%psc% &quot;(([WMISEARCHER]&#x27;SELECT Name FROM !_path! WHERE ID=&#x27;&#x27;!_actid!&#x27;&#x27;&#x27;).Get()).Name | %% &#123;echo (&#x27;Name=&#x27;+$_)&#125;&quot; 2^&gt;nul&#x27;) do call echo Activating: %%x</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:_actinfo</span><br><span class="line"></span><br><span class="line">if [%1]==[act_win] if %_kms38% EQU 1 (</span><br><span class="line">echo Windows is activated with KMS38</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %errorcode% EQU 12345 (</span><br><span class="line">echo Product Activation Failed</span><br><span class="line">echo Unable to test KMS servers due to restricted or no Internet</span><br><span class="line">set _tserror=1</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %errorcode% EQU -1073418187 (</span><br><span class="line">echo Product Activation Failed: 0xC004F035</span><br><span class="line">if [%1]==[act_win] if %winbuild% LSS 9200 echo Windows 7 cannot be KMS-activated on this computer due to unqualified OEM BIOS</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %errorcode% EQU -1073417728 (</span><br><span class="line">echo Product Activation Failed: 0xC004F200</span><br><span class="line">echo Windows needs to rebuild the activation-related files.</span><br><span class="line">set _tserror=1</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set gpr=0</span><br><span class="line">set gpr2=0</span><br><span class="line">call :_taskgetgrace</span><br><span class="line">set /a &quot;gpr2=(%gpr%+1440-1)/1440&quot;</span><br><span class="line"></span><br><span class="line">if %errorcode% EQU 0 if %gpr% EQU 0 (</span><br><span class="line">echo Product Activation succeeded, but Remaining Period failed to increase.</span><br><span class="line">if [%1]==[act_win] if %winbuild% LSS 9200 echo This could be related to the error described in KB4487266</span><br><span class="line">set _tserror=1</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set _actpass=1</span><br><span class="line">if %gpr% EQU 43200  if [%1]==[act_win] if %winbuild% GEQ 9200 set _actpass=0</span><br><span class="line">if %gpr% EQU 64800  set _actpass=0</span><br><span class="line">if %gpr% GTR 259200 if [%1]==[act_win] call :_taskchkEnterpriseG _actpass</span><br><span class="line">if %gpr% EQU 259200 set _actpass=0</span><br><span class="line"></span><br><span class="line">if %errorcode% EQU 0 if %_actpass% EQU 0 (</span><br><span class="line">echo 产品激活成功</span><br><span class="line">echo Remaining Period: %gpr2% days ^(%gpr% minutes^)</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">cmd /c exit /b %errorcode%</span><br><span class="line">if %errorcode% NEQ 0 (</span><br><span class="line">echo Product Activation Failed: 0x!=ExitCode!</span><br><span class="line">) else (</span><br><span class="line">echo Product Activation Failed</span><br><span class="line">)</span><br><span class="line">echo Remaining Period: %gpr2% days ^(%gpr% minutes^)</span><br><span class="line">set _tserror=1</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:_taskgetids</span><br><span class="line"></span><br><span class="line">set %1=</span><br><span class="line">if %_wmic% EQU 1 set &quot;chkapp=for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;&quot;wmic path %2 where (Name like &#x27;%%%3%%&#x27; and Description like &#x27;%%KMSCLIENT%%&#x27; and PartialProductKey is not NULL) get ID /VALUE&quot; 2^&gt;nul&#x27;)&quot;</span><br><span class="line">if %_wmic% EQU 0 set &quot;chkapp=for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;%psc% &quot;(([WMISEARCHER]&#x27;SELECT ID FROM %2 WHERE Name like &#x27;&#x27;%%%3%%&#x27;&#x27; and Description like &#x27;&#x27;%%KMSCLIENT%%&#x27;&#x27; and PartialProductKey is not NULL&#x27;).Get()).ID ^| %% &#123;echo (&#x27;ID=&#x27;+$_)&#125;&quot; 2^&gt;nul&#x27;)&quot;</span><br><span class="line">%chkapp% do (if defined %1 (call set &quot;%1=!%1! %%a&quot;) else (call set &quot;%1=%%a&quot;))</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:_taskgetgrace</span><br><span class="line"></span><br><span class="line">set gpr=0</span><br><span class="line">if %_wmic% EQU 1 for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;&quot;wmic path !_path! where ID=&#x27;!_actid!&#x27; get GracePeriodRemaining /VALUE&quot; 2^&gt;nul&#x27;) do call set &quot;gpr=%%#&quot;</span><br><span class="line">if %_wmic% EQU 0 for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;%psc% &quot;(([WMISEARCHER]&#x27;SELECT GracePeriodRemaining FROM !_path! where ID=&#x27;&#x27;!_actid!&#x27;&#x27;&#x27;).Get()).GracePeriodRemaining | %% &#123;echo (&#x27;GracePeriodRemaining=&#x27;+$_)&#125;&quot; 2^&gt;nul&#x27;) do call set &quot;gpr=%%#&quot;</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:_taskchkEnterpriseG</span><br><span class="line"></span><br><span class="line">for %%# in (e0b2d383-d112-413f-8a80-97f373a5820c e38454fb-41a4-4f59-a5dc-25080e354730) do (if %sppwid%==%%# set %1=0)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:_taskregserv</span><br><span class="line"></span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;%KMS_IP%&quot;</span><br><span class="line">%nul% reg add &quot;HKLM\%OPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;%KMS_IP%&quot;</span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 9200 (</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;%KMS_IP%&quot;</span><br><span class="line">if defined notx86 (</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;%KMS_IP%&quot; /reg:32</span><br><span class="line">%nul% reg add &quot;HKLM\%SPPk%\%_oApp%&quot; /f /v KeyManagementServiceName /t REG_SZ /d &quot;%KMS_IP%&quot; /reg:32</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:_tasksetserv</span><br><span class="line"></span><br><span class="line">::  Multi KMS servers integration and servers randomization</span><br><span class="line"></span><br><span class="line">set srvlist=</span><br><span class="line">set -=</span><br><span class="line"></span><br><span class="line">set &quot;srvlist=kms.zhu%-%xiaole.org kms-default.cangs%-%hui.net kms.six%-%yin.com kms.moe%-%club.org kms.cgt%-%soft.com&quot;</span><br><span class="line">set &quot;srvlist=%srvlist% kms.id%-%ina.cn kms.moe%-%yuuko.com xinch%-%eng213618.cn kms.wl%-%rxy.cn kms.ca%-%tqu.com&quot;</span><br><span class="line">set &quot;srvlist=%srvlist% kms.0%-%t.net.cn kms.its%-%jzx.com kms.wx%-%lost.com kms.moe%-%yuuko.top kms.gh%-%pym.com&quot;</span><br><span class="line"></span><br><span class="line">set n=1</span><br><span class="line">for %%a in (%srvlist%) do (set %%a=&amp;set server!n!=%%a&amp;set /a n+=1)</span><br><span class="line">set max_servers=15</span><br><span class="line">set /a server_num=0</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:_taskgetserv</span><br><span class="line"></span><br><span class="line">if %server_num% geq %max_servers% (set /a server_num+=1&amp;set KMS_IP=222.184.9.98&amp;exit /b)</span><br><span class="line">set /a rand=%Random%%%(15+1-1)+1</span><br><span class="line">if defined !server%rand%! goto :_taskgetserv</span><br><span class="line">set KMS_IP=!server%rand%!</span><br><span class="line">set !server%rand%!=1</span><br><span class="line"></span><br><span class="line">::  Get IPv4 address of KMS server to use for the activation, works even if ICMP echo is disabled.</span><br><span class="line">::  Microsoft and Antivirus&#x27;s may flag the issue if public KMS server host name is directly used for the activation.</span><br><span class="line"></span><br><span class="line">set /a server_num+=1</span><br><span class="line">(for /f &quot;delims=[] tokens=2&quot; %%a in (&#x27;ping -4 -n 1 %KMS_IP% 2^&gt;nul&#x27;) do set &quot;KMS_IP=%%a&quot;</span><br><span class="line">if [%KMS_IP%]==[!KMS_IP!] for /f &quot;delims=[] tokens=2&quot; %%# in (&#x27;pathping -4 -h 1 -n -p 1 -q 1 -w 1 %KMS_IP% 2^&gt;nul&#x27;) do set &quot;KMS_IP=%%#&quot;</span><br><span class="line">if not [%KMS_IP%]==[!KMS_IP!] exit /b</span><br><span class="line">goto :_taskgetserv</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:: Ver:1.9</span><br><span class="line">::========================================================================================================================================</span><br><span class="line">:_extracttask:</span><br><span class="line"></span><br><span class="line">:======================================================================================================================================================</span><br><span class="line"></span><br><span class="line">:_color</span><br><span class="line"></span><br><span class="line">if %_NCS% EQU 1 (</span><br><span class="line">if defined _unattended (echo %~2) else (echo %esc%[%~1%~2%esc%[0m)</span><br><span class="line">) else (</span><br><span class="line">if defined _unattended (echo %~2) else (call :batcol %~1 &quot;%~2&quot;)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:_color2</span><br><span class="line"></span><br><span class="line">if %_NCS% EQU 1 (</span><br><span class="line">echo %esc%[%~1%~2%esc%[%~3%~4%esc%[0m</span><br><span class="line">) else (</span><br><span class="line">call :batcol %~1 &quot;%~2&quot; %~3 &quot;%~4&quot;</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::=======================================</span><br><span class="line"></span><br><span class="line">:: Colored text with pure batch method</span><br><span class="line">:: Thanks to @dbenham and @jeb</span><br><span class="line">:: stackoverflow.com/a/10407642</span><br><span class="line"></span><br><span class="line">:batcol</span><br><span class="line"></span><br><span class="line">pushd %_coltemp%</span><br><span class="line">if not exist &quot;&#x27;&quot; (&lt;nul &gt;&quot;&#x27;&quot; set /p &quot;=.&quot;)</span><br><span class="line">setlocal</span><br><span class="line">set &quot;s=%~2&quot;</span><br><span class="line">set &quot;t=%~4&quot;</span><br><span class="line">call :_batcol %1 s %3 t</span><br><span class="line">del /f /q &quot;&#x27;&quot;</span><br><span class="line">del /f /q &quot;`.txt&quot;</span><br><span class="line">popd</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:_batcol</span><br><span class="line"></span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line">set &quot;s=!%~2!&quot;</span><br><span class="line">set &quot;t=!%~4!&quot;</span><br><span class="line">for /f delims^=^ eol^= %%i in (&quot;!s!&quot;) do (</span><br><span class="line">  if &quot;!&quot; equ &quot;&quot; setlocal DisableDelayedExpansion</span><br><span class="line">    &gt;`.txt (echo %%i\..\&#x27;)</span><br><span class="line">    findstr /a:%~1 /f:`.txt &quot;.&quot;</span><br><span class="line">    &lt;nul set /p &quot;=%_BS%%_BS%%_BS%%_BS%%_BS%%_BS%%_BS%&quot;</span><br><span class="line">)</span><br><span class="line">if &quot;%~4&quot;==&quot;&quot; echo(&amp;exit /b</span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line">for /f delims^=^ eol^= %%i in (&quot;!t!&quot;) do (</span><br><span class="line">  if &quot;!&quot; equ &quot;&quot; setlocal DisableDelayedExpansion</span><br><span class="line">    &gt;`.txt (echo %%i\..\&#x27;)</span><br><span class="line">    findstr /a:%~3 /f:`.txt &quot;.&quot;</span><br><span class="line">    &lt;nul set /p &quot;=%_BS%%_BS%%_BS%%_BS%%_BS%%_BS%%_BS%&quot;</span><br><span class="line">)</span><br><span class="line">echo(</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::=======================================</span><br><span class="line"></span><br><span class="line">:_colorprep</span><br><span class="line"></span><br><span class="line">if %_NCS% EQU 1 (</span><br><span class="line">for /F %%a in (&#x27;echo prompt $E ^| cmd&#x27;) do set &quot;esc=%%a&quot;</span><br><span class="line"></span><br><span class="line">set     &quot;Red=&quot;41;97m&quot;&quot;</span><br><span class="line">set    &quot;Gray=&quot;100;97m&quot;&quot;</span><br><span class="line">set   &quot;Black=&quot;30m&quot;&quot;</span><br><span class="line">set   &quot;Green=&quot;42;97m&quot;&quot;</span><br><span class="line">set    &quot;Blue=&quot;44;97m&quot;&quot;</span><br><span class="line">set  &quot;Yellow=&quot;43;97m&quot;&quot;</span><br><span class="line">set &quot;Magenta=&quot;45;97m&quot;&quot;</span><br><span class="line"></span><br><span class="line">set    &quot;_Red=&quot;40;91m&quot;&quot;</span><br><span class="line">set  &quot;_Green=&quot;40;92m&quot;&quot;</span><br><span class="line">set   &quot;_Blue=&quot;40;94m&quot;&quot;</span><br><span class="line">set  &quot;_White=&quot;40;37m&quot;&quot;</span><br><span class="line">set &quot;_Yellow=&quot;40;93m&quot;&quot;</span><br><span class="line"></span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for /f %%A in (&#x27;&quot;prompt $H&amp;for %%B in (1) do rem&quot;&#x27;) do set &quot;_BS=%%A %%A&quot;</span><br><span class="line">set &quot;_coltemp=%SystemRoot%\Temp&quot;</span><br><span class="line"></span><br><span class="line">set     &quot;Red=&quot;CF&quot;&quot;</span><br><span class="line">set    &quot;Gray=&quot;8F&quot;&quot;</span><br><span class="line">set   &quot;Black=&quot;00&quot;&quot;</span><br><span class="line">set   &quot;Green=&quot;2F&quot;&quot;</span><br><span class="line">set    &quot;Blue=&quot;1F&quot;&quot;</span><br><span class="line">set  &quot;Yellow=&quot;6F&quot;&quot;</span><br><span class="line">set &quot;Magenta=&quot;5F&quot;&quot;</span><br><span class="line"></span><br><span class="line">set    &quot;_Red=&quot;0C&quot;&quot;</span><br><span class="line">set  &quot;_Green=&quot;0A&quot;&quot;</span><br><span class="line">set   &quot;_Blue=&quot;09&quot;&quot;</span><br><span class="line">set  &quot;_White=&quot;07&quot;&quot;</span><br><span class="line">set &quot;_Yellow=&quot;0E&quot;&quot;</span><br><span class="line"></span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  https://gist.github.com/ave9858/9fff6af726ba3ddc646285d1bbf37e71</span><br><span class="line">::  This code is used to clean Office licenses</span><br><span class="line"></span><br><span class="line">:cleanlicense:</span><br><span class="line">function UninstallLicenses($DllPath) &#123;</span><br><span class="line">    $AssemblyBuilder = [AppDomain]::CurrentDomain.DefineDynamicAssembly(4, 1)</span><br><span class="line">    $ModuleBuilder = $AssemblyBuilder.DefineDynamicModule(2, $False)</span><br><span class="line">    $TypeBuilder = $ModuleBuilder.DefineType(0)</span><br><span class="line">    </span><br><span class="line">    [void]$TypeBuilder.DefinePInvokeMethod(&#x27;SLOpen&#x27;, $DllPath, &#x27;Public, Static&#x27;, 1, [int], @([IntPtr].MakeByRefType()), 1, 3)</span><br><span class="line">    [void]$TypeBuilder.DefinePInvokeMethod(&#x27;SLGetSLIDList&#x27;, $DllPath, &#x27;Public, Static&#x27;, 1, [int],</span><br><span class="line">        @([IntPtr], [int], [Guid].MakeByRefType(), [int], [int].MakeByRefType(), [IntPtr].MakeByRefType()), 1, 3).SetImplementationFlags(128)</span><br><span class="line">    [void]$TypeBuilder.DefinePInvokeMethod(&#x27;SLUninstallLicense&#x27;, $DllPath, &#x27;Public, Static&#x27;, 1, [int], @([IntPtr], [IntPtr]), 1, 3)</span><br><span class="line"></span><br><span class="line">    $SPPC = $TypeBuilder.CreateType()</span><br><span class="line">    $Handle = 0</span><br><span class="line">    [void]$SPPC::SLOpen([ref]$Handle)</span><br><span class="line">    $pnReturnIds = 0</span><br><span class="line">    $ppReturnIds = 0</span><br><span class="line"></span><br><span class="line">    if (!$SPPC::SLGetSLIDList($Handle, 0, [ref][Guid]&quot;0ff1ce15-a989-479d-af46-f275c6370663&quot;, 6, [ref]$pnReturnIds, [ref]$ppReturnIds)) &#123;</span><br><span class="line">        foreach ($i in 0..($pnReturnIds - 1)) &#123;</span><br><span class="line">            [void]$SPPC::SLUninstallLicense($Handle, [Int64]$ppReturnIds + [Int64]16 * $i)</span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$OSPP = (Get-ItemProperty -Path &quot;HKLM:\SOFTWARE\Microsoft\OfficeSoftwareProtectionPlatform&quot; -ErrorAction SilentlyContinue).Path</span><br><span class="line">if ($OSPP) &#123;</span><br><span class="line">    Write-Output &quot;Found Office Software Protection installed, cleaning&quot;</span><br><span class="line">    UninstallLicenses($OSPP + &quot;osppc.dll&quot;)</span><br><span class="line">&#125;</span><br><span class="line">UninstallLicenses(&quot;sppc.dll&quot;)</span><br><span class="line">:cleanlicense:</span><br><span class="line"></span><br><span class="line">:+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class="line"></span><br><span class="line">:_Check_Status_vbs</span><br><span class="line">@setlocal DisableDelayedExpansion</span><br><span class="line">@echo off</span><br><span class="line">@cls</span><br><span class="line">mode con cols=100 lines=32</span><br><span class="line">powershell &quot;&amp;&#123;$W=$Host.UI.RawUI.WindowSize;$B=$Host.UI.RawUI.BufferSize;$W.Height=31;$B.Height=300;$Host.UI.RawUI.WindowSize=$W;$Host.UI.RawUI.BufferSize=$B;&#125;&quot;</span><br><span class="line">color 07</span><br><span class="line">title 检查 激活状态 [vbs]</span><br><span class="line">set &quot;SysPath=%SystemRoot%\System32&quot;</span><br><span class="line">set &quot;Path=%SystemRoot%\System32;%SystemRoot%\System32\Wbem;%SystemRoot%\System32\WindowsPowerShell\v1.0\&quot;</span><br><span class="line">if exist &quot;%SystemRoot%\Sysnative\reg.exe&quot; (</span><br><span class="line">set &quot;SysPath=%SystemRoot%\Sysnative&quot;</span><br><span class="line">set &quot;Path=%SystemRoot%\Sysnative;%SystemRoot%\Sysnative\Wbem;%SystemRoot%\Sysnative\WindowsPowerShell\v1.0\;%Path%&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set ohook=</span><br><span class="line">for %%# in (15 16) do (</span><br><span class="line">for %%A in (&quot;%ProgramFiles%&quot; &quot;%ProgramW6432%&quot; &quot;%ProgramFiles(x86)%&quot;) do (</span><br><span class="line">if exist &quot;%%~A\Microsoft Office\Office%%#\sppc*dll&quot; set ohook=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%# in (System SystemX86) do (</span><br><span class="line">for %%G in (&quot;Office 15&quot; &quot;Office&quot;) do (</span><br><span class="line">for %%A in (&quot;%ProgramFiles%&quot; &quot;%ProgramW6432%&quot; &quot;%ProgramFiles(x86)%&quot;) do (</span><br><span class="line">if exist &quot;%%~A\Microsoft %%~G\root\vfs\%%#\sppc*dll&quot; set ohook=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;_bit=64&quot;</span><br><span class="line">set &quot;_wow=1&quot;</span><br><span class="line">if /i &quot;%PROCESSOR_ARCHITECTURE%&quot;==&quot;x86&quot; if &quot;%PROCESSOR_ARCHITEW6432%&quot;==&quot;&quot; set &quot;_wow=0&quot;&amp;set &quot;_bit=32&quot;</span><br><span class="line">set &quot;_utemp=%TEMP%&quot;</span><br><span class="line">set &quot;line2=************************************************************&quot;</span><br><span class="line">set &quot;line3=____________________________________________________________&quot;</span><br><span class="line">set _sO16vbs=0</span><br><span class="line">set _sO15vbs=0</span><br><span class="line">if exist &quot;%ProgramFiles%\Microsoft Office\Office15\ospp.vbs&quot; (</span><br><span class="line">  set _sO15vbs=1</span><br><span class="line">) else if exist &quot;%ProgramW6432%\Microsoft Office\Office15\ospp.vbs&quot; (</span><br><span class="line">  set _sO15vbs=1</span><br><span class="line">) else if exist &quot;%ProgramFiles(x86)%\Microsoft Office\Office15\ospp.vbs&quot; (</span><br><span class="line">  set _sO15vbs=1</span><br><span class="line">)</span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line">echo %line2%</span><br><span class="line">echo ***                   Windows Status                     ***</span><br><span class="line">echo %line2%</span><br><span class="line">pushd &quot;!_utemp!&quot;</span><br><span class="line">copy /y %SystemRoot%\System32\slmgr.vbs . &gt;nul 2&gt;&amp;1</span><br><span class="line">net start sppsvc /y &gt;nul 2&gt;&amp;1</span><br><span class="line">cscript //nologo slmgr.vbs /dli || (echo Error executing slmgr.vbs&amp;del /f /q slmgr.vbs&amp;popd&amp;goto :casVend)</span><br><span class="line">cscript //nologo slmgr.vbs /xpr</span><br><span class="line">del /f /q slmgr.vbs &gt;nul 2&gt;&amp;1</span><br><span class="line">popd</span><br><span class="line">echo %line3%</span><br><span class="line"></span><br><span class="line">if defined ohook (</span><br><span class="line">echo.</span><br><span class="line">echo.</span><br><span class="line">echo %line2%</span><br><span class="line">echo ***            Office Ohook Activation Status            ***</span><br><span class="line">echo %line2%</span><br><span class="line">echo.</span><br><span class="line">powershell &quot;write-host -back &#x27;Black&#x27; -fore &#x27;Yellow&#x27; &#x27;Ohook for permanent Office activation is installed.&#x27;; write-host -back &#x27;Black&#x27; -fore &#x27;Yellow&#x27; &#x27;You can ignore below Office activation status.&#x27;&quot;</span><br><span class="line">echo.</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:casVo16</span><br><span class="line">set office=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\16.0\Common\InstallRoot /v Path&quot; 2^&gt;nul&#x27;) do (set &quot;office=%%b&quot;)</span><br><span class="line">if exist &quot;!office!\ospp.vbs&quot; (</span><br><span class="line">set _sO16vbs=1</span><br><span class="line">echo.</span><br><span class="line">echo %line2%</span><br><span class="line">if %_sO15vbs% EQU 0 (</span><br><span class="line">echo ***              Office 2016 %_bit%-bit Status               ***</span><br><span class="line">) else (</span><br><span class="line">echo ***               Office 2013/2016 Status                ***</span><br><span class="line">)</span><br><span class="line">echo %line2%</span><br><span class="line">cscript //nologo &quot;!office!\ospp.vbs&quot; /dstatus</span><br><span class="line">)</span><br><span class="line">if %_wow%==0 goto :casVo13</span><br><span class="line">set office=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Wow6432Node\Microsoft\Office\16.0\Common\InstallRoot /v Path&quot; 2^&gt;nul&#x27;) do (set &quot;office=%%b&quot;)</span><br><span class="line">if exist &quot;!office!\ospp.vbs&quot; (</span><br><span class="line">set _sO16vbs=1</span><br><span class="line">echo.</span><br><span class="line">echo %line2%</span><br><span class="line">if %_sO15vbs% EQU 0 (</span><br><span class="line">echo ***              Office 2016 32-bit Status               ***</span><br><span class="line">) else (</span><br><span class="line">echo ***               Office 2013/2016 Status                ***</span><br><span class="line">)</span><br><span class="line">echo %line2%</span><br><span class="line">cscript //nologo &quot;!office!\ospp.vbs&quot; /dstatus</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:casVo13</span><br><span class="line">if %_sO16vbs% EQU 1 goto :casVo10</span><br><span class="line">set office=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\15.0\Common\InstallRoot /v Path&quot; 2^&gt;nul&#x27;) do (set &quot;office=%%b&quot;)</span><br><span class="line">if exist &quot;!office!\ospp.vbs&quot; (</span><br><span class="line">echo.</span><br><span class="line">echo %line2%</span><br><span class="line">echo ***              Office 2013 %_bit%-bit Status               ***</span><br><span class="line">echo %line2%</span><br><span class="line">cscript //nologo &quot;!office!\ospp.vbs&quot; /dstatus</span><br><span class="line">)</span><br><span class="line">if %_wow%==0 goto :casVo10</span><br><span class="line">set office=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Wow6432Node\Microsoft\Office\15.0\Common\InstallRoot /v Path&quot; 2^&gt;nul&#x27;) do (set &quot;office=%%b&quot;)</span><br><span class="line">if exist &quot;!office!\ospp.vbs&quot; (</span><br><span class="line">echo.</span><br><span class="line">echo %line2%</span><br><span class="line">echo ***              Office 2013 32-bit Status               ***</span><br><span class="line">echo %line2%</span><br><span class="line">cscript //nologo &quot;!office!\ospp.vbs&quot; /dstatus</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:casVo10</span><br><span class="line">set office=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\14.0\Common\InstallRoot /v Path&quot; 2^&gt;nul&#x27;) do (set &quot;office=%%b&quot;)</span><br><span class="line">if exist &quot;!office!\ospp.vbs&quot; (</span><br><span class="line">echo.</span><br><span class="line">echo %line2%</span><br><span class="line">echo ***              Office 2010 %_bit%-bit Status               ***</span><br><span class="line">echo %line2%</span><br><span class="line">cscript //nologo &quot;!office!\ospp.vbs&quot; /dstatus</span><br><span class="line">)</span><br><span class="line">if %_wow%==0 goto :casVc16</span><br><span class="line">set office=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Wow6432Node\Microsoft\Office\14.0\Common\InstallRoot /v Path&quot; 2^&gt;nul&#x27;) do (set &quot;office=%%b&quot;)</span><br><span class="line">if exist &quot;!office!\ospp.vbs&quot; (</span><br><span class="line">echo.</span><br><span class="line">echo %line2%</span><br><span class="line">echo ***              Office 2010 32-bit Status               ***</span><br><span class="line">echo %line2%</span><br><span class="line">cscript //nologo &quot;!office!\ospp.vbs&quot; /dstatus</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:casVc16</span><br><span class="line">reg query HKLM\SOFTWARE\Microsoft\Office\ClickToRun /v InstallPath &gt;nul 2&gt;&amp;1 || (</span><br><span class="line">reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun /v InstallPath &gt;nul 2&gt;&amp;1 || goto :casVc13</span><br><span class="line">)</span><br><span class="line">set office=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\Microsoft\Office\ClickToRun /v InstallPath&quot; 2^&gt;nul&#x27;) do (set &quot;office=%%b\Office16&quot;)</span><br><span class="line">if exist &quot;!office!\ospp.vbs&quot; (</span><br><span class="line">set _sO16vbs=1</span><br><span class="line">echo.</span><br><span class="line">echo %line2%</span><br><span class="line">if %_sO15vbs% EQU 0 (</span><br><span class="line">echo ***              Office 2016-2021 C2R Status             ***</span><br><span class="line">) else (</span><br><span class="line">echo ***                Office 2013-2021 Status               ***</span><br><span class="line">)</span><br><span class="line">echo %line2%</span><br><span class="line">cscript //nologo &quot;!office!\ospp.vbs&quot; /dstatus</span><br><span class="line">)</span><br><span class="line">if %_wow%==0 goto :casVc13</span><br><span class="line">set office=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;&quot;reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\ClickToRun /v InstallPath&quot; 2^&gt;nul&#x27;) do (set &quot;office=%%b\Office16&quot;)</span><br><span class="line">if exist &quot;!office!\ospp.vbs&quot; (</span><br><span class="line">set _sO16vbs=1</span><br><span class="line">echo.</span><br><span class="line">echo %line2%</span><br><span class="line">if %_sO15vbs% EQU 0 (</span><br><span class="line">echo ***              Office 2016-2021 C2R Status             ***</span><br><span class="line">) else (</span><br><span class="line">echo ***                Office 2013-2021 Status               ***</span><br><span class="line">)</span><br><span class="line">echo %line2%</span><br><span class="line">cscript //nologo &quot;!office!\ospp.vbs&quot; /dstatus</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:casVc13</span><br><span class="line">if %_sO16vbs% EQU 1 goto :casVc10</span><br><span class="line">reg query HKLM\SOFTWARE\Microsoft\Office\15.0\ClickToRun /v InstallPath &gt;nul 2&gt;&amp;1 || (</span><br><span class="line">reg query HKLM\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\ClickToRun /v InstallPath &gt;nul 2&gt;&amp;1 || goto :casVc10</span><br><span class="line">)</span><br><span class="line">set office=</span><br><span class="line">if exist &quot;%ProgramFiles%\Microsoft Office\Office15\ospp.vbs&quot; (</span><br><span class="line">  set &quot;office=%ProgramFiles%\Microsoft Office\Office15&quot;</span><br><span class="line">) else if exist &quot;%ProgramW6432%\Microsoft Office\Office15\ospp.vbs&quot; (</span><br><span class="line">  set &quot;office=%ProgramW6432%\Microsoft Office\Office15&quot;</span><br><span class="line">) else if exist &quot;%ProgramFiles(x86)%\Microsoft Office\Office15\ospp.vbs&quot; (</span><br><span class="line">  set &quot;office=%ProgramFiles(x86)%\Microsoft Office\Office15&quot;</span><br><span class="line">)</span><br><span class="line">if exist &quot;!office!\ospp.vbs&quot; (</span><br><span class="line">echo.</span><br><span class="line">echo %line2%</span><br><span class="line">echo ***                Office 2013 C2R Status                ***</span><br><span class="line">echo %line2%</span><br><span class="line">cscript //nologo &quot;!office!\ospp.vbs&quot; /dstatus</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:casVc10</span><br><span class="line">if %_wow%==0 reg query HKLM\SOFTWARE\Microsoft\Office\14.0\CVH /f Click2run /k &gt;nul 2&gt;&amp;1 || goto :casVend</span><br><span class="line">if %_wow%==1 reg query HKLM\SOFTWARE\Wow6432Node\Microsoft\Office\14.0\CVH /f Click2run /k &gt;nul 2&gt;&amp;1 || goto :casVend</span><br><span class="line">set office=</span><br><span class="line">if exist &quot;%ProgramFiles%\Microsoft Office\Office14\ospp.vbs&quot; (</span><br><span class="line">  set &quot;office=%ProgramFiles%\Microsoft Office\Office14&quot;</span><br><span class="line">) else if exist &quot;%ProgramW6432%\Microsoft Office\Office14\ospp.vbs&quot; (</span><br><span class="line">  set &quot;office=%ProgramW6432%\Microsoft Office\Office14&quot;</span><br><span class="line">) else if exist &quot;%ProgramFiles(x86)%\Microsoft Office\Office14\ospp.vbs&quot; (</span><br><span class="line">  set &quot;office=%ProgramFiles(x86)%\Microsoft Office\Office14&quot;</span><br><span class="line">)</span><br><span class="line">if exist &quot;!office!\ospp.vbs&quot; (</span><br><span class="line">echo.</span><br><span class="line">echo %line2%</span><br><span class="line">echo ***                Office 2010 C2R Status                ***</span><br><span class="line">echo %line2%</span><br><span class="line">cscript //nologo &quot;!office!\ospp.vbs&quot; /dstatus</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:casVend</span><br><span class="line">echo.</span><br><span class="line">call :_color %_Yellow% &quot;按任意键返回...&quot;</span><br><span class="line">pause &gt;nul</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class="line"></span><br><span class="line">:_Check_Status_wmi</span><br><span class="line"></span><br><span class="line">@setlocal DisableDelayedExpansion</span><br><span class="line">@echo off</span><br><span class="line">mode con cols=100 lines=32</span><br><span class="line">powershell &quot;&amp;&#123;$W=$Host.UI.RawUI.WindowSize;$B=$Host.UI.RawUI.BufferSize;$W.Height=31;$B.Height=300;$Host.UI.RawUI.WindowSize=$W;$Host.UI.RawUI.BufferSize=$B;&#125;&quot;</span><br><span class="line">color 07</span><br><span class="line">title 检查 激活状态 [wmi]</span><br><span class="line"></span><br><span class="line">set WMI_VBS=0</span><br><span class="line">@cls</span><br><span class="line">set &quot;_cmdf=%~f0&quot;</span><br><span class="line">set wspp=SoftwareLicensingProduct</span><br><span class="line">set wsps=SoftwareLicensingService</span><br><span class="line">set ospp=OfficeSoftwareProtectionProduct</span><br><span class="line">set osps=OfficeSoftwareProtectionService</span><br><span class="line">set winApp=55c92734-d682-4d71-983e-d6ec3f16059f</span><br><span class="line">set o14App=59a52881-a989-479d-af46-f275c6370663</span><br><span class="line">set o15App=0ff1ce15-a989-479d-af46-f275c6370663</span><br><span class="line">for %%# in (spp_get,ospp_get,cW1nd0ws,sppw,c0ff1ce15,sppo,osppsvc,ospp14,ospp15) do set &quot;%%#=&quot;</span><br><span class="line">for /f &quot;tokens=6 delims=[]. &quot; %%# in (&#x27;ver&#x27;) do set winbuild=%%#</span><br><span class="line">set &quot;spp_get=Description, DiscoveredKeyManagementServiceMachineName, DiscoveredKeyManagementServiceMachinePort, EvaluationEndDate, GracePeriodRemaining, ID, KeyManagementServiceMachine, KeyManagementServicePort, KeyManagementServiceProductKeyID, LicenseStatus, LicenseStatusReason, Name, PartialProductKey, ProductKeyID, VLActivationInterval, VLRenewalInterval&quot;</span><br><span class="line">set &quot;ospp_get=%spp_get%&quot;</span><br><span class="line">if %winbuild% GEQ 9200 set &quot;spp_get=%spp_get%, KeyManagementServiceLookupDomain, VLActivationTypeEnabled&quot;</span><br><span class="line">if %winbuild% GEQ 9600 set &quot;spp_get=%spp_get%, DiscoveredKeyManagementServiceMachineIpAddress, ProductKeyChannel&quot;</span><br><span class="line">set &quot;_work=%~dp0&quot;</span><br><span class="line">set &quot;_batf=%~f0&quot;</span><br><span class="line">set &quot;_batp=%_batf:&#x27;=&#x27;&#x27;%&quot;</span><br><span class="line">set &quot;_Local=%LocalAppData%&quot;</span><br><span class="line">set _Identity=0</span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line">dir /b /s /a:-d &quot;!_Local!\Microsoft\Office\Licenses\*1*&quot; 1&gt;nul 2&gt;nul &amp;&amp; set _Identity=1</span><br><span class="line">dir /b /s /a:-d &quot;!ProgramData!\Microsoft\Office\Licenses\*1*&quot; 1&gt;nul 2&gt;nul &amp;&amp; set _Identity=1</span><br><span class="line">pushd &quot;!_work!&quot;</span><br><span class="line">setlocal DisableDelayedExpansion</span><br><span class="line">if %winbuild% LSS 9200 if not exist &quot;%SystemRoot%\servicing\Packages\Microsoft-Windows-PowerShell-WTR-Package~*.mum&quot; set _Identity=0</span><br><span class="line"></span><br><span class="line">set &quot;SysPath=%SystemRoot%\System32&quot;</span><br><span class="line">set &quot;Path=%SystemRoot%\System32;%SystemRoot%\System32\Wbem;%SystemRoot%\System32\WindowsPowerShell\v1.0\&quot;</span><br><span class="line">if exist &quot;%SystemRoot%\Sysnative\reg.exe&quot; (</span><br><span class="line">set &quot;SysPath=%SystemRoot%\Sysnative&quot;</span><br><span class="line">set &quot;Path=%SystemRoot%\Sysnative;%SystemRoot%\Sysnative\Wbem;%SystemRoot%\Sysnative\WindowsPowerShell\v1.0\;%Path%&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set ohook=</span><br><span class="line">for %%# in (15 16) do (</span><br><span class="line">for %%A in (&quot;%ProgramFiles%&quot; &quot;%ProgramW6432%&quot; &quot;%ProgramFiles(x86)%&quot;) do (</span><br><span class="line">if exist &quot;%%~A\Microsoft Office\Office%%#\sppc*dll&quot; set ohook=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%# in (System SystemX86) do (</span><br><span class="line">for %%G in (&quot;Office 15&quot; &quot;Office&quot;) do (</span><br><span class="line">for %%A in (&quot;%ProgramFiles%&quot; &quot;%ProgramW6432%&quot; &quot;%ProgramFiles(x86)%&quot;) do (</span><br><span class="line">if exist &quot;%%~A\Microsoft %%~G\root\vfs\%%#\sppc*dll&quot; set ohook=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set _cwmi=0</span><br><span class="line">for %%# in (wmic.exe) do @if not &quot;%%~$PATH:#&quot;==&quot;&quot; (</span><br><span class="line">wmic path Win32_ComputerSystem get CreationClassName /value 2&gt;nul | find /i &quot;ComputerSystem&quot; 1&gt;nul &amp;&amp; set _cwmi=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %_cwmi% EQU 0 (</span><br><span class="line">echo:</span><br><span class="line">echo Error: WMI 在系统中无响应。</span><br><span class="line">echo:</span><br><span class="line">echo 在 MAS 中，转到故障排除并运行修复 WMI 选项。</span><br><span class="line">echo:</span><br><span class="line">echo 按任意键返回...</span><br><span class="line">pause &gt;nul</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;line2=************************************************************&quot;</span><br><span class="line">set &quot;line3=____________________________________________________________&quot;</span><br><span class="line">set &quot;_psc=powershell&quot;</span><br><span class="line"></span><br><span class="line">set _prsh=1</span><br><span class="line">for %%# in (powershell.exe) do @if &quot;%%~$PATH:#&quot;==&quot;&quot; set _prsh=0</span><br><span class="line">set &quot;_csg=cscript.exe //NoLogo //Job:WmiMulti &quot;%~nx0?.wsf&quot;&quot;</span><br><span class="line">set &quot;_csq=cscript.exe //NoLogo //Job:WmiQuery &quot;%~nx0?.wsf&quot;&quot;</span><br><span class="line">set &quot;_csx=cscript.exe //NoLogo //Job:XPDT &quot;%~nx0?.wsf&quot;&quot;</span><br><span class="line">if %_cwmi% EQU 0 set WMI_VBS=1</span><br><span class="line">if %WMI_VBS% EQU 0 (</span><br><span class="line">set &quot;_zz1=wmic path&quot;</span><br><span class="line">set &quot;_zz2=where&quot;</span><br><span class="line">set &quot;_zz3=get&quot;</span><br><span class="line">set &quot;_zz4=/value&quot;</span><br><span class="line">set &quot;_zz5=(&quot;</span><br><span class="line">set &quot;_zz6=)&quot;</span><br><span class="line">set &quot;_zz7=&quot;wmic path&quot;</span><br><span class="line">set &quot;_zz8=/value&quot;&quot;</span><br><span class="line">) else (</span><br><span class="line">set &quot;_zz1=%_csq%&quot;</span><br><span class="line">set &quot;_zz2=&quot;</span><br><span class="line">set &quot;_zz3=&quot;</span><br><span class="line">set &quot;_zz4=&quot;</span><br><span class="line">set &quot;_zz5=&quot;&quot;</span><br><span class="line">set &quot;_zz6=&quot;&quot;</span><br><span class="line">set &quot;_zz7=%_csq%&quot;</span><br><span class="line">set &quot;_zz8=&quot;</span><br><span class="line">)</span><br><span class="line">set _WSH=0</span><br><span class="line">set OsppHook=1</span><br><span class="line">sc query osppsvc &gt;nul 2&gt;&amp;1</span><br><span class="line">if %errorlevel% EQU 1060 set OsppHook=0</span><br><span class="line"></span><br><span class="line">net start sppsvc /y &gt;nul 2&gt;&amp;1</span><br><span class="line">call :casWpkey %wspp% %winApp% cW1nd0ws sppw</span><br><span class="line">if %winbuild% GEQ 9200 call :casWpkey %wspp% %o15App% c0ff1ce15 sppo</span><br><span class="line">if %OsppHook% NEQ 0 (</span><br><span class="line">net start osppsvc /y &gt;nul 2&gt;&amp;1</span><br><span class="line">call :casWpkey %ospp% %o14App% osppsvc ospp14</span><br><span class="line">if %winbuild% LSS 9200 call :casWpkey %ospp% %o15App% osppsvc ospp15</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo %line2%</span><br><span class="line">echo ***                   Windows Status                     ***</span><br><span class="line">echo %line2%</span><br><span class="line">if not defined cW1nd0ws (</span><br><span class="line">echo.</span><br><span class="line">echo Error: product key not found.</span><br><span class="line">goto :casWcon</span><br><span class="line">)</span><br><span class="line">set winID=1</span><br><span class="line">set &quot;_qr=%_zz7% %wspp% %_zz2% %_zz5%ApplicationID=&#x27;%winApp%&#x27; and PartialProductKey is not null%_zz6% %_zz3% ID %_zz8%&quot;</span><br><span class="line">for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;%_qr%&#x27;) do (</span><br><span class="line">  set &quot;chkID=%%#&quot;</span><br><span class="line">  call :casWdet &quot;%wspp%&quot; &quot;%wsps%&quot; &quot;%spp_get%&quot;</span><br><span class="line">  call :casWout</span><br><span class="line">  echo %line3%</span><br><span class="line">  echo.</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined ohook (</span><br><span class="line">echo.</span><br><span class="line">echo.</span><br><span class="line">echo %line2%</span><br><span class="line">echo ***            Office Ohook Activation Status            ***</span><br><span class="line">echo %line2%</span><br><span class="line">echo.</span><br><span class="line">powershell &quot;write-host -back &#x27;Black&#x27; -fore &#x27;Yellow&#x27; &#x27;Ohook for permanent Office activation is installed.&#x27;; write-host -back &#x27;Black&#x27; -fore &#x27;Yellow&#x27; &#x27;You can ignore below Office activation status.&#x27;&quot;</span><br><span class="line">echo.</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:casWcon</span><br><span class="line">set winID=0</span><br><span class="line">set verbose=1</span><br><span class="line">if not defined c0ff1ce15 (</span><br><span class="line">if defined osppsvc goto :casWospp</span><br><span class="line">goto :casWend</span><br><span class="line">)</span><br><span class="line">echo %line2%</span><br><span class="line">echo ***                   Office Status                      ***</span><br><span class="line">echo %line2%</span><br><span class="line">set &quot;_qr=%_zz7% %wspp% %_zz2% %_zz5%ApplicationID=&#x27;%o15App%&#x27; and PartialProductKey is not null%_zz6% %_zz3% ID %_zz8%&quot;</span><br><span class="line">for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;%_qr%&#x27;) do (</span><br><span class="line">  set &quot;chkID=%%#&quot;</span><br><span class="line">  call :casWdet &quot;%wspp%&quot; &quot;%wsps%&quot; &quot;%spp_get%&quot;</span><br><span class="line">  call :casWout</span><br><span class="line">  echo %line3%</span><br><span class="line">  echo.</span><br><span class="line">)</span><br><span class="line">set verbose=0</span><br><span class="line">if defined osppsvc goto :casWospp</span><br><span class="line">goto :casWend</span><br><span class="line"></span><br><span class="line">:casWospp</span><br><span class="line">if %verbose% EQU 1 (</span><br><span class="line">echo %line2%</span><br><span class="line">echo ***                   Office Status                      ***</span><br><span class="line">echo %line2%</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz7% %ospp% %_zz2% %_zz5%ApplicationID=&#x27;%o15App%&#x27; and PartialProductKey is not null%_zz6% %_zz3% ID %_zz8%&quot;</span><br><span class="line">if defined ospp15 for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;%_qr%&#x27;) do (</span><br><span class="line">  set &quot;chkID=%%#&quot;</span><br><span class="line">  call :casWdet &quot;%ospp%&quot; &quot;%osps%&quot; &quot;%ospp_get%&quot;</span><br><span class="line">  call :casWout</span><br><span class="line">  echo %line3%</span><br><span class="line">  echo.</span><br><span class="line">)</span><br><span class="line">set &quot;_qr=%_zz7% %ospp% %_zz2% %_zz5%ApplicationID=&#x27;%o14App%&#x27; and PartialProductKey is not null%_zz6% %_zz3% ID %_zz8%&quot;</span><br><span class="line">if defined ospp14 for /f &quot;tokens=2 delims==&quot; %%# in (&#x27;%_qr%&#x27;) do (</span><br><span class="line">  set &quot;chkID=%%#&quot;</span><br><span class="line">  call :casWdet &quot;%ospp%&quot; &quot;%osps%&quot; &quot;%ospp_get%&quot;</span><br><span class="line">  call :casWout</span><br><span class="line">  echo %line3%</span><br><span class="line">  echo.</span><br><span class="line">)</span><br><span class="line">goto :casWend</span><br><span class="line"></span><br><span class="line">:casWpkey</span><br><span class="line">set &quot;_qr=%_zz1% %1 %_zz2% %_zz5%ApplicationID=&#x27;%2&#x27; and PartialProductKey is not null%_zz6% %_zz3% ID %_zz4%&quot;</span><br><span class="line">%_qr% 2&gt;nul | findstr /i ID 1&gt;nul &amp;&amp; (set %3=1&amp;set %4=1)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:casWdet</span><br><span class="line">for %%# in (%~3) do set &quot;%%#=&quot;</span><br><span class="line">if /i %~1==%ospp% for %%# in (DiscoveredKeyManagementServiceMachineIpAddress, KeyManagementServiceLookupDomain, ProductKeyChannel, VLActivationTypeEnabled) do set &quot;%%#=&quot;</span><br><span class="line">set &quot;cKmsClient=&quot;</span><br><span class="line">set &quot;cTblClient=&quot;</span><br><span class="line">set &quot;cAvmClient=&quot;</span><br><span class="line">set &quot;ExpireMsg=&quot;</span><br><span class="line">set &quot;_xpr=&quot;</span><br><span class="line">set &quot;_qr=&quot;wmic path %~1 where ID=&#x27;%chkID%&#x27; get %~3 /value&quot; ^| findstr ^=&quot;</span><br><span class="line">if %WMI_VBS% NEQ 0 set &quot;_qr=%_csg% %~1 &quot;ID=&#x27;%chkID%&#x27;&quot; &quot;%~3&quot;&quot;</span><br><span class="line">for /f &quot;tokens=* delims=&quot; %%# in (&#x27;%_qr%&#x27;) do set &quot;%%#&quot;</span><br><span class="line"></span><br><span class="line">set /a _gpr=(GracePeriodRemaining+1440-1)/1440</span><br><span class="line">echo %Description%| findstr /i VOLUME_KMSCLIENT 1&gt;nul &amp;&amp; (set cKmsClient=1&amp;set _mTag=Volume)</span><br><span class="line">echo %Description%| findstr /i TIMEBASED_ 1&gt;nul &amp;&amp; (set cTblClient=1&amp;set _mTag=Timebased)</span><br><span class="line">echo %Description%| findstr /i VIRTUAL_MACHINE_ACTIVATION 1&gt;nul &amp;&amp; (set cAvmClient=1&amp;set _mTag=Automatic VM)</span><br><span class="line">cmd /c exit /b %LicenseStatusReason%</span><br><span class="line">set &quot;LicenseReason=%=ExitCode%&quot;</span><br><span class="line">set &quot;LicenseMsg=Time remaining: %GracePeriodRemaining% minute(s) (%_gpr% day(s))&quot;</span><br><span class="line">if %_gpr% GEQ 1 if %_WSH% EQU 1 (</span><br><span class="line">for /f &quot;tokens=* delims=&quot; %%# in (&#x27;%_csx% %GracePeriodRemaining%&#x27;) do set &quot;_xpr=%%#&quot;</span><br><span class="line">)</span><br><span class="line">if %_gpr% GEQ 1 if %_prsh% EQU 1 if not defined _xpr (</span><br><span class="line">for /f &quot;tokens=* delims=&quot; %%# in (&#x27;%_psc% &quot;$([DateTime]::Now.addMinutes(%GracePeriodRemaining%)).ToString(&#x27;yyyy-MM-dd HH:mm:ss&#x27;)&quot; 2^&gt;nul&#x27;) do set &quot;_xpr=%%#&quot;</span><br><span class="line">title 检查 激活状态 [wmi]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %LicenseStatus% EQU 0 (</span><br><span class="line">set &quot;License=Unlicensed&quot;</span><br><span class="line">set &quot;LicenseMsg=&quot;</span><br><span class="line">)</span><br><span class="line">if %LicenseStatus% EQU 1 (</span><br><span class="line">set &quot;License=Licensed&quot;</span><br><span class="line">set &quot;LicenseMsg=&quot;</span><br><span class="line">if %GracePeriodRemaining% EQU 0 (</span><br><span class="line">  if %winID% EQU 1 (set &quot;ExpireMsg=The machine is permanently activated.&quot;) else (set &quot;ExpireMsg=The product is permanently activated.&quot;)</span><br><span class="line">  ) else (</span><br><span class="line">  set &quot;LicenseMsg=%_mTag% activation expiration: %GracePeriodRemaining% minute(s) (%_gpr% day(s))&quot;</span><br><span class="line">  if defined _xpr set &quot;ExpireMsg=%_mTag% activation will expire %_xpr%&quot;</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">if %LicenseStatus% EQU 2 (</span><br><span class="line">set &quot;License=Initial grace period&quot;</span><br><span class="line">if defined _xpr set &quot;ExpireMsg=Initial grace period ends %_xpr%&quot;</span><br><span class="line">)</span><br><span class="line">if %LicenseStatus% EQU 3 (</span><br><span class="line">set &quot;License=Additional grace period (KMS license expired or hardware out of tolerance)&quot;</span><br><span class="line">if defined _xpr set &quot;ExpireMsg=Additional grace period ends %_xpr%&quot;</span><br><span class="line">)</span><br><span class="line">if %LicenseStatus% EQU 4 (</span><br><span class="line">set &quot;License=Non-genuine grace period.&quot;</span><br><span class="line">if defined _xpr set &quot;ExpireMsg=Non-genuine grace period ends %_xpr%&quot;</span><br><span class="line">)</span><br><span class="line">if %LicenseStatus% EQU 6 (</span><br><span class="line">set &quot;License=Extended grace period&quot;</span><br><span class="line">if defined _xpr set &quot;ExpireMsg=Extended grace period ends %_xpr%&quot;</span><br><span class="line">)</span><br><span class="line">if %LicenseStatus% EQU 5 (</span><br><span class="line">set &quot;License=Notification&quot;</span><br><span class="line">  if &quot;%LicenseReason%&quot;==&quot;C004F200&quot; (set &quot;LicenseMsg=Notification Reason: 0xC004F200 (non-genuine).&quot;</span><br><span class="line">  ) else if &quot;%LicenseReason%&quot;==&quot;C004F009&quot; (set &quot;LicenseMsg=Notification Reason: 0xC004F009 (grace time expired).&quot;</span><br><span class="line">  ) else (set &quot;LicenseMsg=Notification Reason: 0x%LicenseReason%&quot;</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">if %LicenseStatus% GTR 6 (</span><br><span class="line">set &quot;License=Unknown&quot;</span><br><span class="line">set &quot;LicenseMsg=&quot;</span><br><span class="line">)</span><br><span class="line">if not defined cKmsClient exit /b</span><br><span class="line"></span><br><span class="line">if %KeyManagementServicePort%==0 set KeyManagementServicePort=1688</span><br><span class="line">set &quot;KmsReg=Registered KMS machine name: %KeyManagementServiceMachine%:%KeyManagementServicePort%&quot;</span><br><span class="line">if &quot;%KeyManagementServiceMachine%&quot;==&quot;&quot; set &quot;KmsReg=Registered KMS machine name: KMS name not available&quot;</span><br><span class="line"></span><br><span class="line">if %DiscoveredKeyManagementServiceMachinePort%==0 set DiscoveredKeyManagementServiceMachinePort=1688</span><br><span class="line">set &quot;KmsDns=KMS machine name from DNS: %DiscoveredKeyManagementServiceMachineName%:%DiscoveredKeyManagementServiceMachinePort%&quot;</span><br><span class="line">if &quot;%DiscoveredKeyManagementServiceMachineName%&quot;==&quot;&quot; set &quot;KmsDns=DNS auto-discovery: KMS name not available&quot;</span><br><span class="line"></span><br><span class="line">set &quot;_qr=&quot;wmic path %~2 get ClientMachineID, KeyManagementServiceHostCaching /value&quot; ^| findstr ^=&quot;</span><br><span class="line">if %WMI_VBS% NEQ 0 set &quot;_qr=%_csg% %~2 &quot;ClientMachineID, KeyManagementServiceHostCaching&quot;&quot;</span><br><span class="line">for /f &quot;tokens=* delims=&quot; %%# in (&#x27;%_qr%&#x27;) do set &quot;%%#&quot;</span><br><span class="line">if /i %KeyManagementServiceHostCaching%==True (set KeyManagementServiceHostCaching=Enabled) else (set KeyManagementServiceHostCaching=Disabled)</span><br><span class="line"></span><br><span class="line">if %winbuild% LSS 9200 exit /b</span><br><span class="line">if /i %~1==%ospp% exit /b</span><br><span class="line"></span><br><span class="line">if &quot;%KeyManagementServiceLookupDomain%&quot;==&quot;&quot; set &quot;KeyManagementServiceLookupDomain=&quot;</span><br><span class="line"></span><br><span class="line">if %VLActivationTypeEnabled% EQU 3 (</span><br><span class="line">set VLActivationType=Token</span><br><span class="line">) else if %VLActivationTypeEnabled% EQU 2 (</span><br><span class="line">set VLActivationType=KMS</span><br><span class="line">) else if %VLActivationTypeEnabled% EQU 1 (</span><br><span class="line">set VLActivationType=AD</span><br><span class="line">) else (</span><br><span class="line">set VLActivationType=All</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %winbuild% LSS 9600 exit /b</span><br><span class="line">if &quot;%DiscoveredKeyManagementServiceMachineIpAddress%&quot;==&quot;&quot; set &quot;DiscoveredKeyManagementServiceMachineIpAddress=not available&quot;</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:casWout</span><br><span class="line">echo.</span><br><span class="line">echo Name: %Name%</span><br><span class="line">echo Description: %Description%</span><br><span class="line">echo Activation ID: %ID%</span><br><span class="line">echo Extended PID: %ProductKeyID%</span><br><span class="line">if defined ProductKeyChannel echo Product Key Channel: %ProductKeyChannel%</span><br><span class="line">echo Partial Product Key: %PartialProductKey%</span><br><span class="line">echo License Status: %License%</span><br><span class="line">if defined LicenseMsg echo %LicenseMsg%</span><br><span class="line">if not %LicenseStatus%==0 if not %EvaluationEndDate:~0,8%==16010101 echo Evaluation End Date: %EvaluationEndDate:~0,4%-%EvaluationEndDate:~4,2%-%EvaluationEndDate:~6,2% %EvaluationEndDate:~8,2%:%EvaluationEndDate:~10,2% UTC</span><br><span class="line">if not defined cKmsClient (</span><br><span class="line">if defined ExpireMsg echo.&amp;echo.    %ExpireMsg%</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">if defined VLActivationTypeEnabled echo Configured Activation Type: %VLActivationType%</span><br><span class="line">echo.</span><br><span class="line">if not %LicenseStatus%==1 (</span><br><span class="line">echo Please activate the product in order to update KMS client information values.</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">echo Most recent activation information:</span><br><span class="line">echo Key Management Service client information</span><br><span class="line">echo.    Client Machine ID (CMID): %ClientMachineID%</span><br><span class="line">echo.    %KmsDns%</span><br><span class="line">echo.    %KmsReg%</span><br><span class="line">if defined DiscoveredKeyManagementServiceMachineIpAddress echo.    KMS machine IP address: %DiscoveredKeyManagementServiceMachineIpAddress%</span><br><span class="line">echo.    KMS machine extended PID: %KeyManagementServiceProductKeyID%</span><br><span class="line">echo.    Activation interval: %VLActivationInterval% minutes</span><br><span class="line">echo.    Renewal interval: %VLRenewalInterval% minutes</span><br><span class="line">echo.    KMS host caching: %KeyManagementServiceHostCaching%</span><br><span class="line">if defined KeyManagementServiceLookupDomain echo.    KMS SRV record lookup domain: %KeyManagementServiceLookupDomain%</span><br><span class="line">if defined ExpireMsg echo.&amp;echo.    %ExpireMsg%</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:casWend</span><br><span class="line">if %_Identity% EQU 1 if %_prsh% EQU 1 (</span><br><span class="line">echo %line2%</span><br><span class="line">echo ***                  Office vNext Status                 ***</span><br><span class="line">echo %line2%</span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line">%_psc% &quot;$f=[IO.File]::ReadAllText(&#x27;!_batp!&#x27;) -split &#x27;:vNextDiag\:.*&#x27;;iex ($f[1])&quot;</span><br><span class="line">title 检查 激活状态 [wmi]</span><br><span class="line">echo %line3%</span><br><span class="line">echo.</span><br><span class="line">)</span><br><span class="line">echo.</span><br><span class="line">call :_color %_Yellow% &quot;按任意键返回...&quot;</span><br><span class="line">pause &gt;nul</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:vNextDiag:</span><br><span class="line">function PrintModePerPridFromRegistry</span><br><span class="line">&#123;</span><br><span class="line">	$vNextRegkey = &quot;HKCU:\SOFTWARE\Microsoft\Office\16.0\Common\Licensing\LicensingNext&quot;</span><br><span class="line">	$vNextPrids = Get-Item -Path $vNextRegkey -ErrorAction Ignore | Select-Object -ExpandProperty &#x27;property&#x27; | Where-Object -FilterScript &#123;$_.ToLower() -like &quot;*retail&quot; -or $_.ToLower() -like &quot;*volume&quot;&#125;</span><br><span class="line">	If ($vNextPrids -Eq $null)</span><br><span class="line">	&#123;</span><br><span class="line">		Write-Host &quot;No registry keys found.&quot;</span><br><span class="line">		Return</span><br><span class="line">	&#125;</span><br><span class="line">	$vNextPrids | ForEach `</span><br><span class="line">	&#123;</span><br><span class="line">		$mode = (Get-ItemProperty -Path $vNextRegkey -Name $_).$_</span><br><span class="line">		Switch ($mode)</span><br><span class="line">		&#123;</span><br><span class="line">			2 &#123; $mode = &quot;vNext&quot;; Break &#125;</span><br><span class="line">			3 &#123; $mode = &quot;Device&quot;; Break &#125;</span><br><span class="line">			Default &#123; $mode = &quot;Legacy&quot;; Break &#125;</span><br><span class="line">		&#125;</span><br><span class="line">		Write-Host $_ = $mode</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">function PrintSharedComputerLicensing</span><br><span class="line">&#123;</span><br><span class="line">	$scaRegKey = &quot;HKLM:\SOFTWARE\Microsoft\Office\ClickToRun\Configuration&quot;</span><br><span class="line">	$scaValue = Get-ItemProperty -Path $scaRegKey -ErrorAction Ignore | Select-Object -ExpandProperty &quot;SharedComputerLicensing&quot; -ErrorAction Ignore</span><br><span class="line">	$scaRegKey2 = &quot;HKLM:\SOFTWARE\Microsoft\Office\16.0\Common\Licensing&quot;</span><br><span class="line">	$scaValue2 = Get-ItemProperty -Path $scaRegKey2 -ErrorAction Ignore | Select-Object -ExpandProperty &quot;SharedComputerLicensing&quot; -ErrorAction Ignore</span><br><span class="line">	$scaPolicyKey = &quot;HKLM:\SOFTWARE\Policies\Microsoft\Office\16.0\Common\Licensing&quot;</span><br><span class="line">	$scaPolicyValue = Get-ItemProperty -Path $scaPolicyKey -ErrorAction Ignore | Select-Object -ExpandProperty &quot;SharedComputerLicensing&quot; -ErrorAction Ignore</span><br><span class="line">	If ($scaValue -Eq $null -And $scaValue2 -Eq $null -And $scaPolicyValue -Eq $null)</span><br><span class="line">	&#123;</span><br><span class="line">		Write-Host &quot;No registry keys found.&quot;</span><br><span class="line">		Return</span><br><span class="line">	&#125;</span><br><span class="line">	$scaModeValue = $scaValue -Or $scaValue2 -Or $scaPolicyValue</span><br><span class="line">	If ($scaModeValue -Eq 0)</span><br><span class="line">	&#123;</span><br><span class="line">		$scaMode = &quot;Disabled&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	If ($scaModeValue -Eq 1)</span><br><span class="line">	&#123;</span><br><span class="line">		$scaMode = &quot;Enabled&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	Write-Host &quot;SharedComputerLicensing&quot; = $scaMode</span><br><span class="line">	Write-Host</span><br><span class="line">	$tokenFiles = $null</span><br><span class="line">	$tokenPath = &quot;$&#123;env:LOCALAPPDATA&#125;\Microsoft\Office\16.0\Licensing&quot;</span><br><span class="line">	If (Test-Path $tokenPath)</span><br><span class="line">	&#123;</span><br><span class="line">		$tokenFiles = Get-ChildItem -Path $tokenPath -Recurse -File -Filter &quot;*authString*&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	If ($tokenFiles.length -Eq 0)</span><br><span class="line">	&#123;</span><br><span class="line">		Write-Host &quot;No tokens found.&quot;</span><br><span class="line">		Return</span><br><span class="line">	&#125;</span><br><span class="line">	$tokenFiles | ForEach `</span><br><span class="line">	&#123;</span><br><span class="line">		$tokenParts = (Get-Content -Encoding Unicode -Path $_.FullName).Split(&#x27;_&#x27;)</span><br><span class="line">		$output = [PSCustomObject] `</span><br><span class="line">			@&#123;</span><br><span class="line">				ACID = $tokenParts[0];</span><br><span class="line">				User = $tokenParts[3]</span><br><span class="line">				NotBefore = $tokenParts[4];</span><br><span class="line">				NotAfter = $tokenParts[5];</span><br><span class="line">			&#125; | ConvertTo-Json</span><br><span class="line">		Write-Host $output</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">function PrintLicensesInformation</span><br><span class="line">&#123;</span><br><span class="line">	Param(</span><br><span class="line">		[ValidateSet(&quot;NUL&quot;, &quot;Device&quot;)]</span><br><span class="line">		[String]$mode</span><br><span class="line">	)</span><br><span class="line">	If ($mode -Eq &quot;NUL&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		$licensePath = &quot;$&#123;env:LOCALAPPDATA&#125;\Microsoft\Office\Licenses&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	ElseIf ($mode -Eq &quot;Device&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		$licensePath = &quot;$&#123;env:PROGRAMDATA&#125;\Microsoft\Office\Licenses&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	$licenseFiles = $null</span><br><span class="line">	If (Test-Path $licensePath)</span><br><span class="line">	&#123;</span><br><span class="line">		$licenseFiles = Get-ChildItem -Path $licensePath -Recurse -File</span><br><span class="line">	&#125;</span><br><span class="line">	If ($licenseFiles.length -Eq 0)</span><br><span class="line">	&#123;</span><br><span class="line">		Write-Host &quot;No licenses found.&quot;</span><br><span class="line">		Return</span><br><span class="line">	&#125;</span><br><span class="line">	$licenseFiles | ForEach `</span><br><span class="line">	&#123;</span><br><span class="line">		$license = (Get-Content -Encoding Unicode $_.FullName | ConvertFrom-Json).License</span><br><span class="line">		$decodedLicense = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($license)) | ConvertFrom-Json</span><br><span class="line">		$licenseType = $decodedLicense.LicenseType</span><br><span class="line">		If ($null -Ne $decodedLicense.ExpiresOn)</span><br><span class="line">		&#123;</span><br><span class="line">			$expiry = [DateTime]::Parse($decodedLicense.ExpiresOn, $null, 48)</span><br><span class="line">		&#125;</span><br><span class="line">		Else</span><br><span class="line">		&#123;</span><br><span class="line">			$expiry = New-Object DateTime</span><br><span class="line">		&#125;</span><br><span class="line">		$licenseState = $null</span><br><span class="line">		If ((Get-Date) -Gt (Get-Date $decodedLicense.MetaData.NotAfter))</span><br><span class="line">		&#123;</span><br><span class="line">			$licenseState = &quot;RFM&quot;</span><br><span class="line">		&#125;</span><br><span class="line">		ElseIf ((Get-Date) -Lt (Get-Date $expiry))</span><br><span class="line">		&#123;</span><br><span class="line">			$licenseState = &quot;Licensed&quot;</span><br><span class="line">		&#125;</span><br><span class="line">		Else</span><br><span class="line">		&#123;</span><br><span class="line">			$licenseState = &quot;Grace&quot;</span><br><span class="line">		&#125;</span><br><span class="line">		if ($mode -Eq &quot;NUL&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			$output = [PSCustomObject] `</span><br><span class="line">			@&#123;</span><br><span class="line">				Version = $_.Directory.Name</span><br><span class="line">				Type = &quot;User|$&#123;licenseType&#125;&quot;;</span><br><span class="line">				Product = $decodedLicense.ProductReleaseId;</span><br><span class="line">				Acid = $decodedLicense.Acid;</span><br><span class="line">				LicenseState = $licenseState;</span><br><span class="line">				EntitlementStatus = $decodedLicense.Status;</span><br><span class="line">				EntitlementExpiration = $decodedLicense.ExpiresOn;</span><br><span class="line">				ReasonCode = $decodedLicense.ReasonCode;</span><br><span class="line">				NotBefore = $decodedLicense.Metadata.NotBefore;</span><br><span class="line">				NotAfter = $decodedLicense.Metadata.NotAfter;</span><br><span class="line">				NextRenewal = $decodedLicense.Metadata.RenewAfter;</span><br><span class="line">				TenantId = $decodedLicense.Metadata.TenantId;</span><br><span class="line">			&#125; | ConvertTo-Json</span><br><span class="line">		&#125;</span><br><span class="line">		ElseIf ($mode -Eq &quot;Device&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			$output = [PSCustomObject] `</span><br><span class="line">			@&#123;</span><br><span class="line">				Version = $_.Directory.Name</span><br><span class="line">				Type = &quot;Device|$&#123;licenseType&#125;&quot;;</span><br><span class="line">				Product = $decodedLicense.ProductReleaseId;</span><br><span class="line">				Acid = $decodedLicense.Acid;</span><br><span class="line">				DeviceId = $decodedLicense.Metadata.DeviceId;</span><br><span class="line">				LicenseState = $licenseState;</span><br><span class="line">				EntitlementStatus = $decodedLicense.Status;</span><br><span class="line">				EntitlementExpiration = $decodedLicense.ExpiresOn;</span><br><span class="line">				ReasonCode = $decodedLicense.ReasonCode;</span><br><span class="line">				NotBefore = $decodedLicense.Metadata.NotBefore;</span><br><span class="line">				NotAfter = $decodedLicense.Metadata.NotAfter;</span><br><span class="line">				NextRenewal = $decodedLicense.Metadata.RenewAfter;</span><br><span class="line">				TenantId = $decodedLicense.Metadata.TenantId;</span><br><span class="line">			&#125; | ConvertTo-Json</span><br><span class="line">		&#125;</span><br><span class="line">		Write-Output $output</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">	Write-Host</span><br><span class="line">	Write-Host &quot;========== Mode per ProductReleaseId ==========&quot;</span><br><span class="line">	Write-Host</span><br><span class="line">PrintModePerPridFromRegistry</span><br><span class="line">	Write-Host</span><br><span class="line">	Write-Host &quot;========== Shared Computer Licensing ==========&quot;</span><br><span class="line">	Write-Host</span><br><span class="line">PrintSharedComputerLicensing</span><br><span class="line">	Write-Host</span><br><span class="line">	Write-Host &quot;========== vNext licenses ==========&quot;</span><br><span class="line">	Write-Host</span><br><span class="line">PrintLicensesInformation -Mode &quot;NUL&quot;</span><br><span class="line">	Write-Host</span><br><span class="line">	Write-Host &quot;========== Device licenses ==========&quot;</span><br><span class="line">	Write-Host</span><br><span class="line">PrintLicensesInformation -Mode &quot;Device&quot;</span><br><span class="line">:vNextDiag:</span><br><span class="line"></span><br><span class="line">:+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class="line"></span><br><span class="line">:troubleshoot</span><br><span class="line">@setlocal DisableDelayedExpansion</span><br><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">color 07</span><br><span class="line">title  故障排除</span><br><span class="line"></span><br><span class="line">set _args=</span><br><span class="line">set _elev=</span><br><span class="line"></span><br><span class="line">set _args=%*</span><br><span class="line">if defined _args set _args=%_args:&quot;=%</span><br><span class="line">if defined _args (</span><br><span class="line">for %%A in (%_args%) do (</span><br><span class="line">if /i &quot;%%A&quot;==&quot;-el&quot;                    set _elev=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;nul1=1&gt;nul&quot;</span><br><span class="line">set &quot;nul2=2&gt;nul&quot;</span><br><span class="line">set &quot;nul6=2^&gt;nul&quot;</span><br><span class="line">set &quot;nul=&gt;nul 2&gt;&amp;1&quot;</span><br><span class="line"></span><br><span class="line">set psc=powershell.exe</span><br><span class="line">set winbuild=1</span><br><span class="line">for /f &quot;tokens=6 delims=[]. &quot; %%G in (&#x27;ver&#x27;) do set winbuild=%%G</span><br><span class="line"></span><br><span class="line">set _NCS=1</span><br><span class="line">if %winbuild% LSS 10586 set _NCS=0</span><br><span class="line">if %winbuild% GEQ 10586 reg query &quot;HKCU\Console&quot; /v ForceV2 %nul2% | find /i &quot;0x0&quot; %nul1% &amp;&amp; (set _NCS=0)</span><br><span class="line"></span><br><span class="line">call :_colorprep</span><br><span class="line"></span><br><span class="line">set &quot;nceline=echo: &amp;echo ==== ERROR ==== &amp;echo:&quot;</span><br><span class="line">set &quot;eline=echo: &amp;call :_color %Red% &quot;==== ERROR ====&quot; &amp;echo:&quot;</span><br><span class="line">set &quot;line=_________________________________________________________________________________________________&quot;</span><br><span class="line">if %~z0 GEQ 200000 (set &quot;_exitmsg=Go back&quot;) else (set &quot;_exitmsg=Exit&quot;)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Fix for the special characters limitation in path name</span><br><span class="line"></span><br><span class="line">set &quot;_work=%~dp0&quot;</span><br><span class="line">if &quot;%_work:~-1%&quot;==&quot;\&quot; set &quot;_work=%_work:~0,-1%&quot;</span><br><span class="line"></span><br><span class="line">set &quot;_batf=%~f0&quot;</span><br><span class="line">set &quot;_batp=%_batf:&#x27;=&#x27;&#x27;%&quot;</span><br><span class="line"></span><br><span class="line">set _PSarg=&quot;&quot;&quot;%~f0&quot;&quot;&quot; -el %_args%</span><br><span class="line"></span><br><span class="line">set &quot;_ttemp=%temp%&quot;</span><br><span class="line"></span><br><span class="line">::  Check desktop location</span><br><span class="line"></span><br><span class="line">set desktop=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders&quot; /v Desktop&#x27;) do call set &quot;desktop=%%b&quot;</span><br><span class="line">if not defined desktop for /f &quot;delims=&quot; %%a in (&#x27;%psc% &quot;&amp; &#123;write-host $([Environment]::GetFolderPath(&#x27;Desktop&#x27;))&#125;&quot;&#x27;) do call set &quot;desktop=%%a&quot;</span><br><span class="line"></span><br><span class="line">if not defined desktop (</span><br><span class="line">%eline%</span><br><span class="line">echo Desktop location was not detected, aborting...</span><br><span class="line">goto at_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:at_menu</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">color 07</span><br><span class="line">title  故障排除</span><br><span class="line">mode con cols=77 lines=30</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">echo:       _______________________________________________________________</span><br><span class="line">echo:                                                   </span><br><span class="line">call :_color2 %_White% &quot;             [1] &quot; %_Green% &quot;帮助&quot;</span><br><span class="line">echo:             ___________________________________________________</span><br><span class="line">echo:                                                                      </span><br><span class="line">echo:             [2] Dism RestoreHealth</span><br><span class="line">echo:             [3] SFC Scannow</span><br><span class="line">echo:                                                                      </span><br><span class="line">echo:             [4] 修复 WMI</span><br><span class="line">echo:             [5] 修复 Licensing</span><br><span class="line">echo:             [6] 修复 WPA Registry</span><br><span class="line">echo:             ___________________________________________________</span><br><span class="line">echo:</span><br><span class="line">echo:             [0] %_exitmsg%</span><br><span class="line">echo:       _______________________________________________________________</span><br><span class="line">echo:          </span><br><span class="line">call :_color2 %_White% &quot;            &quot; %_Green% &quot;通过键盘输入菜单选项 ：&quot;</span><br><span class="line">choice /C:1234560 /N</span><br><span class="line">set _erl=%errorlevel%</span><br><span class="line"></span><br><span class="line">if %_erl%==7 exit /b</span><br><span class="line">if %_erl%==6 start %mas%fix-wpa-registry.html &amp;goto at_menu</span><br><span class="line">if %_erl%==5 goto:retokens</span><br><span class="line">if %_erl%==4 goto:fixwmi</span><br><span class="line">if %_erl%==3 goto:sfcscan</span><br><span class="line">if %_erl%==2 goto:dism_rest</span><br><span class="line">if %_erl%==1 start %mas%troubleshoot.html &amp;goto at_menu</span><br><span class="line">goto :at_menu</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:dism_rest</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode 98, 30</span><br><span class="line">title  Dism /English /Online /Cleanup-Image /RestoreHealth</span><br><span class="line"></span><br><span class="line">if %winbuild% LSS 9200 (</span><br><span class="line">%eline%</span><br><span class="line">echo Unsupported OS version Detected.</span><br><span class="line">echo This command is supported only for Windows 8/8.1/10/11 and their Server equivalent.</span><br><span class="line">goto :at_back</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set _int=</span><br><span class="line">for %%a in (l.root-servers.net resolver1.opendns.com download.windowsupdate.com google.com) do if not defined _int (</span><br><span class="line">for /f &quot;delims=[] tokens=2&quot; %%# in (&#x27;ping -n 1 %%a&#x27;) do (if not [%%#]==[] set _int=1)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if defined _int (</span><br><span class="line">echo      Checking Internet Connection  [Connected]</span><br><span class="line">) else (</span><br><span class="line">call :_color2 %_White% &quot;     &quot; %Red% &quot;检查网络连接  [未连接]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">echo      Dism uses Windows Update to provide the files required to fix corruption.</span><br><span class="line">echo      This will take 5-15 minutes or more..</span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">echo      Notes:</span><br><span class="line">echo:</span><br><span class="line">call :_color2 %_White% &quot;     - &quot; %Gray% &quot;请确保您的网络已连接。&quot;</span><br><span class="line">call :_color2 %_White% &quot;     - &quot; %Gray% &quot;请确保 Windows 更新正常运行。&quot;</span><br><span class="line">echo:</span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">choice /C:09 /N /M &quot;&gt;    [9] 继续 [0] Go back : &quot;</span><br><span class="line">if %errorlevel%==1 goto at_menu</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode 110, 30</span><br><span class="line">call :_stopservice TrustedInstaller</span><br><span class="line"></span><br><span class="line">set _time=</span><br><span class="line">for /f %%a in (&#x27;%psc% &quot;Get-Date -format HH_mm_ss&quot;&#x27;) do set _time=%%a</span><br><span class="line">echo:</span><br><span class="line">echo Applying the command,</span><br><span class="line">echo dism /english /online /cleanup-image /restorehealth</span><br><span class="line">dism /english /online /cleanup-image /restorehealth</span><br><span class="line"></span><br><span class="line">call :_stopservice TrustedInstaller</span><br><span class="line"></span><br><span class="line">if not exist &quot;!desktop!\AT_Logs\&quot; md &quot;!desktop!\AT_Logs\&quot; %nul%</span><br><span class="line"></span><br><span class="line">call :compresslog cbs\CBS.log RHealth_CBS %nul%</span><br><span class="line">call :compresslog DISM\dism.log RHealth_DISM %nul%</span><br><span class="line"></span><br><span class="line">if not exist &quot;!desktop!\AT_Logs\RHealth_CBS_%_time%.cab&quot; (</span><br><span class="line">copy /y /b &quot;%SystemRoot%\logs\cbs\cbs.log&quot; &quot;!desktop!\AT_Logs\RHealth_CBS_%_time%.log&quot; %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not exist &quot;!desktop!\AT_Logs\RHealth_DISM_%_time%.cab&quot; (</span><br><span class="line">copy /y /b &quot;%SystemRoot%\logs\DISM\dism.log&quot; &quot;!desktop!\AT_Logs\RHealth_DISM_%_time%.log&quot; %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">call :_color %Gray% &quot;CBS 和 DISM 日志会复制到桌面上的 AT_Logs 文件夹。&quot;</span><br><span class="line">goto :at_back</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:sfcscan</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode 98, 30</span><br><span class="line">title  sfc /scannow</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo %line%</span><br><span class="line">echo:    </span><br><span class="line">echo      System File Checker will repair missing or corrupted system files.</span><br><span class="line">echo      This will take 10-15 minutes or more..</span><br><span class="line">echo:</span><br><span class="line">echo      If SFC could not fix something, then run the command again to see if it may be able </span><br><span class="line">echo      to the next time. Sometimes it may take running the sfc /scannow command 3 times</span><br><span class="line">echo      restarting the PC after each time to completely fix everything that it&#x27;s able to.</span><br><span class="line">echo:   </span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">choice /C:09 /N /M &quot;&gt;    [9] 继续 [0] Go back : &quot;</span><br><span class="line">if %errorlevel%==1 goto at_menu</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">call :_stopservice TrustedInstaller</span><br><span class="line"></span><br><span class="line">set _time=</span><br><span class="line">for /f %%a in (&#x27;%psc% &quot;Get-Date -format HH_mm_ss&quot;&#x27;) do set _time=%%a</span><br><span class="line">echo:</span><br><span class="line">echo Applying the command,</span><br><span class="line">echo sfc /scannow</span><br><span class="line">sfc /scannow</span><br><span class="line"></span><br><span class="line">call :_stopservice TrustedInstaller</span><br><span class="line"></span><br><span class="line">if not exist &quot;!desktop!\AT_Logs\&quot; md &quot;!desktop!\AT_Logs\&quot; %nul%</span><br><span class="line"></span><br><span class="line">call :compresslog cbs\CBS.log SFC_CBS %nul%</span><br><span class="line"></span><br><span class="line">if not exist &quot;!desktop!\AT_Logs\SFC_CBS_%_time%.cab&quot; (</span><br><span class="line">copy /y /b &quot;%SystemRoot%\logs\cbs\cbs.log&quot; &quot;!desktop!\AT_Logs\SFC_CBS_%_time%.log&quot; %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">call :_color %Gray% &quot;CBS 日志将被复制到桌面上的 AT_Logs 文件夹中。&quot;</span><br><span class="line">goto :at_back</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:retokens</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode con cols=115 lines=32</span><br><span class="line">%psc% &quot;&amp;&#123;$W=$Host.UI.RawUI.WindowSize;$B=$Host.UI.RawUI.BufferSize;$W.Height=31;$B.Height=200;$Host.UI.RawUI.WindowSize=$W;$Host.UI.RawUI.BufferSize=$B;&#125;&quot;</span><br><span class="line">title  修复 Licensing ^(ClipSVC ^+ Office vNext ^+ SPP ^+ OSPP^)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo %line%</span><br><span class="line">echo:   </span><br><span class="line">echo      Notes:</span><br><span class="line">echo:</span><br><span class="line">echo       - It helps in troubleshooting activation issues.</span><br><span class="line">echo:</span><br><span class="line">echo       - This option will,</span><br><span class="line">echo            - Deactivate Windows and Office, you may need to reactivate</span><br><span class="line">echo            - Clear ClipSVC, Office vNext, SPP and OSPP licenses</span><br><span class="line">echo            - Fix SPP permissions of tokens folder and registries</span><br><span class="line">echo            - Trigger the repair option for Office.</span><br><span class="line">echo:</span><br><span class="line">call :_color2 %_White% &quot;      - &quot; %Red% &quot;只在必要时使用。&quot;</span><br><span class="line">echo:</span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">choice /C:09 /N /M &quot;&gt;    [9] 继续 [0] 返回 : &quot;</span><br><span class="line">if %errorlevel%==1 goto at_menu</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Rebuild ClipSVC Licences</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">:cleanlicensing</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">call :_color %Blue% &quot;重建 ClipSVC 许可证&quot;</span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">if %winbuild% LSS 10240 (</span><br><span class="line">echo ClipSVC Licence rebuilding is supported only on Win 10/11 and Server equivalent.</span><br><span class="line">echo Skipping...</span><br><span class="line">goto :cleanvnext</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">%psc% &quot;(([WMISEARCHER]&#x27;SELECT Name FROM SoftwareLicensingProduct WHERE LicenseStatus=1 AND GracePeriodRemaining=0 AND PartialProductKey IS NOT NULL&#x27;).Get()).Name&quot; %nul2% | findstr /i &quot;Windows&quot; %nul1% &amp;&amp; (</span><br><span class="line">echo Windows is permanently activated.</span><br><span class="line">echo Skipping 重建 ClipSVC 许可证...</span><br><span class="line">goto :cleanvnext</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo Stopping ClipSVC service...</span><br><span class="line">call :_stopservice ClipSVC</span><br><span class="line">timeout /t 2 %nul%</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Applying the command to Clean ClipSVC Licences...</span><br><span class="line">echo rundll32 clipc.dll,ClipCleanUpState</span><br><span class="line"></span><br><span class="line">rundll32 clipc.dll,ClipCleanUpState</span><br><span class="line"></span><br><span class="line">if %winbuild% LEQ 10240 (</span><br><span class="line">echo [成功]</span><br><span class="line">) else (</span><br><span class="line">if exist &quot;%ProgramData%\Microsoft\Windows\ClipSVC\tokens.dat&quot; (</span><br><span class="line">call :_color %Red% &quot;[失败]&quot;</span><br><span class="line">) else (</span><br><span class="line">echo [成功]</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::  Below registry key (Volatile &amp; Protected) gets created after the ClipSVC License cleanup command, and gets automatically deleted after </span><br><span class="line">::  system restart. It needs to be deleted to activate the system without restart.</span><br><span class="line"></span><br><span class="line">set &quot;RegKey=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ClipSVC\Volatile\PersistedSystemState&quot;</span><br><span class="line">set &quot;_ident=HKU\S-1-5-19\SOFTWARE\Microsoft\IdentityCRL&quot;</span><br><span class="line"></span><br><span class="line">reg query &quot;%RegKey%&quot; %nul% &amp;&amp; %nul% call :regownstart</span><br><span class="line">reg delete &quot;%RegKey%&quot; /f %nul% </span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Deleting a Volatile ^&amp; Protected Registry Key...</span><br><span class="line">echo [%RegKey%]</span><br><span class="line">reg query &quot;%RegKey%&quot; %nul% &amp;&amp; (</span><br><span class="line">call :_color %Red% &quot;[失败]&quot;</span><br><span class="line">echo Restart the system, that will delete this registry key automatically.</span><br><span class="line">) || (</span><br><span class="line">echo [成功]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::   Clear HWID token related registry to fix activation incase if there is any corruption</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Deleting a IdentityCRL Registry Key...</span><br><span class="line">echo [%_ident%]</span><br><span class="line">reg delete &quot;%_ident%&quot; /f %nul%</span><br><span class="line">reg query &quot;%_ident%&quot; %nul% &amp;&amp; (</span><br><span class="line">call :_color %Red% &quot;[失败]&quot;</span><br><span class="line">) || (</span><br><span class="line">echo [成功]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :_stopservice ClipSVC</span><br><span class="line"></span><br><span class="line">::  Rebuild ClipSVC folder to fix permission issues</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if %winbuild% GTR 10240 (</span><br><span class="line">echo Deleting Folder %ProgramData%\Microsoft\Windows\ClipSVC\</span><br><span class="line">rmdir /s /q &quot;C:\ProgramData\Microsoft\Windows\ClipSvc&quot; %nul%</span><br><span class="line"></span><br><span class="line">if exist &quot;%ProgramData%\Microsoft\Windows\ClipSVC\&quot; (</span><br><span class="line">call :_color %Red% &quot;[失败]&quot;</span><br><span class="line">) else (</span><br><span class="line">echo [成功]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Rebuilding Folder %ProgramData%\Microsoft\Windows\ClipSVC\</span><br><span class="line">net start ClipSVC /y %nul%</span><br><span class="line">timeout /t 3 %nul%</span><br><span class="line">if not exist &quot;%ProgramData%\Microsoft\Windows\ClipSVC\&quot; timeout /t 5 %nul%</span><br><span class="line">if not exist &quot;%ProgramData%\Microsoft\Windows\ClipSVC\&quot; (</span><br><span class="line">call :_color %Red% &quot;[失败]&quot;</span><br><span class="line">) else (</span><br><span class="line">echo [成功]</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Restarting [wlidsvc LicenseManager] services...</span><br><span class="line">for %%# in (wlidsvc LicenseManager) do (net stop %%# /y %nul% &amp; net start %%# /y %nul%)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Clear Office vNext License</span><br><span class="line"></span><br><span class="line">:cleanvnext</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">call :_color %Blue% &quot;清除 Office vNext 许可证&quot;</span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">setlocal DisableDelayedExpansion</span><br><span class="line">set &quot;_Local=%LocalAppData%&quot;</span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line"></span><br><span class="line">attrib -R &quot;!ProgramData!\Microsoft\Office\Licenses&quot; %nul%</span><br><span class="line">attrib -R &quot;!_Local!\Microsoft\Office\Licenses&quot; %nul%</span><br><span class="line"></span><br><span class="line">if exist &quot;!ProgramData!\Microsoft\Office\Licenses\&quot; (</span><br><span class="line">rd /s /q &quot;!ProgramData!\Microsoft\Office\Licenses\&quot; %nul%</span><br><span class="line">if exist &quot;!ProgramData!\Microsoft\Office\Licenses\&quot; (</span><br><span class="line">echo Failed To Delete - !ProgramData!\Microsoft\Office\Licenses\</span><br><span class="line">) else (</span><br><span class="line">echo Deleted Folder - !ProgramData!\Microsoft\Office\Licenses\</span><br><span class="line">)</span><br><span class="line">) else (</span><br><span class="line">echo Not Found - !ProgramData!\Microsoft\Office\Licenses\</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if exist &quot;!_Local!\Microsoft\Office\Licenses\&quot; (</span><br><span class="line">rd /s /q &quot;!_Local!\Microsoft\Office\Licenses\&quot; %nul%</span><br><span class="line">if exist &quot;!_Local!\Microsoft\Office\Licenses\&quot; (</span><br><span class="line">echo Failed To Delete - !_Local!\Microsoft\Office\Licenses\</span><br><span class="line">) else (</span><br><span class="line">echo Deleted Folder - !_Local!\Microsoft\Office\Licenses\</span><br><span class="line">)</span><br><span class="line">) else (</span><br><span class="line">echo Not Found - !_Local!\Microsoft\Office\Licenses\</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">for %%# in (</span><br><span class="line">HKCU\Software\Microsoft\Office\16.0\Common\Licensing</span><br><span class="line">HKCU\Software\Microsoft\Office\16.0\Registration</span><br><span class="line">) do (</span><br><span class="line">reg query %%# %nul% &amp;&amp; (</span><br><span class="line">reg delete %%# /f %nul% &amp;&amp; (</span><br><span class="line">echo Deleted Registry - %%#</span><br><span class="line">) || (</span><br><span class="line">echo Failed to Delete - %%#</span><br><span class="line">)</span><br><span class="line">) || (</span><br><span class="line">echo Not Found Registry - %%#</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Rebuild SPP Tokens</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">call :_color %Blue% &quot;重建 SPP 许可令牌&quot;</span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">call :scandat check</span><br><span class="line"></span><br><span class="line">if not defined token (</span><br><span class="line">call :_color %Red% &quot;tokens.dat 文件未找到.&quot;</span><br><span class="line">) else (</span><br><span class="line">echo tokens.dat file: [%token%]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 14393 (</span><br><span class="line">set wpaerror=</span><br><span class="line">set /a count=0</span><br><span class="line">for /f %%a in (&#x27;reg query &quot;HKLM\SYSTEM\WPA&quot; %nul6%&#x27;) do set /a count+=1</span><br><span class="line">for /L %%# in (1,1,!count!) do (</span><br><span class="line">reg query &quot;HKLM\SYSTEM\WPA\8DEC0AF1-0341-4b93-85CD-72606C2DF94C-7P-%%#&quot; /ve /t REG_BINARY %nul% || set wpaerror=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined wpaerror (</span><br><span class="line">echo:</span><br><span class="line">echo Checking WPA Registry Keys...</span><br><span class="line">call :_color %Red% &quot;[Error Found] [Registry Count - !count!]&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set tokenstore=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform&quot; /v TokenStore %nul6%&#x27;) do call set &quot;tokenstore=%%b&quot;</span><br><span class="line"></span><br><span class="line">::  Check sppsvc permissions and apply fixes</span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 10240 (</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Checking SPP permission related issues...</span><br><span class="line">call :checkperms</span><br><span class="line"></span><br><span class="line">if defined permerror (</span><br><span class="line"></span><br><span class="line">mkdir &quot;%tokenstore%&quot; %nul%</span><br><span class="line">set &quot;d=$sddl = &#x27;O:BAG:BAD:PAI(A;OICI;FA;;;SY)(A;OICI;FA;;;BA)(A;OICIIO;GR;;;BU)(A;;FR;;;BU)(A;OICI;FA;;;S-1-5-80-123231216-2592883651-3715271367-3753151631-4175906628)&#x27;;&quot;</span><br><span class="line">set &quot;d=!d! $AclObject = New-Object System.Security.AccessControl.DirectorySecurity;&quot;</span><br><span class="line">set &quot;d=!d! $AclObject.SetSecurityDescriptorSddlForm($sddl);&quot;</span><br><span class="line">set &quot;d=!d! Set-Acl -Path %tokenstore% -AclObject $AclObject;&quot;</span><br><span class="line">%psc% &quot;!d!&quot; %nul%</span><br><span class="line"></span><br><span class="line">for %%# in (</span><br><span class="line">&quot;HKLM:\SYSTEM\WPA_QueryValues, EnumerateSubKeys, WriteKey&quot;</span><br><span class="line">&quot;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform_SetValue&quot;</span><br><span class="line">) do for /f &quot;tokens=1,2 delims=_&quot; %%A in (%%#) do (</span><br><span class="line">set &quot;d=$acl = Get-Acl &#x27;%%A&#x27;;&quot;</span><br><span class="line">set &quot;d=!d! $rule = New-Object System.Security.AccessControl.RegistryAccessRule (&#x27;NT Service\sppsvc&#x27;, &#x27;%%B&#x27;, &#x27;ContainerInherit, ObjectInherit&#x27;,&#x27;None&#x27;,&#x27;Allow&#x27;);&quot;</span><br><span class="line">set &quot;d=!d! $acl.ResetAccessRule($rule);&quot;</span><br><span class="line">set &quot;d=!d! $acl.SetAccessRule($rule);&quot;</span><br><span class="line">set &quot;d=!d! Set-Acl -Path &#x27;%%A&#x27; -AclObject $acl&quot;</span><br><span class="line">%psc% &quot;!d!&quot; %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :checkperms</span><br><span class="line">if defined permerror (</span><br><span class="line">call :_color %Red% &quot;[Failed To Fix]&quot;</span><br><span class="line">) else (</span><br><span class="line">echo [Successfully Fixed]</span><br><span class="line">)</span><br><span class="line">) else (</span><br><span class="line">echo [No Error Found]</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Stopping sppsvc service...</span><br><span class="line">call :_stopservice sppsvc</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">call :scandat delete</span><br><span class="line">call :scandat check</span><br><span class="line"></span><br><span class="line">if defined token (</span><br><span class="line">echo:</span><br><span class="line">call :_color %Red% &quot;Failed to delete .dat files.&quot;</span><br><span class="line">echo:</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Reinstalling System Licenses [slmgr /rilc]...</span><br><span class="line">cscript //nologo %windir%\system32\slmgr.vbs /rilc %nul%</span><br><span class="line">if %errorlevel% NEQ 0 cscript //nologo %windir%\system32\slmgr.vbs /rilc %nul%</span><br><span class="line">if %errorlevel% EQU 0 (</span><br><span class="line">echo [成功]</span><br><span class="line">) else (</span><br><span class="line">call :_color %Red% &quot;[失败]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :scandat check</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if not defined token (</span><br><span class="line">call :_color %Red% &quot;Failed to rebuilt tokens.dat file.&quot;</span><br><span class="line">) else (</span><br><span class="line">echo tokens.dat file was rebuilt successfully.</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Rebuild OSPP Tokens</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">call :_color %Blue% &quot;重建 OSPP 许可令牌&quot;</span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">sc qc osppsvc %nul% || (</span><br><span class="line">echo OSPP based Office is not installed</span><br><span class="line">echo Skipping rebuilding OSPP tokens...</span><br><span class="line">goto :repairoffice</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :scandatospp check</span><br><span class="line"></span><br><span class="line">if not defined token (</span><br><span class="line">call :_color %Red% &quot;tokens.dat 文件未找到.&quot;</span><br><span class="line">) else (</span><br><span class="line">echo tokens.dat file: [%token%]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Stopping osppsvc service...</span><br><span class="line">call :_stopservice osppsvc</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">call :scandatospp delete</span><br><span class="line">call :scandatospp check</span><br><span class="line"></span><br><span class="line">if defined token (</span><br><span class="line">echo:</span><br><span class="line">call :_color %Red% &quot;删除 .dat 文件失败.&quot;</span><br><span class="line">echo:</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Starting osppsvc service to generate tokens.dat</span><br><span class="line">call :_startservice osppsvc</span><br><span class="line">call :scandatospp check</span><br><span class="line">if not defined token (</span><br><span class="line">call :_stopservice osppsvc</span><br><span class="line">call :_startservice osppsvc</span><br><span class="line">timeout /t 3 %nul%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :scandatospp check</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if not defined token (</span><br><span class="line">call :_color %Red% &quot;重建 tokens.dat 文件失败.&quot;</span><br><span class="line">) else (</span><br><span class="line">echo tokens.dat file was rebuilt successfully.</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:repairoffice</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">call :_color %Blue% &quot;修复 Office 许可证&quot;</span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot; /v PROCESSOR_ARCHITECTURE&#x27;) do set arch=%%b</span><br><span class="line"></span><br><span class="line">if /i &quot;%arch%&quot;==&quot;ARM64&quot; (</span><br><span class="line">echo:</span><br><span class="line">echo ARM64 Windows Found.</span><br><span class="line">echo You need to use repair option in Windows settings for Office.</span><br><span class="line">echo:</span><br><span class="line">start ms-settings:appsfeatures</span><br><span class="line">goto :repairend</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if /i &quot;%arch%&quot;==&quot;x86&quot; (</span><br><span class="line">set arch=X86</span><br><span class="line">) else (</span><br><span class="line">set arch=X64</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%# in (68 86) do (</span><br><span class="line">for %%A in (msi14 msi15 msi16 c2r14 c2r15 c2r16) do (set %%A_%%#=&amp;set %%Arepair%%#=)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set _68=HKLM\SOFTWARE\Microsoft\Office</span><br><span class="line">set _86=HKLM\SOFTWARE\Wow6432Node\Microsoft\Office</span><br><span class="line"></span><br><span class="line">%nul% reg query %_68%\14.0\Common\InstallRoot /v Path  &amp;&amp; (set &quot;msi14_68=Office 14.0 MSI x86/x64&quot;  &amp; set &quot;msi14repair68=%systemdrive%\Program Files\Common Files\microsoft shared\OFFICE14\Office Setup Controller\Setup.exe&quot;)</span><br><span class="line">%nul% reg query %_86%\14.0\Common\InstallRoot /v Path  &amp;&amp; (set &quot;msi14_86=Office 14.0 MSI x86&quot;      &amp; set &quot;msi14repair86=%systemdrive%\Program Files (x86)\Common Files\Microsoft Shared\OFFICE14\Office Setup Controller\Setup.exe&quot;)</span><br><span class="line">%nul% reg query %_68%\15.0\Common\InstallRoot /v Path  &amp;&amp; (set &quot;msi15_68=Office 15.0 MSI x86/x64&quot;  &amp; set &quot;msi15repair68=%systemdrive%\Program Files\Common Files\microsoft shared\OFFICE15\Office Setup Controller\Setup.exe&quot;)</span><br><span class="line">%nul% reg query %_86%\15.0\Common\InstallRoot /v Path  &amp;&amp; (set &quot;msi15_86=Office 15.0 MSI x86&quot;      &amp; set &quot;msi15repair86=%systemdrive%\Program Files (x86)\Common Files\Microsoft Shared\OFFICE15\Office Setup Controller\Setup.exe&quot;)</span><br><span class="line">%nul% reg query %_68%\16.0\Common\InstallRoot /v Path  &amp;&amp; (set &quot;msi16_68=Office 16.0 MSI x86/x64&quot;  &amp; set &quot;msi16repair68=%systemdrive%\Program Files\Common Files\Microsoft Shared\OFFICE16\Office Setup Controller\Setup.exe&quot;)</span><br><span class="line">%nul% reg query %_86%\16.0\Common\InstallRoot /v Path  &amp;&amp; (set &quot;msi16_86=Office 16.0 MSI x86&quot;      &amp; set &quot;msi16repair86=%systemdrive%\Program Files (x86)\Common Files\Microsoft Shared\OFFICE16\Office Setup Controller\Setup.exe&quot;)</span><br><span class="line">%nul% reg query %_68%\14.0\CVH /f Click2run /k         &amp;&amp; (set &quot;c2r14_68=Office 14.0 C2R x86/x64&quot;  &amp; set &quot;c2r14repair68=&quot;)</span><br><span class="line">%nul% reg query %_86%\14.0\CVH /f Click2run /k         &amp;&amp; (set &quot;c2r14_86=Office 14.0 C2R x86&quot;      &amp; set &quot;c2r14repair86=&quot;)</span><br><span class="line">%nul% reg query %_68%\15.0\ClickToRun /v InstallPath   &amp;&amp; (set &quot;c2r15_68=Office 15.0 C2R x86/x64&quot;  &amp; set &quot;c2r15repair68=%systemdrive%\Program Files\Microsoft Office 15\Client%arch%\integratedoffice.exe&quot;)</span><br><span class="line">%nul% reg query %_86%\15.0\ClickToRun /v InstallPath   &amp;&amp; (set &quot;c2r15_86=Office 15.0 C2R x86&quot;      &amp; set &quot;c2r15repair86=%systemdrive%\Program Files\Microsoft Office 15\Client%arch%\integratedoffice.exe&quot;)</span><br><span class="line">%nul% reg query %_68%\ClickToRun /v InstallPath        &amp;&amp; (set &quot;c2r16_68=Office 16.0 C2R x86/x64&quot;  &amp; set &quot;c2r16repair68=%systemdrive%\Program Files\Microsoft Office 15\Client%arch%\OfficeClickToRun.exe&quot;)</span><br><span class="line">%nul% reg query %_86%\ClickToRun /v InstallPath        &amp;&amp; (set &quot;c2r16_86=Office 16.0 C2R x86&quot;      &amp; set &quot;c2r16repair86=%systemdrive%\Program Files\Microsoft Office 15\Client%arch%\OfficeClickToRun.exe&quot;)</span><br><span class="line"></span><br><span class="line">set uwp16=</span><br><span class="line">if %winbuild% GEQ 10240 (</span><br><span class="line">%psc% &quot;Get-AppxPackage -name &quot;Microsoft.Office.Desktop&quot;&quot; | find /i &quot;Office&quot; %nul1% &amp;&amp; set uwp16=Office 16.0 UWP</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set /a counter=0</span><br><span class="line">echo Checking installed Office versions...</span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">for %%# in (</span><br><span class="line">&quot;%msi14_68%&quot;</span><br><span class="line">&quot;%msi14_86%&quot;</span><br><span class="line">&quot;%msi15_68%&quot;</span><br><span class="line">&quot;%msi15_86%&quot;</span><br><span class="line">&quot;%msi16_68%&quot;</span><br><span class="line">&quot;%msi16_86%&quot;</span><br><span class="line">&quot;%c2r14_68%&quot;</span><br><span class="line">&quot;%c2r14_86%&quot;</span><br><span class="line">&quot;%c2r15_68%&quot;</span><br><span class="line">&quot;%c2r15_86%&quot;</span><br><span class="line">&quot;%c2r16_68%&quot;</span><br><span class="line">&quot;%c2r16_86%&quot;</span><br><span class="line">&quot;%uwp16%&quot;</span><br><span class="line">) do (</span><br><span class="line">if not &quot;%%#&quot;==&quot;&quot;&quot;&quot; (</span><br><span class="line">set insoff=%%#</span><br><span class="line">set insoff=!insoff:&quot;=!</span><br><span class="line">echo [!insoff!]</span><br><span class="line">set /a counter+=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %counter% GTR 1 (</span><br><span class="line">%eline%</span><br><span class="line">echo Multiple office versions found.</span><br><span class="line">echo It&#x27;s recommended to install only one version of office.</span><br><span class="line">echo ________________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %counter% EQU 0 (</span><br><span class="line">echo:</span><br><span class="line">echo Installed Office is not found.</span><br><span class="line">goto :repairend</span><br><span class="line">echo:</span><br><span class="line">) else (</span><br><span class="line">echo:</span><br><span class="line">call :_color %_Yellow% &quot;将弹出一个窗口，您需要在该窗口中选择 [Quick] 选项...&quot;</span><br><span class="line">call :_color %_Yellow% &quot;按任意键继续...&quot;</span><br><span class="line">echo:</span><br><span class="line">pause %nul1%</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined uwp16 (</span><br><span class="line">echo:</span><br><span class="line">echo Note: Skipping repair for Office 16.0 UWP. </span><br><span class="line">echo       You need to use reset option in Windows settings for it.</span><br><span class="line">echo ________________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">start ms-settings:appsfeatures</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set c2r14=</span><br><span class="line">if defined c2r14_68 set c2r14=1</span><br><span class="line">if defined c2r14_86 set c2r14=1</span><br><span class="line"></span><br><span class="line">if defined c2r14 (</span><br><span class="line">echo:</span><br><span class="line">echo Note: Skipping repair for Office 14.0 C2R </span><br><span class="line">echo       You need to use Repair option in Windows settings for it.</span><br><span class="line">echo ________________________________________________________________</span><br><span class="line">echo:</span><br><span class="line">start appwiz.cpl</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined msi14_68 if exist &quot;%msi14repair68%&quot; echo Running - &quot;%msi14repair68%&quot;                    &amp; &quot;%msi14repair68%&quot;</span><br><span class="line">if defined msi14_86 if exist &quot;%msi14repair86%&quot; echo Running - &quot;%msi14repair86%&quot;                    &amp; &quot;%msi14repair86%&quot;</span><br><span class="line">if defined msi15_68 if exist &quot;%msi15repair68%&quot; echo Running - &quot;%msi15repair68%&quot;                    &amp; &quot;%msi15repair68%&quot;</span><br><span class="line">if defined msi15_86 if exist &quot;%msi15repair86%&quot; echo Running - &quot;%msi15repair86%&quot;                    &amp; &quot;%msi15repair86%&quot;</span><br><span class="line">if defined msi16_68 if exist &quot;%msi16repair68%&quot; echo Running - &quot;%msi16repair68%&quot;                    &amp; &quot;%msi16repair68%&quot;</span><br><span class="line">if defined msi16_86 if exist &quot;%msi16repair86%&quot; echo Running - &quot;%msi16repair86%&quot;                    &amp; &quot;%msi16repair86%&quot;</span><br><span class="line">if defined c2r15_68 if exist &quot;%c2r15repair68%&quot; echo Running - &quot;%c2r15repair68%&quot; REPAIRUI RERUNMODE &amp; &quot;%c2r15repair68%&quot; REPAIRUI RERUNMODE</span><br><span class="line">if defined c2r15_86 if exist &quot;%c2r15repair86%&quot; echo Running - &quot;%c2r15repair86%&quot; REPAIRUI RERUNMODE &amp; &quot;%c2r15repair86%&quot; REPAIRUI RERUNMODE</span><br><span class="line">if defined c2r16_68 if exist &quot;%c2r16repair68%&quot; echo Running - &quot;%c2r16repair68%&quot; scenario=Repair    &amp; &quot;%c2r16repair68%&quot; scenario=Repair</span><br><span class="line">if defined c2r16_86 if exist &quot;%c2r16repair86%&quot; echo Running - &quot;%c2r16repair86%&quot; scenario=Repair    &amp; &quot;%c2r16repair86%&quot; scenario=Repair</span><br><span class="line"></span><br><span class="line">:repairend</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">echo:</span><br><span class="line">call :_color %Green% &quot;完成&quot;</span><br><span class="line">goto :at_back</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:fixwmi</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode 98, 34</span><br><span class="line">title  修复 WMI</span><br><span class="line"></span><br><span class="line">::  https://techcommunity.microsoft.com/t5/ask-the-performance-team/wmi-repository-corruption-or-not/ba-p/375484</span><br><span class="line"></span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-Server*Edition~*.mum&quot; (</span><br><span class="line">%eline%</span><br><span class="line">echo WMI rebuild is not recommended on Windows Server. 程序中止...</span><br><span class="line">goto :at_back</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%# in (wmic.exe) do @if &quot;%%~$PATH:#&quot;==&quot;&quot; (</span><br><span class="line">%eline%</span><br><span class="line">echo wmic.exe file is not found in the system. 程序中止...</span><br><span class="line">goto :at_back</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Checking WMI</span><br><span class="line">call :checkwmi</span><br><span class="line"></span><br><span class="line">::  Apply basic fix first and check</span><br><span class="line"></span><br><span class="line">if defined error (</span><br><span class="line">call :_stopservice Winmgmt</span><br><span class="line">winmgmt /salvagerepository %nul%</span><br><span class="line">call :checkwmi</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not defined error (</span><br><span class="line">echo [工作中]</span><br><span class="line">echo No need to apply this option. 程序中止...</span><br><span class="line">goto :at_back</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :_color %Red% &quot;[无响应]&quot;</span><br><span class="line"></span><br><span class="line">set _corrupt=</span><br><span class="line">sc start Winmgmt %nul%</span><br><span class="line">if %errorlevel% EQU 1060 set _corrupt=1</span><br><span class="line">sc query Winmgmt %nul% || set _corrupt=1</span><br><span class="line">for %%G in (DependOnService Description DisplayName ErrorControl ImagePath ObjectName Start Type) do if not defined _corrupt (reg query HKLM\SYSTEM\CurrentControlSet\Services\Winmgmt /v %%G %nul% || set _corrupt=1)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">if defined _corrupt (</span><br><span class="line">%eline%</span><br><span class="line">echo Winmgmt service is corrupted. 程序中止...</span><br><span class="line">goto :at_back</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo Disabling Winmgmt service</span><br><span class="line">sc config Winmgmt start= disabled %nul%</span><br><span class="line">if %errorlevel% EQU 0 (</span><br><span class="line">echo [成功]</span><br><span class="line">) else (</span><br><span class="line">call :_color %Red% &quot;[失败] 程序中止...&quot;</span><br><span class="line">sc config Winmgmt start= auto %nul%</span><br><span class="line">goto :at_back</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Stopping Winmgmt service</span><br><span class="line">call :_stopservice Winmgmt</span><br><span class="line">call :_stopservice Winmgmt</span><br><span class="line">call :_stopservice Winmgmt</span><br><span class="line">sc query Winmgmt | find /i &quot;STOPPED&quot; %nul% &amp;&amp; (</span><br><span class="line">echo [成功]</span><br><span class="line">) || (</span><br><span class="line">call :_color %Red% &quot;[失败]&quot;</span><br><span class="line">echo:</span><br><span class="line">call :_color %Blue% &quot;建议选择 [重新启动] 选项，然后再次应用修复 WMI 选项。&quot;</span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">choice /C:21 /N /M &quot;&gt; [1] 重启  [2] 还原更改 :&quot;</span><br><span class="line">if !errorlevel!==1 (sc config Winmgmt start= auto %nul%&amp;goto :at_back)</span><br><span class="line">echo:</span><br><span class="line">echo Restarting...</span><br><span class="line">shutdown -t 5 -r</span><br><span class="line">exit</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Deleting WMI repository</span><br><span class="line">rmdir /s /q &quot;%windir%\System32\wbem\repository\&quot; %nul%</span><br><span class="line">if exist &quot;%windir%\System32\wbem\repository\&quot; (</span><br><span class="line">call :_color %Red% &quot;[失败]&quot;</span><br><span class="line">) else (</span><br><span class="line">echo [成功]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Enabling Winmgmt service</span><br><span class="line">sc config Winmgmt start= auto %nul%</span><br><span class="line">if %errorlevel% EQU 0 (</span><br><span class="line">echo [成功]</span><br><span class="line">) else (</span><br><span class="line">call :_color %Red% &quot;[失败]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">call :checkwmi</span><br><span class="line">if not defined error (</span><br><span class="line">echo:</span><br><span class="line">echo Checking WMI</span><br><span class="line">call :_color %Green% &quot;[工作中]&quot;</span><br><span class="line">goto :at_back</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Registering .dll&#x27;s and Compiling .mof&#x27;s, .mfl&#x27;s</span><br><span class="line">call :registerobj %nul%</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Checking WMI</span><br><span class="line">call :checkwmi</span><br><span class="line">if defined error (</span><br><span class="line">call :_color %Red% &quot;[无响应]&quot;</span><br><span class="line">echo:</span><br><span class="line">echo Run [Dism RestoreHealth] and [SFC Scannow] options and make sure there are no errors.</span><br><span class="line">) else (</span><br><span class="line">call :_color %Green% &quot;[工作中]&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">goto :at_back</span><br><span class="line"></span><br><span class="line">:registerobj</span><br><span class="line"></span><br><span class="line">::  https://eskonr.com/2012/01/how-to-fix-wmi-issues-automatically/</span><br><span class="line"></span><br><span class="line">call :_stopservice Winmgmt</span><br><span class="line">cd /d %systemroot%\system32\wbem\</span><br><span class="line">regsvr32 /s %systemroot%\system32\scecli.dll</span><br><span class="line">regsvr32 /s %systemroot%\system32\userenv.dll</span><br><span class="line">mofcomp cimwin32.mof</span><br><span class="line">mofcomp cimwin32.mfl</span><br><span class="line">mofcomp rsop.mof</span><br><span class="line">mofcomp rsop.mfl</span><br><span class="line">for /f %%s in (&#x27;dir /b /s *.dll&#x27;) do regsvr32 /s %%s</span><br><span class="line">for /f %%s in (&#x27;dir /b *.mof&#x27;) do mofcomp %%s</span><br><span class="line">for /f %%s in (&#x27;dir /b *.mfl&#x27;) do mofcomp %%s</span><br><span class="line"></span><br><span class="line">winmgmt /salvagerepository</span><br><span class="line">winmgmt /resetrepository</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:checkwmi</span><br><span class="line"></span><br><span class="line">::  https://learn.microsoft.com/en-us/windows/win32/wmisdk/wmi-error-constants</span><br><span class="line"></span><br><span class="line">set error=</span><br><span class="line">wmic path Win32_ComputerSystem get CreationClassName /value %nul2% | find /i &quot;computersystem&quot; %nul1%</span><br><span class="line">if %errorlevel% NEQ 0 (set error=1&amp; exit /b)</span><br><span class="line">winmgmt /verifyrepository %nul%</span><br><span class="line">if %errorlevel% NEQ 0 (set error=1&amp; exit /b)</span><br><span class="line"></span><br><span class="line">cscript //nologo %windir%\system32\slmgr.vbs /dlv %nul%</span><br><span class="line">cmd /c exit /b %errorlevel%</span><br><span class="line">echo &quot;0x%=ExitCode%&quot; | findstr /i &quot;0x800410 0x800440&quot; %nul1%</span><br><span class="line">if %errorlevel% EQU 0 set error=1</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:at_back</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo %line%</span><br><span class="line">echo:</span><br><span class="line">call :_color %_Yellow% &quot;按任意键返回...&quot;</span><br><span class="line">pause %nul1%</span><br><span class="line">goto :at_menu</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:at_done</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo Press any key to %_exitmsg%...</span><br><span class="line">pause %nul1%</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:compresslog</span><br><span class="line"></span><br><span class="line">::  https://stackoverflow.com/a/46268232</span><br><span class="line"></span><br><span class="line">set &quot;ddf=&quot;%SystemRoot%\Temp\ddf&quot;&quot;</span><br><span class="line">%nul% del /q /f %ddf%</span><br><span class="line">echo/.New Cabinet&gt;%ddf%</span><br><span class="line">echo/.set Cabinet=ON&gt;&gt;%ddf%</span><br><span class="line">echo/.set CabinetFileCountThreshold=0;&gt;&gt;%ddf%</span><br><span class="line">echo/.set Compress=ON&gt;&gt;%ddf%</span><br><span class="line">echo/.set CompressionType=LZX&gt;&gt;%ddf%</span><br><span class="line">echo/.set CompressionLevel=7;&gt;&gt;%ddf%</span><br><span class="line">echo/.set CompressionMemory=21;&gt;&gt;%ddf%</span><br><span class="line">echo/.set FolderFileCountThreshold=0;&gt;&gt;%ddf%</span><br><span class="line">echo/.set FolderSizeThreshold=0;&gt;&gt;%ddf%</span><br><span class="line">echo/.set GenerateInf=OFF&gt;&gt;%ddf%</span><br><span class="line">echo/.set InfFileName=nul&gt;&gt;%ddf%</span><br><span class="line">echo/.set MaxCabinetSize=0;&gt;&gt;%ddf%</span><br><span class="line">echo/.set MaxDiskFileCount=0;&gt;&gt;%ddf%</span><br><span class="line">echo/.set MaxDiskSize=0;&gt;&gt;%ddf%</span><br><span class="line">echo/.set MaxErrors=1;&gt;&gt;%ddf%</span><br><span class="line">echo/.set RptFileName=nul&gt;&gt;%ddf%</span><br><span class="line">echo/.set UniqueFiles=ON&gt;&gt;%ddf%</span><br><span class="line">for /f &quot;tokens=* delims=&quot; %%D in (&#x27;dir /a:-D/b/s &quot;%SystemRoot%\logs\%1&quot;&#x27;) do (</span><br><span class="line"> echo/&quot;%%~fD&quot;  /inf=no;&gt;&gt;%ddf%</span><br><span class="line">)</span><br><span class="line">makecab /F %ddf% /D DiskDirectory1=&quot;&quot; /D CabinetNameTemplate=&quot;!desktop!\AT_Logs\%2_%_time%.cab&quot;</span><br><span class="line">del /q /f %ddf%</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:_stopservice</span><br><span class="line"></span><br><span class="line">for %%# in (%1) do (</span><br><span class="line">sc query %%# | find /i &quot;STOPPED&quot; %nul% || net stop %%# /y %nul%</span><br><span class="line">sc query %%# | find /i &quot;STOPPED&quot; %nul% || sc stop %%# %nul%</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:_startservice</span><br><span class="line"></span><br><span class="line">for %%# in (%1) do (</span><br><span class="line">sc query %%# | find /i &quot;RUNNING&quot; %nul% || net start %%# /y %nul%</span><br><span class="line">sc query %%# | find /i &quot;RUNNING&quot; %nul% || sc start %%# %nul%</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:checkperms</span><br><span class="line"></span><br><span class="line">set permerror=</span><br><span class="line">if not exist &quot;%tokenstore%\&quot; set permerror=1</span><br><span class="line"></span><br><span class="line">for %%# in (</span><br><span class="line">&quot;%tokenstore%&quot;</span><br><span class="line">&quot;HKLM:\SYSTEM\WPA&quot;</span><br><span class="line">&quot;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform&quot;</span><br><span class="line">) do if not defined permerror (</span><br><span class="line">%psc% &quot;$acl = Get-Acl &#x27;%%#&#x27;; if ($acl.Access.Where&#123; $_.IdentityReference -eq &#x27;NT SERVICE\sppsvc&#x27; -and $_.AccessControlType -eq &#x27;Deny&#x27; -or $acl.Access.IdentityReference -notcontains &#x27;NT SERVICE\sppsvc&#x27;&#125;) &#123;Exit 2&#125;&quot; %nul%</span><br><span class="line">if !errorlevel!==2 set permerror=1</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:scandat</span><br><span class="line"></span><br><span class="line">set token=</span><br><span class="line">for %%# in (</span><br><span class="line">%Systemdrive%\Windows\System32\spp\store_test\2.0\</span><br><span class="line">%Systemdrive%\Windows\System32\spp\store\</span><br><span class="line">%Systemdrive%\Windows\System32\spp\store\2.0\</span><br><span class="line">%Systemdrive%\Windows\ServiceProfiles\NetworkService\AppData\Roaming\Microsoft\SoftwareProtectionPlatform\</span><br><span class="line">) do (</span><br><span class="line"></span><br><span class="line">if %1==check (</span><br><span class="line">if exist %%#tokens.dat set token=%%#tokens.dat</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %1==delete (</span><br><span class="line">if exist %%# (</span><br><span class="line">%nul% dir /a-d /s &quot;%%#*.dat&quot; &amp;&amp; (</span><br><span class="line">attrib -r -s -h &quot;%%#*.dat&quot; /S</span><br><span class="line">del /S /F /Q &quot;%%#*.dat&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:scandatospp</span><br><span class="line"></span><br><span class="line">set token=</span><br><span class="line">for %%# in (</span><br><span class="line">%ProgramData%\Microsoft\OfficeSoftwareProtectionPlatform\</span><br><span class="line">) do (</span><br><span class="line"></span><br><span class="line">if %1==check (</span><br><span class="line">if exist %%#tokens.dat set token=%%#tokens.dat</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %1==delete (</span><br><span class="line">if exist %%# (</span><br><span class="line">%nul% dir /a-d /s &quot;%%#*.dat&quot; &amp;&amp; (</span><br><span class="line">attrib -r -s -h &quot;%%#*.dat&quot; /S</span><br><span class="line">del /S /F /Q &quot;%%#*.dat&quot;</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:regownstart</span><br><span class="line"></span><br><span class="line">%psc% &quot;$f=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split &#x27;:regown\:.*&#x27;;iex ($f[1]);&quot;</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::  Below code takes ownership of a volatile registry key and deletes it</span><br><span class="line">::  HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ClipSVC\Volatile\PersistedSystemState</span><br><span class="line"></span><br><span class="line">:regown:</span><br><span class="line">$AssemblyBuilder = [AppDomain]::CurrentDomain.DefineDynamicAssembly(4, 1)</span><br><span class="line">$ModuleBuilder = $AssemblyBuilder.DefineDynamicModule(2, $False)</span><br><span class="line">$TypeBuilder = $ModuleBuilder.DefineType(0)</span><br><span class="line"></span><br><span class="line">$TypeBuilder.DefinePInvokeMethod(&#x27;RtlAdjustPrivilege&#x27;, &#x27;ntdll.dll&#x27;, &#x27;Public, Static&#x27;, 1, [int], @([int], [bool], [bool], [bool].MakeByRefType()), 1, 3) | Out-Null</span><br><span class="line">$TypeBuilder.CreateType()::RtlAdjustPrivilege(9, $true, $false, [ref]$false) | Out-Null</span><br><span class="line"></span><br><span class="line">$SID = New-Object System.Security.Principal.SecurityIdentifier(&#x27;S-1-5-32-544&#x27;)</span><br><span class="line">$IDN = ($SID.Translate([System.Security.Principal.NTAccount])).Value</span><br><span class="line">$Admin = New-Object System.Security.Principal.NTAccount($IDN)</span><br><span class="line"></span><br><span class="line">$path = &#x27;SOFTWARE\Microsoft\Windows NT\CurrentVersion\ClipSVC\Volatile\PersistedSystemState&#x27;</span><br><span class="line">$key = [Microsoft.Win32.RegistryKey]::OpenBaseKey(&#x27;LocalMachine&#x27;, &#x27;Registry64&#x27;).OpenSubKey($path, &#x27;ReadWriteSubTree&#x27;, &#x27;takeownership&#x27;)</span><br><span class="line"></span><br><span class="line">$acl = $key.GetAccessControl()</span><br><span class="line">$acl.SetOwner($Admin)</span><br><span class="line">$key.SetAccessControl($acl)</span><br><span class="line"></span><br><span class="line">$rule = New-Object System.Security.AccessControl.RegistryAccessRule($Admin,&quot;FullControl&quot;,&quot;Allow&quot;)</span><br><span class="line">$acl.SetAccessRule($rule)</span><br><span class="line">$key.SetAccessControl($acl)</span><br><span class="line">:regown:</span><br><span class="line"></span><br><span class="line">:+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class="line"></span><br><span class="line">:change_edition</span><br><span class="line">@setlocal DisableDelayedExpansion</span><br><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">::  To stage current edition while changing edition with CBS Upgrade Method, change 0 to 1 in below line</span><br><span class="line">set _stg=0</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">color 07</span><br><span class="line">title  更改WIndows系统版本</span><br><span class="line"></span><br><span class="line">set _args=</span><br><span class="line">set _elev=</span><br><span class="line"></span><br><span class="line">set _args=%*</span><br><span class="line">if defined _args set _args=%_args:&quot;=%</span><br><span class="line">if defined _args (</span><br><span class="line">for %%A in (%_args%) do (</span><br><span class="line">if /i &quot;%%A&quot;==&quot;-el&quot;                    set _elev=1</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;nul1=1&gt;nul&quot;</span><br><span class="line">set &quot;nul2=2&gt;nul&quot;</span><br><span class="line">set &quot;nul6=2^&gt;nul&quot;</span><br><span class="line">set &quot;nul=&gt;nul 2&gt;&amp;1&quot;</span><br><span class="line"></span><br><span class="line">set psc=powershell.exe</span><br><span class="line">set winbuild=1</span><br><span class="line">for /f &quot;tokens=6 delims=[]. &quot; %%G in (&#x27;ver&#x27;) do set winbuild=%%G</span><br><span class="line"></span><br><span class="line">set _NCS=1</span><br><span class="line">if %winbuild% LSS 10586 set _NCS=0</span><br><span class="line">if %winbuild% GEQ 10586 reg query &quot;HKCU\Console&quot; /v ForceV2 %nul2% | find /i &quot;0x0&quot; %nul1% &amp;&amp; (set _NCS=0)</span><br><span class="line"></span><br><span class="line">if %_NCS% EQU 1 (</span><br><span class="line">for /F %%a in (&#x27;echo prompt $E ^| cmd&#x27;) do set &quot;esc=%%a&quot;</span><br><span class="line">set     &quot;Red=&quot;41;97m&quot;&quot;</span><br><span class="line">set    &quot;Gray=&quot;100;97m&quot;&quot;</span><br><span class="line">set   &quot;Green=&quot;42;97m&quot;&quot;</span><br><span class="line">set    &quot;Blue=&quot;44;97m&quot;&quot;</span><br><span class="line">set  &quot;_White=&quot;40;37m&quot;&quot;</span><br><span class="line">set  &quot;_Green=&quot;40;92m&quot;&quot;</span><br><span class="line">set &quot;_Yellow=&quot;40;93m&quot;&quot;</span><br><span class="line">) else (</span><br><span class="line">set     &quot;Red=&quot;Red&quot; &quot;white&quot;&quot;</span><br><span class="line">set    &quot;Gray=&quot;Darkgray&quot; &quot;white&quot;&quot;</span><br><span class="line">set   &quot;Green=&quot;DarkGreen&quot; &quot;white&quot;&quot;</span><br><span class="line">set    &quot;Blue=&quot;Blue&quot; &quot;white&quot;&quot;</span><br><span class="line">set  &quot;_White=&quot;Black&quot; &quot;Gray&quot;&quot;</span><br><span class="line">set  &quot;_Green=&quot;Black&quot; &quot;Green&quot;&quot;</span><br><span class="line">set &quot;_Yellow=&quot;Black&quot; &quot;Yellow&quot;&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;nceline=echo: &amp;echo ==== ERROR ==== &amp;echo:&quot;</span><br><span class="line">set &quot;eline=echo: &amp;call :dk_color %Red% &quot;==== ERROR ====&quot; &amp;echo:&quot;</span><br><span class="line">set &quot;line=echo ___________________________________________________________________________________________&quot;</span><br><span class="line">if %~z0 GEQ 200000 (set &quot;_exitmsg=Go back&quot;) else (set &quot;_exitmsg=Exit&quot;)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Fix for the special characters limitation in path name</span><br><span class="line"></span><br><span class="line">set &quot;_work=%~dp0&quot;</span><br><span class="line">if &quot;%_work:~-1%&quot;==&quot;\&quot; set &quot;_work=%_work:~0,-1%&quot;</span><br><span class="line"></span><br><span class="line">set &quot;_batf=%~f0&quot;</span><br><span class="line">set &quot;_batp=%_batf:&#x27;=&#x27;&#x27;%&quot;</span><br><span class="line"></span><br><span class="line">set _PSarg=&quot;&quot;&quot;%~f0&quot;&quot;&quot; -el %_args%</span><br><span class="line"></span><br><span class="line">set &quot;_ttemp=%temp%&quot;</span><br><span class="line"></span><br><span class="line">setlocal EnableDelayedExpansion</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode 98, 30</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo 初始化...</span><br><span class="line">echo:</span><br><span class="line">call :dk_product</span><br><span class="line">call :dk_ckeckwmic</span><br><span class="line"></span><br><span class="line">::  Show info for potential script stuck scenario</span><br><span class="line"></span><br><span class="line">sc start sppsvc %nul%</span><br><span class="line">if %errorlevel% NEQ 1056 if %errorlevel% NEQ 0 (</span><br><span class="line">echo:</span><br><span class="line">echo 错误代码: %errorlevel%</span><br><span class="line">call :dk_color %Red% &quot;启动 [sppsvc] 服务失败，剩余过程可能需要很长时间...&quot;</span><br><span class="line">echo:</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check Activation IDs</span><br><span class="line"></span><br><span class="line">call :dk_actids</span><br><span class="line">if not defined applist (</span><br><span class="line">net stop sppsvc /y %nul%</span><br><span class="line">cscript //nologo %windir%\system32\slmgr.vbs /rilc %nul%</span><br><span class="line">if !errorlevel! NEQ 0 cscript //nologo %windir%\system32\slmgr.vbs /rilc %nul%</span><br><span class="line">call :dk_refresh</span><br><span class="line">call :dk_actids</span><br><span class="line">if not defined applist (</span><br><span class="line">%eline%</span><br><span class="line">echo 未找到激活 ID，程序终止...</span><br><span class="line">echo:</span><br><span class="line">echo 查看此页获取帮助 %mas%troubleshoot</span><br><span class="line">goto ced_done</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check SKU value</span><br><span class="line"></span><br><span class="line">set osSKU=</span><br><span class="line">set slcSKU=</span><br><span class="line">set wmiSKU=</span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 14393 (set info=Kernel-BrandingInfo) else (set info=Kernel-ProductInfo)</span><br><span class="line">set d1=%ref% [void]$TypeBuilder.DefinePInvokeMethod(&#x27;SLGetWindowsInformationDWORD&#x27;, &#x27;slc.dll&#x27;, &#x27;Public, Static&#x27;, 1, [int], @([String], [int].MakeByRefType()), 1, 3);</span><br><span class="line">set d1=%d1% $Sku = 0; [void]$TypeBuilder.CreateType()::SLGetWindowsInformationDWORD(&#x27;%info%&#x27;, [ref]$Sku); $Sku</span><br><span class="line">for /f &quot;delims=&quot; %%s in (&#x27;&quot;%psc% %d1%&quot;&#x27;) do if not errorlevel 1 (set slcSKU=%%s)</span><br><span class="line">if &quot;%slcSKU%&quot;==&quot;0&quot; set slcSKU=</span><br><span class="line">if 1%slcSKU% NEQ +1%slcSKU% set slcSKU=</span><br><span class="line"></span><br><span class="line">if %_wmic% EQU 1 for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;&quot;wmic Path Win32_OperatingSystem Get OperatingSystemSKU /format:LIST&quot; %nul6%&#x27;) do if not errorlevel 1 set &quot;wmiSKU=%%a&quot;</span><br><span class="line">if %_wmic% EQU 0 for /f &quot;tokens=1&quot; %%a in (&#x27;%psc% &quot;([WMI]&#x27;Win32_OperatingSystem=@&#x27;).OperatingSystemSKU&quot; %nul6%&#x27;) do if not errorlevel 1 set &quot;wmiSKU=%%a&quot;</span><br><span class="line"></span><br><span class="line">set osSKU=%slcSKU%</span><br><span class="line">if not defined osSKU set osSKU=%wmiSKU%</span><br><span class="line"></span><br><span class="line">if not defined osSKU (</span><br><span class="line">%eline%</span><br><span class="line">echo 检测到错误的SKU值，程序终止...</span><br><span class="line">goto ced_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Check Windows Edition</span><br><span class="line"></span><br><span class="line">set osedition=</span><br><span class="line">set dismedition=</span><br><span class="line">set dismnotworking=</span><br><span class="line"></span><br><span class="line">set d1=%ref% [void]$TypeBuilder.DefinePInvokeMethod(&#x27;SLGetWindowsInformation&#x27;, &#x27;slc.dll&#x27;, 22, 1, [int], @([String], [int], [int].MakeByRefType(), [String].MakeByRefType()), 1, 3);</span><br><span class="line">set d1=%d1% $editionName = 0; [void]$TypeBuilder.CreateType()::SLGetWindowsInformation(&#x27;Kernel-EditionName&#x27;, 0, [ref]0, [ref]$editionName); $editionName</span><br><span class="line">if %winbuild% GEQ 14393 for /f &quot;delims=&quot; %%s in (&#x27;&quot;%psc% %d1%&quot;&#x27;) do if not errorlevel 1 (set osedition=%%s)</span><br><span class="line">if &quot;%osedition%&quot;==&quot;0&quot; set osedition=</span><br><span class="line"></span><br><span class="line">if not defined osedition (</span><br><span class="line">for /f &quot;skip=2 tokens=3&quot; %%a in (&#x27;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; /v EditionID %nul6%&#x27;) do set &quot;osedition=%%a&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::  Workaround for a Windows bug in builds between 1607 and 1709 where ProfessionalEducation is shown as Professional</span><br><span class="line"></span><br><span class="line">if %osSKU%==164 set osedition=ProfessionalEducation</span><br><span class="line">if %osSKU%==165 set osedition=ProfessionalEducationN</span><br><span class="line"></span><br><span class="line">for /f &quot;tokens=3 delims=: &quot; %%a in (&#x27;DISM /English /Online /Get-CurrentEdition %nul6% ^| find /i &quot;Current Edition :&quot;&#x27;) do set &quot;dismedition=%%a&quot;</span><br><span class="line">if not defined dismedition set dismnotworking=1</span><br><span class="line"></span><br><span class="line">if defined dismedition if not defined osedition set osedition=%dismedition%</span><br><span class="line"></span><br><span class="line">if not defined osedition (</span><br><span class="line">%eline%</span><br><span class="line">DISM /English /Online /Get-CurrentEdition %nul%</span><br><span class="line">cmd /c exit /b !errorlevel!</span><br><span class="line">echo DISM 命令失败 [Error Code - 0x!=ExitCode!]</span><br><span class="line">echo 检测到错误的操作系统版本，程序终止...</span><br><span class="line">echo:</span><br><span class="line">echo 查看此页面寻求帮助。 %mas%troubleshoot</span><br><span class="line">goto ced_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">set branch=</span><br><span class="line">for /f &quot;skip=2 tokens=2*&quot; %%a in (&#x27;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot; /v BuildBranch %nul6%&#x27;) do set &quot;branch=%%b&quot;</span><br><span class="line"></span><br><span class="line">::  Check PowerShell</span><br><span class="line"></span><br><span class="line">%psc% $ExecutionContext.SessionState.LanguageMode %nul2% | find /i &quot;Full&quot; %nul1% || (</span><br><span class="line">%eline%</span><br><span class="line">echo PowerShell 无法正常响应，程序终止...</span><br><span class="line">echo:</span><br><span class="line">echo 查看此页面寻求帮助。 %mas%troubleshoot</span><br><span class="line">goto ced_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Get Target editions list</span><br><span class="line"></span><br><span class="line">set _target=</span><br><span class="line">set _dtarget=</span><br><span class="line">set _ptarget=</span><br><span class="line">set _ntarget=</span><br><span class="line">set _wtarget=</span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 10240 for /f &quot;tokens=4&quot; %%a in (&#x27;dism /online /english /Get-TargetEditions ^| findstr /i /c:&quot;Target Edition : &quot;&#x27;) do (if defined _dtarget (set &quot;_dtarget= !_dtarget! %%a &quot;) else (set &quot;_dtarget= %%a &quot;))</span><br><span class="line">if %winbuild% LSS 10240 for /f &quot;tokens=4&quot; %%a in (&#x27;%psc% &quot;$f=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split &#x27;:cbsxml\:.*&#x27;;&amp; ([ScriptBlock]::Create($f[1])) -GetTargetEditions;&quot; ^| findstr /i /c:&quot;Target Edition : &quot;&#x27;) do (if defined _ptarget (set &quot;_ptarget= !_ptarget! %%a &quot;) else (set &quot;_ptarget= %%a &quot;))</span><br><span class="line"></span><br><span class="line">if %winbuild% GEQ 10240 if not exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-Server*Edition~*.mum&quot; (</span><br><span class="line">call :ced_edilist</span><br><span class="line">if /i &quot;%osedition:~0,4%&quot;==&quot;Core&quot; (set &quot;_wtarget= Professional !_wtarget! &quot;)</span><br><span class="line">set &quot;_dtarget= %_dtarget% !_wtarget! &quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Block the change to/from CloudEdition editions</span><br><span class="line"></span><br><span class="line">for %%# in (202 203) do if %osSKU%==%%# (</span><br><span class="line">%eline%</span><br><span class="line">echo [%winos% ^| SKU:%osSKU% ^| %winbuild%]</span><br><span class="line">echo 不建议将此安装版本更改为其他版本。</span><br><span class="line">echo 程序中止...</span><br><span class="line">goto ced_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for %%# in ( %_dtarget% %_ptarget% ) do if /i not &quot;%%#&quot;==&quot;%osedition%&quot; (</span><br><span class="line">echo &quot;!_target!&quot; | find /i &quot; %%# &quot; %nul1% || set &quot;_target= !_target! %%# &quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if defined _target (</span><br><span class="line">for %%# in (%_target%) do (</span><br><span class="line">echo %%# | findstr /i &quot;特定国家的版本&quot; %nul% || (set &quot;_ntarget=!_ntarget! %%#&quot;)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if not defined _ntarget (</span><br><span class="line">%line%</span><br><span class="line">echo:</span><br><span class="line">if defined dismnotworking call :dk_color %Red% &quot;DISM.exe 没有响应。&quot;</span><br><span class="line">call :dk_color %Gray% &quot;未找到目标版本。&quot;</span><br><span class="line">echo 当前版本 [%osedition% ^| %winbuild%] 不能更改为任何其他版本。</span><br><span class="line">%line%</span><br><span class="line">goto ced_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:cedmenu2</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode 98, 30</span><br><span class="line">set inpt=</span><br><span class="line">set counter=0</span><br><span class="line">set verified=0</span><br><span class="line">set targetedition=</span><br><span class="line"></span><br><span class="line">%line%</span><br><span class="line">echo:</span><br><span class="line">call :dk_color %Gray% &quot;您可以将版本 [%osedition%] [%winbuild%] 更改为以下其中之一。&quot;</span><br><span class="line">if defined dismnotworking (</span><br><span class="line">call :dk_color %_Yellow% &quot;注意 - DISM.exe 没有响应。&quot;</span><br><span class="line">if /i &quot;%osedition:~0,4%&quot;==&quot;Core&quot; call :dk_color %_Yellow% &quot;     - 一旦更改为专业版，您将看到更多版本选项供您选择。&quot;</span><br><span class="line">)</span><br><span class="line">%line%</span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">for %%A in (%_ntarget%) do (</span><br><span class="line">set /a counter+=1</span><br><span class="line">echo [!counter!]  %%A</span><br><span class="line">set targetedition!counter!=%%A</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">%line%</span><br><span class="line">echo:</span><br><span class="line">echo [0]  %_exitmsg%</span><br><span class="line">echo:</span><br><span class="line">call :dk_color %_Green% &quot;在键盘上输入选项编号，然后按 &quot;Enter&quot;：&quot;</span><br><span class="line">set /p inpt=</span><br><span class="line">if &quot;%inpt%&quot;==&quot;&quot; goto cedmenu2</span><br><span class="line">if &quot;%inpt%&quot;==&quot;0&quot; exit /b</span><br><span class="line">for /l %%i in (1,1,%counter%) do (if &quot;%inpt%&quot;==&quot;%%i&quot; set verified=1)</span><br><span class="line">set targetedition=!targetedition%inpt%!</span><br><span class="line">if %verified%==0 goto cedmenu2</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">if %winbuild% LSS 10240 goto :cbsmethod</span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-Server*Edition~*.mum&quot; goto :ced_change_server</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode con cols=105 lines=32</span><br><span class="line"></span><br><span class="line">set key=</span><br><span class="line">set _chan=</span><br><span class="line">set _dismapi=0</span><br><span class="line"></span><br><span class="line">::  Check if DISM Api or slmgr.vbs is required for edition upgrade</span><br><span class="line"></span><br><span class="line">if not exist &quot;%SystemRoot%\System32\spp\tokens\skus\%targetedition%\&quot; (</span><br><span class="line">set _dismapi=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set &quot;keyflow=Retail OEM:NONSLP OEM:DM Volume:MAK Volume:GVLK&quot;</span><br><span class="line"></span><br><span class="line">call :ced_targetSKU %targetedition%</span><br><span class="line">if defined targetSKU call :ced_windowskey</span><br><span class="line">if defined key if defined pkeychannel set _chan=%pkeychannel%</span><br><span class="line">if not defined key call :changeeditiondata</span><br><span class="line"></span><br><span class="line">if not defined key (</span><br><span class="line">%eline%</span><br><span class="line">echo [%targetedition% ^| %winbuild%]</span><br><span class="line">echo 无法从 pkeyhelper.dll 获取产品密钥</span><br><span class="line">echo:</span><br><span class="line">echo 查看此页面寻求帮助。 %mas%troubleshoot</span><br><span class="line">goto ced_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Changing from Core to Non-Core &amp; Changing editions in Windows build older than 17134 requires &quot;changepk /productkey&quot; or DISM Api method and restart</span><br><span class="line">::  In other cases, editions can be changed instantly with &quot;slmgr /ipk&quot;</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">%line%</span><br><span class="line">echo:</span><br><span class="line">echo 将当前版本[%osedition%] %winbuild%更改为[%targetedition%]。</span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">if %_dismapi%==1 (</span><br><span class="line">call :dk_color %Blue% &quot;Notes-&quot;</span><br><span class="line">echo:</span><br><span class="line">echo  - 请保存您的工作后再继续，系统将自动重启。</span><br><span class="line">echo:</span><br><span class="line">echo  - 更改版本后，您需要使用 HWID 选项进行激活。</span><br><span class="line">echo:</span><br><span class="line">choice /C:21 /N /M &quot;[1] 继续 [2] %_exitmsg% : &quot;</span><br><span class="line">if !errorlevel!==1 exit /b</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">if %_dismapi%==0 (</span><br><span class="line">echo 安装 %_chan% 密钥 [%key%]</span><br><span class="line">echo:</span><br><span class="line">if %_wmic% EQU 1 wmic path SoftwareLicensingService where __CLASS=&#x27;SoftwareLicensingService&#x27; call InstallProductKey ProductKey=&quot;%key%&quot; %nul%</span><br><span class="line">if %_wmic% EQU 0 %psc% &quot;(([WMISEARCHER]&#x27;SELECT Version FROM SoftwareLicensingService&#x27;).Get()).InstallProductKey(&#x27;%key%&#x27;)&quot; %nul%</span><br><span class="line">if not !errorlevel!==0 cscript //nologo %windir%\system32\slmgr.vbs /ipk %key% %nul%</span><br><span class="line"></span><br><span class="line">set error_code=!errorlevel!</span><br><span class="line">cmd /c exit /b !error_code!</span><br><span class="line">if !error_code! NEQ 0 set &quot;error_code=[0x!=ExitCode!]&quot;</span><br><span class="line"></span><br><span class="line">if !error_code! EQU 0 (</span><br><span class="line">call :dk_refresh</span><br><span class="line">call :dk_color %Green% &quot;[成功]&quot;</span><br><span class="line">echo:</span><br><span class="line">call :dk_color %Gray% &quot;需要重新启动才能正确更改版本。&quot;</span><br><span class="line">) else (</span><br><span class="line">call :dk_color %Red% &quot;[Unsuccessful] [Error Code: 0x!=ExitCode!]&quot;</span><br><span class="line">echo 查看此页面寻求帮助。 %mas%troubleshoot</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if %_dismapi%==1 (</span><br><span class="line">echo:</span><br><span class="line">echo 使用 %_chan% 密钥 %key% 应用 DISM API 方法</span><br><span class="line">echo:</span><br><span class="line">%psc% &quot;$f=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split &#x27;:dismapi\:.*&#x27;;&amp; ([ScriptBlock]::Create($f[1])) %targetedition% %key%;&quot;</span><br><span class="line">timeout /t 3 %nul1%</span><br><span class="line">echo:</span><br><span class="line">call :dk_color %Blue% &quot;Incase of errors, you must restart your system before trying again.&quot;</span><br><span class="line">echo 查看此页面寻求帮助。 %mas%troubleshoot</span><br><span class="line">)</span><br><span class="line">%line%</span><br><span class="line"></span><br><span class="line">goto ced_done</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:cbsmethod</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode con cols=105 lines=32</span><br><span class="line">%psc% &quot;&amp;&#123;$W=$Host.UI.RawUI.WindowSize;$B=$Host.UI.RawUI.BufferSize;$W.Height=31;$B.Height=200;$Host.UI.RawUI.WindowSize=$W;$Host.UI.RawUI.BufferSize=$B;&#125;&quot;</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo 将当前版本[%osedition%] %winbuild%更改为[%targetedition%]。</span><br><span class="line">echo:</span><br><span class="line">call :dk_color %Blue% &quot;Important - Save your work before continue, system will auto reboot.&quot;</span><br><span class="line">echo:</span><br><span class="line">choice /C:01 /N /M &quot;[1] 继续 [0] %_exitmsg% : &quot;</span><br><span class="line">if %errorlevel%==1 exit /b</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">echo 初始化...</span><br><span class="line">echo:</span><br><span class="line"></span><br><span class="line">if %_stg%==0 (set stage=) else (set stage=-StageCurrent)</span><br><span class="line">%psc% &quot;$f=[io.file]::ReadAllText(&#x27;!_batp!&#x27;) -split &#x27;:cbsxml\:.*&#x27;;&amp; ([ScriptBlock]::Create($f[1])) -SetEdition %targetedition% %stage%;&quot;</span><br><span class="line">echo:</span><br><span class="line">call :dk_color %Blue% &quot;Incase of errors, you must restart your system before trying again.&quot;</span><br><span class="line">echo 查看此页面寻求帮助。 %mas%troubleshoot</span><br><span class="line">%line%</span><br><span class="line"></span><br><span class="line">goto ced_done</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:ced_change_server</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">mode con cols=105 lines=32</span><br><span class="line">%psc% &quot;&amp;&#123;$W=$Host.UI.RawUI.WindowSize;$B=$Host.UI.RawUI.BufferSize;$W.Height=31;$B.Height=200;$Host.UI.RawUI.WindowSize=$W;$Host.UI.RawUI.BufferSize=$B;&#125;&quot;</span><br><span class="line"></span><br><span class="line">set key=</span><br><span class="line">set _chan=</span><br><span class="line">set &quot;keyflow=Volume:GVLK Retail Volume:MAK OEM:NONSLP OEM:DM&quot;</span><br><span class="line"></span><br><span class="line">call :ced_targetSKU %targetedition%</span><br><span class="line">if defined targetSKU call :ced_windowskey</span><br><span class="line">if defined key if defined pkeychannel set _chan=%pkeychannel%</span><br><span class="line">if not defined key call :changeeditiondata</span><br><span class="line"></span><br><span class="line">if not defined key (</span><br><span class="line">%eline%</span><br><span class="line">echo [%targetedition% ^| %winbuild%]</span><br><span class="line">echo 无法从 pkeyhelper.dll 获取产品密钥</span><br><span class="line">echo:</span><br><span class="line">echo 查看此页面寻求帮助。 %mas%troubleshoot</span><br><span class="line">goto ced_done</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">cls</span><br><span class="line">echo:</span><br><span class="line">echo 将当前版本[%osedition%] %winbuild%更改为[%targetedition%]。</span><br><span class="line">echo:</span><br><span class="line">echo 使用 %_chan% 密钥执行命令</span><br><span class="line">echo DISM /online /Set-Edition:%targetedition% /ProductKey:%key% /AcceptEula</span><br><span class="line">DISM /online /Set-Edition:%targetedition% /ProductKey:%key% /AcceptEula</span><br><span class="line"></span><br><span class="line">call :dk_color %Blue% &quot;You must restart the system at this stage.&quot;</span><br><span class="line">echo 帮助: %mas%troubleshoot</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:ced_done</span><br><span class="line"></span><br><span class="line">echo:</span><br><span class="line">call :dk_color %_Yellow% &quot;Press any key to %_exitmsg%...&quot;</span><br><span class="line">pause %nul1%</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Get Edition list</span><br><span class="line"></span><br><span class="line">:ced_edilist</span><br><span class="line"></span><br><span class="line">if %_wmic% EQU 1 set &quot;chkedi=for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;&quot;wmic path SoftwareLicensingProduct where (ApplicationID=&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27;) get LicenseFamily /VALUE&quot; %nul6%&#x27;)&quot;</span><br><span class="line">if %_wmic% EQU 0 set &quot;chkedi=for /f &quot;tokens=2 delims==&quot; %%a in (&#x27;%psc% &quot;(([WMISEARCHER]&#x27;SELECT LicenseFamily FROM SoftwareLicensingProduct WHERE ApplicationID=&#x27;&#x27;55c92734-d682-4d71-983e-d6ec3f16059f&#x27;&#x27;&#x27;).Get()).LicenseFamily ^| %% &#123;echo (&#x27;LicenseFamily=&#x27;+$_)&#125;&quot; %nul6%&#x27;)&quot;</span><br><span class="line">%chkedi% do (call set &quot;_wtarget= !_wtarget! %%a &quot;)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:ced_windowskey</span><br><span class="line"></span><br><span class="line">for %%# in (pkeyhelper.dll) do @if &quot;%%~$PATH:#&quot;==&quot;&quot; exit /b</span><br><span class="line">for %%# in (%keyflow%) do (</span><br><span class="line">call :dk_pkey %targetSKU% &#x27;%%#&#x27;</span><br><span class="line">if defined pkey call :dk_pkeychannel !pkey!</span><br><span class="line">if /i [!pkeychannel!]==[%%#] (</span><br><span class="line">set key=!pkey!</span><br><span class="line">exit /b</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">:ced_targetSKU</span><br><span class="line"></span><br><span class="line">set k=%1</span><br><span class="line">set targetSKU=</span><br><span class="line">for %%# in (pkeyhelper.dll) do @if &quot;%%~$PATH:#&quot;==&quot;&quot; exit /b</span><br><span class="line"></span><br><span class="line">call :dk_reflection</span><br><span class="line"></span><br><span class="line">set d1=%ref% [void]$TypeBuilder.DefinePInvokeMethod(&#x27;GetEditionIdFromName&#x27;, &#x27;pkeyhelper.dll&#x27;, &#x27;Public, Static&#x27;, 1, [int], @([String], [int].MakeByRefType()), 1, 3);</span><br><span class="line">set d1=%d1% $out = 0; [void]$TypeBuilder.CreateType()::GetEditionIdFromName(&#x27;%k%&#x27;, [ref]$out); $out</span><br><span class="line"></span><br><span class="line">for /f %%a in (&#x27;%psc% &quot;%d1%&quot;&#x27;) do if not errorlevel 1 (set targetSKU=%%a)</span><br><span class="line">if &quot;%targetSKU%&quot;==&quot;0&quot; set targetSKU=</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  https://github.com/Gamers-Against-Weed/Set-WindowsCbsEdition</span><br><span class="line"></span><br><span class="line">:cbsxml:[</span><br><span class="line">param (</span><br><span class="line">    [Parameter()]</span><br><span class="line">    [String]$SetEdition,</span><br><span class="line"></span><br><span class="line">    [Parameter()]</span><br><span class="line">    [Switch]$GetTargetEditions,</span><br><span class="line"></span><br><span class="line">    [Parameter()]</span><br><span class="line">    [Switch]$StageCurrent</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">function Get-AssemblyIdentity &#123;</span><br><span class="line">    param (</span><br><span class="line">        [String]$PackageName</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    $PackageName = [String]$PackageName</span><br><span class="line">    $packageData = ($PackageName -split &#x27;~&#x27;)</span><br><span class="line"></span><br><span class="line">    if($packageData[3] -eq &#x27;&#x27;) &#123;</span><br><span class="line">        $packageData[3] = &#x27;neutral&#x27;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return &quot;&lt;assemblyIdentity name=`&quot;$($packageData[0])`&quot; version=`&quot;$($packageData[4])`&quot; processorArchitecture=`&quot;$($packageData[2])`&quot; publicKeyToken=`&quot;$($packageData[1])`&quot; language=`&quot;$($packageData[3])`&quot; /&gt;&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Get-SxsName &#123;</span><br><span class="line">    param (</span><br><span class="line">        [String]$PackageName</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    $name = ($PackageName -replace &#x27;[^A-z0-9\-\._]&#x27;, &#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">    if($name.Length -gt 40) &#123;</span><br><span class="line">        $name = ($name[0..18] -join &#x27;&#x27;) + &#x27;\.\.&#x27; + ($name[-19..-1] -join &#x27;&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return $name.ToLower()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Find-EditionXmlInSxs &#123;</span><br><span class="line">    param (</span><br><span class="line">        [String]$Edition</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    $candidates = @($Edition, &#x27;Client&#x27;, &#x27;Server&#x27;)</span><br><span class="line">    $winSxs = $Env:SystemRoot + &#x27;\WinSxS&#x27;</span><br><span class="line">    $allInSxs = Get-ChildItem -Path $winSxs | select Name</span><br><span class="line"></span><br><span class="line">    foreach($candidate in $candidates) &#123;</span><br><span class="line">        $name = Get-SxsName -PackageName &quot;Microsoft-Windows-Editions-$candidate&quot;</span><br><span class="line">        $packages = $allInSxs | where name -Match (&#x27;^.*_&#x27;+$name+&#x27;_31bf3856ad364e35&#x27;)</span><br><span class="line"></span><br><span class="line">        if($packages.Length -eq 0) &#123;</span><br><span class="line">            continue</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $package = $packages[-1].Name</span><br><span class="line">        $testPath = $winSxs + &quot;\$package\&quot; + $Edition + &#x27;Edition.xml&#x27;</span><br><span class="line"></span><br><span class="line">        if(Test-Path -Path $testPath -PathType Leaf) &#123;</span><br><span class="line">            return $testPath</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return $null</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Find-EditionXml &#123;</span><br><span class="line">    param (</span><br><span class="line">        [String]$Edition</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    $servicingEditions = $Env:SystemRoot + &#x27;\servicing\Editions&#x27;</span><br><span class="line">    $editionXml = $Edition + &#x27;Edition.xml&#x27;</span><br><span class="line"></span><br><span class="line">    $editionXmlInServicing = $servicingEditions + &#x27;\&#x27; + $editionXml</span><br><span class="line"></span><br><span class="line">    if(Test-Path -Path $editionXmlInServicing -PathType Leaf) &#123;</span><br><span class="line">        return $editionXmlInServicing</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return Find-EditionXmlInSxs -Edition $Edition</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Write-UpgradeCandidates &#123;</span><br><span class="line">    param (</span><br><span class="line">        [HashTable]$InstallCandidates</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    $editionCount = 0</span><br><span class="line">    Write-Host &#x27;Editions that can be upgraded to:&#x27;</span><br><span class="line">    foreach($candidate in $InstallCandidates.Keys) &#123;</span><br><span class="line">        Write-Host &quot;Target Edition : $candidate&quot;</span><br><span class="line">        $editionCount++</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if($editionCount -eq 0) &#123;</span><br><span class="line">        Write-Host &#x27;(no editions are available)&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Write-UpgradeXml &#123;</span><br><span class="line">    param (</span><br><span class="line">        [Array]$RemovalCandidates,</span><br><span class="line">        [Array]$InstallCandidates,</span><br><span class="line">        [Boolean]$Stage</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    $removeAction = &#x27;remove&#x27;</span><br><span class="line">    if($Stage) &#123;</span><br><span class="line">        $removeAction = &#x27;stage&#x27;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Write-Output &#x27;&lt;?xml version=&quot;1.0&quot;?&gt;&#x27;</span><br><span class="line">    Write-Output &#x27;&lt;unattend xmlns=&quot;urn:schemas-microsoft-com:unattend&quot;&gt;&#x27;</span><br><span class="line">    Write-Output &#x27;&lt;servicing&gt;&#x27;</span><br><span class="line"></span><br><span class="line">    foreach($package in $InstallCandidates) &#123;</span><br><span class="line">        Write-Output &#x27;&lt;package action=&quot;install&quot;&gt;&#x27;</span><br><span class="line">        Write-Output (Get-AssemblyIdentity -PackageName $package)</span><br><span class="line">        Write-Output &#x27;&lt;/package&gt;&#x27;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    foreach($package in $RemovalCandidates) &#123;</span><br><span class="line">        Write-Output &quot;&lt;package action=`&quot;$removeAction`&quot;&gt;&quot;</span><br><span class="line">        Write-Output (Get-AssemblyIdentity -PackageName $package)</span><br><span class="line">        Write-Output &#x27;&lt;/package&gt;&#x27;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Write-Output &#x27;&lt;/servicing&gt;&#x27;</span><br><span class="line">    Write-Output &#x27;&lt;/unattend&gt;&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Write-Usage &#123;</span><br><span class="line">    Get-Help $script:MyInvocation.MyCommand.Path -detailed</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$version = &#x27;1.0&#x27;</span><br><span class="line">$getTargetsParam = $GetTargetEditions.IsPresent</span><br><span class="line">$stageCurrentParam = $StageCurrent.IsPresent</span><br><span class="line"></span><br><span class="line">if($SetEdition -eq &#x27;&#x27; -and ($false -eq $getTargetsParam)) &#123;</span><br><span class="line">    Write-Usage</span><br><span class="line">    Exit 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$removalCandidates = @();</span><br><span class="line">$installCandidates = @&#123;&#125;;</span><br><span class="line"></span><br><span class="line">$packages = Get-ChildItem -Path &#x27;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages&#x27; | select Name | where &#123; $_.name -match &#x27;^.*\\Microsoft-Windows-.*Edition~&#x27; &#125;</span><br><span class="line">foreach($package in $packages) &#123;</span><br><span class="line">    $state = (Get-ItemProperty -Path &quot;Registry::$($package.Name)&quot;).CurrentState</span><br><span class="line">    $packageName = ($package.Name -split &#x27;\\&#x27;)[-1]</span><br><span class="line">    $packageEdition = (($packageName -split &#x27;Edition~&#x27;)[0] -split &#x27;Microsoft-Windows-&#x27;)[-1]</span><br><span class="line"></span><br><span class="line">    if($state -eq 0x40) &#123;</span><br><span class="line">        if($null -eq $installCandidates[$packageEdition]) &#123;</span><br><span class="line">            $installCandidates[$packageEdition] = @()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if($false -eq ($installCandidates[$packageEdition] -contains $packageName)) &#123;</span><br><span class="line">            $installCandidates[$packageEdition] = $installCandidates[$packageEdition] + @($packageName)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if((($state -eq 0x50) -or ($state -eq 0x70)) -and ($false -eq ($removalCandidates -contains $packageName))) &#123;</span><br><span class="line">        $removalCandidates = $removalCandidates + @($packageName)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($getTargetsParam) &#123;</span><br><span class="line">    Write-UpgradeCandidates -InstallCandidates $installCandidates</span><br><span class="line">    Exit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($false -eq ($installCandidates.Keys -contains $SetEdition)) &#123;</span><br><span class="line">    Write-Error &quot;The system cannot be upgraded to `&quot;$SetEdition`&quot;&quot;</span><br><span class="line">    Exit 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$xmlPath = $Env:SystemRoot + &#x27;\Temp&#x27; + &#x27;\CbsUpgrade.xml&#x27;</span><br><span class="line"></span><br><span class="line">Write-UpgradeXml -RemovalCandidates $removalCandidates `</span><br><span class="line">    -InstallCandidates $installCandidates[$SetEdition] `</span><br><span class="line">    -Stage $stageCurrentParam &gt;$xmlPath</span><br><span class="line"></span><br><span class="line">$editionXml = Find-EditionXml -Edition $SetEdition</span><br><span class="line">if($null -eq $editionXml) &#123;</span><br><span class="line">    Write-Warning &#x27;Unable to find edition specific settings XML. Proceeding without it...&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Write-Host &#x27;Starting the upgrade process. This may take a while...&#x27;</span><br><span class="line"></span><br><span class="line">DISM.EXE /English /NoRestart /Online /Apply-Unattend:$xmlPath</span><br><span class="line">$dismError = $LASTEXITCODE</span><br><span class="line"></span><br><span class="line">Remove-Item -Path $xmlPath -Force</span><br><span class="line"></span><br><span class="line">if(($dismError -ne 0) -and ($dismError -ne 3010)) &#123;</span><br><span class="line">    Write-Error &#x27;Failed to upgrade to the target edition&#x27;</span><br><span class="line">    Exit $dismError</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($null -ne $editionXml) &#123;</span><br><span class="line">    $destination = $Env:SystemRoot + &#x27;\&#x27; + $SetEdition + &#x27;.xml&#x27;</span><br><span class="line">    Copy-Item -Path $editionXml -Destination $destination</span><br><span class="line"></span><br><span class="line">    DISM.EXE /English /NoRestart /Online /Apply-Unattend:$editionXml</span><br><span class="line">    $dismError = $LASTEXITCODE</span><br><span class="line"></span><br><span class="line">    if(($dismError -ne 0) -and ($dismError -ne 3010)) &#123;</span><br><span class="line">        Write-Error &#x27;Failed to apply edition specific settings&#x27;</span><br><span class="line">        Exit $dismError</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Restart-Computer</span><br><span class="line">:cbsxml:]</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  Change edition using DISM API</span><br><span class="line">::  Thanks to Alex (aka may, ave9858)</span><br><span class="line"></span><br><span class="line">:dismapi:[</span><br><span class="line">param (</span><br><span class="line">    [Parameter()]</span><br><span class="line">    [String]$TargetEdition,</span><br><span class="line"></span><br><span class="line">    [Parameter()]</span><br><span class="line">    [String]$Key</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">$AssemblyBuilder = [AppDomain]::CurrentDomain.DefineDynamicAssembly(4, 1)</span><br><span class="line">$ModuleBuilder = $AssemblyBuilder.DefineDynamicModule(2, $False)</span><br><span class="line">$TB = $ModuleBuilder.DefineType(0)</span><br><span class="line"></span><br><span class="line">[void]$TB.DefinePInvokeMethod(&#x27;DismInitialize&#x27;, &#x27;DismApi.dll&#x27;, 22, 1, [int], @([int], [IntPtr], [IntPtr]), 1, 3)</span><br><span class="line">[void]$TB.DefinePInvokeMethod(&#x27;DismOpenSession&#x27;, &#x27;DismApi.dll&#x27;, 22, 1, [int], @([String], [IntPtr], [IntPtr], [UInt32].MakeByRefType()), 1, 3)</span><br><span class="line">[void]$TB.DefinePInvokeMethod(&#x27;_DismSetEdition&#x27;, &#x27;DismApi.dll&#x27;, 22, 1, [int], @([UInt32], [String], [String], [IntPtr], [IntPtr], [IntPtr]), 1, 3)</span><br><span class="line">$Dism = $TB.CreateType()</span><br><span class="line"></span><br><span class="line">[void]$Dism::DismInitialize(2, 0, 0)</span><br><span class="line">$Session = 0</span><br><span class="line">[void]$Dism::DismOpenSession(&#x27;DISM_&#123;53BFAE52-B167-4E2F-A258-0A37B57FF845&#125;&#x27;, 0, 0, [ref]$Session)</span><br><span class="line">if (!$Dism::_DismSetEdition($Session, &quot;$TargetEdition&quot;, &quot;$Key&quot;, 0, 0, 0)) &#123;</span><br><span class="line">    Restart-Computer</span><br><span class="line">&#125;</span><br><span class="line">:dismapi:]</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line"></span><br><span class="line">::  1st column = Generic Retail/OEM/MAK/GVLK Key</span><br><span class="line">::  2nd column = Key Type</span><br><span class="line">::  3rd column = WMI Edition ID</span><br><span class="line">::  4th column = Version name incase same Edition ID is used in different OS versions with different key</span><br><span class="line">::  Separator  = _</span><br><span class="line"></span><br><span class="line">::  For Windows 10/11 editions, HWID key is listed where ever possible, in Server versions, KMS key is listed where ever possible.</span><br><span class="line">::  Only RS3 and older version Generic keys are stored here, later ones are extracted from the pkeyhelper.dll itself</span><br><span class="line"></span><br><span class="line">:changeeditiondata</span><br><span class="line"></span><br><span class="line">if %winbuild% GTR 17763 exit /b</span><br><span class="line">if exist &quot;%SystemRoot%\Servicing\Packages\Microsoft-Windows-Server*CorEdition~*.mum&quot; (set Cor=Cor) else (set Cor=)</span><br><span class="line"></span><br><span class="line">set h=</span><br><span class="line">for %%# in (</span><br><span class="line">XGV%h%PP-NM%h%H47-7TT%h%HJ-W%h%3FW7-8HV%h%2C__OEM:NONSLP_Enterprise</span><br><span class="line">D6R%h%D9-D4%h%N8T-RT9%h%QX-Y%h%W6YT-FCW%h%WJ______Retail_Starter</span><br><span class="line">3V6%h%Q6-NQ%h%XCX-V8Y%h%XR-9%h%QCYV-QPF%h%CT__Volume:MAK_EnterpriseN</span><br><span class="line">3NF%h%XW-2T%h%27M-2BD%h%W6-4%h%GHRV-68X%h%RX______Retail_StarterN</span><br><span class="line">VK7%h%JG-NP%h%HTM-C97%h%JM-9%h%MPGT-3V6%h%6T______Retail_Professional</span><br><span class="line">2B8%h%7N-8K%h%FHP-DKV%h%6R-Y%h%2C8J-PKC%h%KT______Retail_ProfessionalN</span><br><span class="line">4CP%h%RK-NM%h%3K3-X6X%h%XQ-R%h%XX86-WXC%h%HW______Retail_CoreN</span><br><span class="line">N24%h%34-X9%h%D7W-8PF%h%6X-8%h%DV9T-8TY%h%MD______Retail_CoreCountrySpecific</span><br><span class="line">BT7%h%9Q-G7%h%N6G-PGB%h%YW-4%h%YWX6-6F4%h%BT______Retail_CoreSingleLanguage</span><br><span class="line">YTM%h%G3-N6%h%DKC-DKB%h%77-7%h%M9GH-8HV%h%X7______Retail_Core</span><br><span class="line">XKC%h%NC-J2%h%6Q9-KFH%h%D2-F%h%KTHY-KD7%h%2Y__OEM:NONSLP_PPIPro</span><br><span class="line">YNM%h%GQ-8R%h%YV3-4PG%h%Q3-C%h%8XTP-7CF%h%BY______Retail_Education</span><br><span class="line">84N%h%GF-MH%h%BT6-FXB%h%X8-Q%h%WJK7-DRR%h%8H______Retail_EducationN</span><br><span class="line">NK9%h%6Y-D9%h%CD8-W44%h%CQ-R%h%8YTK-DYJ%h%WX__OEM:NONSLP_EnterpriseS_RS1</span><br><span class="line">FWN%h%7H-PF%h%93Q-4GG%h%P8-M%h%8RF3-MDW%h%WW__OEM:NONSLP_EnterpriseS_TH</span><br><span class="line">2DB%h%W3-N2%h%PJG-MVH%h%W3-G%h%7TDK-9HK%h%R4__Volume:MAK_EnterpriseSN_RS1</span><br><span class="line">NTX%h%6B-BR%h%YC2-K67%h%86-F%h%6MVQ-M7V%h%2X__Volume:MAK_EnterpriseSN_TH</span><br><span class="line">G3K%h%NM-CH%h%G6T-R36%h%X3-9%h%QDG6-8M8%h%K9______Retail_ProfessionalSingleLanguage</span><br><span class="line">HNG%h%CC-Y3%h%8KG-QVK%h%8D-W%h%MWRK-X86%h%VK______Retail_ProfessionalCountrySpecific</span><br><span class="line">DXG%h%7C-N3%h%6C4-C4H%h%TG-X%h%4T3X-2YV%h%77______Retail_ProfessionalWorkstation</span><br><span class="line">WYP%h%NQ-8C%h%467-V2W%h%6J-T%h%X4WX-WT2%h%RQ______Retail_ProfessionalWorkstationN</span><br><span class="line">8PT%h%T6-RN%h%W4C-6V7%h%J2-C%h%2D3X-MHB%h%PB______Retail_ProfessionalEducation</span><br><span class="line">GJT%h%YN-HD%h%MQY-FRR%h%76-H%h%VGC7-QPF%h%8P______Retail_ProfessionalEducationN</span><br><span class="line">C4N%h%TJ-CX%h%6Q2-VXD%h%MR-X%h%VKGM-F9D%h%JC__Volume:MAK_EnterpriseG</span><br><span class="line">46P%h%N6-R9%h%BK9-CVH%h%KB-H%h%WQ9V-MBJ%h%Y8__Volume:MAK_EnterpriseGN</span><br><span class="line">NJC%h%F7-PW%h%8QT-332%h%4D-6%h%88JX-2YV%h%66______Retail_ServerRdsh</span><br><span class="line">V3W%h%VW-N2%h%PV2-CGW%h%C3-3%h%4QGF-VMJ%h%2C______Retail_Cloud</span><br><span class="line">NH9%h%J3-68%h%WK7-6FB%h%93-4%h%K3DF-DJ4%h%F6______Retail_CloudN</span><br><span class="line">2HN%h%6V-HG%h%TM8-6C9%h%7C-R%h%K67V-JQP%h%FD______Retail_CloudE</span><br><span class="line">WC2%h%BQ-8N%h%RM3-FDD%h%YY-2%h%BFGV-KHK%h%QY_Volume:GVLK_ServerStandard%Cor%_RS1</span><br><span class="line">CB7%h%KF-BW%h%N84-R7R%h%2Y-7%h%93K2-8XD%h%DG_Volume:GVLK_ServerDatacenter%Cor%_RS1</span><br><span class="line">JCK%h%RF-N3%h%7P4-C2D%h%82-9%h%YXRT-4M6%h%3B_Volume:GVLK_ServerSolution_RS1</span><br><span class="line">QN4%h%C6-GB%h%JD2-FB4%h%22-G%h%HWJK-GJG%h%2R_Volume:GVLK_ServerCloudStorage_RS1</span><br><span class="line">VP3%h%4G-4N%h%PPG-79J%h%TQ-8%h%64T4-R3M%h%QX_Volume:GVLK_ServerAzureCor_RS1</span><br><span class="line">9JQ%h%NQ-V8%h%HQ6-PKB%h%8H-G%h%GHRY-R62%h%H6______Retail_ServerAzureNano_RS1</span><br><span class="line">VN8%h%D3-PR%h%82H-DB6%h%BJ-J%h%9P4M-92F%h%6J______Retail_ServerStorageStandard_RS1</span><br><span class="line">48T%h%QX-NV%h%K3R-D8Q%h%R3-G%h%THHM-8FH%h%XC______Retail_ServerStorageWorkgroup_RS1</span><br><span class="line">2HX%h%DN-KR%h%XHB-GPY%h%C7-Y%h%CKFJ-7FV%h%DG_Volume:GVLK_ServerDatacenterACor_RS3</span><br><span class="line">PTX%h%N8-JF%h%HJM-4WC%h%78-M%h%PCBR-9W4%h%KR_Volume:GVLK_ServerStandardACor_RS3</span><br><span class="line">) do (</span><br><span class="line">for /f &quot;tokens=1-4 delims=_&quot; %%A in (&quot;%%#&quot;) do if /i %targetedition%==%%C (</span><br><span class="line"></span><br><span class="line">if not defined key (</span><br><span class="line">set 4th=%%D</span><br><span class="line">if not defined 4th (</span><br><span class="line">set &quot;key=%%A&quot; &amp; set &quot;_chan=%%B&quot;</span><br><span class="line">) else (</span><br><span class="line">echo &quot;%branch%&quot; | find /i &quot;%%D&quot; %nul1% &amp;&amp; (set &quot;key=%%A&quot; &amp; set &quot;_chan=%%B&quot;)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">:+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class="line"></span><br><span class="line">:MASend</span><br><span class="line">echo:</span><br><span class="line">if defined _MASunattended timeout /t 2 &amp; exit /b</span><br><span class="line">echo 按任意键退出....</span><br><span class="line">pause &gt;nul</span><br><span class="line">exit /b</span><br><span class="line"></span><br><span class="line">::========================================================================================================================================</span><br><span class="line">:: Leave empty line below</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://geyueshi.com">feifei</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://geyueshi.com/2024/08/23/win%E6%BF%80%E6%B4%BB/">https://geyueshi.com/2024/08/23/win激活/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">此文章版权归fiefei所有，如有转载，请注明来自原作者</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/">应用程序</a></div><div class="post_share"><div class="social-share" data-image="https://pic.imgdb.cn/item/66f52624f21886ccc0dd07f6.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>QQ群</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://s2.loli.net/2024/12/17/xUKMgG7uC6qdRfv.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2024/12/17/xUKMgG7uC6qdRfv.png" alt="qq群：303254470"/></a><div class="post-qr-code-desc">qq群：303254470</div></li></ul></div></div><div class="ads-wrap"><div class="ad" style="text-align: center;">
  <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2024/12/17/xUKMgG7uC6qdRfv.png" alt="社团群" />
  <p><b>加入大数据创智社团群，群号：303254470</b></p>
</div>
</div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2024/08/23/yuancheng/" title="Todesk远程工具"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/66f52625f21886ccc0dd0874.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Todesk远程工具</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/08/23/office/" title="Office2016专业版"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/66f52626f21886ccc0dd08fc.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-23</div><div class="title">Office2016专业版</div></div></a></div><div><a href="/2024/08/23/youhua/" title="系统优化"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/66f52624f21886ccc0dd07f6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-23</div><div class="title">系统优化</div></div></a></div><div><a href="/2024/08/23/yuancheng/" title="Todesk远程工具"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/66f52625f21886ccc0dd0874.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-23</div><div class="title">Todesk远程工具</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Windows%E6%BF%80%E6%B4%BB%E5%B7%A5%E5%85%B7"><span class="toc-number">1.</span> <span class="toc-text">Windows激活工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E5%88%B6%E4%BB%A3%E7%A0%81%E7%84%B6%E5%90%8E%E5%90%8E%E7%BC%80%E4%B8%BAcmd%E6%96%87%E4%BB%B6"><span class="toc-number">1.1.</span> <span class="toc-text">复制代码然后后缀为cmd文件</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://pic.imgdb.cn/item/66f52624f21886ccc0dd07f6.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2024 By 极风</div><div class="footer_custom_text">很高兴认识你</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>